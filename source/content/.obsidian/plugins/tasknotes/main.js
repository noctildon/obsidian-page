/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var Xc=Object.defineProperty;var zw=Object.getOwnPropertyDescriptor;var jw=Object.getOwnPropertyNames;var qw=Object.prototype.hasOwnProperty;var b=(i,e)=>()=>(i&&(e=i(i=0)),e);var ws=(i,e)=>{for(var t in e)Xc(i,t,{get:e[t],enumerable:!0})},Yw=(i,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of jw(e))!qw.call(i,s)&&s!==t&&Xc(i,s,{get:()=>e[s],enumerable:!(r=zw(e,s))||r.enumerable});return i};var Qw=i=>Yw(Xc({},"__esModule",{value:!0}),i);function je(i){return je=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},je(i)}var Lr=b(()=>{});function z(i){if(i===null||i===!0||i===!1)return NaN;var e=Number(i);return isNaN(e)?e:e<0?Math.ceil(e):Math.floor(e)}var Ue=b(()=>{});function O(i,e){if(e.length<i)throw new TypeError(i+" argument"+(i>1?"s":"")+" required, but only "+e.length+" present")}var ce=b(()=>{});function V(i){O(1,arguments);var e=Object.prototype.toString.call(i);return i instanceof Date||je(i)==="object"&&e==="[object Date]"?new Date(i.getTime()):typeof i=="number"||e==="[object Number]"?new Date(i):((typeof i=="string"||e==="[object String]")&&typeof console!="undefined"&&(console.warn("Starting with v2.0.0-beta.1 date-fns doesn't accept strings as date arguments. Please use `parseISO` to parse strings. See: https://github.com/date-fns/date-fns/blob/master/docs/upgradeGuide.md#string-arguments"),console.warn(new Error().stack)),new Date(NaN))}var Ee=b(()=>{Lr();ce()});function yt(i,e){O(2,arguments);var t=V(i),r=z(e);return isNaN(r)?new Date(NaN):(r&&t.setDate(t.getDate()+r),t)}var Jc=b(()=>{Ue();Ee();ce()});function ed(i,e){O(2,arguments);var t=V(i),r=z(e);if(isNaN(r))return new Date(NaN);if(!r)return t;var s=t.getDate(),n=new Date(t.getTime());n.setMonth(t.getMonth()+r+1,0);var a=n.getDate();return s>=a?n:(t.setFullYear(n.getFullYear(),n.getMonth(),s),t)}var mp=b(()=>{Ue();Ee();ce()});function Fr(i,e){if(O(2,arguments),!e||je(e)!=="object")return new Date(NaN);var t=e.years?z(e.years):0,r=e.months?z(e.months):0,s=e.weeks?z(e.weeks):0,n=e.days?z(e.days):0,a=e.hours?z(e.hours):0,o=e.minutes?z(e.minutes):0,l=e.seconds?z(e.seconds):0,c=V(i),d=r||t?ed(c,r+t*12):c,u=n||s?yt(d,n+s*7):d,f=o+a*60,h=l+f*60,m=h*1e3,p=new Date(u.getTime()+m);return p}var gp=b(()=>{Lr();Jc();mp();Ee();ce();Ue()});function td(i,e){O(2,arguments);var t=V(i).getTime(),r=z(e);return new Date(t+r)}var yp=b(()=>{Ue();Ee();ce()});function Qe(){return Gw}var Gw,mr=b(()=>{Gw={}});function ai(i,e){var t,r,s,n,a,o,l,c;O(1,arguments);var d=Qe(),u=z((t=(r=(s=(n=e==null?void 0:e.weekStartsOn)!==null&&n!==void 0?n:e==null||(a=e.locale)===null||a===void 0||(o=a.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&s!==void 0?s:d.weekStartsOn)!==null&&r!==void 0?r:(l=d.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&t!==void 0?t:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=V(i),h=f.getDay(),m=(h<u?7:0)+h-u;return f.setDate(f.getDate()-m),f.setHours(0,0,0,0),f}var vp=b(()=>{Ee();Ue();ce();mr()});function fn(i){var e=new Date(Date.UTC(i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()));return e.setUTCFullYear(i.getFullYear()),i.getTime()-e.getTime()}var rd=b(()=>{});function Re(i){O(1,arguments);var e=V(i);return e.setHours(0,0,0,0),e}var sd=b(()=>{Ee();ce()});var Kw,Zw,hn,pn,bp,Nx,Xw,wp,Ox,Jw,eT,Lx,lo=b(()=>{Kw=365.2425,Zw=Math.pow(10,8)*24*60*60*1e3,hn=6e4,pn=36e5,bp=1e3,Nx=-Zw,Xw=3600,wp=Xw*24,Ox=wp*7,Jw=wp*Kw,eT=Jw/12,Lx=eT*3});function gr(i,e){O(2,arguments);var t=Re(i),r=Re(e);return t.getTime()===r.getTime()}var id=b(()=>{sd();ce()});function nd(i){return O(1,arguments),i instanceof Date||je(i)==="object"&&Object.prototype.toString.call(i)==="[object Date]"}var Tp=b(()=>{Lr();ce()});function Hr(i){if(O(1,arguments),!nd(i)&&typeof i!="number")return!1;var e=V(i);return!isNaN(Number(e))}var ad=b(()=>{Tp();Ee();ce()});function Ts(i){O(1,arguments);var e=V(i);return e.setHours(23,59,59,999),e}var Ep=b(()=>{Ee();ce()});function oi(i,e){var t,r,s,n,a,o,l,c;O(1,arguments);var d=Qe(),u=z((t=(r=(s=(n=e==null?void 0:e.weekStartsOn)!==null&&n!==void 0?n:e==null||(a=e.locale)===null||a===void 0||(o=a.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&s!==void 0?s:d.weekStartsOn)!==null&&r!==void 0?r:(l=d.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&t!==void 0?t:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=V(i),h=f.getDay(),m=(h<u?-7:0)+6-(h-u);return f.setDate(f.getDate()+m),f.setHours(23,59,59,999),f}var kp=b(()=>{mr();Ee();Ue();ce()});function mn(i,e){O(2,arguments);var t=z(e);return td(i,-t)}var od=b(()=>{yp();ce();Ue()});function ld(i){O(1,arguments);var e=V(i),t=e.getTime();e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0);var r=e.getTime(),s=t-r;return Math.floor(s/tT)+1}var tT,Dp=b(()=>{Ee();ce();tT=864e5});function vt(i){O(1,arguments);var e=1,t=V(i),r=t.getUTCDay(),s=(r<e?7:0)+r-e;return t.setUTCDate(t.getUTCDate()-s),t.setUTCHours(0,0,0,0),t}var li=b(()=>{Ee();ce()});function gn(i){O(1,arguments);var e=V(i),t=e.getUTCFullYear(),r=new Date(0);r.setUTCFullYear(t+1,0,4),r.setUTCHours(0,0,0,0);var s=vt(r),n=new Date(0);n.setUTCFullYear(t,0,4),n.setUTCHours(0,0,0,0);var a=vt(n);return e.getTime()>=s.getTime()?t+1:e.getTime()>=a.getTime()?t:t-1}var cd=b(()=>{Ee();ce();li()});function dd(i){O(1,arguments);var e=gn(i),t=new Date(0);t.setUTCFullYear(e,0,4),t.setUTCHours(0,0,0,0);var r=vt(t);return r}var Sp=b(()=>{cd();li();ce()});function yn(i){O(1,arguments);var e=V(i),t=vt(e).getTime()-dd(e).getTime();return Math.round(t/rT)+1}var rT,ud=b(()=>{Ee();li();Sp();ce();rT=6048e5});function dt(i,e){var t,r,s,n,a,o,l,c;O(1,arguments);var d=Qe(),u=z((t=(r=(s=(n=e==null?void 0:e.weekStartsOn)!==null&&n!==void 0?n:e==null||(a=e.locale)===null||a===void 0||(o=a.options)===null||o===void 0?void 0:o.weekStartsOn)!==null&&s!==void 0?s:d.weekStartsOn)!==null&&r!==void 0?r:(l=d.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.weekStartsOn)!==null&&t!==void 0?t:0);if(!(u>=0&&u<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var f=V(i),h=f.getUTCDay(),m=(h<u?7:0)+h-u;return f.setUTCDate(f.getUTCDate()-m),f.setUTCHours(0,0,0,0),f}var ci=b(()=>{Ee();ce();Ue();mr()});function Es(i,e){var t,r,s,n,a,o,l,c;O(1,arguments);var d=V(i),u=d.getUTCFullYear(),f=Qe(),h=z((t=(r=(s=(n=e==null?void 0:e.firstWeekContainsDate)!==null&&n!==void 0?n:e==null||(a=e.locale)===null||a===void 0||(o=a.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&s!==void 0?s:f.firstWeekContainsDate)!==null&&r!==void 0?r:(l=f.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&t!==void 0?t:1);if(!(h>=1&&h<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var m=new Date(0);m.setUTCFullYear(u+1,0,h),m.setUTCHours(0,0,0,0);var p=dt(m,e),g=new Date(0);g.setUTCFullYear(u,0,h),g.setUTCHours(0,0,0,0);var v=dt(g,e);return d.getTime()>=p.getTime()?u+1:d.getTime()>=v.getTime()?u:u-1}var co=b(()=>{Ee();ce();ci();Ue();mr()});function fd(i,e){var t,r,s,n,a,o,l,c;O(1,arguments);var d=Qe(),u=z((t=(r=(s=(n=e==null?void 0:e.firstWeekContainsDate)!==null&&n!==void 0?n:e==null||(a=e.locale)===null||a===void 0||(o=a.options)===null||o===void 0?void 0:o.firstWeekContainsDate)!==null&&s!==void 0?s:d.firstWeekContainsDate)!==null&&r!==void 0?r:(l=d.locale)===null||l===void 0||(c=l.options)===null||c===void 0?void 0:c.firstWeekContainsDate)!==null&&t!==void 0?t:1),f=Es(i,e),h=new Date(0);h.setUTCFullYear(f,0,u),h.setUTCHours(0,0,0,0);var m=dt(h,e);return m}var Cp=b(()=>{co();ce();ci();Ue();mr()});function vn(i,e){O(1,arguments);var t=V(i),r=dt(t,e).getTime()-fd(t,e).getTime();return Math.round(r/sT)+1}var sT,hd=b(()=>{Ee();ci();Cp();ce();sT=6048e5});function de(i,e){for(var t=i<0?"-":"",r=Math.abs(i).toString();r.length<e;)r="0"+r;return t+r}var pd=b(()=>{});var iT,yr,_p=b(()=>{pd();iT={y:function(e,t){var r=e.getUTCFullYear(),s=r>0?r:1-r;return de(t==="yy"?s%100:s,t.length)},M:function(e,t){var r=e.getUTCMonth();return t==="M"?String(r+1):de(r+1,2)},d:function(e,t){return de(e.getUTCDate(),t.length)},a:function(e,t){var r=e.getUTCHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h:function(e,t){return de(e.getUTCHours()%12||12,t.length)},H:function(e,t){return de(e.getUTCHours(),t.length)},m:function(e,t){return de(e.getUTCMinutes(),t.length)},s:function(e,t){return de(e.getUTCSeconds(),t.length)},S:function(e,t){var r=t.length,s=e.getUTCMilliseconds(),n=Math.floor(s*Math.pow(10,r-3));return de(n,t.length)}},yr=iT});function xp(i,e){var t=i>0?"-":"+",r=Math.abs(i),s=Math.floor(r/60),n=r%60;if(n===0)return t+String(s);var a=e||"";return t+String(s)+a+de(n,2)}function Mp(i,e){if(i%60===0){var t=i>0?"-":"+";return t+de(Math.abs(i)/60,2)}return ks(i,e)}function ks(i,e){var t=e||"",r=i>0?"-":"+",s=Math.abs(i),n=de(Math.floor(s/60),2),a=de(s%60,2);return r+n+t+a}var di,nT,Ap,Ip=b(()=>{Dp();ud();cd();hd();co();pd();_p();di={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},nT={G:function(e,t,r){var s=e.getUTCFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return r.era(s,{width:"abbreviated"});case"GGGGG":return r.era(s,{width:"narrow"});case"GGGG":default:return r.era(s,{width:"wide"})}},y:function(e,t,r){if(t==="yo"){var s=e.getUTCFullYear(),n=s>0?s:1-s;return r.ordinalNumber(n,{unit:"year"})}return yr.y(e,t)},Y:function(e,t,r,s){var n=Es(e,s),a=n>0?n:1-n;if(t==="YY"){var o=a%100;return de(o,2)}return t==="Yo"?r.ordinalNumber(a,{unit:"year"}):de(a,t.length)},R:function(e,t){var r=gn(e);return de(r,t.length)},u:function(e,t){var r=e.getUTCFullYear();return de(r,t.length)},Q:function(e,t,r){var s=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"Q":return String(s);case"QQ":return de(s,2);case"Qo":return r.ordinalNumber(s,{unit:"quarter"});case"QQQ":return r.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return r.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(s,{width:"wide",context:"formatting"})}},q:function(e,t,r){var s=Math.ceil((e.getUTCMonth()+1)/3);switch(t){case"q":return String(s);case"qq":return de(s,2);case"qo":return r.ordinalNumber(s,{unit:"quarter"});case"qqq":return r.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return r.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(s,{width:"wide",context:"standalone"})}},M:function(e,t,r){var s=e.getUTCMonth();switch(t){case"M":case"MM":return yr.M(e,t);case"Mo":return r.ordinalNumber(s+1,{unit:"month"});case"MMM":return r.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return r.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(s,{width:"wide",context:"formatting"})}},L:function(e,t,r){var s=e.getUTCMonth();switch(t){case"L":return String(s+1);case"LL":return de(s+1,2);case"Lo":return r.ordinalNumber(s+1,{unit:"month"});case"LLL":return r.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return r.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(s,{width:"wide",context:"standalone"})}},w:function(e,t,r,s){var n=vn(e,s);return t==="wo"?r.ordinalNumber(n,{unit:"week"}):de(n,t.length)},I:function(e,t,r){var s=yn(e);return t==="Io"?r.ordinalNumber(s,{unit:"week"}):de(s,t.length)},d:function(e,t,r){return t==="do"?r.ordinalNumber(e.getUTCDate(),{unit:"date"}):yr.d(e,t)},D:function(e,t,r){var s=ld(e);return t==="Do"?r.ordinalNumber(s,{unit:"dayOfYear"}):de(s,t.length)},E:function(e,t,r){var s=e.getUTCDay();switch(t){case"E":case"EE":case"EEE":return r.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return r.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(s,{width:"short",context:"formatting"});case"EEEE":default:return r.day(s,{width:"wide",context:"formatting"})}},e:function(e,t,r,s){var n=e.getUTCDay(),a=(n-s.weekStartsOn+8)%7||7;switch(t){case"e":return String(a);case"ee":return de(a,2);case"eo":return r.ordinalNumber(a,{unit:"day"});case"eee":return r.day(n,{width:"abbreviated",context:"formatting"});case"eeeee":return r.day(n,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(n,{width:"short",context:"formatting"});case"eeee":default:return r.day(n,{width:"wide",context:"formatting"})}},c:function(e,t,r,s){var n=e.getUTCDay(),a=(n-s.weekStartsOn+8)%7||7;switch(t){case"c":return String(a);case"cc":return de(a,t.length);case"co":return r.ordinalNumber(a,{unit:"day"});case"ccc":return r.day(n,{width:"abbreviated",context:"standalone"});case"ccccc":return r.day(n,{width:"narrow",context:"standalone"});case"cccccc":return r.day(n,{width:"short",context:"standalone"});case"cccc":default:return r.day(n,{width:"wide",context:"standalone"})}},i:function(e,t,r){var s=e.getUTCDay(),n=s===0?7:s;switch(t){case"i":return String(n);case"ii":return de(n,t.length);case"io":return r.ordinalNumber(n,{unit:"day"});case"iii":return r.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return r.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return r.day(s,{width:"short",context:"formatting"});case"iiii":default:return r.day(s,{width:"wide",context:"formatting"})}},a:function(e,t,r){var s=e.getUTCHours(),n=s/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"aaa":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},b:function(e,t,r){var s=e.getUTCHours(),n;switch(s===12?n=di.noon:s===0?n=di.midnight:n=s/12>=1?"pm":"am",t){case"b":case"bb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"bbb":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},B:function(e,t,r){var s=e.getUTCHours(),n;switch(s>=17?n=di.evening:s>=12?n=di.afternoon:s>=4?n=di.morning:n=di.night,t){case"B":case"BB":case"BBB":return r.dayPeriod(n,{width:"abbreviated",context:"formatting"});case"BBBBB":return r.dayPeriod(n,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(n,{width:"wide",context:"formatting"})}},h:function(e,t,r){if(t==="ho"){var s=e.getUTCHours()%12;return s===0&&(s=12),r.ordinalNumber(s,{unit:"hour"})}return yr.h(e,t)},H:function(e,t,r){return t==="Ho"?r.ordinalNumber(e.getUTCHours(),{unit:"hour"}):yr.H(e,t)},K:function(e,t,r){var s=e.getUTCHours()%12;return t==="Ko"?r.ordinalNumber(s,{unit:"hour"}):de(s,t.length)},k:function(e,t,r){var s=e.getUTCHours();return s===0&&(s=24),t==="ko"?r.ordinalNumber(s,{unit:"hour"}):de(s,t.length)},m:function(e,t,r){return t==="mo"?r.ordinalNumber(e.getUTCMinutes(),{unit:"minute"}):yr.m(e,t)},s:function(e,t,r){return t==="so"?r.ordinalNumber(e.getUTCSeconds(),{unit:"second"}):yr.s(e,t)},S:function(e,t){return yr.S(e,t)},X:function(e,t,r,s){var n=s._originalDate||e,a=n.getTimezoneOffset();if(a===0)return"Z";switch(t){case"X":return Mp(a);case"XXXX":case"XX":return ks(a);case"XXXXX":case"XXX":default:return ks(a,":")}},x:function(e,t,r,s){var n=s._originalDate||e,a=n.getTimezoneOffset();switch(t){case"x":return Mp(a);case"xxxx":case"xx":return ks(a);case"xxxxx":case"xxx":default:return ks(a,":")}},O:function(e,t,r,s){var n=s._originalDate||e,a=n.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+xp(a,":");case"OOOO":default:return"GMT"+ks(a,":")}},z:function(e,t,r,s){var n=s._originalDate||e,a=n.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+xp(a,":");case"zzzz":default:return"GMT"+ks(a,":")}},t:function(e,t,r,s){var n=s._originalDate||e,a=Math.floor(n.getTime()/1e3);return de(a,t.length)},T:function(e,t,r,s){var n=s._originalDate||e,a=n.getTime();return de(a,t.length)}};Ap=nT});var Pp,Rp,aT,oT,bn,md=b(()=>{Pp=function(e,t){switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},Rp=function(e,t){switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},aT=function(e,t){var r=e.match(/(P+)(p+)?/)||[],s=r[1],n=r[2];if(!n)return Pp(e,t);var a;switch(s){case"P":a=t.dateTime({width:"short"});break;case"PP":a=t.dateTime({width:"medium"});break;case"PPP":a=t.dateTime({width:"long"});break;case"PPPP":default:a=t.dateTime({width:"full"});break}return a.replace("{{date}}",Pp(s,t)).replace("{{time}}",Rp(n,t))},oT={p:Rp,P:aT},bn=oT});function uo(i){return lT.indexOf(i)!==-1}function fo(i){return cT.indexOf(i)!==-1}function ui(i,e,t){if(i==="YYYY")throw new RangeError("Use `yyyy` instead of `YYYY` (in `".concat(e,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(i==="YY")throw new RangeError("Use `yy` instead of `YY` (in `".concat(e,"`) for formatting years to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(i==="D")throw new RangeError("Use `d` instead of `D` (in `".concat(e,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"));if(i==="DD")throw new RangeError("Use `dd` instead of `DD` (in `".concat(e,"`) for formatting days of the month to the input `").concat(t,"`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md"))}var lT,cT,gd=b(()=>{lT=["D","DD"],cT=["YY","YYYY"]});var dT,uT,Np,Op=b(()=>{dT={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},uT=function(e,t,r){var s,n=dT[e];return typeof n=="string"?s=n:t===1?s=n.one:s=n.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+s:s+" ago":s},Np=uT});function wn(i){return function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=e.width?String(e.width):i.defaultWidth,r=i.formats[t]||i.formats[i.defaultWidth];return r}}var Lp=b(()=>{});var fT,hT,pT,mT,Fp,Hp=b(()=>{Lp();fT={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},hT={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},pT={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},mT={date:wn({formats:fT,defaultWidth:"full"}),time:wn({formats:hT,defaultWidth:"full"}),dateTime:wn({formats:pT,defaultWidth:"full"})},Fp=mT});var gT,yT,Bp,Wp=b(()=>{gT={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},yT=function(e,t,r,s){return gT[e]},Bp=yT});function Ds(i){return function(e,t){var r=t!=null&&t.context?String(t.context):"standalone",s;if(r==="formatting"&&i.formattingValues){var n=i.defaultFormattingWidth||i.defaultWidth,a=t!=null&&t.width?String(t.width):n;s=i.formattingValues[a]||i.formattingValues[n]}else{var o=i.defaultWidth,l=t!=null&&t.width?String(t.width):i.defaultWidth;s=i.values[l]||i.values[o]}var c=i.argumentCallback?i.argumentCallback(e):e;return s[c]}}var Up=b(()=>{});var vT,bT,wT,TT,ET,kT,DT,ST,$p,Vp=b(()=>{Up();vT={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},bT={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},wT={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},TT={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},ET={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},kT={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},DT=function(e,t){var r=Number(e),s=r%100;if(s>20||s<10)switch(s%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},ST={ordinalNumber:DT,era:Ds({values:vT,defaultWidth:"wide"}),quarter:Ds({values:bT,defaultWidth:"wide",argumentCallback:function(e){return e-1}}),month:Ds({values:wT,defaultWidth:"wide"}),day:Ds({values:TT,defaultWidth:"wide"}),dayPeriod:Ds({values:ET,defaultWidth:"wide",formattingValues:kT,defaultFormattingWidth:"wide"})},$p=ST});function Ss(i){return function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.width,s=r&&i.matchPatterns[r]||i.matchPatterns[i.defaultMatchWidth],n=e.match(s);if(!n)return null;var a=n[0],o=r&&i.parsePatterns[r]||i.parsePatterns[i.defaultParseWidth],l=Array.isArray(o)?_T(o,function(u){return u.test(a)}):CT(o,function(u){return u.test(a)}),c;c=i.valueCallback?i.valueCallback(l):l,c=t.valueCallback?t.valueCallback(c):c;var d=e.slice(a.length);return{value:c,rest:d}}}function CT(i,e){for(var t in i)if(i.hasOwnProperty(t)&&e(i[t]))return t}function _T(i,e){for(var t=0;t<i.length;t++)if(e(i[t]))return t}var zp=b(()=>{});function yd(i){return function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=e.match(i.matchPattern);if(!r)return null;var s=r[0],n=e.match(i.parsePattern);if(!n)return null;var a=i.valueCallback?i.valueCallback(n[0]):n[0];a=t.valueCallback?t.valueCallback(a):a;var o=e.slice(s.length);return{value:a,rest:o}}}var jp=b(()=>{});var xT,MT,AT,IT,PT,RT,NT,OT,LT,FT,HT,BT,WT,qp,Yp=b(()=>{zp();jp();xT=/^(\d+)(th|st|nd|rd)?/i,MT=/\d+/i,AT={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},IT={any:[/^b/i,/^(a|c)/i]},PT={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},RT={any:[/1/i,/2/i,/3/i,/4/i]},NT={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},OT={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},LT={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},FT={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},HT={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},BT={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},WT={ordinalNumber:yd({matchPattern:xT,parsePattern:MT,valueCallback:function(e){return parseInt(e,10)}}),era:Ss({matchPatterns:AT,defaultMatchWidth:"wide",parsePatterns:IT,defaultParseWidth:"any"}),quarter:Ss({matchPatterns:PT,defaultMatchWidth:"wide",parsePatterns:RT,defaultParseWidth:"any",valueCallback:function(e){return e+1}}),month:Ss({matchPatterns:NT,defaultMatchWidth:"wide",parsePatterns:OT,defaultParseWidth:"any"}),day:Ss({matchPatterns:LT,defaultMatchWidth:"wide",parsePatterns:FT,defaultParseWidth:"any"}),dayPeriod:Ss({matchPatterns:HT,defaultMatchWidth:"any",parsePatterns:BT,defaultParseWidth:"any"})},qp=WT});var UT,Qp,Gp=b(()=>{Op();Hp();Wp();Vp();Yp();UT={code:"en-US",formatDistance:Np,formatLong:Fp,formatRelative:Bp,localize:$p,match:qp,options:{weekStartsOn:0,firstWeekContainsDate:1}},Qp=UT});var ho,vd=b(()=>{Gp();ho=Qp});function k(i,e,t){var r,s,n,a,o,l,c,d,u,f,h,m,p,g,v,w,_,E;O(2,arguments);var S=String(e),D=Qe(),A=(r=(s=t==null?void 0:t.locale)!==null&&s!==void 0?s:D.locale)!==null&&r!==void 0?r:ho,C=z((n=(a=(o=(l=t==null?void 0:t.firstWeekContainsDate)!==null&&l!==void 0?l:t==null||(c=t.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.firstWeekContainsDate)!==null&&o!==void 0?o:D.firstWeekContainsDate)!==null&&a!==void 0?a:(u=D.locale)===null||u===void 0||(f=u.options)===null||f===void 0?void 0:f.firstWeekContainsDate)!==null&&n!==void 0?n:1);if(!(C>=1&&C<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var B=z((h=(m=(p=(g=t==null?void 0:t.weekStartsOn)!==null&&g!==void 0?g:t==null||(v=t.locale)===null||v===void 0||(w=v.options)===null||w===void 0?void 0:w.weekStartsOn)!==null&&p!==void 0?p:D.weekStartsOn)!==null&&m!==void 0?m:(_=D.locale)===null||_===void 0||(E=_.options)===null||E===void 0?void 0:E.weekStartsOn)!==null&&h!==void 0?h:0);if(!(B>=0&&B<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(!A.localize)throw new RangeError("locale must contain localize property");if(!A.formatLong)throw new RangeError("locale must contain formatLong property");var $=V(i);if(!Hr($))throw new RangeError("Invalid time value");var K=fn($),Be=mn($,K),mt={firstWeekContainsDate:C,weekStartsOn:B,locale:A,_originalDate:$},De=S.match(VT).map(function(xe){var ct=xe[0];if(ct==="p"||ct==="P"){var bs=bn[ct];return bs(xe,A.formatLong)}return xe}).join("").match($T).map(function(xe){if(xe==="''")return"'";var ct=xe[0];if(ct==="'")return YT(xe);var bs=Ap[ct];if(bs)return!(t!=null&&t.useAdditionalWeekYearTokens)&&fo(xe)&&ui(xe,e,String(i)),!(t!=null&&t.useAdditionalDayOfYearTokens)&&uo(xe)&&ui(xe,e,String(i)),bs(Be,xe,A.localize,mt);if(ct.match(qT))throw new RangeError("Format string contains an unescaped latin alphabet character `"+ct+"`");return xe}).join("");return De}function YT(i){var e=i.match(zT);return e?e[1].replace(jT,"'"):i}var $T,VT,zT,jT,qT,Kp=b(()=>{ad();od();Ee();Ip();md();rd();gd();Ue();ce();mr();vd();$T=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,VT=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,zT=/^'([^]*?)'?$/,jT=/''/g,qT=/[a-zA-Z]/});function bd(i,e){if(i==null)throw new TypeError("assign requires that input parameter not be null or undefined");for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(i[t]=e[t]);return i}var Zp=b(()=>{});function Gt(i,e){O(2,arguments);var t=V(i),r=V(e);return t.getTime()<r.getTime()}var Xp=b(()=>{Ee();ce()});function wd(i,e){(e==null||e>i.length)&&(e=i.length);for(var t=0,r=Array(e);t<e;t++)r[t]=i[t];return r}var Jp=b(()=>{});function em(i,e){if(i){if(typeof i=="string")return wd(i,e);var t={}.toString.call(i).slice(8,-1);return t==="Object"&&i.constructor&&(t=i.constructor.name),t==="Map"||t==="Set"?Array.from(i):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?wd(i,e):void 0}}var tm=b(()=>{Jp()});function Td(i,e){var t=typeof Symbol!="undefined"&&i[Symbol.iterator]||i["@@iterator"];if(!t){if(Array.isArray(i)||(t=em(i))||e&&i&&typeof i.length=="number"){t&&(i=t);var r=0,s=function(){};return{s,n:function(){return r>=i.length?{done:!0}:{done:!1,value:i[r++]}},e:function(c){throw c},f:s}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var n,a=!0,o=!1;return{s:function(){t=t.call(i)},n:function(){var c=t.next();return a=c.done,c},e:function(c){o=!0,n=c},f:function(){try{a||t.return==null||t.return()}finally{if(o)throw n}}}}var rm=b(()=>{tm()});function M(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}var J=b(()=>{});function po(i,e){return po=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},po(i,e)}var sm=b(()=>{});function R(i,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&po(i,e)}var ae=b(()=>{sm()});function Tn(i){return Tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Tn(i)}var im=b(()=>{});function Ed(){try{var i=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ed=function(){return!!i})()}var nm=b(()=>{});function am(i,e){if(e&&(je(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return M(i)}var om=b(()=>{Lr();J()});function N(i){var e=Ed();return function(){var t,r=Tn(i);if(e){var s=Tn(this).constructor;t=Reflect.construct(r,arguments,s)}else t=r.apply(this,arguments);return am(this,t)}}var oe=b(()=>{im();nm();om()});function I(i,e){if(!(i instanceof e))throw new TypeError("Cannot call a class as a function")}var ee=b(()=>{});function lm(i,e){if(je(i)!="object"||!i)return i;var t=i[Symbol.toPrimitive];if(t!==void 0){var r=t.call(i,e||"default");if(je(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(i)}var cm=b(()=>{Lr()});function mo(i){var e=lm(i,"string");return je(e)=="symbol"?e:e+""}var kd=b(()=>{Lr();cm()});function dm(i,e){for(var t=0;t<e.length;t++){var r=e[t];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(i,mo(r.key),r)}}function P(i,e,t){return e&&dm(i.prototype,e),t&&dm(i,t),Object.defineProperty(i,"prototype",{writable:!1}),i}var te=b(()=>{kd()});function x(i,e,t){return(e=mo(e))in i?Object.defineProperty(i,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):i[e]=t,i}var re=b(()=>{kd()});var QT,um,fm,hm,Dd=b(()=>{J();ae();oe();ee();te();re();QT=10,um=function(){function i(){I(this,i),x(this,"priority",void 0),x(this,"subPriority",0)}return P(i,[{key:"validate",value:function(t,r){return!0}}]),i}(),fm=function(i){R(t,i);var e=N(t);function t(r,s,n,a,o){var l;return I(this,t),l=e.call(this),l.value=r,l.validateValue=s,l.setValue=n,l.priority=a,o&&(l.subPriority=o),l}return P(t,[{key:"validate",value:function(s,n){return this.validateValue(s,this.value,n)}},{key:"set",value:function(s,n,a){return this.setValue(s,n,this.value,a)}}]),t}(um),hm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",QT),x(M(r),"subPriority",-1),r}return P(t,[{key:"set",value:function(s,n){if(n.timestampIsSet)return s;var a=new Date(0);return a.setFullYear(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()),a.setHours(s.getUTCHours(),s.getUTCMinutes(),s.getUTCSeconds(),s.getUTCMilliseconds()),a}}]),t}(um)});var L,ue=b(()=>{ee();te();re();Dd();L=function(){function i(){I(this,i),x(this,"incompatibleTokens",void 0),x(this,"priority",void 0),x(this,"subPriority",void 0)}return P(i,[{key:"run",value:function(t,r,s,n){var a=this.parse(t,r,s,n);return a?{setter:new fm(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}},{key:"validate",value:function(t,r,s){return!0}}]),i}()});var pm,mm=b(()=>{ee();te();J();ae();oe();re();ue();pm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",140),x(M(r),"incompatibleTokens",["R","u","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"G":case"GG":case"GGG":return a.era(s,{width:"abbreviated"})||a.era(s,{width:"narrow"});case"GGGGG":return a.era(s,{width:"narrow"});case"GGGG":default:return a.era(s,{width:"wide"})||a.era(s,{width:"abbreviated"})||a.era(s,{width:"narrow"})}}},{key:"set",value:function(s,n,a){return n.era=a,s.setUTCFullYear(a,0,1),s.setUTCHours(0,0,0,0),s}}]),t}(L)});var se,bt,Ge=b(()=>{se={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},bt={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/}});function be(i,e){return i&&{value:e(i.value),rest:i.rest}}function Z(i,e){var t=e.match(i);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function wt(i,e){var t=e.match(i);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};var r=t[1]==="+"?1:-1,s=t[2]?parseInt(t[2],10):0,n=t[3]?parseInt(t[3],10):0,a=t[5]?parseInt(t[5],10):0;return{value:r*(s*pn+n*hn+a*bp),rest:e.slice(t[0].length)}}function go(i){return Z(se.anyDigitsSigned,i)}function q(i,e){switch(i){case 1:return Z(se.singleDigit,e);case 2:return Z(se.twoDigits,e);case 3:return Z(se.threeDigits,e);case 4:return Z(se.fourDigits,e);default:return Z(new RegExp("^\\d{1,"+i+"}"),e)}}function fi(i,e){switch(i){case 1:return Z(se.singleDigitSigned,e);case 2:return Z(se.twoDigitsSigned,e);case 3:return Z(se.threeDigitsSigned,e);case 4:return Z(se.fourDigitsSigned,e);default:return Z(new RegExp("^-?\\d{1,"+i+"}"),e)}}function hi(i){switch(i){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function yo(i,e){var t=e>0,r=t?e:1-e,s;if(r<=50)s=i||100;else{var n=r+50,a=Math.floor(n/100)*100,o=i>=n%100;s=i+a-(o?100:0)}return t?s:1-s}function vo(i){return i%400===0||i%4===0&&i%100!==0}var me=b(()=>{lo();Ge()});var gm,ym=b(()=>{ee();te();J();ae();oe();re();ue();me();gm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",130),x(M(r),"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){var o=function(c){return{year:c,isTwoDigitYear:n==="yy"}};switch(n){case"y":return be(q(4,s),o);case"yo":return be(a.ordinalNumber(s,{unit:"year"}),o);default:return be(q(n.length,s),o)}}},{key:"validate",value:function(s,n){return n.isTwoDigitYear||n.year>0}},{key:"set",value:function(s,n,a){var o=s.getUTCFullYear();if(a.isTwoDigitYear){var l=yo(a.year,o);return s.setUTCFullYear(l,0,1),s.setUTCHours(0,0,0,0),s}var c=!("era"in n)||n.era===1?a.year:1-a.year;return s.setUTCFullYear(c,0,1),s.setUTCHours(0,0,0,0),s}}]),t}(L)});var vm,bm=b(()=>{ee();te();J();ae();oe();re();ue();me();co();ci();vm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",130),x(M(r),"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){var o=function(c){return{year:c,isTwoDigitYear:n==="YY"}};switch(n){case"Y":return be(q(4,s),o);case"Yo":return be(a.ordinalNumber(s,{unit:"year"}),o);default:return be(q(n.length,s),o)}}},{key:"validate",value:function(s,n){return n.isTwoDigitYear||n.year>0}},{key:"set",value:function(s,n,a,o){var l=Es(s,o);if(a.isTwoDigitYear){var c=yo(a.year,l);return s.setUTCFullYear(c,0,o.firstWeekContainsDate),s.setUTCHours(0,0,0,0),dt(s,o)}var d=!("era"in n)||n.era===1?a.year:1-a.year;return s.setUTCFullYear(d,0,o.firstWeekContainsDate),s.setUTCHours(0,0,0,0),dt(s,o)}}]),t}(L)});var wm,Tm=b(()=>{ee();te();J();ae();oe();re();ue();me();li();wm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",130),x(M(r),"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]),r}return P(t,[{key:"parse",value:function(s,n){return n==="R"?fi(4,s):fi(n.length,s)}},{key:"set",value:function(s,n,a){var o=new Date(0);return o.setUTCFullYear(a,0,4),o.setUTCHours(0,0,0,0),vt(o)}}]),t}(L)});var Em,km=b(()=>{ee();te();J();ae();oe();re();ue();me();Em=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",130),x(M(r),"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"]),r}return P(t,[{key:"parse",value:function(s,n){return n==="u"?fi(4,s):fi(n.length,s)}},{key:"set",value:function(s,n,a){return s.setUTCFullYear(a,0,1),s.setUTCHours(0,0,0,0),s}}]),t}(L)});var Dm,Sm=b(()=>{ee();te();J();ae();oe();re();ue();me();Dm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",120),x(M(r),"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"Q":case"QQ":return q(n.length,s);case"Qo":return a.ordinalNumber(s,{unit:"quarter"});case"QQQ":return a.quarter(s,{width:"abbreviated",context:"formatting"})||a.quarter(s,{width:"narrow",context:"formatting"});case"QQQQQ":return a.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(s,{width:"wide",context:"formatting"})||a.quarter(s,{width:"abbreviated",context:"formatting"})||a.quarter(s,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(s,n){return n>=1&&n<=4}},{key:"set",value:function(s,n,a){return s.setUTCMonth((a-1)*3,1),s.setUTCHours(0,0,0,0),s}}]),t}(L)});var Cm,_m=b(()=>{ee();te();J();ae();oe();re();ue();me();Cm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",120),x(M(r),"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"q":case"qq":return q(n.length,s);case"qo":return a.ordinalNumber(s,{unit:"quarter"});case"qqq":return a.quarter(s,{width:"abbreviated",context:"standalone"})||a.quarter(s,{width:"narrow",context:"standalone"});case"qqqqq":return a.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(s,{width:"wide",context:"standalone"})||a.quarter(s,{width:"abbreviated",context:"standalone"})||a.quarter(s,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(s,n){return n>=1&&n<=4}},{key:"set",value:function(s,n,a){return s.setUTCMonth((a-1)*3,1),s.setUTCHours(0,0,0,0),s}}]),t}(L)});var xm,Mm=b(()=>{ee();te();J();ae();oe();re();me();ue();Ge();xm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]),x(M(r),"priority",110),r}return P(t,[{key:"parse",value:function(s,n,a){var o=function(c){return c-1};switch(n){case"M":return be(Z(se.month,s),o);case"MM":return be(q(2,s),o);case"Mo":return be(a.ordinalNumber(s,{unit:"month"}),o);case"MMM":return a.month(s,{width:"abbreviated",context:"formatting"})||a.month(s,{width:"narrow",context:"formatting"});case"MMMMM":return a.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(s,{width:"wide",context:"formatting"})||a.month(s,{width:"abbreviated",context:"formatting"})||a.month(s,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(s,n){return n>=0&&n<=11}},{key:"set",value:function(s,n,a){return s.setUTCMonth(a,1),s.setUTCHours(0,0,0,0),s}}]),t}(L)});var Am,Im=b(()=>{ee();te();J();ae();oe();re();ue();Ge();me();Am=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",110),x(M(r),"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){var o=function(c){return c-1};switch(n){case"L":return be(Z(se.month,s),o);case"LL":return be(q(2,s),o);case"Lo":return be(a.ordinalNumber(s,{unit:"month"}),o);case"LLL":return a.month(s,{width:"abbreviated",context:"standalone"})||a.month(s,{width:"narrow",context:"standalone"});case"LLLLL":return a.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(s,{width:"wide",context:"standalone"})||a.month(s,{width:"abbreviated",context:"standalone"})||a.month(s,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(s,n){return n>=0&&n<=11}},{key:"set",value:function(s,n,a){return s.setUTCMonth(a,1),s.setUTCHours(0,0,0,0),s}}]),t}(L)});function Sd(i,e,t){O(2,arguments);var r=V(i),s=z(e),n=vn(r,t)-s;return r.setUTCDate(r.getUTCDate()-n*7),r}var Pm=b(()=>{Ue();Ee();hd();ce()});var Rm,Nm=b(()=>{ee();te();J();ae();oe();re();ue();Ge();me();Pm();ci();Rm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",100),x(M(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"w":return Z(se.week,s);case"wo":return a.ordinalNumber(s,{unit:"week"});default:return q(n.length,s)}}},{key:"validate",value:function(s,n){return n>=1&&n<=53}},{key:"set",value:function(s,n,a,o){return dt(Sd(s,a,o),o)}}]),t}(L)});function Cd(i,e){O(2,arguments);var t=V(i),r=z(e),s=yn(t)-r;return t.setUTCDate(t.getUTCDate()-s*7),t}var Om=b(()=>{Ue();Ee();ud();ce()});var Lm,Fm=b(()=>{ee();te();J();ae();oe();re();ue();Ge();me();Om();li();Lm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",100),x(M(r),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"I":return Z(se.week,s);case"Io":return a.ordinalNumber(s,{unit:"week"});default:return q(n.length,s)}}},{key:"validate",value:function(s,n){return n>=1&&n<=53}},{key:"set",value:function(s,n,a){return vt(Cd(s,a))}}]),t}(L)});var GT,KT,Hm,Bm=b(()=>{ee();te();J();ae();oe();re();me();ue();Ge();GT=[31,28,31,30,31,30,31,31,30,31,30,31],KT=[31,29,31,30,31,30,31,31,30,31,30,31],Hm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",90),x(M(r),"subPriority",1),x(M(r),"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"d":return Z(se.date,s);case"do":return a.ordinalNumber(s,{unit:"date"});default:return q(n.length,s)}}},{key:"validate",value:function(s,n){var a=s.getUTCFullYear(),o=vo(a),l=s.getUTCMonth();return o?n>=1&&n<=KT[l]:n>=1&&n<=GT[l]}},{key:"set",value:function(s,n,a){return s.setUTCDate(a),s.setUTCHours(0,0,0,0),s}}]),t}(L)});var Wm,Um=b(()=>{ee();te();J();ae();oe();re();ue();Ge();me();Wm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",90),x(M(r),"subpriority",1),x(M(r),"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"D":case"DD":return Z(se.dayOfYear,s);case"Do":return a.ordinalNumber(s,{unit:"date"});default:return q(n.length,s)}}},{key:"validate",value:function(s,n){var a=s.getUTCFullYear(),o=vo(a);return o?n>=1&&n<=366:n>=1&&n<=365}},{key:"set",value:function(s,n,a){return s.setUTCMonth(0,a),s.setUTCHours(0,0,0,0),s}}]),t}(L)});function Cs(i,e,t){var r,s,n,a,o,l,c,d;O(2,arguments);var u=Qe(),f=z((r=(s=(n=(a=t==null?void 0:t.weekStartsOn)!==null&&a!==void 0?a:t==null||(o=t.locale)===null||o===void 0||(l=o.options)===null||l===void 0?void 0:l.weekStartsOn)!==null&&n!==void 0?n:u.weekStartsOn)!==null&&s!==void 0?s:(c=u.locale)===null||c===void 0||(d=c.options)===null||d===void 0?void 0:d.weekStartsOn)!==null&&r!==void 0?r:0);if(!(f>=0&&f<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");var h=V(i),m=z(e),p=h.getUTCDay(),g=m%7,v=(g+7)%7,w=(v<f?7:0)+m-p;return h.setUTCDate(h.getUTCDate()+w),h}var bo=b(()=>{Ee();ce();Ue();mr()});var $m,Vm=b(()=>{ee();te();J();ae();oe();re();ue();bo();$m=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",90),x(M(r),"incompatibleTokens",["D","i","e","c","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"E":case"EE":case"EEE":return a.day(s,{width:"abbreviated",context:"formatting"})||a.day(s,{width:"short",context:"formatting"})||a.day(s,{width:"narrow",context:"formatting"});case"EEEEE":return a.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(s,{width:"short",context:"formatting"})||a.day(s,{width:"narrow",context:"formatting"});case"EEEE":default:return a.day(s,{width:"wide",context:"formatting"})||a.day(s,{width:"abbreviated",context:"formatting"})||a.day(s,{width:"short",context:"formatting"})||a.day(s,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(s,n){return n>=0&&n<=6}},{key:"set",value:function(s,n,a,o){return s=Cs(s,a,o),s.setUTCHours(0,0,0,0),s}}]),t}(L)});var zm,jm=b(()=>{ee();te();J();ae();oe();re();ue();me();bo();zm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",90),x(M(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a,o){var l=function(d){var u=Math.floor((d-1)/7)*7;return(d+o.weekStartsOn+6)%7+u};switch(n){case"e":case"ee":return be(q(n.length,s),l);case"eo":return be(a.ordinalNumber(s,{unit:"day"}),l);case"eee":return a.day(s,{width:"abbreviated",context:"formatting"})||a.day(s,{width:"short",context:"formatting"})||a.day(s,{width:"narrow",context:"formatting"});case"eeeee":return a.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(s,{width:"short",context:"formatting"})||a.day(s,{width:"narrow",context:"formatting"});case"eeee":default:return a.day(s,{width:"wide",context:"formatting"})||a.day(s,{width:"abbreviated",context:"formatting"})||a.day(s,{width:"short",context:"formatting"})||a.day(s,{width:"narrow",context:"formatting"})}}},{key:"validate",value:function(s,n){return n>=0&&n<=6}},{key:"set",value:function(s,n,a,o){return s=Cs(s,a,o),s.setUTCHours(0,0,0,0),s}}]),t}(L)});var qm,Ym=b(()=>{ee();te();J();ae();oe();re();ue();me();bo();qm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",90),x(M(r),"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a,o){var l=function(d){var u=Math.floor((d-1)/7)*7;return(d+o.weekStartsOn+6)%7+u};switch(n){case"c":case"cc":return be(q(n.length,s),l);case"co":return be(a.ordinalNumber(s,{unit:"day"}),l);case"ccc":return a.day(s,{width:"abbreviated",context:"standalone"})||a.day(s,{width:"short",context:"standalone"})||a.day(s,{width:"narrow",context:"standalone"});case"ccccc":return a.day(s,{width:"narrow",context:"standalone"});case"cccccc":return a.day(s,{width:"short",context:"standalone"})||a.day(s,{width:"narrow",context:"standalone"});case"cccc":default:return a.day(s,{width:"wide",context:"standalone"})||a.day(s,{width:"abbreviated",context:"standalone"})||a.day(s,{width:"short",context:"standalone"})||a.day(s,{width:"narrow",context:"standalone"})}}},{key:"validate",value:function(s,n){return n>=0&&n<=6}},{key:"set",value:function(s,n,a,o){return s=Cs(s,a,o),s.setUTCHours(0,0,0,0),s}}]),t}(L)});function _d(i,e){O(2,arguments);var t=z(e);t%7===0&&(t=t-7);var r=1,s=V(i),n=s.getUTCDay(),a=t%7,o=(a+7)%7,l=(o<r?7:0)+t-n;return s.setUTCDate(s.getUTCDate()+l),s}var Qm=b(()=>{Ee();ce();Ue()});var Gm,Km=b(()=>{ee();te();J();ae();oe();re();ue();me();Qm();Gm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",90),x(M(r),"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){var o=function(c){return c===0?7:c};switch(n){case"i":case"ii":return q(n.length,s);case"io":return a.ordinalNumber(s,{unit:"day"});case"iii":return be(a.day(s,{width:"abbreviated",context:"formatting"})||a.day(s,{width:"short",context:"formatting"})||a.day(s,{width:"narrow",context:"formatting"}),o);case"iiiii":return be(a.day(s,{width:"narrow",context:"formatting"}),o);case"iiiiii":return be(a.day(s,{width:"short",context:"formatting"})||a.day(s,{width:"narrow",context:"formatting"}),o);case"iiii":default:return be(a.day(s,{width:"wide",context:"formatting"})||a.day(s,{width:"abbreviated",context:"formatting"})||a.day(s,{width:"short",context:"formatting"})||a.day(s,{width:"narrow",context:"formatting"}),o)}}},{key:"validate",value:function(s,n){return n>=1&&n<=7}},{key:"set",value:function(s,n,a){return s=_d(s,a),s.setUTCHours(0,0,0,0),s}}]),t}(L)});var Zm,Xm=b(()=>{ee();te();J();ae();oe();re();ue();me();Zm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",80),x(M(r),"incompatibleTokens",["b","B","H","k","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"a":case"aa":case"aaa":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"})||a.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaaa":return a.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(s,{width:"wide",context:"formatting"})||a.dayPeriod(s,{width:"abbreviated",context:"formatting"})||a.dayPeriod(s,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(s,n,a){return s.setUTCHours(hi(a),0,0,0),s}}]),t}(L)});var Jm,eg=b(()=>{ee();te();J();ae();oe();re();ue();me();Jm=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",80),x(M(r),"incompatibleTokens",["a","B","H","k","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"b":case"bb":case"bbb":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"})||a.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbbb":return a.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(s,{width:"wide",context:"formatting"})||a.dayPeriod(s,{width:"abbreviated",context:"formatting"})||a.dayPeriod(s,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(s,n,a){return s.setUTCHours(hi(a),0,0,0),s}}]),t}(L)});var tg,rg=b(()=>{ee();te();J();ae();oe();re();ue();me();tg=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",80),x(M(r),"incompatibleTokens",["a","b","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"B":case"BB":case"BBB":return a.dayPeriod(s,{width:"abbreviated",context:"formatting"})||a.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBBB":return a.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(s,{width:"wide",context:"formatting"})||a.dayPeriod(s,{width:"abbreviated",context:"formatting"})||a.dayPeriod(s,{width:"narrow",context:"formatting"})}}},{key:"set",value:function(s,n,a){return s.setUTCHours(hi(a),0,0,0),s}}]),t}(L)});var sg,ig=b(()=>{ee();te();J();ae();oe();re();ue();Ge();me();sg=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",70),x(M(r),"incompatibleTokens",["H","K","k","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"h":return Z(se.hour12h,s);case"ho":return a.ordinalNumber(s,{unit:"hour"});default:return q(n.length,s)}}},{key:"validate",value:function(s,n){return n>=1&&n<=12}},{key:"set",value:function(s,n,a){var o=s.getUTCHours()>=12;return o&&a<12?s.setUTCHours(a+12,0,0,0):!o&&a===12?s.setUTCHours(0,0,0,0):s.setUTCHours(a,0,0,0),s}}]),t}(L)});var ng,ag=b(()=>{ee();te();J();ae();oe();re();ue();Ge();me();ng=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",70),x(M(r),"incompatibleTokens",["a","b","h","K","k","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"H":return Z(se.hour23h,s);case"Ho":return a.ordinalNumber(s,{unit:"hour"});default:return q(n.length,s)}}},{key:"validate",value:function(s,n){return n>=0&&n<=23}},{key:"set",value:function(s,n,a){return s.setUTCHours(a,0,0,0),s}}]),t}(L)});var og,lg=b(()=>{ee();te();J();ae();oe();re();ue();Ge();me();og=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",70),x(M(r),"incompatibleTokens",["h","H","k","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"K":return Z(se.hour11h,s);case"Ko":return a.ordinalNumber(s,{unit:"hour"});default:return q(n.length,s)}}},{key:"validate",value:function(s,n){return n>=0&&n<=11}},{key:"set",value:function(s,n,a){var o=s.getUTCHours()>=12;return o&&a<12?s.setUTCHours(a+12,0,0,0):s.setUTCHours(a,0,0,0),s}}]),t}(L)});var cg,dg=b(()=>{ee();te();J();ae();oe();re();ue();Ge();me();cg=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",70),x(M(r),"incompatibleTokens",["a","b","h","H","K","t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"k":return Z(se.hour24h,s);case"ko":return a.ordinalNumber(s,{unit:"hour"});default:return q(n.length,s)}}},{key:"validate",value:function(s,n){return n>=1&&n<=24}},{key:"set",value:function(s,n,a){var o=a<=24?a%24:a;return s.setUTCHours(o,0,0,0),s}}]),t}(L)});var ug,fg=b(()=>{ee();te();J();ae();oe();re();ue();Ge();me();ug=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",60),x(M(r),"incompatibleTokens",["t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"m":return Z(se.minute,s);case"mo":return a.ordinalNumber(s,{unit:"minute"});default:return q(n.length,s)}}},{key:"validate",value:function(s,n){return n>=0&&n<=59}},{key:"set",value:function(s,n,a){return s.setUTCMinutes(a,0,0),s}}]),t}(L)});var hg,pg=b(()=>{ee();te();J();ae();oe();re();ue();Ge();me();hg=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",50),x(M(r),"incompatibleTokens",["t","T"]),r}return P(t,[{key:"parse",value:function(s,n,a){switch(n){case"s":return Z(se.second,s);case"so":return a.ordinalNumber(s,{unit:"second"});default:return q(n.length,s)}}},{key:"validate",value:function(s,n){return n>=0&&n<=59}},{key:"set",value:function(s,n,a){return s.setUTCSeconds(a,0),s}}]),t}(L)});var mg,gg=b(()=>{ee();te();J();ae();oe();re();ue();me();mg=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",30),x(M(r),"incompatibleTokens",["t","T"]),r}return P(t,[{key:"parse",value:function(s,n){var a=function(l){return Math.floor(l*Math.pow(10,-n.length+3))};return be(q(n.length,s),a)}},{key:"set",value:function(s,n,a){return s.setUTCMilliseconds(a),s}}]),t}(L)});var yg,vg=b(()=>{ee();te();J();ae();oe();re();ue();Ge();me();yg=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",10),x(M(r),"incompatibleTokens",["t","T","x"]),r}return P(t,[{key:"parse",value:function(s,n){switch(n){case"X":return wt(bt.basicOptionalMinutes,s);case"XX":return wt(bt.basic,s);case"XXXX":return wt(bt.basicOptionalSeconds,s);case"XXXXX":return wt(bt.extendedOptionalSeconds,s);case"XXX":default:return wt(bt.extended,s)}}},{key:"set",value:function(s,n,a){return n.timestampIsSet?s:new Date(s.getTime()-a)}}]),t}(L)});var bg,wg=b(()=>{ee();te();J();ae();oe();re();ue();Ge();me();bg=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",10),x(M(r),"incompatibleTokens",["t","T","X"]),r}return P(t,[{key:"parse",value:function(s,n){switch(n){case"x":return wt(bt.basicOptionalMinutes,s);case"xx":return wt(bt.basic,s);case"xxxx":return wt(bt.basicOptionalSeconds,s);case"xxxxx":return wt(bt.extendedOptionalSeconds,s);case"xxx":default:return wt(bt.extended,s)}}},{key:"set",value:function(s,n,a){return n.timestampIsSet?s:new Date(s.getTime()-a)}}]),t}(L)});var Tg,Eg=b(()=>{ee();te();J();ae();oe();re();ue();me();Tg=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",40),x(M(r),"incompatibleTokens","*"),r}return P(t,[{key:"parse",value:function(s){return go(s)}},{key:"set",value:function(s,n,a){return[new Date(a*1e3),{timestampIsSet:!0}]}}]),t}(L)});var kg,Dg=b(()=>{ee();te();J();ae();oe();re();ue();me();kg=function(i){R(t,i);var e=N(t);function t(){var r;I(this,t);for(var s=arguments.length,n=new Array(s),a=0;a<s;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n)),x(M(r),"priority",20),x(M(r),"incompatibleTokens","*"),r}return P(t,[{key:"parse",value:function(s){return go(s)}},{key:"set",value:function(s,n,a){return[new Date(a),{timestampIsSet:!0}]}}]),t}(L)});var Sg,Cg=b(()=>{mm();ym();bm();Tm();km();Sm();_m();Mm();Im();Nm();Fm();Bm();Um();Vm();jm();Ym();Km();Xm();eg();rg();ig();ag();lg();dg();fg();pg();gg();vg();wg();Eg();Dg();Sg={G:new pm,y:new gm,Y:new vm,R:new wm,u:new Em,Q:new Dm,q:new Cm,M:new xm,L:new Am,w:new Rm,I:new Lm,d:new Hm,D:new Wm,E:new $m,e:new zm,c:new qm,i:new Gm,a:new Zm,b:new Jm,B:new tg,h:new sg,H:new ng,K:new og,k:new cg,m:new ug,s:new hg,S:new mg,X:new yg,x:new bg,t:new Tg,T:new kg}});function wo(i,e,t,r){var s,n,a,o,l,c,d,u,f,h,m,p,g,v,w,_,E,S;O(3,arguments);var D=String(i),A=String(e),C=Qe(),B=(s=(n=r==null?void 0:r.locale)!==null&&n!==void 0?n:C.locale)!==null&&s!==void 0?s:ho;if(!B.match)throw new RangeError("locale must contain match property");var $=z((a=(o=(l=(c=r==null?void 0:r.firstWeekContainsDate)!==null&&c!==void 0?c:r==null||(d=r.locale)===null||d===void 0||(u=d.options)===null||u===void 0?void 0:u.firstWeekContainsDate)!==null&&l!==void 0?l:C.firstWeekContainsDate)!==null&&o!==void 0?o:(f=C.locale)===null||f===void 0||(h=f.options)===null||h===void 0?void 0:h.firstWeekContainsDate)!==null&&a!==void 0?a:1);if(!($>=1&&$<=7))throw new RangeError("firstWeekContainsDate must be between 1 and 7 inclusively");var K=z((m=(p=(g=(v=r==null?void 0:r.weekStartsOn)!==null&&v!==void 0?v:r==null||(w=r.locale)===null||w===void 0||(_=w.options)===null||_===void 0?void 0:_.weekStartsOn)!==null&&g!==void 0?g:C.weekStartsOn)!==null&&p!==void 0?p:(E=C.locale)===null||E===void 0||(S=E.options)===null||S===void 0?void 0:S.weekStartsOn)!==null&&m!==void 0?m:0);if(!(K>=0&&K<=6))throw new RangeError("weekStartsOn must be between 0 and 6 inclusively");if(A==="")return D===""?V(t):new Date(NaN);var Be={firstWeekContainsDate:$,weekStartsOn:K,locale:B},mt=[new hm],De=A.match(XT).map(function(We){var Te=We[0];if(Te in bn){var gt=bn[Te];return gt(We,B.formatLong)}return We}).join("").match(ZT),xe=[],ct=Td(De),bs;try{var $w=function(){var Te=bs.value;!(r!=null&&r.useAdditionalWeekYearTokens)&&fo(Te)&&ui(Te,A,i),!(r!=null&&r.useAdditionalDayOfYearTokens)&&uo(Te)&&ui(Te,A,i);var gt=Te[0],oo=Sg[gt];if(oo){var fp=oo.incompatibleTokens;if(Array.isArray(fp)){var hp=xe.find(function(pp){return fp.includes(pp.token)||pp.token===gt});if(hp)throw new RangeError("The format string mustn't contain `".concat(hp.fullToken,"` and `").concat(Te,"` at the same time"))}else if(oo.incompatibleTokens==="*"&&xe.length>0)throw new RangeError("The format string mustn't contain `".concat(Te,"` and any other token at the same time"));xe.push({token:gt,fullToken:Te});var Zc=oo.run(D,Te,B.match,Be);if(!Zc)return{v:new Date(NaN)};mt.push(Zc.setter),D=Zc.rest}else{if(gt.match(rE))throw new RangeError("Format string contains an unescaped latin alphabet character `"+gt+"`");if(Te==="''"?Te="'":gt==="'"&&(Te=sE(Te)),D.indexOf(Te)===0)D=D.slice(Te.length);else return{v:new Date(NaN)}}};for(ct.s();!(bs=ct.n()).done;){var lp=$w();if(je(lp)==="object")return lp.v}}catch(We){ct.e(We)}finally{ct.f()}if(D.length>0&&tE.test(D))return new Date(NaN);var Vw=mt.map(function(We){return We.priority}).sort(function(We,Te){return Te-We}).filter(function(We,Te,gt){return gt.indexOf(We)===Te}).map(function(We){return mt.filter(function(Te){return Te.priority===We}).sort(function(Te,gt){return gt.subPriority-Te.subPriority})}).map(function(We){return We[0]}),Kc=V(t);if(isNaN(Kc.getTime()))return new Date(NaN);var un=mn(Kc,fn(Kc)),cp={},no=Td(Vw),dp;try{for(no.s();!(dp=no.n()).done;){var up=dp.value;if(!up.validate(un,Be))return new Date(NaN);var ao=up.set(un,cp,Be);Array.isArray(ao)?(un=ao[0],bd(cp,ao[1])):un=ao}}catch(We){no.e(We)}finally{no.f()}return un}function sE(i){return i.match(JT)[1].replace(eE,"'")}var ZT,XT,JT,eE,tE,rE,_g=b(()=>{Lr();rm();vd();od();Ee();Zp();md();rd();gd();Ue();ce();Dd();Cg();mr();ZT=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,XT=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,JT=/^'([^]*?)'?$/,eE=/''/g,tE=/\S/,rE=/[a-zA-Z]/});function pi(i){return O(1,arguments),gr(i,Date.now())}var xg=b(()=>{id();ce()});function kn(i,e){var t;O(1,arguments);var r=z((t=e==null?void 0:e.additionalDigits)!==null&&t!==void 0?t:2);if(r!==2&&r!==1&&r!==0)throw new RangeError("additionalDigits must be 0, 1 or 2");if(!(typeof i=="string"||Object.prototype.toString.call(i)==="[object String]"))return new Date(NaN);var s=oE(i),n;if(s.date){var a=lE(s.date,r);n=cE(a.restDateString,a.year)}if(!n||isNaN(n.getTime()))return new Date(NaN);var o=n.getTime(),l=0,c;if(s.time&&(l=dE(s.time),isNaN(l)))return new Date(NaN);if(s.timezone){if(c=uE(s.timezone),isNaN(c))return new Date(NaN)}else{var d=new Date(o+l),u=new Date(0);return u.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),u.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),u}return new Date(o+l+c)}function oE(i){var e={},t=i.split(To.dateTimeDelimiter),r;if(t.length>2)return e;if(/:/.test(t[0])?r=t[0]:(e.date=t[0],r=t[1],To.timeZoneDelimiter.test(e.date)&&(e.date=i.split(To.timeZoneDelimiter)[0],r=i.substr(e.date.length,i.length))),r){var s=To.timezone.exec(r);s?(e.time=r.replace(s[1],""),e.timezone=s[1]):e.time=r}return e}function lE(i,e){var t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),r=i.match(t);if(!r)return{year:NaN,restDateString:""};var s=r[1]?parseInt(r[1]):null,n=r[2]?parseInt(r[2]):null;return{year:n===null?s:n*100,restDateString:i.slice((r[1]||r[2]).length)}}function cE(i,e){if(e===null)return new Date(NaN);var t=i.match(iE);if(!t)return new Date(NaN);var r=!!t[4],s=En(t[1]),n=En(t[2])-1,a=En(t[3]),o=En(t[4]),l=En(t[5])-1;if(r)return gE(e,o,l)?fE(e,o,l):new Date(NaN);var c=new Date(0);return!pE(e,n,a)||!mE(e,s)?new Date(NaN):(c.setUTCFullYear(e,n,Math.max(s,a)),c)}function En(i){return i?parseInt(i):1}function dE(i){var e=i.match(nE);if(!e)return NaN;var t=xd(e[1]),r=xd(e[2]),s=xd(e[3]);return yE(t,r,s)?t*pn+r*hn+s*1e3:NaN}function xd(i){return i&&parseFloat(i.replace(",","."))||0}function uE(i){if(i==="Z")return 0;var e=i.match(aE);if(!e)return 0;var t=e[1]==="+"?-1:1,r=parseInt(e[2]),s=e[3]&&parseInt(e[3])||0;return vE(r,s)?t*(r*pn+s*hn):NaN}function fE(i,e,t){var r=new Date(0);r.setUTCFullYear(i,0,4);var s=r.getUTCDay()||7,n=(e-1)*7+t+1-s;return r.setUTCDate(r.getUTCDate()+n),r}function Mg(i){return i%400===0||i%4===0&&i%100!==0}function pE(i,e,t){return e>=0&&e<=11&&t>=1&&t<=(hE[e]||(Mg(i)?29:28))}function mE(i,e){return e>=1&&e<=(Mg(i)?366:365)}function gE(i,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function yE(i,e,t){return i===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&i>=0&&i<25}function vE(i,e){return e>=0&&e<=59}var To,iE,nE,aE,hE,Ag=b(()=>{lo();ce();Ue();To={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},iE=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,nE=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,aE=/^([+-])(\d{2})(?::?(\d{2}))?$/;hE=[31,null,31,30,31,30,31,31,30,31,30,31]});var Me=b(()=>{gp();Jc();Ep();kp();Kp();Xp();id();xg();ad();_g();Ag();sd();vp();lo()});var Br,Md=b(()=>{Br=class{constructor(e){this.statuses=e}getNextStatus(e){var n;let t=this.getStatusesByOrder(),r=t.findIndex(a=>a.value===e);if(r===-1)return((n=t[0])==null?void 0:n.value)||"open";let s=(r+1)%t.length;return t[s].value}getStatusConfig(e){return this.statuses.find(t=>t.value===e)}getCompletedStatuses(){return this.statuses.filter(e=>e.isCompleted).map(e=>e.value)}getOpenStatuses(){return this.statuses.filter(e=>!e.isCompleted).map(e=>e.value)}getStatusesByOrder(){return[...this.statuses].sort((e,t)=>e.order-t.order)}isCompletedStatus(e){let t=this.getStatusConfig(e);return(t==null?void 0:t.isCompleted)||!1}getStatusOrder(e){let t=this.getStatusConfig(e);return(t==null?void 0:t.order)||0}getStatusStyles(){let e=[];for(let t of this.statuses){let r=`--status-${t.value.replace(/[^a-zA-Z0-9-]/g,"-")}-color`;e.push(`${r}: ${t.color};`)}return`:root { ${e.join(" ")} }`}getAllStatuses(){return[...this.statuses]}getNonCompletionStatuses(){return this.statuses.filter(e=>!e.isCompleted)}updateStatuses(e){this.statuses=e}static validateStatuses(e){let t=[];e.length<2&&t.push("At least 2 statuses are required"),e.some(l=>l.isCompleted)||t.push("At least one status must be marked as completed");let s=e.map(l=>l.value),n=new Set(s);s.length!==n.size&&t.push("Status values must be unique");let a=e.map(l=>l.id),o=new Set(a);a.length!==o.size&&t.push("Status IDs must be unique");for(let l of e){if(!l.value||l.value.trim()===""){t.push("Status values cannot be empty");break}if(!l.label||l.label.trim()===""){t.push("Status labels cannot be empty");break}if(!l.color||!l.color.match(/^#[0-9a-fA-F]{6}$/)){t.push("Status colors must be valid hex colors (#rrggbb)");break}}return{valid:t.length===0,errors:t}}static generateStatusId(e){let t=new Set(e.map(n=>n.id)),r=1,s=`status-${r}`;for(;t.has(s);)r++,s=`status-${r}`;return s}static createDefaultStatus(e){let t=Br.generateStatusId(e),r=Math.max(...e.map(s=>s.order),0)+1;return{id:t,value:"new-status",label:"New status",color:"#808080",isCompleted:!1,order:r}}}});var vr,Ad=b(()=>{vr=class{constructor(e){this.priorities=e}getPriorityConfig(e){return this.priorities.find(t=>t.value===e)}getPrioritiesByWeight(){return[...this.priorities].sort((e,t)=>t.weight-e.weight)}getPrioritiesByWeightAsc(){return[...this.priorities].sort((e,t)=>e.weight-t.weight)}getNextPriority(e){var n;let t=this.getPrioritiesByWeightAsc(),r=t.findIndex(a=>a.value===e);if(r===-1)return((n=t[0])==null?void 0:n.value)||"normal";let s=(r+1)%t.length;return t[s].value}comparePriorities(e,t){let r=this.getPriorityConfig(e),s=this.getPriorityConfig(t),n=(r==null?void 0:r.weight)||0;return((s==null?void 0:s.weight)||0)-n}getPriorityStyles(){let e=[];for(let t of this.priorities){let r=`--priority-${t.value.replace(/[^a-zA-Z0-9-]/g,"-")}-color`;e.push(`${r}: ${t.color};`)}return`:root { ${e.join(" ")} }`}getAllPriorities(){return[...this.priorities]}updatePriorities(e){this.priorities=e}getHighestPriority(){var t;return(t=this.getPrioritiesByWeight()[0])==null?void 0:t.value}getLowestPriority(){var t;return(t=this.getPrioritiesByWeightAsc()[0])==null?void 0:t.value}getPriorityWeight(e){let t=this.getPriorityConfig(e);return(t==null?void 0:t.weight)||0}isHigherPriority(e,t){return this.comparePriorities(e,t)>0}static validatePriorities(e){let t=[];e.length<1&&t.push("At least 1 priority is required");let r=e.map(c=>c.value),s=new Set(r);r.length!==s.size&&t.push("Priority values must be unique");let n=e.map(c=>c.id),a=new Set(n);n.length!==a.size&&t.push("Priority IDs must be unique");let o=e.map(c=>c.weight),l=new Set(o);o.length!==l.size&&t.push("Priority weights must be unique");for(let c of e){if(!c.value||c.value.trim()===""){t.push("Priority values cannot be empty");break}if(!c.label||c.label.trim()===""){t.push("Priority labels cannot be empty");break}if(!c.color||!c.color.match(/^#[0-9a-fA-F]{6}$/)){t.push("Priority colors must be valid hex colors (#rrggbb)");break}if(typeof c.weight!="number"||c.weight<0){t.push("Priority weights must be non-negative numbers");break}}return{valid:t.length===0,errors:t}}static generatePriorityId(e){let t=new Set(e.map(n=>n.id)),r=1,s=`priority-${r}`;for(;t.has(s);)r++,s=`priority-${r}`;return s}static generatePriorityWeight(e){let t=e.map(r=>r.weight);return t.length===0?1:Math.max(...t)+1}static createDefaultPriority(e){let t=vr.generatePriorityId(e),r=vr.generatePriorityWeight(e);return{id:t,value:"new-priority",label:"New priority",color:"#808080",weight:r}}}});var H,ko,bE,wE,TE,mi,Eo,Id=b(()=>{H=require("obsidian");Md();Ad();ko={title:"title",status:"status",priority:"priority",due:"due",scheduled:"scheduled",contexts:"contexts",timeEstimate:"timeEstimate",completedDate:"completedDate",dateCreated:"dateCreated",dateModified:"dateModified",recurrence:"recurrence",archiveTag:"archived",timeEntries:"timeEntries",completeInstances:"complete_instances",pomodoros:"pomodoros"},bE=[{id:"open",value:"open",label:"Open",color:"#808080",isCompleted:!1,order:1},{id:"in-progress",value:"in-progress",label:"In progress",color:"#0066cc",isCompleted:!1,order:2},{id:"done",value:"done",label:"Done",color:"#00aa00",isCompleted:!0,order:3}],wE=[{id:"low",value:"low",label:"Low",color:"#00aa00",weight:1},{id:"normal",value:"normal",label:"Normal",color:"#ffaa00",weight:2},{id:"high",value:"high",label:"High",color:"#ff0000",weight:3}],TE={defaultContexts:"",defaultTags:"",defaultTimeEstimate:0,defaultRecurrence:"none",defaultFolder:"",defaultDueDate:"none",defaultScheduledDate:"today",bodyTemplate:"",useBodyTemplate:!1},mi={dailyNotesFolder:"TaskNotes/Daily",tasksFolder:"TaskNotes/Tasks",taskTag:"task",excludedFolders:"",defaultTaskPriority:"normal",defaultTaskStatus:"open",taskOrgFiltersCollapsed:!1,dailyNoteTemplate:"",taskFilenameFormat:"zettel",customFilenameTemplate:"{title}",taskCreationDefaults:TE,pomodoroWorkDuration:25,pomodoroShortBreakDuration:5,pomodoroLongBreakDuration:15,pomodoroLongBreakInterval:4,pomodoroAutoStartBreaks:!0,pomodoroAutoStartWork:!1,pomodoroNotifications:!0,pomodoroSoundEnabled:!0,pomodoroSoundVolume:50,enableTaskLinkOverlay:!0,enableInstantTaskConvert:!0,fieldMapping:ko,customStatuses:bE,customPriorities:wE},Eo=class extends H.PluginSettingTab{constructor(t,r){super(t,r);this.activeTab="general";this.tabContents={};this.plugin=r}display(){let{containerEl:t}=this;t.empty(),t.addClass("tasknotes-settings"),t.addClass("tasknotes-plugin"),t.addClass("settings-view");let r=t.createDiv("settings-tab-nav settings-view__tab-nav"),s=[{id:"general",name:"Basic setup"},{id:"task-defaults",name:"Task defaults"},{id:"field-mapping",name:"Field mapping"},{id:"statuses",name:"Statuses"},{id:"priorities",name:"Priorities"},{id:"daily-notes",name:"Daily notes"},{id:"pomodoro",name:"Pomodoro"}];s.forEach(a=>{let o=this.activeTab===a.id,l=r.createEl("button",{text:a.name,cls:o?"settings-tab-button settings-view__tab-button active settings-view__tab-button--active":"settings-tab-button settings-view__tab-button",attr:{role:"tab","aria-selected":o.toString(),"aria-controls":`settings-tab-${a.id}`,id:`tab-button-${a.id}`,tabindex:o?"0":"-1"}});l.addEventListener("click",()=>{this.switchTab(a.id)}),l.addEventListener("keydown",c=>{if(c.key==="ArrowLeft"||c.key==="ArrowRight"){c.preventDefault();let d=s.findIndex(h=>h.id===a.id),u=c.key==="ArrowRight"?(d+1)%s.length:(d-1+s.length)%s.length,f=s[u].id;this.switchTab(f)}})});let n=t.createDiv("settings-tab-contents settings-view__tab-contents");s.forEach(a=>{let o=n.createDiv("settings-tab-content settings-view__tab-content");o.setAttribute("role","tabpanel"),o.setAttribute("id",`settings-tab-${a.id}`),o.setAttribute("aria-labelledby",`tab-button-${a.id}`),this.activeTab===a.id&&(o.addClass("active"),o.addClass("settings-view__tab-content--active")),this.tabContents[a.id]=o}),this.renderActiveTab()}switchTab(t){this.activeTab=t,this.display(),setTimeout(()=>{let r=this.containerEl.querySelector(`#tab-button-${t}`);r&&r.focus()},50)}renderActiveTab(){switch(Object.values(this.tabContents).forEach(t=>t.empty()),this.activeTab){case"general":this.renderGeneralTab();break;case"task-defaults":this.renderTaskDefaultsTab();break;case"field-mapping":this.renderFieldMappingTab();break;case"statuses":this.renderStatusesTab();break;case"priorities":this.renderPrioritiesTab();break;case"daily-notes":this.renderDailyNotesTab();break;case"pomodoro":this.renderPomodoroTab();break}}renderGeneralTab(){let t=this.tabContents.general;new H.Setting(t).setName("Default tasks folder").setDesc("Default folder for new tasks (tasks are identified by tag, not folder)").addText(r=>(r.inputEl.setAttribute("aria-label","Default tasks folder path"),r.setPlaceholder("TaskNotes/Tasks").setValue(this.plugin.settings.tasksFolder).onChange(async s=>{this.plugin.settings.tasksFolder=s,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Task tag").setDesc("Tag that identifies notes as tasks (without #)").addText(r=>(r.inputEl.setAttribute("aria-label","Task identification tag"),r.setPlaceholder("task").setValue(this.plugin.settings.taskTag).onChange(async s=>{this.plugin.settings.taskTag=s,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Excluded folders").setDesc("Comma-separated list of folder paths to exclude from Notes tab").addText(r=>(r.inputEl.setAttribute("aria-label","Comma-separated list of folders to exclude"),r.setPlaceholder("Templates,Archive").setValue(this.plugin.settings.excludedFolders).onChange(async s=>{this.plugin.settings.excludedFolders=s,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Editor settings").setHeading(),new H.Setting(t).setName("Task link overlay").setDesc("Replace wikilinks to task files with interactive task cards in live preview mode").addToggle(r=>(r.toggleEl.setAttribute("aria-label","Enable task link overlay in live preview mode"),r.setValue(this.plugin.settings.enableTaskLinkOverlay).onChange(async s=>{this.plugin.settings.enableTaskLinkOverlay=s,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Instant task convert").setDesc("Show a convert button next to checkbox tasks for instant conversion to TaskNotes").addToggle(r=>(r.toggleEl.setAttribute("aria-label","Enable instant task conversion buttons"),r.setValue(this.plugin.settings.enableInstantTaskConvert).onChange(async s=>{this.plugin.settings.enableInstantTaskConvert=s,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Task filenames").setHeading(),new H.Setting(t).setName("Filename format").setDesc("How task filenames should be generated").addDropdown(r=>(r.selectEl.setAttribute("aria-label","Task filename generation format"),r.addOption("title","Task title").addOption("zettel","Zettelkasten format (YYMMDD + base36 seconds since midnight)").addOption("timestamp","Full timestamp (YYYY-MM-DD-HHMMSS)").addOption("custom","Custom template").setValue(this.plugin.settings.taskFilenameFormat).onChange(async s=>{this.plugin.settings.taskFilenameFormat=s,await this.plugin.saveSettings(),this.renderActiveTab()}))),this.plugin.settings.taskFilenameFormat==="custom"&&new H.Setting(t).setName("Custom filename template").setDesc("Template for custom filenames. Available variables: {title}, {date}, {time}, {priority}, {status}, {timestamp}, etc.").addText(r=>(r.inputEl.setAttribute("aria-label","Custom filename template with variables"),r.setPlaceholder("{date}-{title}").setValue(this.plugin.settings.customFilenameTemplate).onChange(async s=>{this.plugin.settings.customFilenameTemplate=s,await this.plugin.saveSettings()})))}renderTaskDefaultsTab(){let t=this.tabContents["task-defaults"];new H.Setting(t).setName("Basic defaults").setHeading(),new H.Setting(t).setName("Default task status").setDesc("Default status for new tasks").addDropdown(n=>(n.selectEl.setAttribute("aria-label","Default status for new tasks"),this.plugin.settings.customStatuses.forEach(a=>{n.addOption(a.value,a.label)}),n.setValue(this.plugin.settings.defaultTaskStatus).onChange(async a=>{this.plugin.settings.defaultTaskStatus=a,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Default task priority").setDesc("Default priority for new tasks").addDropdown(n=>(n.selectEl.setAttribute("aria-label","Default priority for new tasks"),this.plugin.settings.customPriorities.forEach(a=>{n.addOption(a.value,a.label)}),n.setValue(this.plugin.settings.defaultTaskPriority).onChange(async a=>{this.plugin.settings.defaultTaskPriority=a,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Default contexts").setDesc("Default contexts for new tasks (comma-separated)").addText(n=>(n.inputEl.setAttribute("aria-label","Default contexts for new tasks"),n.setPlaceholder("@work, @personal").setValue(this.plugin.settings.taskCreationDefaults.defaultContexts).onChange(async a=>{this.plugin.settings.taskCreationDefaults.defaultContexts=a,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Default tags").setDesc("Default tags for new tasks (comma-separated)").addText(n=>(n.inputEl.setAttribute("aria-label","Default tags for new tasks"),n.setPlaceholder("#project, #urgent").setValue(this.plugin.settings.taskCreationDefaults.defaultTags).onChange(async a=>{this.plugin.settings.taskCreationDefaults.defaultTags=a,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Default time estimate").setDesc("Default time estimate for new tasks in minutes (0 = no default)").addText(n=>(n.inputEl.setAttribute("aria-label","Default time estimate in minutes"),n.setPlaceholder("0").setValue(this.plugin.settings.taskCreationDefaults.defaultTimeEstimate.toString()).onChange(async a=>{let o=parseInt(a)||0;this.plugin.settings.taskCreationDefaults.defaultTimeEstimate=o,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Default recurrence").setDesc("Default recurrence pattern for new tasks").addDropdown(n=>(n.selectEl.setAttribute("aria-label","Default recurrence pattern"),n.addOption("none","None").addOption("daily","Daily").addOption("weekly","Weekly").addOption("monthly","Monthly").addOption("yearly","Yearly").setValue(this.plugin.settings.taskCreationDefaults.defaultRecurrence).onChange(async a=>{this.plugin.settings.taskCreationDefaults.defaultRecurrence=a,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Default folder").setDesc("Override default tasks folder for new tasks (leave empty to use general tasks folder)").addText(n=>(n.inputEl.setAttribute("aria-label","Default folder for new tasks"),n.setPlaceholder("TaskNotes/Projects").setValue(this.plugin.settings.taskCreationDefaults.defaultFolder).onChange(async a=>{this.plugin.settings.taskCreationDefaults.defaultFolder=a,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Date defaults").setHeading(),new H.Setting(t).setName("Default due date").setDesc("Default due date for new tasks").addDropdown(n=>(n.selectEl.setAttribute("aria-label","Default due date for new tasks"),n.addOption("none","None").addOption("today","Today").addOption("tomorrow","Tomorrow").addOption("next-week","Next week").setValue(this.plugin.settings.taskCreationDefaults.defaultDueDate).onChange(async a=>{this.plugin.settings.taskCreationDefaults.defaultDueDate=a,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Default scheduled date").setDesc("Default scheduled date for new tasks").addDropdown(n=>(n.selectEl.setAttribute("aria-label","Default scheduled date for new tasks"),n.addOption("none","None").addOption("today","Today").addOption("tomorrow","Tomorrow").addOption("next-week","Next week").setValue(this.plugin.settings.taskCreationDefaults.defaultScheduledDate).onChange(async a=>{this.plugin.settings.taskCreationDefaults.defaultScheduledDate=a,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Body template").setHeading(),new H.Setting(t).setName("Use body template").setDesc("Pre-fill task details with content from a template file").addToggle(n=>(n.toggleEl.setAttribute("aria-label","Enable body template for new tasks"),n.setValue(this.plugin.settings.taskCreationDefaults.useBodyTemplate).onChange(async a=>{this.plugin.settings.taskCreationDefaults.useBodyTemplate=a,await this.plugin.saveSettings(),this.renderActiveTab()}))),this.plugin.settings.taskCreationDefaults.useBodyTemplate&&new H.Setting(t).setName("Body template file").setDesc("Path to template file for task body content. Supports template variables like {{title}}, {{date}}, {{time}}, {{priority}}, {{status}}, etc.").addText(n=>(n.inputEl.setAttribute("aria-label","Path to body template file"),n.setPlaceholder("Templates/Task Template.md").setValue(this.plugin.settings.taskCreationDefaults.bodyTemplate).onChange(async a=>{this.plugin.settings.taskCreationDefaults.bodyTemplate=a,await this.plugin.saveSettings()})));let r=t.createDiv("settings-help-section");r.createEl("h4",{text:"Template variables:"});let s=r.createEl("ul");s.createEl("li",{text:"{{title}} - Task title"}),s.createEl("li",{text:"{{date}} - Current date (YYYY-MM-DD)"}),s.createEl("li",{text:"{{time}} - Current time (HH:MM)"}),s.createEl("li",{text:"{{priority}} - Task priority"}),s.createEl("li",{text:"{{status}} - Task status"}),s.createEl("li",{text:"{{contexts}} - Task contexts"}),s.createEl("li",{text:"{{tags}} - Task tags"}),s.createEl("li",{text:"{{timeEstimate}} - Time estimate in minutes"}),s.createEl("li",{text:"{{dueDate}} - Task due date"}),s.createEl("li",{text:"{{scheduledDate}} - Task scheduled date"}),r.createEl("p",{text:"Variables are replaced when the task is created. Use the same format as daily note templates.",cls:"settings-help-note"})}renderFieldMappingTab(){let t=this.tabContents["field-mapping"],r=t.createDiv("settings-warning settings-view__warning"),s=r.createEl("strong",{cls:"settings-view__warning-icon"});(0,H.setIcon)(s,"alert-triangle"),s.createSpan({text:" Warning:"}),r.createSpan({text:" TaskNotes will read AND write using these property names. Changing these after creating tasks may cause inconsistencies."}),new H.Setting(t).setName("Field mapping").setHeading(),t.createEl("p",{text:"Configure which frontmatter properties TaskNotes should use for each field."});let n=t.createEl("table",{cls:"settings-table settings-view__table"}),a=n.createEl("tr");a.createEl("th",{cls:"settings-view__table-header",text:"TaskNotes field"}),a.createEl("th",{cls:"settings-view__table-header",text:"Your property name"}),[["title","Title"],["status","Status"],["priority","Priority"],["due","Due date"],["scheduled","Scheduled date"],["contexts","Contexts"],["timeEstimate","Time estimate"],["completedDate","Completed date"],["dateCreated","Created date"],["dateModified","Modified date"],["recurrence","Recurrence"],["archiveTag","Archive tag"]].forEach(([l,c])=>{let d=n.createEl("tr",{cls:"settings-view__table-row"}),u=d.createEl("td",{cls:"settings-view__table-cell"});u.textContent=c;let h=d.createEl("td",{cls:"settings-view__table-cell"}).createEl("input",{type:"text",value:this.plugin.settings.fieldMapping[l],cls:"settings-view__table-input",attr:{"aria-label":`Property name for ${c}`,id:`field-mapping-${l}`}});h.addEventListener("change",async()=>{try{this.plugin.settings.fieldMapping[l]=h.value,await this.plugin.saveSettings()}catch(m){console.error(`Error updating field mapping for ${l}:`,m),new H.Notice(`Failed to update field mapping for ${c}. Please try again.`)}})}),new H.Setting(t).setName("Reset to defaults").setDesc("Reset all field mappings to default values").addButton(l=>l.setButtonText("Reset").setWarning().onClick(async()=>{this.plugin.settings.fieldMapping={...ko},await this.plugin.saveSettings(),this.renderActiveTab()}))}renderStatusesTab(){let t=this.tabContents.statuses;new H.Setting(t).setName("Task statuses").setHeading(),t.createEl("p",{text:"Customize the status options available for your tasks. These statuses control the task lifecycle and determine when tasks are considered complete."});let r=t.createDiv("settings-help-section");r.createEl("h4",{text:"How statuses work:"});let s=r.createEl("ul");s.createEl("li",{text:'Value: The internal identifier stored in your task files (e.g., "in-progress")'}),s.createEl("li",{text:'Label: The display name shown in the interface (e.g., "In Progress")'}),s.createEl("li",{text:"Color: Visual indicator color for the status dot and badges"}),s.createEl("li",{text:"Completed: When checked, tasks with this status are considered finished and may be filtered differently"}),r.createEl("p",{text:"The order below determines the sequence when cycling through statuses by clicking on task status badges.",cls:"settings-help-note"});let n=t.createDiv("settings-headers-row settings-view__list-headers");n.createDiv("settings-header-spacer settings-view__header-spacer"),n.createEl("span",{text:"Value",cls:"settings-column-header settings-view__column-header"}),n.createEl("span",{text:"Display Label",cls:"settings-column-header settings-view__column-header"}),n.createEl("span",{text:"Color",cls:"settings-column-header settings-view__column-header"}),n.createEl("span",{text:"Mark as Completed",cls:"settings-column-header settings-view__column-header"}),n.createDiv("settings-header-spacer settings-view__header-spacer");let a=t.createDiv("settings-list settings-view__list");this.renderStatusList(a),new H.Setting(t).setName("Add new status").setDesc("Create a new status option for your tasks").addButton(o=>o.setButtonText("Add status").onClick(async()=>{let l=Br.createDefaultStatus(this.plugin.settings.customStatuses);this.plugin.settings.customStatuses.push(l),await this.plugin.saveSettings(),this.renderActiveTab()})),t.createEl("p",{text:'Note: You must have at least 2 statuses, and at least one status must be marked as "Completed".',cls:"settings-validation-note"})}renderStatusList(t){t.empty(),[...this.plugin.settings.customStatuses].sort((s,n)=>s.order-n.order).forEach((s,n)=>{let a=t.createDiv("settings-item-row settings-view__item-row"),o=a.createDiv("settings-color-indicator settings-view__color-indicator");o.style.setProperty("--indicator-color",s.color);let l=a.createEl("input",{type:"text",value:s.value,cls:"settings-input value-input settings-view__input settings-view__input--value",attr:{"aria-label":`Status value for ${s.label}`,id:`status-value-${s.id}`}}),c=a.createEl("input",{type:"text",value:s.label,cls:"settings-input label-input settings-view__input settings-view__input--label",attr:{"aria-label":`Display label for ${s.label} status`,id:`status-label-${s.id}`}}),d=a.createEl("input",{type:"color",value:s.color,cls:"settings-input color-input settings-view__input settings-view__input--color",attr:{"aria-label":`Color for ${s.label} status`,id:`status-color-${s.id}`}}),u=a.createEl("label",{cls:"settings-checkbox-label settings-view__checkbox-label",attr:{for:`status-completed-${s.id}`}}),f=u.createEl("input",{type:"checkbox",cls:"settings-view__checkbox",attr:{id:`status-completed-${s.id}`,"aria-label":`Mark ${s.label} as completed status`}});f.checked=s.isCompleted,u.createSpan({text:"Completed"});let h=a.createEl("button",{text:"Delete",cls:"settings-delete-button settings-view__delete-button"}),m=async()=>{try{s.value=l.value,s.label=c.value,s.color=d.value,s.isCompleted=f.checked,await this.plugin.saveSettings(),o.style.setProperty("--indicator-color",s.color)}catch(p){console.error("Error updating status configuration:",p),new H.Notice("Failed to update status configuration. Please try again.")}};l.addEventListener("change",m),c.addEventListener("change",m),d.addEventListener("change",m),f.addEventListener("change",m),h.addEventListener("click",async()=>{if(this.plugin.settings.customStatuses.length<=2){new H.Notice("You must have at least 2 statuses");return}let p=document.createElement("div");p.className="modal-container mod-confirmation",p.innerHTML=`
					<div class="modal-bg"></div>
					<div class="modal">
						<div class="modal-title">Delete Status</div>
						<div class="modal-content">
							<p>Are you sure you want to delete the status "${s.label}"?</p>
							<p>This action cannot be undone and may affect existing tasks.</p>
						</div>
						<div class="modal-button-container">
							<button class="mod-cta" data-action="delete">Delete</button>
							<button data-action="cancel">Cancel</button>
						</div>
					</div>
				`,document.body.appendChild(p),p.addEventListener("click",async g=>{let v=g.target;if(v.dataset.action==="delete"){let w=this.plugin.settings.customStatuses.findIndex(_=>_.id===s.id);w!==-1&&(this.plugin.settings.customStatuses.splice(w,1),await this.plugin.saveSettings(),this.renderActiveTab()),p.remove()}else(v.dataset.action==="cancel"||v.classList.contains("modal-bg"))&&p.remove()})})})}renderPrioritiesTab(){let t=this.tabContents.priorities;new H.Setting(t).setName("Task priorities").setHeading(),t.createEl("p",{text:"Customize the priority levels available for your tasks. Priority weights determine sorting order and visual hierarchy in your task views."});let r=t.createDiv("settings-help-section");r.createEl("h4",{text:"How priorities work:"});let s=r.createEl("ul");s.createEl("li",{text:'Value: The internal identifier stored in your task files (e.g., "high")'}),s.createEl("li",{text:'Display Label: The display name shown in the interface (e.g., "High Priority")'}),s.createEl("li",{text:"Color: Visual indicator color for the priority dot and badges"}),s.createEl("li",{text:"Weight: Numeric value for sorting (higher weights appear first in lists)"}),r.createEl("p",{text:"Tasks are automatically sorted by priority weight in descending order (highest weight first). Weights can be any positive number.",cls:"settings-help-note"});let n=t.createDiv("settings-headers-row settings-view__list-headers");n.createDiv("settings-header-spacer settings-view__header-spacer"),n.createEl("span",{text:"Value",cls:"settings-column-header settings-view__column-header"}),n.createEl("span",{text:"Display Label",cls:"settings-column-header settings-view__column-header"}),n.createEl("span",{text:"Color",cls:"settings-column-header settings-view__column-header"}),n.createEl("span",{text:"Weight",cls:"settings-column-header settings-view__column-header"}),n.createDiv("settings-header-spacer settings-view__header-spacer");let a=t.createDiv("settings-list settings-view__list");this.renderPriorityList(a),new H.Setting(t).setName("Add new priority").setDesc("Create a new priority level for your tasks").addButton(o=>o.setButtonText("Add priority").onClick(async()=>{let l=vr.createDefaultPriority(this.plugin.settings.customPriorities);this.plugin.settings.customPriorities.push(l),await this.plugin.saveSettings(),this.renderActiveTab()})),t.createEl("p",{text:"Note: You must have at least 1 priority. Higher weights take precedence in sorting and visual hierarchy.",cls:"settings-validation-note"})}renderPriorityList(t){t.empty(),[...this.plugin.settings.customPriorities].sort((s,n)=>n.weight-s.weight).forEach((s,n)=>{let a=t.createDiv("settings-item-row"),o=a.createDiv("settings-color-indicator");o.style.setProperty("--indicator-color",s.color);let l=a.createEl("input",{type:"text",value:s.value,cls:"settings-input value-input",attr:{"aria-label":`Priority value for ${s.label}`,id:`priority-value-${s.id}`}}),c=a.createEl("input",{type:"text",value:s.label,cls:"settings-input label-input",attr:{"aria-label":`Display label for ${s.label} priority`,id:`priority-label-${s.id}`}}),d=a.createEl("input",{type:"color",value:s.color,cls:"settings-input color-input",attr:{"aria-label":`Color for ${s.label} priority`,id:`priority-color-${s.id}`}}),u=a.createEl("input",{type:"number",value:s.weight.toString(),cls:"settings-input weight-input",attr:{min:"0",step:"1","aria-label":`Weight for ${s.label} priority`,id:`priority-weight-${s.id}`}}),f=a.createEl("button",{text:"Delete",cls:"settings-delete-button"}),h=async()=>{try{s.value=l.value,s.label=c.value,s.color=d.value;let m=parseInt(u.value);if(isNaN(m)||m<0){new H.Notice("Priority weight must be a valid positive number.");return}s.weight=m,await this.plugin.saveSettings(),o.style.setProperty("--indicator-color",s.color)}catch(m){console.error("Error updating priority configuration:",m),new H.Notice("Failed to update priority configuration. Please try again.")}};l.addEventListener("change",h),c.addEventListener("change",h),d.addEventListener("change",h),u.addEventListener("change",h),f.addEventListener("click",async()=>{if(this.plugin.settings.customPriorities.length<=1){new H.Notice("You must have at least 1 priority");return}let m=document.createElement("div");m.className="modal-container mod-confirmation",m.innerHTML=`
					<div class="modal-bg"></div>
					<div class="modal">
						<div class="modal-title">Delete Priority</div>
						<div class="modal-content">
							<p>Are you sure you want to delete the priority "${s.label}"?</p>
							<p>This action cannot be undone and may affect existing tasks.</p>
						</div>
						<div class="modal-button-container">
							<button class="mod-cta" data-action="delete">Delete</button>
							<button data-action="cancel">Cancel</button>
						</div>
					</div>
				`,document.body.appendChild(m),m.addEventListener("click",async p=>{let g=p.target;if(g.dataset.action==="delete"){let v=this.plugin.settings.customPriorities.findIndex(w=>w.id===s.id);v!==-1&&(this.plugin.settings.customPriorities.splice(v,1),await this.plugin.saveSettings(),this.renderActiveTab()),m.remove()}else(g.dataset.action==="cancel"||g.classList.contains("modal-bg"))&&m.remove()})})})}renderDailyNotesTab(){let t=this.tabContents["daily-notes"];new H.Setting(t).setName("Daily notes folder").setDesc("Folder where daily notes will be stored").addText(r=>(r.inputEl.setAttribute("aria-label","Daily notes folder path"),r.setPlaceholder("TaskNotes/Daily").setValue(this.plugin.settings.dailyNotesFolder).onChange(async s=>{this.plugin.settings.dailyNotesFolder=s,await this.plugin.saveSettings()}))),new H.Setting(t).setName("Daily note template").setDesc("Path to template file for daily notes (leave empty to use built-in template). Supports Obsidian template variables like {{title}}, {{date}}, {{date:format}}, {{time}}, etc.").addText(r=>(r.inputEl.setAttribute("aria-label","Daily note template file path"),r.setPlaceholder("Templates/Daily Note Template.md").setValue(this.plugin.settings.dailyNoteTemplate).onChange(async s=>{this.plugin.settings.dailyNoteTemplate=s,await this.plugin.saveSettings()})))}renderPomodoroTab(){let t=this.tabContents.pomodoro;new H.Setting(t).setName("Work duration").setDesc("Duration of work intervals in minutes").addText(r=>r.setPlaceholder("25").setValue(this.plugin.settings.pomodoroWorkDuration.toString()).onChange(async s=>{try{let n=parseInt(s);if(isNaN(n)||n<=0){new H.Notice("Work duration must be a positive number.");return}this.plugin.settings.pomodoroWorkDuration=n,await this.plugin.saveSettings()}catch(n){console.error("Error updating pomodoro work duration:",n),new H.Notice("Failed to update work duration setting.")}})),new H.Setting(t).setName("Short break duration").setDesc("Duration of short breaks in minutes").addText(r=>r.setPlaceholder("5").setValue(this.plugin.settings.pomodoroShortBreakDuration.toString()).onChange(async s=>{try{let n=parseInt(s);if(isNaN(n)||n<=0){new H.Notice("Short break duration must be a positive number.");return}this.plugin.settings.pomodoroShortBreakDuration=n,await this.plugin.saveSettings()}catch(n){console.error("Error updating pomodoro short break duration:",n),new H.Notice("Failed to update short break duration setting.")}})),new H.Setting(t).setName("Long break duration").setDesc("Duration of long breaks in minutes").addText(r=>r.setPlaceholder("15").setValue(this.plugin.settings.pomodoroLongBreakDuration.toString()).onChange(async s=>{try{let n=parseInt(s);if(isNaN(n)||n<=0){new H.Notice("Long break duration must be a positive number.");return}this.plugin.settings.pomodoroLongBreakDuration=n,await this.plugin.saveSettings()}catch(n){console.error("Error updating pomodoro long break duration:",n),new H.Notice("Failed to update long break duration setting.")}})),new H.Setting(t).setName("Long break interval").setDesc("Take a long break after this many pomodoros").addText(r=>r.setPlaceholder("4").setValue(this.plugin.settings.pomodoroLongBreakInterval.toString()).onChange(async s=>{try{let n=parseInt(s);if(isNaN(n)||n<=0){new H.Notice("Long break interval must be a positive number.");return}this.plugin.settings.pomodoroLongBreakInterval=n,await this.plugin.saveSettings()}catch(n){console.error("Error updating pomodoro long break interval:",n),new H.Notice("Failed to update long break interval setting.")}})),new H.Setting(t).setName("Auto-start breaks").setDesc("Automatically start break timer after work session").addToggle(r=>r.setValue(this.plugin.settings.pomodoroAutoStartBreaks).onChange(async s=>{this.plugin.settings.pomodoroAutoStartBreaks=s,await this.plugin.saveSettings()})),new H.Setting(t).setName("Auto-start work").setDesc("Automatically start work timer after break").addToggle(r=>r.setValue(this.plugin.settings.pomodoroAutoStartWork).onChange(async s=>{this.plugin.settings.pomodoroAutoStartWork=s,await this.plugin.saveSettings()})),new H.Setting(t).setName("Enable notifications").setDesc("Show notifications when pomodoro sessions complete").addToggle(r=>r.setValue(this.plugin.settings.pomodoroNotifications).onChange(async s=>{this.plugin.settings.pomodoroNotifications=s,await this.plugin.saveSettings()})),new H.Setting(t).setName("Enable sound").setDesc("Play sound when pomodoro sessions complete").addToggle(r=>r.setValue(this.plugin.settings.pomodoroSoundEnabled).onChange(async s=>{this.plugin.settings.pomodoroSoundEnabled=s,await this.plugin.saveSettings()})),new H.Setting(t).setName("Sound volume").setDesc("Volume for completion sounds (0-100)").addSlider(r=>r.setLimits(0,100,5).setValue(this.plugin.settings.pomodoroSoundVolume).setDynamicTooltip().onChange(async s=>{try{this.plugin.settings.pomodoroSoundVolume=s,await this.plugin.saveSettings()}catch(n){console.error("Error updating pomodoro sound volume:",n),new H.Notice("Failed to update sound volume setting.")}}))}}});function he(i){if(i&&typeof i=="object")switch(i[Xe]){case Nt:case br:return!0}return!1}function X(i){if(i&&typeof i=="object")switch(i[Xe]){case _o:case Nt:case ut:case br:return!0}return!1}var _o,xo,Nt,Pd,ut,br,Xe,Tt,Ot,Lt,Q,Y,Ft,Mo,ie=b(()=>{_o=Symbol.for("yaml.alias"),xo=Symbol.for("yaml.document"),Nt=Symbol.for("yaml.map"),Pd=Symbol.for("yaml.pair"),ut=Symbol.for("yaml.scalar"),br=Symbol.for("yaml.seq"),Xe=Symbol.for("yaml.node.type"),Tt=i=>!!i&&typeof i=="object"&&i[Xe]===_o,Ot=i=>!!i&&typeof i=="object"&&i[Xe]===xo,Lt=i=>!!i&&typeof i=="object"&&i[Xe]===Nt,Q=i=>!!i&&typeof i=="object"&&i[Xe]===Pd,Y=i=>!!i&&typeof i=="object"&&i[Xe]===ut,Ft=i=>!!i&&typeof i=="object"&&i[Xe]===br;Mo=i=>(Y(i)||he(i))&&!!i.anchor});function Zt(i,e){let t=Rg(e);Ot(i)?gi(null,i.contents,t,Object.freeze([i]))===Kt&&(i.contents=null):gi(null,i,t,Object.freeze([]))}function gi(i,e,t,r){let s=Ng(i,e,t,r);if(X(s)||Q(s))return Og(i,r,s),gi(i,s,t,r);if(typeof s!="symbol"){if(he(e)){r=Object.freeze(r.concat(e));for(let n=0;n<e.items.length;++n){let a=gi(n,e.items[n],t,r);if(typeof a=="number")n=a-1;else{if(a===rt)return rt;a===Kt&&(e.items.splice(n,1),n-=1)}}}else if(Q(e)){r=Object.freeze(r.concat(e));let n=gi("key",e.key,t,r);if(n===rt)return rt;n===Kt&&(e.key=null);let a=gi("value",e.value,t,r);if(a===rt)return rt;a===Kt&&(e.value=null)}}return s}async function Ao(i,e){let t=Rg(e);Ot(i)?await yi(null,i.contents,t,Object.freeze([i]))===Kt&&(i.contents=null):await yi(null,i,t,Object.freeze([]))}async function yi(i,e,t,r){let s=await Ng(i,e,t,r);if(X(s)||Q(s))return Og(i,r,s),yi(i,s,t,r);if(typeof s!="symbol"){if(he(e)){r=Object.freeze(r.concat(e));for(let n=0;n<e.items.length;++n){let a=await yi(n,e.items[n],t,r);if(typeof a=="number")n=a-1;else{if(a===rt)return rt;a===Kt&&(e.items.splice(n,1),n-=1)}}}else if(Q(e)){r=Object.freeze(r.concat(e));let n=await yi("key",e.key,t,r);if(n===rt)return rt;n===Kt&&(e.key=null);let a=await yi("value",e.value,t,r);if(a===rt)return rt;a===Kt&&(e.value=null)}}return s}function Rg(i){return typeof i=="object"&&(i.Collection||i.Node||i.Value)?Object.assign({Alias:i.Node,Map:i.Node,Scalar:i.Node,Seq:i.Node},i.Value&&{Map:i.Value,Scalar:i.Value,Seq:i.Value},i.Collection&&{Map:i.Collection,Seq:i.Collection},i):i}function Ng(i,e,t,r){var s,n,a,o,l;if(typeof t=="function")return t(i,e,r);if(Lt(e))return(s=t.Map)==null?void 0:s.call(t,i,e,r);if(Ft(e))return(n=t.Seq)==null?void 0:n.call(t,i,e,r);if(Q(e))return(a=t.Pair)==null?void 0:a.call(t,i,e,r);if(Y(e))return(o=t.Scalar)==null?void 0:o.call(t,i,e,r);if(Tt(e))return(l=t.Alias)==null?void 0:l.call(t,i,e,r)}function Og(i,e,t){let r=e[e.length-1];if(he(r))r.items[i]=t;else if(Q(r))i==="key"?r.key=t:r.value=t;else if(Ot(r))r.contents=t;else{let s=Tt(r)?"alias":"scalar";throw new Error(`Cannot replace node with ${s} parent`)}}var rt,Pg,Kt,_n=b(()=>{ie();rt=Symbol("break visit"),Pg=Symbol("skip children"),Kt=Symbol("remove node");Zt.BREAK=rt;Zt.SKIP=Pg;Zt.REMOVE=Kt;Ao.BREAK=rt;Ao.SKIP=Pg;Ao.REMOVE=Kt});var EE,kE,Ne,Rd=b(()=>{ie();_n();EE={"!":"%21",",":"%2C","[":"%5B","]":"%5D","{":"%7B","}":"%7D"},kE=i=>i.replace(/[!,[\]{}]/g,e=>EE[e]),Ne=class{constructor(e,t){this.docStart=null,this.docEnd=!1,this.yaml=Object.assign({},Ne.defaultYaml,e),this.tags=Object.assign({},Ne.defaultTags,t)}clone(){let e=new Ne(this.yaml,this.tags);return e.docStart=this.docStart,e}atDocument(){let e=new Ne(this.yaml,this.tags);switch(this.yaml.version){case"1.1":this.atNextDocument=!0;break;case"1.2":this.atNextDocument=!1,this.yaml={explicit:Ne.defaultYaml.explicit,version:"1.2"},this.tags=Object.assign({},Ne.defaultTags);break}return e}add(e,t){this.atNextDocument&&(this.yaml={explicit:Ne.defaultYaml.explicit,version:"1.1"},this.tags=Object.assign({},Ne.defaultTags),this.atNextDocument=!1);let r=e.trim().split(/[ \t]+/),s=r.shift();switch(s){case"%TAG":{if(r.length!==2&&(t(0,"%TAG directive should contain exactly two parts"),r.length<2))return!1;let[n,a]=r;return this.tags[n]=a,!0}case"%YAML":{if(this.yaml.explicit=!0,r.length!==1)return t(0,"%YAML directive should contain exactly one part"),!1;let[n]=r;if(n==="1.1"||n==="1.2")return this.yaml.version=n,!0;{let a=/^\d+\.\d+$/.test(n);return t(6,`Unsupported YAML version ${n}`,a),!1}}default:return t(0,`Unknown directive ${s}`,!0),!1}}tagName(e,t){if(e==="!")return"!";if(e[0]!=="!")return t(`Not a valid tag: ${e}`),null;if(e[1]==="<"){let a=e.slice(2,-1);return a==="!"||a==="!!"?(t(`Verbatim tags aren't resolved, so ${e} is invalid.`),null):(e[e.length-1]!==">"&&t("Verbatim tags must end with a >"),a)}let[,r,s]=e.match(/^(.*!)([^!]*)$/s);s||t(`The ${e} tag has no suffix`);let n=this.tags[r];if(n)try{return n+decodeURIComponent(s)}catch(a){return t(String(a)),null}return r==="!"?e:(t(`Could not resolve tag: ${e}`),null)}tagString(e){for(let[t,r]of Object.entries(this.tags))if(e.startsWith(r))return t+kE(e.substring(r.length));return e[0]==="!"?e:`!<${e}>`}toString(e){let t=this.yaml.explicit?[`%YAML ${this.yaml.version||"1.2"}`]:[],r=Object.entries(this.tags),s;if(e&&r.length>0&&X(e.contents)){let n={};Zt(e.contents,(a,o)=>{X(o)&&o.tag&&(n[o.tag]=!0)}),s=Object.keys(n)}else s=[];for(let[n,a]of r)n==="!!"&&a==="tag:yaml.org,2002:"||(!e||s.some(o=>o.startsWith(a)))&&t.push(`%TAG ${n} ${a}`);return t.join(`
`)}};Ne.defaultYaml={explicit:!1,version:"1.2"};Ne.defaultTags={"!!":"tag:yaml.org,2002:"}});function Io(i){if(/[\x00-\x19\s,[\]{}]/.test(i)){let t=`Anchor must not contain whitespace or control characters: ${JSON.stringify(i)}`;throw new Error(t)}return!0}function Nd(i){let e=new Set;return Zt(i,{Value(t,r){r.anchor&&e.add(r.anchor)}}),e}function Od(i,e){for(let t=1;;++t){let r=`${i}${t}`;if(!e.has(r))return r}}function Lg(i,e){let t=[],r=new Map,s=null;return{onAnchor:n=>{t.push(n),s!=null||(s=Nd(i));let a=Od(e,s);return s.add(a),a},setAnchors:()=>{for(let n of t){let a=r.get(n);if(typeof a=="object"&&a.anchor&&(Y(a.node)||he(a.node)))a.node.anchor=a.anchor;else{let o=new Error("Failed to resolve repeated object (this should not happen)");throw o.source=n,o}}},sourceObjects:r}}var Po=b(()=>{ie();_n()});function Vr(i,e,t,r){if(r&&typeof r=="object")if(Array.isArray(r))for(let s=0,n=r.length;s<n;++s){let a=r[s],o=Vr(i,r,String(s),a);o===void 0?delete r[s]:o!==a&&(r[s]=o)}else if(r instanceof Map)for(let s of Array.from(r.keys())){let n=r.get(s),a=Vr(i,r,s,n);a===void 0?r.delete(s):a!==n&&r.set(s,a)}else if(r instanceof Set)for(let s of Array.from(r)){let n=Vr(i,r,s,s);n===void 0?r.delete(s):n!==s&&(r.delete(s),r.add(n))}else for(let[s,n]of Object.entries(r)){let a=Vr(i,r,s,n);a===void 0?delete r[s]:a!==n&&(r[s]=a)}return i.call(e,t,r)}var Ld=b(()=>{});function Oe(i,e,t){if(Array.isArray(i))return i.map((r,s)=>Oe(r,String(s),t));if(i&&typeof i.toJSON=="function"){if(!t||!Mo(i))return i.toJSON(e,t);let r={aliasCount:0,count:1,res:void 0};t.anchors.set(i,r),t.onCreate=n=>{r.res=n,delete t.onCreate};let s=i.toJSON(e,t);return t.onCreate&&t.onCreate(s),s}return typeof i=="bigint"&&!(t!=null&&t.keep)?Number(i):i}var zr=b(()=>{ie()});var jr,Ro=b(()=>{Ld();ie();zr();jr=class{constructor(e){Object.defineProperty(this,Xe,{value:e})}clone(){let e=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return this.range&&(e.range=this.range.slice()),e}toJS(e,{mapAsMap:t,maxAliasCount:r,onAnchor:s,reviver:n}={}){if(!Ot(e))throw new TypeError("A document argument is required");let a={anchors:new Map,doc:e,keep:!0,mapAsMap:t===!0,mapKeyWarned:!1,maxAliasCount:typeof r=="number"?r:100},o=Oe(this,"",a);if(typeof s=="function")for(let{count:l,res:c}of a.anchors.values())s(c,l);return typeof n=="function"?Vr(n,{"":o},"",o):o}}});function No(i,e,t){if(Tt(e)){let r=e.resolve(i),s=t&&r&&t.get(r);return s?s.count*s.aliasCount:0}else if(he(e)){let r=0;for(let s of e.items){let n=No(i,s,t);n>r&&(r=n)}return r}else if(Q(e)){let r=No(i,e.key,t),s=No(i,e.value,t);return Math.max(r,s)}return 1}var wr,xn=b(()=>{Po();_n();ie();Ro();zr();wr=class extends jr{constructor(e){super(_o),this.source=e,Object.defineProperty(this,"tag",{set(){throw new Error("Alias nodes cannot have tags")}})}resolve(e,t){let r;t!=null&&t.aliasResolveCache?r=t.aliasResolveCache:(r=[],Zt(e,{Node:(n,a)=>{(Tt(a)||Mo(a))&&r.push(a)}}),t&&(t.aliasResolveCache=r));let s;for(let n of r){if(n===this)break;n.anchor===this.source&&(s=n)}return s}toJSON(e,t){if(!t)return{source:this.source};let{anchors:r,doc:s,maxAliasCount:n}=t,a=this.resolve(s,t);if(!a){let l=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new ReferenceError(l)}let o=r.get(a);if(o||(Oe(a,null,t),o=r.get(a)),!o||o.res===void 0){let l="This should not happen: Alias anchor was not resolved?";throw new ReferenceError(l)}if(n>=0&&(o.count+=1,o.aliasCount===0&&(o.aliasCount=No(s,a,r)),o.count*o.aliasCount>n)){let l="Excessive alias count indicates a resource exhaustion attack";throw new ReferenceError(l)}return o.res}toString(e,t,r){let s=`*${this.source}`;if(e){if(Io(this.source),e.options.verifyAliasOrder&&!e.anchors.has(this.source)){let n=`Unresolved alias (the anchor must be set before the alias): ${this.source}`;throw new Error(n)}if(e.implicitKey)return`${s} `}return s}}});var Oo,F,Ie=b(()=>{ie();Ro();zr();Oo=i=>!i||typeof i!="function"&&typeof i!="object",F=class extends jr{constructor(e){super(ut),this.value=e}toJSON(e,t){return t!=null&&t.keep?this.value:Oe(this.value,e,t)}toString(){return String(this.value)}};F.BLOCK_FOLDED="BLOCK_FOLDED";F.BLOCK_LITERAL="BLOCK_LITERAL";F.PLAIN="PLAIN";F.QUOTE_DOUBLE="QUOTE_DOUBLE";F.QUOTE_SINGLE="QUOTE_SINGLE"});function SE(i,e,t){var r;if(e){let s=t.filter(a=>a.tag===e),n=(r=s.find(a=>!a.format))!=null?r:s[0];if(!n)throw new Error(`Tag ${e} not found`);return n}return t.find(s=>{var n;return((n=s.identify)==null?void 0:n.call(s,i))&&!s.format})}function Tr(i,e,t){var u,f,h,m;if(Ot(i)&&(i=i.contents),X(i))return i;if(Q(i)){let p=(f=(u=t.schema[Nt]).createNode)==null?void 0:f.call(u,t.schema,null,t);return p.items.push(i),p}(i instanceof String||i instanceof Number||i instanceof Boolean||typeof BigInt!="undefined"&&i instanceof BigInt)&&(i=i.valueOf());let{aliasDuplicateObjects:r,onAnchor:s,onTagObj:n,schema:a,sourceObjects:o}=t,l;if(r&&i&&typeof i=="object"){if(l=o.get(i),l)return(h=l.anchor)!=null||(l.anchor=s(i)),new wr(l.anchor);l={anchor:null,node:null},o.set(i,l)}e!=null&&e.startsWith("!!")&&(e=DE+e.slice(2));let c=SE(i,e,a.tags);if(!c){if(i&&typeof i.toJSON=="function"&&(i=i.toJSON()),!i||typeof i!="object"){let p=new F(i);return l&&(l.node=p),p}c=i instanceof Map?a[Nt]:Symbol.iterator in Object(i)?a[br]:a[Nt]}n&&(n(c),delete t.onTagObj);let d=c!=null&&c.createNode?c.createNode(t.schema,i,t):typeof((m=c==null?void 0:c.nodeClass)==null?void 0:m.from)=="function"?c.nodeClass.from(t.schema,i,t):new F(i);return e?d.tag=e:c.default||(d.tag=c.tag),l&&(l.node=d),d}var DE,Mn=b(()=>{xn();ie();Ie();DE="tag:yaml.org,2002:"});function An(i,e,t){let r=t;for(let s=e.length-1;s>=0;--s){let n=e[s];if(typeof n=="number"&&Number.isInteger(n)&&n>=0){let a=[];a[n]=r,r=a}else r=new Map([[n,r]])}return Tr(r,void 0,{aliasDuplicateObjects:!1,keepUndefined:!1,onAnchor:()=>{throw new Error("This should not happen, please report a bug.")},schema:i,sourceObjects:new Map})}var bi,vi,Lo=b(()=>{Mn();ie();Ro();bi=i=>i==null||typeof i=="object"&&!!i[Symbol.iterator]().next().done,vi=class extends jr{constructor(e,t){super(e),Object.defineProperty(this,"schema",{value:t,configurable:!0,enumerable:!1,writable:!0})}clone(e){let t=Object.create(Object.getPrototypeOf(this),Object.getOwnPropertyDescriptors(this));return e&&(t.schema=e),t.items=t.items.map(r=>X(r)||Q(r)?r.clone(e):r),this.range&&(t.range=this.range.slice()),t}addIn(e,t){if(bi(e))this.add(t);else{let[r,...s]=e,n=this.get(r,!0);if(he(n))n.addIn(s,t);else if(n===void 0&&this.schema)this.set(r,An(this.schema,s,t));else throw new Error(`Expected YAML collection at ${r}. Remaining path: ${s}`)}}deleteIn(e){let[t,...r]=e;if(r.length===0)return this.delete(t);let s=this.get(t,!0);if(he(s))return s.deleteIn(r);throw new Error(`Expected YAML collection at ${t}. Remaining path: ${r}`)}getIn(e,t){let[r,...s]=e,n=this.get(r,!0);return s.length===0?!t&&Y(n)?n.value:n:he(n)?n.getIn(s,t):void 0}hasAllNullValues(e){return this.items.every(t=>{if(!Q(t))return!1;let r=t.value;return r==null||e&&Y(r)&&r.value==null&&!r.commentBefore&&!r.comment&&!r.tag})}hasIn(e){let[t,...r]=e;if(r.length===0)return this.has(t);let s=this.get(t,!0);return he(s)?s.hasIn(r):!1}setIn(e,t){let[r,...s]=e;if(s.length===0)this.set(r,t);else{let n=this.get(r,!0);if(he(n))n.setIn(s,t);else if(n===void 0&&this.schema)this.set(r,An(this.schema,s,t));else throw new Error(`Expected YAML collection at ${r}. Remaining path: ${s}`)}}}});function Et(i,e){return/^\n+$/.test(i)?i.substring(1):e?i.replace(/^(?! *$)/gm,e):i}var Fg,Xt,In=b(()=>{Fg=i=>i.replace(/^(?!$)(?: $)?/gm,"#");Xt=(i,e,t)=>i.endsWith(`
`)?Et(t,e):t.includes(`
`)?`
`+Et(t,e):(i.endsWith(" ")?"":" ")+t});function Rn(i,e,t="flow",{indentAtStart:r,lineWidth:s=80,minContentWidth:n=20,onFold:a,onOverflow:o}={}){if(!s||s<0)return i;s<n&&(n=0);let l=Math.max(1+n,1+s-e.length);if(i.length<=l)return i;let c=[],d={},u=s-e.length;typeof r=="number"&&(r>s-Math.max(2,n)?c.push(0):u=s-r);let f,h,m=!1,p=-1,g=-1,v=-1;t===Fo&&(p=Hg(i,p,e.length),p!==-1&&(u=p+l));for(let _;_=i[p+=1];){if(t===Pn&&_==="\\"){switch(g=p,i[p+1]){case"x":p+=3;break;case"u":p+=5;break;case"U":p+=9;break;default:p+=1}v=p}if(_===`
`)t===Fo&&(p=Hg(i,p,e.length)),u=p+e.length+l,f=void 0;else{if(_===" "&&h&&h!==" "&&h!==`
`&&h!=="	"){let E=i[p+1];E&&E!==" "&&E!==`
`&&E!=="	"&&(f=p)}if(p>=u)if(f)c.push(f),u=f+l,f=void 0;else if(t===Pn){for(;h===" "||h==="	";)h=_,_=i[p+=1],m=!0;let E=p>v+1?p-2:g-1;if(d[E])return i;c.push(E),d[E]=!0,u=E+l,f=void 0}else m=!0}h=_}if(m&&o&&o(),c.length===0)return i;a&&a();let w=i.slice(0,c[0]);for(let _=0;_<c.length;++_){let E=c[_],S=c[_+1]||i.length;E===0?w=`
${e}${i.slice(0,S)}`:(t===Pn&&d[E]&&(w+=`${i[E]}\\`),w+=`
${e}${i.slice(E+1,S)}`)}return w}function Hg(i,e,t){let r=e,s=e+1,n=i[s];for(;n===" "||n==="	";)if(e<s+t)n=i[++e];else{do n=i[++e];while(n&&n!==`
`);r=e,s=e+1,n=i[s]}return r}var Fd,Fo,Pn,Bg=b(()=>{Fd="flow",Fo="block",Pn="quoted"});function CE(i,e,t){if(!e||e<0)return!1;let r=e-t,s=i.length;if(s<=r)return!1;for(let n=0,a=0;n<s;++n)if(i[n]===`
`){if(n-a>r)return!0;if(a=n+1,s-a<=r)return!1}return!0}function Nn(i,e){let t=JSON.stringify(i);if(e.options.doubleQuotedAsJSON)return t;let{implicitKey:r}=e,s=e.options.doubleQuotedMinMultiLineLength,n=e.indent||(Wo(i)?"  ":""),a="",o=0;for(let l=0,c=t[l];c;c=t[++l])if(c===" "&&t[l+1]==="\\"&&t[l+2]==="n"&&(a+=t.slice(o,l)+"\\ ",l+=1,o=l,c="\\"),c==="\\")switch(t[l+1]){case"u":{a+=t.slice(o,l);let d=t.substr(l+2,4);switch(d){case"0000":a+="\\0";break;case"0007":a+="\\a";break;case"000b":a+="\\v";break;case"001b":a+="\\e";break;case"0085":a+="\\N";break;case"00a0":a+="\\_";break;case"2028":a+="\\L";break;case"2029":a+="\\P";break;default:d.substr(0,2)==="00"?a+="\\x"+d.substr(2):a+=t.substr(l,6)}l+=5,o=l+1}break;case"n":if(r||t[l+2]==='"'||t.length<s)l+=1;else{for(a+=t.slice(o,l)+`

`;t[l+2]==="\\"&&t[l+3]==="n"&&t[l+4]!=='"';)a+=`
`,l+=2;a+=n,t[l+2]===" "&&(a+="\\"),l+=1,o=l+1}break;default:l+=1}return a=o?a+t.slice(o):t,r?a:Rn(a,n,Pn,Bo(e,!1))}function Hd(i,e){if(e.options.singleQuote===!1||e.implicitKey&&i.includes(`
`)||/[ \t]\n|\n[ \t]/.test(i))return Nn(i,e);let t=e.indent||(Wo(i)?"  ":""),r="'"+i.replace(/'/g,"''").replace(/\n+/g,`$&
${t}`)+"'";return e.implicitKey?r:Rn(r,t,Fd,Bo(e,!1))}function wi(i,e){let{singleQuote:t}=e.options,r;if(t===!1)r=Nn;else{let s=i.includes('"'),n=i.includes("'");s&&!n?r=Hd:n&&!s?r=Nn:r=t?Hd:Nn}return r(i,e)}function Ho({comment:i,type:e,value:t},r,s,n){let{blockQuote:a,commentString:o,lineWidth:l}=r.options;if(!a||/\n[\t ]+$/.test(t)||/^\s*$/.test(t))return wi(t,r);let c=r.indent||(r.forceBlockIndent||Wo(t)?"  ":""),d=a==="literal"?!0:a==="folded"||e===F.BLOCK_FOLDED?!1:e===F.BLOCK_LITERAL?!0:!CE(t,l,c.length);if(!t)return d?`|
`:`>
`;let u,f;for(f=t.length;f>0;--f){let S=t[f-1];if(S!==`
`&&S!=="	"&&S!==" ")break}let h=t.substring(f),m=h.indexOf(`
`);m===-1?u="-":t===h||m!==h.length-1?(u="+",n&&n()):u="",h&&(t=t.slice(0,-h.length),h[h.length-1]===`
`&&(h=h.slice(0,-1)),h=h.replace(Bd,`$&${c}`));let p=!1,g,v=-1;for(g=0;g<t.length;++g){let S=t[g];if(S===" ")p=!0;else if(S===`
`)v=g;else break}let w=t.substring(0,v<g?v+1:g);w&&(t=t.substring(w.length),w=w.replace(/\n+/g,`$&${c}`));let E=(p?c?"2":"1":"")+u;if(i&&(E+=" "+o(i.replace(/ ?[\r\n]+/g," ")),s&&s()),!d){let S=t.replace(/\n+/g,`
$&`).replace(/(?:^|\n)([\t ].*)(?:([\n\t ]*)\n(?![\n\t ]))?/g,"$1$2").replace(/\n+/g,`$&${c}`),D=!1,A=Bo(r,!0);a!=="folded"&&e!==F.BLOCK_FOLDED&&(A.onOverflow=()=>{D=!0});let C=Rn(`${w}${S}${h}`,c,Fo,A);if(!D)return`>${E}
${c}${C}`}return t=t.replace(/\n+/g,`$&${c}`),`|${E}
${c}${w}${t}${h}`}function _E(i,e,t,r){let{type:s,value:n}=i,{actualString:a,implicitKey:o,indent:l,indentStep:c,inFlow:d}=e;if(o&&n.includes(`
`)||d&&/[[\]{},]/.test(n))return wi(n,e);if(/^[\n\t ,[\]{}#&*!|>'"%@`]|^[?-]$|^[?-][ \t]|[\n:][ \t]|[ \t]\n|[\n\t ]#|[\n\t :]$/.test(n))return o||d||!n.includes(`
`)?wi(n,e):Ho(i,e,t,r);if(!o&&!d&&s!==F.PLAIN&&n.includes(`
`))return Ho(i,e,t,r);if(Wo(n)){if(l==="")return e.forceBlockIndent=!0,Ho(i,e,t,r);if(o&&l===c)return wi(n,e)}let u=n.replace(/\n+/g,`$&
${l}`);if(a){let f=p=>{var g;return p.default&&p.tag!=="tag:yaml.org,2002:str"&&((g=p.test)==null?void 0:g.test(u))},{compat:h,tags:m}=e.doc.schema;if(m.some(f)||h!=null&&h.some(f))return wi(n,e)}return o?u:Rn(u,l,Fd,Bo(e,!1))}function Is(i,e,t,r){let{implicitKey:s,inFlow:n}=e,a=typeof i.value=="string"?i:Object.assign({},i,{value:String(i.value)}),{type:o}=i;o!==F.QUOTE_DOUBLE&&/[\x00-\x08\x0b-\x1f\x7f-\x9f\u{D800}-\u{DFFF}]/u.test(a.value)&&(o=F.QUOTE_DOUBLE);let l=d=>{switch(d){case F.BLOCK_FOLDED:case F.BLOCK_LITERAL:return s||n?wi(a.value,e):Ho(a,e,t,r);case F.QUOTE_DOUBLE:return Nn(a.value,e);case F.QUOTE_SINGLE:return Hd(a.value,e);case F.PLAIN:return _E(a,e,t,r);default:return null}},c=l(o);if(c===null){let{defaultKeyType:d,defaultStringType:u}=e.options,f=s&&d||u;if(c=l(f),c===null)throw new Error(`Unsupported default string type ${f}`)}return c}var Bo,Wo,Bd,On=b(()=>{Ie();Bg();Bo=(i,e)=>({indentAtStart:e?i.indent.length:i.indentAtStart,lineWidth:i.options.lineWidth,minContentWidth:i.options.minContentWidth}),Wo=i=>/^(%|---|\.\.\.)/m.test(i);try{Bd=new RegExp(`(^|(?<!
))
+(?!
|$)`,"g")}catch(i){Bd=/\n+(?!\n|$)/g}});function Uo(i,e){let t=Object.assign({blockQuote:!0,commentString:Fg,defaultKeyType:null,defaultStringType:"PLAIN",directives:null,doubleQuotedAsJSON:!1,doubleQuotedMinMultiLineLength:40,falseStr:"false",flowCollectionPadding:!0,indentSeq:!0,lineWidth:80,minContentWidth:20,nullStr:"null",simpleKeys:!1,singleQuote:null,trueStr:"true",verifyAliasOrder:!0},i.schema.toStringOptions,e),r;switch(t.collectionStyle){case"block":r=!1;break;case"flow":r=!0;break;default:r=null}return{anchors:new Set,doc:i,flowCollectionPadding:t.flowCollectionPadding?" ":"",indent:"",indentStep:typeof t.indent=="number"?" ".repeat(t.indent):"  ",inFlow:r,options:t}}function xE(i,e){var s,n,a,o;if(e.tag){let l=i.filter(c=>c.tag===e.tag);if(l.length>0)return(s=l.find(c=>c.format===e.format))!=null?s:l[0]}let t,r;if(Y(e)){r=e.value;let l=i.filter(c=>{var d;return(d=c.identify)==null?void 0:d.call(c,r)});if(l.length>1){let c=l.filter(d=>d.test);c.length>0&&(l=c)}t=(n=l.find(c=>c.format===e.format))!=null?n:l.find(c=>!c.format)}else r=e,t=i.find(l=>l.nodeClass&&r instanceof l.nodeClass);if(!t){let l=(o=(a=r==null?void 0:r.constructor)==null?void 0:a.name)!=null?o:r===null?"null":typeof r;throw new Error(`Tag not resolved for ${l} value`)}return t}function ME(i,e,{anchors:t,doc:r}){var o;if(!r.directives)return"";let s=[],n=(Y(i)||he(i))&&i.anchor;n&&Io(n)&&(t.add(n),s.push(`&${n}`));let a=(o=i.tag)!=null?o:e.default?null:e.tag;return a&&s.push(r.directives.tagString(a)),s.join(" ")}function Er(i,e,t,r){var l,c;if(Q(i))return i.toString(e,t,r);if(Tt(i)){if(e.doc.directives)return i.toString(e);if((l=e.resolvedAliases)!=null&&l.has(i))throw new TypeError("Cannot stringify circular structure without alias nodes");e.resolvedAliases?e.resolvedAliases.add(i):e.resolvedAliases=new Set([i]),i=i.resolve(e.doc)}let s,n=X(i)?i:e.doc.createNode(i,{onTagObj:d=>s=d});s!=null||(s=xE(e.doc.schema.tags,n));let a=ME(n,s,e);a.length>0&&(e.indentAtStart=((c=e.indentAtStart)!=null?c:0)+a.length+1);let o=typeof s.stringify=="function"?s.stringify(n,e,t,r):Y(n)?Is(n,e,t,r):n.toString(e,t,r);return a?Y(n)||o[0]==="{"||o[0]==="["?`${a} ${o}`:`${a}
${e.indent}${o}`:o}var Ln=b(()=>{Po();ie();In();On()});function Wg({key:i,value:e},t,r,s){var A,C;let{allNullValues:n,doc:a,indent:o,indentStep:l,options:{commentString:c,indentSeq:d,simpleKeys:u}}=t,f=X(i)&&i.comment||null;if(u){if(f)throw new Error("With simple keys, key nodes cannot have comments");if(he(i)||!X(i)&&typeof i=="object"){let B="With simple keys, collection cannot be used as a key value";throw new Error(B)}}let h=!u&&(!i||f&&e==null&&!t.inFlow||he(i)||(Y(i)?i.type===F.BLOCK_FOLDED||i.type===F.BLOCK_LITERAL:typeof i=="object"));t=Object.assign({},t,{allNullValues:!1,implicitKey:!h&&(u||!n),indent:o+l});let m=!1,p=!1,g=Er(i,t,()=>m=!0,()=>p=!0);if(!h&&!t.inFlow&&g.length>1024){if(u)throw new Error("With simple keys, single line scalar must not span more than 1024 characters");h=!0}if(t.inFlow){if(n||e==null)return m&&r&&r(),g===""?"?":h?`? ${g}`:g}else if(n&&!u||e==null&&h)return g=`? ${g}`,f&&!m?g+=Xt(g,t.indent,c(f)):p&&s&&s(),g;m&&(f=null),h?(f&&(g+=Xt(g,t.indent,c(f))),g=`? ${g}
${o}:`):(g=`${g}:`,f&&(g+=Xt(g,t.indent,c(f))));let v,w,_;X(e)?(v=!!e.spaceBefore,w=e.commentBefore,_=e.comment):(v=!1,w=null,_=null,e&&typeof e=="object"&&(e=a.createNode(e))),t.implicitKey=!1,!h&&!f&&Y(e)&&(t.indentAtStart=g.length+1),p=!1,!d&&l.length>=2&&!t.inFlow&&!h&&Ft(e)&&!e.flow&&!e.tag&&!e.anchor&&(t.indent=t.indent.substring(2));let E=!1,S=Er(e,t,()=>E=!0,()=>p=!0),D=" ";if(f||v||w){if(D=v?`
`:"",w){let B=c(w);D+=`
${Et(B,t.indent)}`}S===""&&!t.inFlow?D===`
`&&(D=`

`):D+=`
${t.indent}`}else if(!h&&he(e)){let B=S[0],$=S.indexOf(`
`),K=$!==-1,Be=(C=(A=t.inFlow)!=null?A:e.flow)!=null?C:e.items.length===0;if(K||!Be){let mt=!1;if(K&&(B==="&"||B==="!")){let De=S.indexOf(" ");B==="&"&&De!==-1&&De<$&&S[De+1]==="!"&&(De=S.indexOf(" ",De+1)),(De===-1||$<De)&&(mt=!0)}mt||(D=`
${t.indent}`)}}else(S===""||S[0]===`
`)&&(D="");return g+=D+S,t.inFlow?E&&r&&r():_&&!E?g+=Xt(g,t.indent,c(_)):p&&s&&s(),g}var Ug=b(()=>{ie();Ie();Ln();In()});function $o(i,e){(i==="debug"||i==="warn")&&console.warn(e)}var Wd=b(()=>{});function $d(i,e,t){if(t=i&&Tt(t)?t.resolve(i.doc):t,Ft(t))for(let r of t.items)Ud(i,e,r);else if(Array.isArray(t))for(let r of t)Ud(i,e,r);else Ud(i,e,t)}function Ud(i,e,t){let r=i&&Tt(t)?t.resolve(i.doc):t;if(!Lt(r))throw new Error("Merge sources must be maps or map aliases");let s=r.toJSON(null,i,Map);for(let[n,a]of s)e instanceof Map?e.has(n)||e.set(n,a):e instanceof Set?e.add(n):Object.prototype.hasOwnProperty.call(e,n)||Object.defineProperty(e,n,{value:a,writable:!0,enumerable:!0,configurable:!0});return e}var Vo,Ht,$g,zo=b(()=>{ie();Ie();Vo="<<",Ht={identify:i=>i===Vo||typeof i=="symbol"&&i.description===Vo,default:"key",tag:"tag:yaml.org,2002:merge",test:/^<<$/,resolve:()=>Object.assign(new F(Symbol(Vo)),{addToJSMap:$d}),stringify:()=>Vo},$g=(i,e)=>(Ht.identify(e)||Y(e)&&(!e.type||e.type===F.PLAIN)&&Ht.identify(e.value))&&(i==null?void 0:i.doc.schema.tags.some(t=>t.tag===Ht.tag&&t.default))});function jo(i,e,{key:t,value:r}){if(X(t)&&t.addToJSMap)t.addToJSMap(i,e,r);else if($g(i,t))$d(i,e,r);else{let s=Oe(t,"",i);if(e instanceof Map)e.set(s,Oe(r,s,i));else if(e instanceof Set)e.add(s);else{let n=AE(t,s,i),a=Oe(r,n,i);n in e?Object.defineProperty(e,n,{value:a,writable:!0,enumerable:!0,configurable:!0}):e[n]=a}}return e}function AE(i,e,t){if(e===null)return"";if(typeof e!="object")return String(e);if(X(i)&&(t!=null&&t.doc)){let r=Uo(t.doc,{});r.anchors=new Set;for(let n of t.anchors.keys())r.anchors.add(n.anchor);r.inFlow=!0,r.inStringifyKey=!0;let s=i.toString(r);if(!t.mapKeyWarned){let n=JSON.stringify(s);n.length>40&&(n=n.substring(0,36)+'..."'),$o(t.doc.options.logLevel,`Keys with collection values will be stringified due to JS Object restrictions: ${n}. Set mapAsMap: true to use object keys.`),t.mapKeyWarned=!0}return s}return JSON.stringify(e)}var Vd=b(()=>{Wd();zo();Ln();ie();zr()});function Ti(i,e,t){let r=Tr(i,void 0,t),s=Tr(e,void 0,t);return new ke(r,s)}var ke,qr=b(()=>{Mn();Ug();Vd();ie();ke=class{constructor(e,t=null){Object.defineProperty(this,Xe,{value:Pd}),this.key=e,this.value=t}clone(e){let{key:t,value:r}=this;return X(t)&&(t=t.clone(e)),X(r)&&(r=r.clone(e)),new ke(t,r)}toJSON(e,t){let r=t!=null&&t.mapAsMap?new Map:{};return jo(t,r,this)}toString(e,t,r){return e!=null&&e.doc?Wg(this,e,t,r):JSON.stringify(this)}}});function Yo(i,e,t){var n;return(((n=e.inFlow)!=null?n:i.flow)?PE:IE)(i,e,t)}function IE({comment:i,items:e},t,{blockItemPrefix:r,flowChars:s,itemIndent:n,onChompKeep:a,onComment:o}){let{indent:l,options:{commentString:c}}=t,d=Object.assign({},t,{indent:n,type:null}),u=!1,f=[];for(let m=0;m<e.length;++m){let p=e[m],g=null;if(X(p))!u&&p.spaceBefore&&f.push(""),qo(t,f,p.commentBefore,u),p.comment&&(g=p.comment);else if(Q(p)){let w=X(p.key)?p.key:null;w&&(!u&&w.spaceBefore&&f.push(""),qo(t,f,w.commentBefore,u))}u=!1;let v=Er(p,d,()=>g=null,()=>u=!0);g&&(v+=Xt(v,n,c(g))),u&&g&&(u=!1),f.push(r+v)}let h;if(f.length===0)h=s.start+s.end;else{h=f[0];for(let m=1;m<f.length;++m){let p=f[m];h+=p?`
${l}${p}`:`
`}}return i?(h+=`
`+Et(c(i),l),o&&o()):u&&a&&a(),h}function PE({items:i},e,{flowChars:t,itemIndent:r}){let{indent:s,indentStep:n,flowCollectionPadding:a,options:{commentString:o}}=e;r+=n;let l=Object.assign({},e,{indent:r,inFlow:!0,type:null}),c=!1,d=0,u=[];for(let m=0;m<i.length;++m){let p=i[m],g=null;if(X(p))p.spaceBefore&&u.push(""),qo(e,u,p.commentBefore,!1),p.comment&&(g=p.comment);else if(Q(p)){let w=X(p.key)?p.key:null;w&&(w.spaceBefore&&u.push(""),qo(e,u,w.commentBefore,!1),w.comment&&(c=!0));let _=X(p.value)?p.value:null;_?(_.comment&&(g=_.comment),_.commentBefore&&(c=!0)):p.value==null&&(w!=null&&w.comment)&&(g=w.comment)}g&&(c=!0);let v=Er(p,l,()=>g=null);m<i.length-1&&(v+=","),g&&(v+=Xt(v,r,o(g))),!c&&(u.length>d||v.includes(`
`))&&(c=!0),u.push(v),d=u.length}let{start:f,end:h}=t;if(u.length===0)return f+h;if(!c){let m=u.reduce((p,g)=>p+g.length+2,2);c=e.options.lineWidth>0&&m>e.options.lineWidth}if(c){let m=f;for(let p of u)m+=p?`
${n}${s}${p}`:`
`;return`${m}
${s}${h}`}else return`${f}${a}${u.join(" ")}${a}${h}`}function qo({indent:i,options:{commentString:e}},t,r,s){if(r&&s&&(r=r.replace(/^\n+/,"")),r){let n=Et(e(r),i);t.push(n.trimStart())}}var zd=b(()=>{ie();Ln();In()});function Yr(i,e){let t=Y(e)?e.value:e;for(let r of i)if(Q(r)&&(r.key===e||r.key===t||Y(r.key)&&r.key.value===t))return r}var Ce,Qr=b(()=>{zd();Vd();Lo();ie();qr();Ie();Ce=class extends vi{static get tagName(){return"tag:yaml.org,2002:map"}constructor(e){super(Nt,e),this.items=[]}static from(e,t,r){let{keepUndefined:s,replacer:n}=r,a=new this(e),o=(l,c)=>{if(typeof n=="function")c=n.call(t,l,c);else if(Array.isArray(n)&&!n.includes(l))return;(c!==void 0||s)&&a.items.push(Ti(l,c,r))};if(t instanceof Map)for(let[l,c]of t)o(l,c);else if(t&&typeof t=="object")for(let l of Object.keys(t))o(l,t[l]);return typeof e.sortMapEntries=="function"&&a.items.sort(e.sortMapEntries),a}add(e,t){var a;let r;Q(e)?r=e:!e||typeof e!="object"||!("key"in e)?r=new ke(e,e==null?void 0:e.value):r=new ke(e.key,e.value);let s=Yr(this.items,r.key),n=(a=this.schema)==null?void 0:a.sortMapEntries;if(s){if(!t)throw new Error(`Key ${r.key} already set`);Y(s.value)&&Oo(r.value)?s.value.value=r.value:s.value=r.value}else if(n){let o=this.items.findIndex(l=>n(r,l)<0);o===-1?this.items.push(r):this.items.splice(o,0,r)}else this.items.push(r)}delete(e){let t=Yr(this.items,e);return t?this.items.splice(this.items.indexOf(t),1).length>0:!1}get(e,t){var n;let r=Yr(this.items,e),s=r==null?void 0:r.value;return(n=!t&&Y(s)?s.value:s)!=null?n:void 0}has(e){return!!Yr(this.items,e)}set(e,t){this.add(new ke(e,t),!0)}toJSON(e,t,r){let s=r?new r:t!=null&&t.mapAsMap?new Map:{};t!=null&&t.onCreate&&t.onCreate(s);for(let n of this.items)jo(t,s,n);return s}toString(e,t,r){if(!e)return JSON.stringify(this);for(let s of this.items)if(!Q(s))throw new Error(`Map items must all be pairs; found ${JSON.stringify(s)} instead`);return!e.allNullValues&&this.hasAllNullValues(!1)&&(e=Object.assign({},e,{allNullValues:!0})),Yo(this,e,{blockItemPrefix:"",flowChars:{start:"{",end:"}"},itemIndent:e.indent||"",onChompKeep:r,onComment:t})}}});var Bt,Ei=b(()=>{ie();Qr();Bt={collection:"map",default:!0,nodeClass:Ce,tag:"tag:yaml.org,2002:map",resolve(i,e){return Lt(i)||e("Expected a mapping for this tag"),i},createNode:(i,e,t)=>Ce.from(i,e,t)}});function Qo(i){let e=Y(i)?i.value:i;return e&&typeof e=="string"&&(e=Number(e)),typeof e=="number"&&Number.isInteger(e)&&e>=0?e:null}var Ke,Gr=b(()=>{Mn();zd();Lo();ie();Ie();zr();Ke=class extends vi{static get tagName(){return"tag:yaml.org,2002:seq"}constructor(e){super(br,e),this.items=[]}add(e){this.items.push(e)}delete(e){let t=Qo(e);return typeof t!="number"?!1:this.items.splice(t,1).length>0}get(e,t){let r=Qo(e);if(typeof r!="number")return;let s=this.items[r];return!t&&Y(s)?s.value:s}has(e){let t=Qo(e);return typeof t=="number"&&t<this.items.length}set(e,t){let r=Qo(e);if(typeof r!="number")throw new Error(`Expected a valid index, not ${e}.`);let s=this.items[r];Y(s)&&Oo(t)?s.value=t:this.items[r]=t}toJSON(e,t){let r=[];t!=null&&t.onCreate&&t.onCreate(r);let s=0;for(let n of this.items)r.push(Oe(n,String(s++),t));return r}toString(e,t,r){return e?Yo(this,e,{blockItemPrefix:"- ",flowChars:{start:"[",end:"]"},itemIndent:(e.indent||"")+"  ",onChompKeep:r,onComment:t}):JSON.stringify(this)}static from(e,t,r){let{replacer:s}=r,n=new this(e);if(t&&Symbol.iterator in Object(t)){let a=0;for(let o of t){if(typeof s=="function"){let l=t instanceof Set?o:String(a++);o=s.call(t,l,o)}n.items.push(Tr(o,void 0,r))}}return n}}});var Wt,ki=b(()=>{ie();Gr();Wt={collection:"seq",default:!0,nodeClass:Ke,tag:"tag:yaml.org,2002:seq",resolve(i,e){return Ft(i)||e("Expected a sequence for this tag"),i},createNode:(i,e,t)=>Ke.from(i,e,t)}});var Kr,Fn=b(()=>{On();Kr={identify:i=>typeof i=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:i=>i,stringify(i,e,t,r){return e=Object.assign({actualString:!0},e),Is(i,e,t,r)}}});var Ps,Go=b(()=>{Ie();Ps={identify:i=>i==null,createNode:()=>new F(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^(?:~|[Nn]ull|NULL)?$/,resolve:()=>new F(null),stringify:({source:i},e)=>typeof i=="string"&&Ps.test.test(i)?i:e.options.nullStr}});var Hn,jd=b(()=>{Ie();Hn={identify:i=>typeof i=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:[Tt]rue|TRUE|[Ff]alse|FALSE)$/,resolve:i=>new F(i[0]==="t"||i[0]==="T"),stringify({source:i,value:e},t){if(i&&Hn.test.test(i)){let r=i[0]==="t"||i[0]==="T";if(e===r)return i}return e?t.options.trueStr:t.options.falseStr}}});function Ze({format:i,minFractionDigits:e,tag:t,value:r}){if(typeof r=="bigint")return String(r);let s=typeof r=="number"?r:Number(r);if(!isFinite(s))return isNaN(s)?".nan":s<0?"-.inf":".inf";let n=JSON.stringify(r);if(!i&&e&&(!t||t==="tag:yaml.org,2002:float")&&/^\d/.test(n)){let a=n.indexOf(".");a<0&&(a=n.length,n+=".");let o=e-(n.length-a-1);for(;o-- >0;)n+="0"}return n}var Di=b(()=>{});var Ko,Zo,Xo,qd=b(()=>{Ie();Di();Ko={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:i=>i.slice(-3).toLowerCase()==="nan"?NaN:i[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Ze},Zo={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:\.[0-9]+|[0-9]+(?:\.[0-9]*)?)[eE][-+]?[0-9]+$/,resolve:i=>parseFloat(i),stringify(i){let e=Number(i.value);return isFinite(e)?e.toExponential():Ze(i)}},Xo={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:\.[0-9]+|[0-9]+\.[0-9]*)$/,resolve(i){let e=new F(parseFloat(i)),t=i.indexOf(".");return t!==-1&&i[i.length-1]==="0"&&(e.minFractionDigits=i.length-t-1),e},stringify:Ze}});function Vg(i,e,t){let{value:r}=i;return Jo(r)&&r>=0?t+r.toString(e):Ze(i)}var Jo,Yd,el,tl,rl,Qd=b(()=>{Di();Jo=i=>typeof i=="bigint"||Number.isInteger(i),Yd=(i,e,t,{intAsBigInt:r})=>r?BigInt(i):parseInt(i.substring(e),t);el={identify:i=>Jo(i)&&i>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^0o[0-7]+$/,resolve:(i,e,t)=>Yd(i,2,8,t),stringify:i=>Vg(i,8,"0o")},tl={identify:Jo,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9]+$/,resolve:(i,e,t)=>Yd(i,0,10,t),stringify:Ze},rl={identify:i=>Jo(i)&&i>=0,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^0x[0-9a-fA-F]+$/,resolve:(i,e,t)=>Yd(i,2,16,t),stringify:i=>Vg(i,16,"0x")}});var zg,jg=b(()=>{Ei();Go();ki();Fn();jd();qd();Qd();zg=[Bt,Wt,Kr,Ps,Hn,el,tl,rl,Ko,Zo,Xo]});function qg(i){return typeof i=="bigint"||Number.isInteger(i)}var sl,RE,NE,Yg,Qg=b(()=>{Ie();Ei();ki();sl=({value:i})=>JSON.stringify(i),RE=[{identify:i=>typeof i=="string",default:!0,tag:"tag:yaml.org,2002:str",resolve:i=>i,stringify:sl},{identify:i=>i==null,createNode:()=>new F(null),default:!0,tag:"tag:yaml.org,2002:null",test:/^null$/,resolve:()=>null,stringify:sl},{identify:i=>typeof i=="boolean",default:!0,tag:"tag:yaml.org,2002:bool",test:/^true$|^false$/,resolve:i=>i==="true",stringify:sl},{identify:qg,default:!0,tag:"tag:yaml.org,2002:int",test:/^-?(?:0|[1-9][0-9]*)$/,resolve:(i,e,{intAsBigInt:t})=>t?BigInt(i):parseInt(i,10),stringify:({value:i})=>qg(i)?i.toString():JSON.stringify(i)},{identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^-?(?:0|[1-9][0-9]*)(?:\.[0-9]*)?(?:[eE][-+]?[0-9]+)?$/,resolve:i=>parseFloat(i),stringify:sl}],NE={default:!0,tag:"",test:/^/,resolve(i,e){return e(`Unresolved plain scalar ${JSON.stringify(i)}`),i}},Yg=[Bt,Wt].concat(RE,NE)});var Bn,Gd=b(()=>{Ie();On();Bn={identify:i=>i instanceof Uint8Array,default:!1,tag:"tag:yaml.org,2002:binary",resolve(i,e){if(typeof atob=="function"){let t=atob(i.replace(/[\n\r]/g,"")),r=new Uint8Array(t.length);for(let s=0;s<t.length;++s)r[s]=t.charCodeAt(s);return r}else return e("This environment does not support reading binary tags; either Buffer or atob is required"),i},stringify({comment:i,type:e,value:t},r,s,n){if(!t)return"";let a=t,o;if(typeof btoa=="function"){let l="";for(let c=0;c<a.length;++c)l+=String.fromCharCode(a[c]);o=btoa(l)}else throw new Error("This environment does not support writing binary tags; either Buffer or btoa is required");if(e!=null||(e=F.BLOCK_LITERAL),e!==F.QUOTE_DOUBLE){let l=Math.max(r.options.lineWidth-r.indent.length,r.options.minContentWidth),c=Math.ceil(o.length/l),d=new Array(c);for(let u=0,f=0;u<c;++u,f+=l)d[u]=o.substr(f,l);o=d.join(e===F.BLOCK_LITERAL?`
`:" ")}return Is({comment:i,type:e,value:o},r,s,n)}}});function Kd(i,e){var t;if(Ft(i))for(let r=0;r<i.items.length;++r){let s=i.items[r];if(!Q(s)){if(Lt(s)){s.items.length>1&&e("Each pair must have its own sequence indicator");let n=s.items[0]||new ke(new F(null));if(s.commentBefore&&(n.key.commentBefore=n.key.commentBefore?`${s.commentBefore}
${n.key.commentBefore}`:s.commentBefore),s.comment){let a=(t=n.value)!=null?t:n.key;a.comment=a.comment?`${s.comment}
${a.comment}`:s.comment}s=n}i.items[r]=Q(s)?s:new ke(s)}}else e("Expected a sequence for this tag");return i}function Zd(i,e,t){let{replacer:r}=t,s=new Ke(i);s.tag="tag:yaml.org,2002:pairs";let n=0;if(e&&Symbol.iterator in Object(e))for(let a of e){typeof r=="function"&&(a=r.call(e,String(n++),a));let o,l;if(Array.isArray(a))if(a.length===2)o=a[0],l=a[1];else throw new TypeError(`Expected [key, value] tuple: ${a}`);else if(a&&a instanceof Object){let c=Object.keys(a);if(c.length===1)o=c[0],l=a[o];else throw new TypeError(`Expected tuple with one key, not ${c.length} keys`)}else o=a;s.items.push(Ti(o,l,t))}return s}var Wn,il=b(()=>{ie();qr();Ie();Gr();Wn={collection:"seq",default:!1,tag:"tag:yaml.org,2002:pairs",resolve:Kd,createNode:Zd}});var Zr,Un,Xd=b(()=>{ie();zr();Qr();Gr();il();Zr=class extends Ke{constructor(){super(),this.add=Ce.prototype.add.bind(this),this.delete=Ce.prototype.delete.bind(this),this.get=Ce.prototype.get.bind(this),this.has=Ce.prototype.has.bind(this),this.set=Ce.prototype.set.bind(this),this.tag=Zr.tag}toJSON(e,t){if(!t)return super.toJSON(e);let r=new Map;t!=null&&t.onCreate&&t.onCreate(r);for(let s of this.items){let n,a;if(Q(s)?(n=Oe(s.key,"",t),a=Oe(s.value,n,t)):n=Oe(s,"",t),r.has(n))throw new Error("Ordered maps must not include duplicate keys");r.set(n,a)}return r}static from(e,t,r){let s=Zd(e,t,r),n=new this;return n.items=s.items,n}};Zr.tag="tag:yaml.org,2002:omap";Un={collection:"seq",identify:i=>i instanceof Map,nodeClass:Zr,default:!1,tag:"tag:yaml.org,2002:omap",resolve(i,e){let t=Kd(i,e),r=[];for(let{key:s}of t.items)Y(s)&&(r.includes(s.value)?e(`Ordered maps must not include duplicate keys: ${s.value}`):r.push(s.value));return Object.assign(new Zr,t)},createNode:(i,e,t)=>Zr.from(i,e,t)}});function Gg({value:i,source:e},t){return e&&(i?Jd:eu).test.test(e)?e:i?t.options.trueStr:t.options.falseStr}var Jd,eu,Kg=b(()=>{Ie();Jd={identify:i=>i===!0,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:Y|y|[Yy]es|YES|[Tt]rue|TRUE|[Oo]n|ON)$/,resolve:()=>new F(!0),stringify:Gg},eu={identify:i=>i===!1,default:!0,tag:"tag:yaml.org,2002:bool",test:/^(?:N|n|[Nn]o|NO|[Ff]alse|FALSE|[Oo]ff|OFF)$/,resolve:()=>new F(!1),stringify:Gg}});var Zg,Xg,Jg,ey=b(()=>{Ie();Di();Zg={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^(?:[-+]?\.(?:inf|Inf|INF)|\.nan|\.NaN|\.NAN)$/,resolve:i=>i.slice(-3).toLowerCase()==="nan"?NaN:i[0]==="-"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,stringify:Ze},Xg={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"EXP",test:/^[-+]?(?:[0-9][0-9_]*)?(?:\.[0-9_]*)?[eE][-+]?[0-9]+$/,resolve:i=>parseFloat(i.replace(/_/g,"")),stringify(i){let e=Number(i.value);return isFinite(e)?e.toExponential():Ze(i)}},Jg={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",test:/^[-+]?(?:[0-9][0-9_]*)?\.[0-9_]*$/,resolve(i){let e=new F(parseFloat(i.replace(/_/g,""))),t=i.indexOf(".");if(t!==-1){let r=i.substring(t+1).replace(/_/g,"");r[r.length-1]==="0"&&(e.minFractionDigits=r.length)}return e},stringify:Ze}});function nl(i,e,t,{intAsBigInt:r}){let s=i[0];if((s==="-"||s==="+")&&(e+=1),i=i.substring(e).replace(/_/g,""),r){switch(t){case 2:i=`0b${i}`;break;case 8:i=`0o${i}`;break;case 16:i=`0x${i}`;break}let a=BigInt(i);return s==="-"?BigInt(-1)*a:a}let n=parseInt(i,t);return s==="-"?-1*n:n}function tu(i,e,t){let{value:r}=i;if($n(r)){let s=r.toString(e);return r<0?"-"+t+s.substr(1):t+s}return Ze(i)}var $n,ty,ry,sy,iy,ny=b(()=>{Di();$n=i=>typeof i=="bigint"||Number.isInteger(i);ty={identify:$n,default:!0,tag:"tag:yaml.org,2002:int",format:"BIN",test:/^[-+]?0b[0-1_]+$/,resolve:(i,e,t)=>nl(i,2,2,t),stringify:i=>tu(i,2,"0b")},ry={identify:$n,default:!0,tag:"tag:yaml.org,2002:int",format:"OCT",test:/^[-+]?0[0-7_]+$/,resolve:(i,e,t)=>nl(i,1,8,t),stringify:i=>tu(i,8,"0")},sy={identify:$n,default:!0,tag:"tag:yaml.org,2002:int",test:/^[-+]?[0-9][0-9_]*$/,resolve:(i,e,t)=>nl(i,0,10,t),stringify:Ze},iy={identify:$n,default:!0,tag:"tag:yaml.org,2002:int",format:"HEX",test:/^[-+]?0x[0-9a-fA-F_]+$/,resolve:(i,e,t)=>nl(i,2,16,t),stringify:i=>tu(i,16,"0x")}});var Xr,Vn,ru=b(()=>{ie();qr();Qr();Xr=class extends Ce{constructor(e){super(e),this.tag=Xr.tag}add(e){let t;Q(e)?t=e:e&&typeof e=="object"&&"key"in e&&"value"in e&&e.value===null?t=new ke(e.key,null):t=new ke(e,null),Yr(this.items,t.key)||this.items.push(t)}get(e,t){let r=Yr(this.items,e);return!t&&Q(r)?Y(r.key)?r.key.value:r.key:r}set(e,t){if(typeof t!="boolean")throw new Error(`Expected boolean value for set(key, value) in a YAML set, not ${typeof t}`);let r=Yr(this.items,e);r&&!t?this.items.splice(this.items.indexOf(r),1):!r&&t&&this.items.push(new ke(e))}toJSON(e,t){return super.toJSON(e,t,Set)}toString(e,t,r){if(!e)return JSON.stringify(this);if(this.hasAllNullValues(!0))return super.toString(Object.assign({},e,{allNullValues:!0}),t,r);throw new Error("Set items must all have null values")}static from(e,t,r){let{replacer:s}=r,n=new this(e);if(t&&Symbol.iterator in Object(t))for(let a of t)typeof s=="function"&&(a=s.call(t,a,a)),n.items.push(Ti(a,null,r));return n}};Xr.tag="tag:yaml.org,2002:set";Vn={collection:"map",identify:i=>i instanceof Set,nodeClass:Xr,default:!1,tag:"tag:yaml.org,2002:set",createNode:(i,e,t)=>Xr.from(i,e,t),resolve(i,e){if(Lt(i)){if(i.hasAllNullValues(!0))return Object.assign(new Xr,i);e("Set items must all have null values")}else e("Expected a mapping for this tag");return i}}});function su(i,e){let t=i[0],r=t==="-"||t==="+"?i.substring(1):i,s=a=>e?BigInt(a):Number(a),n=r.replace(/_/g,"").split(":").reduce((a,o)=>a*s(60)+s(o),s(0));return t==="-"?s(-1)*n:n}function ay(i){let{value:e}=i,t=a=>a;if(typeof e=="bigint")t=a=>BigInt(a);else if(isNaN(e)||!isFinite(e))return Ze(i);let r="";e<0&&(r="-",e*=t(-1));let s=t(60),n=[e%s];return e<60?n.unshift(0):(e=(e-n[0])/s,n.unshift(e%s),e>=60&&(e=(e-n[0])/s,n.unshift(e))),r+n.map(a=>String(a).padStart(2,"0")).join(":").replace(/000000\d*$/,"")}var al,ol,Si,iu=b(()=>{Di();al={identify:i=>typeof i=="bigint"||Number.isInteger(i),default:!0,tag:"tag:yaml.org,2002:int",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+$/,resolve:(i,e,{intAsBigInt:t})=>su(i,t),stringify:ay},ol={identify:i=>typeof i=="number",default:!0,tag:"tag:yaml.org,2002:float",format:"TIME",test:/^[-+]?[0-9][0-9_]*(?::[0-5]?[0-9])+\.[0-9_]*$/,resolve:i=>su(i,!1),stringify:ay},Si={identify:i=>i instanceof Date,default:!0,tag:"tag:yaml.org,2002:timestamp",test:RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})(?:(?:t|T|[ \\t]+)([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2}(\\.[0-9]+)?)(?:[ \\t]*(Z|[-+][012]?[0-9](?::[0-9]{2})?))?)?$"),resolve(i){let e=i.match(Si.test);if(!e)throw new Error("!!timestamp expects a date, starting with yyyy-mm-dd");let[,t,r,s,n,a,o]=e.map(Number),l=e[7]?Number((e[7]+"00").substr(1,3)):0,c=Date.UTC(t,r-1,s,n||0,a||0,o||0,l),d=e[8];if(d&&d!=="Z"){let u=su(d,!1);Math.abs(u)<30&&(u*=60),c-=6e4*u}return new Date(c)},stringify:({value:i})=>{var e;return(e=i==null?void 0:i.toISOString().replace(/(T00:00:00)?\.000Z$/,""))!=null?e:""}}});var nu,oy=b(()=>{Ei();Go();ki();Fn();Gd();Kg();ey();ny();zo();Xd();il();ru();iu();nu=[Bt,Wt,Kr,Ps,Jd,eu,ty,ry,sy,iy,Zg,Xg,Jg,Bn,Ht,Un,Wn,Vn,al,ol,Si]});function ll(i,e,t){let r=ly.get(e);if(r&&!i)return t&&!r.includes(Ht)?r.concat(Ht):r.slice();let s=r;if(!s)if(Array.isArray(i))s=[];else{let n=Array.from(ly.keys()).filter(a=>a!=="yaml11").map(a=>JSON.stringify(a)).join(", ");throw new Error(`Unknown schema "${e}"; use one of ${n} or define customTags array`)}if(Array.isArray(i))for(let n of i)s=s.concat(n);else typeof i=="function"&&(s=i(s.slice()));return t&&(s=s.concat(Ht)),s.reduce((n,a)=>{let o=typeof a=="string"?cy[a]:a;if(!o){let l=JSON.stringify(a),c=Object.keys(cy).map(d=>JSON.stringify(d)).join(", ");throw new Error(`Unknown custom tag ${l}; use one of ${c}`)}return n.includes(o)||n.push(o),n},[])}var ly,cy,dy,uy=b(()=>{Ei();Go();ki();Fn();jd();qd();Qd();jg();Qg();Gd();zo();Xd();il();oy();ru();iu();ly=new Map([["core",zg],["failsafe",[Bt,Wt,Kr]],["json",Yg],["yaml11",nu],["yaml-1.1",nu]]),cy={binary:Bn,bool:Hn,float:Xo,floatExp:Zo,floatNaN:Ko,floatTime:ol,int:tl,intHex:rl,intOct:el,intTime:al,map:Bt,merge:Ht,null:Ps,omap:Un,pairs:Wn,seq:Wt,set:Vn,timestamp:Si},dy={"tag:yaml.org,2002:binary":Bn,"tag:yaml.org,2002:merge":Ht,"tag:yaml.org,2002:omap":Un,"tag:yaml.org,2002:pairs":Wn,"tag:yaml.org,2002:set":Vn,"tag:yaml.org,2002:timestamp":Si}});var OE,Rs,au=b(()=>{ie();Ei();ki();Fn();uy();OE=(i,e)=>i.key<e.key?-1:i.key>e.key?1:0,Rs=class{constructor({compat:e,customTags:t,merge:r,resolveKnownTags:s,schema:n,sortMapEntries:a,toStringDefaults:o}){this.compat=Array.isArray(e)?ll(e,"compat"):e?ll(null,e):null,this.name=typeof n=="string"&&n||"core",this.knownTags=s?dy:{},this.tags=ll(t,this.name,r),this.toStringOptions=o!=null?o:null,Object.defineProperty(this,Nt,{value:Bt}),Object.defineProperty(this,ut,{value:Kr}),Object.defineProperty(this,br,{value:Wt}),this.sortMapEntries=typeof a=="function"?a:a===!0?OE:null}clone(){let e=Object.create(Rs.prototype,Object.getOwnPropertyDescriptors(this));return e.tags=this.tags.slice(),e}}});function fy(i,e){var l;let t=[],r=e.directives===!0;if(e.directives!==!1&&i.directives){let c=i.directives.toString(i);c?(t.push(c),r=!0):i.directives.docStart&&(r=!0)}r&&t.push("---");let s=Uo(i,e),{commentString:n}=s.options;if(i.commentBefore){t.length!==1&&t.unshift("");let c=n(i.commentBefore);t.unshift(Et(c,""))}let a=!1,o=null;if(i.contents){if(X(i.contents)){if(i.contents.spaceBefore&&r&&t.push(""),i.contents.commentBefore){let u=n(i.contents.commentBefore);t.push(Et(u,""))}s.forceBlockIndent=!!i.comment,o=i.contents.comment}let c=o?void 0:()=>a=!0,d=Er(i.contents,s,()=>o=null,c);o&&(d+=Xt(d,"",n(o))),(d[0]==="|"||d[0]===">")&&t[t.length-1]==="---"?t[t.length-1]=`--- ${d}`:t.push(d)}else t.push(Er(i.contents,s));if((l=i.directives)!=null&&l.docEnd)if(i.comment){let c=n(i.comment);c.includes(`
`)?(t.push("..."),t.push(Et(c,""))):t.push(`... ${c}`)}else t.push("...");else{let c=i.comment;c&&a&&(c=c.replace(/^\n+/,"")),c&&((!a||o)&&t[t.length-1]!==""&&t.push(""),t.push(Et(n(c),"")))}return t.join(`
`)+`
`}var hy=b(()=>{ie();Ln();In()});function Ci(i){if(he(i))return!0;throw new Error("Expected a YAML collection as document contents")}var Ut,zn=b(()=>{xn();Lo();ie();qr();zr();au();hy();Po();Ld();Mn();Rd();Ut=class{constructor(e,t,r){this.commentBefore=null,this.comment=null,this.errors=[],this.warnings=[],Object.defineProperty(this,Xe,{value:xo});let s=null;typeof t=="function"||Array.isArray(t)?s=t:r===void 0&&t&&(r=t,t=void 0);let n=Object.assign({intAsBigInt:!1,keepSourceTokens:!1,logLevel:"warn",prettyErrors:!0,strict:!0,stringKeys:!1,uniqueKeys:!0,version:"1.2"},r);this.options=n;let{version:a}=n;r!=null&&r._directives?(this.directives=r._directives.atDocument(),this.directives.yaml.explicit&&(a=this.directives.yaml.version)):this.directives=new Ne({version:a}),this.setSchema(a,r),this.contents=e===void 0?null:this.createNode(e,s,r)}clone(){let e=Object.create(Ut.prototype,{[Xe]:{value:xo}});return e.commentBefore=this.commentBefore,e.comment=this.comment,e.errors=this.errors.slice(),e.warnings=this.warnings.slice(),e.options=Object.assign({},this.options),this.directives&&(e.directives=this.directives.clone()),e.schema=this.schema.clone(),e.contents=X(this.contents)?this.contents.clone(e.schema):this.contents,this.range&&(e.range=this.range.slice()),e}add(e){Ci(this.contents)&&this.contents.add(e)}addIn(e,t){Ci(this.contents)&&this.contents.addIn(e,t)}createAlias(e,t){if(!e.anchor){let r=Nd(this);e.anchor=!t||r.has(t)?Od(t||"a",r):t}return new wr(e.anchor)}createNode(e,t,r){let s;if(typeof t=="function")e=t.call({"":e},"",e),s=t;else if(Array.isArray(t)){let g=w=>typeof w=="number"||w instanceof String||w instanceof Number,v=t.filter(g).map(String);v.length>0&&(t=t.concat(v)),s=t}else r===void 0&&t&&(r=t,t=void 0);let{aliasDuplicateObjects:n,anchorPrefix:a,flow:o,keepUndefined:l,onTagObj:c,tag:d}=r!=null?r:{},{onAnchor:u,setAnchors:f,sourceObjects:h}=Lg(this,a||"a"),m={aliasDuplicateObjects:n!=null?n:!0,keepUndefined:l!=null?l:!1,onAnchor:u,onTagObj:c,replacer:s,schema:this.schema,sourceObjects:h},p=Tr(e,d,m);return o&&he(p)&&(p.flow=!0),f(),p}createPair(e,t,r={}){let s=this.createNode(e,null,r),n=this.createNode(t,null,r);return new ke(s,n)}delete(e){return Ci(this.contents)?this.contents.delete(e):!1}deleteIn(e){return bi(e)?this.contents==null?!1:(this.contents=null,!0):Ci(this.contents)?this.contents.deleteIn(e):!1}get(e,t){return he(this.contents)?this.contents.get(e,t):void 0}getIn(e,t){return bi(e)?!t&&Y(this.contents)?this.contents.value:this.contents:he(this.contents)?this.contents.getIn(e,t):void 0}has(e){return he(this.contents)?this.contents.has(e):!1}hasIn(e){return bi(e)?this.contents!==void 0:he(this.contents)?this.contents.hasIn(e):!1}set(e,t){this.contents==null?this.contents=An(this.schema,[e],t):Ci(this.contents)&&this.contents.set(e,t)}setIn(e,t){bi(e)?this.contents=t:this.contents==null?this.contents=An(this.schema,Array.from(e),t):Ci(this.contents)&&this.contents.setIn(e,t)}setSchema(e,t={}){typeof e=="number"&&(e=String(e));let r;switch(e){case"1.1":this.directives?this.directives.yaml.version="1.1":this.directives=new Ne({version:"1.1"}),r={resolveKnownTags:!1,schema:"yaml-1.1"};break;case"1.2":case"next":this.directives?this.directives.yaml.version=e:this.directives=new Ne({version:e}),r={resolveKnownTags:!0,schema:"core"};break;case null:this.directives&&delete this.directives,r=null;break;default:{let s=JSON.stringify(e);throw new Error(`Expected '1.1', '1.2' or null as first argument, but found: ${s}`)}}if(t.schema instanceof Object)this.schema=t.schema;else if(r)this.schema=new Rs(Object.assign(r,t));else throw new Error("With a null YAML version, the { schema: Schema } option is required")}toJS({json:e,jsonArg:t,mapAsMap:r,maxAliasCount:s,onAnchor:n,reviver:a}={}){let o={anchors:new Map,doc:this,keep:!e,mapAsMap:r===!0,mapKeyWarned:!1,maxAliasCount:typeof s=="number"?s:100},l=Oe(this.contents,t!=null?t:"",o);if(typeof n=="function")for(let{count:c,res:d}of o.anchors.values())n(d,c);return typeof a=="function"?Vr(a,{"":l},"",l):l}toJSON(e,t){return this.toJS({json:!0,jsonArg:e,mapAsMap:!1,onAnchor:t})}toString(e={}){if(this.errors.length>0)throw new Error("Document with errors cannot be stringified");if("indent"in e&&(!Number.isInteger(e.indent)||Number(e.indent)<=0)){let t=JSON.stringify(e.indent);throw new Error(`"indent" option must be a positive integer, not ${t}`)}return fy(this,e)}}});var jn,$t,qn,ou,Yn=b(()=>{jn=class extends Error{constructor(e,t,r,s){super(),this.name=e,this.code=r,this.message=s,this.pos=t}},$t=class extends jn{constructor(e,t,r){super("YAMLParseError",e,t,r)}},qn=class extends jn{constructor(e,t,r){super("YAMLWarning",e,t,r)}},ou=(i,e)=>t=>{if(t.pos[0]===-1)return;t.linePos=t.pos.map(o=>e.linePos(o));let{line:r,col:s}=t.linePos[0];t.message+=` at line ${r}, column ${s}`;let n=s-1,a=i.substring(e.lineStarts[r-1],e.lineStarts[r]).replace(/[\n\r]+$/,"");if(n>=60&&a.length>80){let o=Math.min(n-39,a.length-79);a="\u2026"+a.substring(o),n-=o-1}if(a.length>80&&(a=a.substring(0,79)+"\u2026"),r>1&&/^ *$/.test(a.substring(0,n))){let o=i.substring(e.lineStarts[r-2],e.lineStarts[r-1]);o.length>80&&(o=o.substring(0,79)+`\u2026
`),a=o+a}if(/[^ ]/.test(a)){let o=1,l=t.linePos[1];l&&l.line===r&&l.col>s&&(o=Math.max(1,Math.min(l.col-s,80-n)));let c=" ".repeat(n)+"^".repeat(o);t.message+=`:

${a}
${c}
`}}});function Jt(i,{flow:e,indicator:t,next:r,offset:s,onError:n,parentIndent:a,startOnNewline:o}){let l=!1,c=o,d=o,u="",f="",h=!1,m=!1,p=null,g=null,v=null,w=null,_=null,E=null,S=null;for(let C of i)switch(m&&(C.type!=="space"&&C.type!=="newline"&&C.type!=="comma"&&n(C.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),m=!1),p&&(c&&C.type!=="comment"&&C.type!=="newline"&&n(p,"TAB_AS_INDENT","Tabs are not allowed as indentation"),p=null),C.type){case"space":!e&&(t!=="doc-start"||(r==null?void 0:r.type)!=="flow-collection")&&C.source.includes("	")&&(p=C),d=!0;break;case"comment":{d||n(C,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let B=C.source.substring(1)||" ";u?u+=f+B:u=B,f="",c=!1;break}case"newline":c?u?u+=C.source:(!E||t!=="seq-item-ind")&&(l=!0):f+=C.source,c=!0,h=!0,(g||v)&&(w=C),d=!0;break;case"anchor":g&&n(C,"MULTIPLE_ANCHORS","A node can have at most one anchor"),C.source.endsWith(":")&&n(C.offset+C.source.length-1,"BAD_ALIAS","Anchor ending in : is ambiguous",!0),g=C,S!=null||(S=C.offset),c=!1,d=!1,m=!0;break;case"tag":{v&&n(C,"MULTIPLE_TAGS","A node can have at most one tag"),v=C,S!=null||(S=C.offset),c=!1,d=!1,m=!0;break}case t:(g||v)&&n(C,"BAD_PROP_ORDER",`Anchors and tags must be after the ${C.source} indicator`),E&&n(C,"UNEXPECTED_TOKEN",`Unexpected ${C.source} in ${e!=null?e:"collection"}`),E=C,c=t==="seq-item-ind"||t==="explicit-key-ind",d=!1;break;case"comma":if(e){_&&n(C,"UNEXPECTED_TOKEN",`Unexpected , in ${e}`),_=C,c=!1,d=!1;break}default:n(C,"UNEXPECTED_TOKEN",`Unexpected ${C.type} token`),c=!1,d=!1}let D=i[i.length-1],A=D?D.offset+D.source.length:s;return m&&r&&r.type!=="space"&&r.type!=="newline"&&r.type!=="comma"&&(r.type!=="scalar"||r.source!=="")&&n(r.offset,"MISSING_CHAR","Tags and anchors must be separated from the next token by white space"),p&&(c&&p.indent<=a||(r==null?void 0:r.type)==="block-map"||(r==null?void 0:r.type)==="block-seq")&&n(p,"TAB_AS_INDENT","Tabs are not allowed as indentation"),{comma:_,found:E,spaceBefore:l,comment:u,hasNewline:h,anchor:g,tag:v,newlineAfterProp:w,end:A,start:S!=null?S:A}}var Qn=b(()=>{});function Jr(i){if(!i)return null;switch(i.type){case"alias":case"scalar":case"double-quoted-scalar":case"single-quoted-scalar":if(i.source.includes(`
`))return!0;if(i.end){for(let e of i.end)if(e.type==="newline")return!0}return!1;case"flow-collection":for(let e of i.items){for(let t of e.start)if(t.type==="newline")return!0;if(e.sep){for(let t of e.sep)if(t.type==="newline")return!0}if(Jr(e.key)||Jr(e.value))return!0}return!1;default:return!0}}var cl=b(()=>{});function Gn(i,e,t){if((e==null?void 0:e.type)==="flow-collection"){let r=e.end[0];r.indent===i&&(r.source==="]"||r.source==="}")&&Jr(e)&&t(r,"BAD_INDENT","Flow end indicator should be more indented than parent",!0)}}var lu=b(()=>{cl()});function dl(i,e,t){let{uniqueKeys:r}=i.options;if(r===!1)return!1;let s=typeof r=="function"?r:(n,a)=>n===a||Y(n)&&Y(a)&&n.value===a.value;return e.some(n=>s(n.key,t))}var cu=b(()=>{ie()});function my({composeNode:i,composeEmptyNode:e},t,r,s,n){var d,u;let a=(d=n==null?void 0:n.nodeClass)!=null?d:Ce,o=new a(t.schema);t.atRoot&&(t.atRoot=!1);let l=r.offset,c=null;for(let f of r.items){let{start:h,key:m,sep:p,value:g}=f,v=Jt(h,{indicator:"explicit-key-ind",next:m!=null?m:p==null?void 0:p[0],offset:l,onError:s,parentIndent:r.indent,startOnNewline:!0}),w=!v.found;if(w){if(m&&(m.type==="block-seq"?s(l,"BLOCK_AS_IMPLICIT_KEY","A block sequence may not be used as an implicit map key"):"indent"in m&&m.indent!==r.indent&&s(l,"BAD_INDENT",py)),!v.anchor&&!v.tag&&!p){c=v.end,v.comment&&(o.comment?o.comment+=`
`+v.comment:o.comment=v.comment);continue}(v.newlineAfterProp||Jr(m))&&s(m!=null?m:h[h.length-1],"MULTILINE_IMPLICIT_KEY","Implicit keys need to be on a single line")}else((u=v.found)==null?void 0:u.indent)!==r.indent&&s(l,"BAD_INDENT",py);t.atKey=!0;let _=v.end,E=m?i(t,m,v,s):e(t,_,h,null,v,s);t.schema.compat&&Gn(r.indent,m,s),t.atKey=!1,dl(t,o.items,E)&&s(_,"DUPLICATE_KEY","Map keys must be unique");let S=Jt(p!=null?p:[],{indicator:"map-value-ind",next:g,offset:E.range[2],onError:s,parentIndent:r.indent,startOnNewline:!m||m.type==="block-scalar"});if(l=S.end,S.found){w&&((g==null?void 0:g.type)==="block-map"&&!S.hasNewline&&s(l,"BLOCK_AS_IMPLICIT_KEY","Nested mappings are not allowed in compact mappings"),t.options.strict&&v.start<S.found.offset-1024&&s(E.range,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit block mapping key"));let D=g?i(t,g,S,s):e(t,l,p,null,S,s);t.schema.compat&&Gn(r.indent,g,s),l=D.range[2];let A=new ke(E,D);t.options.keepSourceTokens&&(A.srcToken=f),o.items.push(A)}else{w&&s(E.range,"MISSING_CHAR","Implicit map keys need to be followed by map values"),S.comment&&(E.comment?E.comment+=`
`+S.comment:E.comment=S.comment);let D=new ke(E);t.options.keepSourceTokens&&(D.srcToken=f),o.items.push(D)}}return c&&c<l&&s(c,"IMPOSSIBLE","Map comment with trailing content"),o.range=[r.offset,l,c!=null?c:l],o}var py,gy=b(()=>{qr();Qr();Qn();cl();lu();cu();py="All mapping items must start at the same column"});function yy({composeNode:i,composeEmptyNode:e},t,r,s,n){var d;let a=(d=n==null?void 0:n.nodeClass)!=null?d:Ke,o=new a(t.schema);t.atRoot&&(t.atRoot=!1),t.atKey&&(t.atKey=!1);let l=r.offset,c=null;for(let{start:u,value:f}of r.items){let h=Jt(u,{indicator:"seq-item-ind",next:f,offset:l,onError:s,parentIndent:r.indent,startOnNewline:!0});if(!h.found)if(h.anchor||h.tag||f)f&&f.type==="block-seq"?s(h.end,"BAD_INDENT","All sequence items must start at the same column"):s(l,"MISSING_CHAR","Sequence item without - indicator");else{c=h.end,h.comment&&(o.comment=h.comment);continue}let m=f?i(t,f,h,s):e(t,h.end,u,null,h,s);t.schema.compat&&Gn(r.indent,f,s),l=m.range[2],o.items.push(m)}return o.range=[r.offset,l,c!=null?c:l],o}var vy=b(()=>{Gr();Qn();lu()});function er(i,e,t,r){let s="";if(i){let n=!1,a="";for(let o of i){let{source:l,type:c}=o;switch(c){case"space":n=!0;break;case"comment":{t&&!n&&r(o,"MISSING_CHAR","Comments must be separated from other tokens by white space characters");let d=l.substring(1)||" ";s?s+=a+d:s=d,a="";break}case"newline":s&&(a+=l),n=!0;break;default:r(o,"UNEXPECTED_TOKEN",`Unexpected ${c} at node end`)}e+=l.length}}return{comment:s,offset:e}}var _i=b(()=>{});function by({composeNode:i,composeEmptyNode:e},t,r,s,n){var g,v;let a=r.start.source==="{",o=a?"flow map":"flow sequence",l=(g=n==null?void 0:n.nodeClass)!=null?g:a?Ce:Ke,c=new l(t.schema);c.flow=!0;let d=t.atRoot;d&&(t.atRoot=!1),t.atKey&&(t.atKey=!1);let u=r.offset+r.start.source.length;for(let w=0;w<r.items.length;++w){let _=r.items[w],{start:E,key:S,sep:D,value:A}=_,C=Jt(E,{flow:o,indicator:"explicit-key-ind",next:S!=null?S:D==null?void 0:D[0],offset:u,onError:s,parentIndent:r.indent,startOnNewline:!1});if(!C.found){if(!C.anchor&&!C.tag&&!D&&!A){w===0&&C.comma?s(C.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${o}`):w<r.items.length-1&&s(C.start,"UNEXPECTED_TOKEN",`Unexpected empty item in ${o}`),C.comment&&(c.comment?c.comment+=`
`+C.comment:c.comment=C.comment),u=C.end;continue}!a&&t.options.strict&&Jr(S)&&s(S,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line")}if(w===0)C.comma&&s(C.comma,"UNEXPECTED_TOKEN",`Unexpected , in ${o}`);else if(C.comma||s(C.start,"MISSING_CHAR",`Missing , between ${o} items`),C.comment){let B="";e:for(let $ of E)switch($.type){case"comma":case"space":break;case"comment":B=$.source.substring(1);break e;default:break e}if(B){let $=c.items[c.items.length-1];Q($)&&($=(v=$.value)!=null?v:$.key),$.comment?$.comment+=`
`+B:$.comment=B,C.comment=C.comment.substring(B.length+1)}}if(!a&&!D&&!C.found){let B=A?i(t,A,C,s):e(t,C.end,D,null,C,s);c.items.push(B),u=B.range[2],uu(A)&&s(B.range,"BLOCK_IN_FLOW",du)}else{t.atKey=!0;let B=C.end,$=S?i(t,S,C,s):e(t,B,E,null,C,s);uu(S)&&s($.range,"BLOCK_IN_FLOW",du),t.atKey=!1;let K=Jt(D!=null?D:[],{flow:o,indicator:"map-value-ind",next:A,offset:$.range[2],onError:s,parentIndent:r.indent,startOnNewline:!1});if(K.found){if(!a&&!C.found&&t.options.strict){if(D)for(let De of D){if(De===K.found)break;if(De.type==="newline"){s(De,"MULTILINE_IMPLICIT_KEY","Implicit keys of flow sequence pairs need to be on a single line");break}}C.start<K.found.offset-1024&&s(K.found,"KEY_OVER_1024_CHARS","The : indicator must be at most 1024 chars after the start of an implicit flow sequence key")}}else A&&("source"in A&&A.source&&A.source[0]===":"?s(A,"MISSING_CHAR",`Missing space after : in ${o}`):s(K.start,"MISSING_CHAR",`Missing , or : between ${o} items`));let Be=A?i(t,A,K,s):K.found?e(t,K.end,D,null,K,s):null;Be?uu(A)&&s(Be.range,"BLOCK_IN_FLOW",du):K.comment&&($.comment?$.comment+=`
`+K.comment:$.comment=K.comment);let mt=new ke($,Be);if(t.options.keepSourceTokens&&(mt.srcToken=_),a){let De=c;dl(t,De.items,$)&&s(B,"DUPLICATE_KEY","Map keys must be unique"),De.items.push(mt)}else{let De=new Ce(t.schema);De.flow=!0,De.items.push(mt);let xe=(Be!=null?Be:$).range;De.range=[$.range[0],xe[1],xe[2]],c.items.push(De)}u=Be?Be.range[2]:K.end}}let f=a?"}":"]",[h,...m]=r.end,p=u;if(h&&h.source===f)p=h.offset+h.source.length;else{let w=o[0].toUpperCase()+o.substring(1),_=d?`${w} must end with a ${f}`:`${w} in block collection must be sufficiently indented and end with a ${f}`;s(u,d?"MISSING_CHAR":"BAD_INDENT",_),h&&h.source.length!==1&&m.unshift(h)}if(m.length>0){let w=er(m,p,t.options.strict,s);w.comment&&(c.comment?c.comment+=`
`+w.comment:c.comment=w.comment),c.range=[r.offset,p,w.offset]}else c.range=[r.offset,p,p];return c}var du,uu,wy=b(()=>{ie();qr();Qr();Gr();_i();Qn();cl();cu();du="Block collections are not allowed within flow collections",uu=i=>i&&(i.type==="block-map"||i.type==="block-seq")});function fu(i,e,t,r,s,n){let a=t.type==="block-map"?my(i,e,t,r,n):t.type==="block-seq"?yy(i,e,t,r,n):by(i,e,t,r,n),o=a.constructor;return s==="!"||s===o.tagName?(a.tag=o.tagName,a):(s&&(a.tag=s),a)}function Ty(i,e,t,r,s){var f,h,m;let n=r.tag,a=n?e.directives.tagName(n.source,p=>s(n,"TAG_RESOLVE_FAILED",p)):null;if(t.type==="block-seq"){let{anchor:p,newlineAfterProp:g}=r,v=p&&n?p.offset>n.offset?p:n:p!=null?p:n;v&&(!g||g.offset<v.offset)&&s(v,"MISSING_CHAR","Missing newline after block sequence props")}let o=t.type==="block-map"?"map":t.type==="block-seq"?"seq":t.start.source==="{"?"map":"seq";if(!n||!a||a==="!"||a===Ce.tagName&&o==="map"||a===Ke.tagName&&o==="seq")return fu(i,e,t,s,a);let l=e.schema.tags.find(p=>p.tag===a&&p.collection===o);if(!l){let p=e.schema.knownTags[a];if(p&&p.collection===o)e.schema.tags.push(Object.assign({},p,{default:!1})),l=p;else return p?s(n,"BAD_COLLECTION_TYPE",`${p.tag} used for ${o} collection, but expects ${(f=p.collection)!=null?f:"scalar"}`,!0):s(n,"TAG_RESOLVE_FAILED",`Unresolved tag: ${a}`,!0),fu(i,e,t,s,a)}let c=fu(i,e,t,s,a,l),d=(m=(h=l.resolve)==null?void 0:h.call(l,c,p=>s(n,"TAG_RESOLVE_FAILED",p),e.options))!=null?m:c,u=X(d)?d:new F(d);return u.range=c.range,u.tag=a,l!=null&&l.format&&(u.format=l.format),u}var Ey=b(()=>{ie();Ie();Qr();Gr();gy();vy();wy()});function hu(i,e,t){let r=e.offset,s=LE(e,i.options.strict,t);if(!s)return{value:"",type:null,comment:"",range:[r,r,r]};let n=s.mode===">"?F.BLOCK_FOLDED:F.BLOCK_LITERAL,a=e.source?FE(e.source):[],o=a.length;for(let p=a.length-1;p>=0;--p){let g=a[p][1];if(g===""||g==="\r")o=p;else break}if(o===0){let p=s.chomp==="+"&&a.length>0?`
`.repeat(Math.max(1,a.length-1)):"",g=r+s.length;return e.source&&(g+=e.source.length),{value:p,type:n,comment:s.comment,range:[r,g,g]}}let l=e.indent+s.indent,c=e.offset+s.length,d=0;for(let p=0;p<o;++p){let[g,v]=a[p];if(v===""||v==="\r")s.indent===0&&g.length>l&&(l=g.length);else{if(g.length<l){let w="Block scalars with more-indented leading empty lines must use an explicit indentation indicator";t(c+g.length,"MISSING_CHAR",w)}s.indent===0&&(l=g.length),d=p,l===0&&!i.atRoot&&t(c,"BAD_INDENT","Block scalar values in collections must be indented");break}c+=g.length+v.length+1}for(let p=a.length-1;p>=o;--p)a[p][0].length>l&&(o=p+1);let u="",f="",h=!1;for(let p=0;p<d;++p)u+=a[p][0].slice(l)+`
`;for(let p=d;p<o;++p){let[g,v]=a[p];c+=g.length+v.length+1;let w=v[v.length-1]==="\r";if(w&&(v=v.slice(0,-1)),v&&g.length<l){let E=`Block scalar lines must not be less indented than their ${s.indent?"explicit indentation indicator":"first line"}`;t(c-v.length-(w?2:1),"BAD_INDENT",E),g=""}n===F.BLOCK_LITERAL?(u+=f+g.slice(l)+v,f=`
`):g.length>l||v[0]==="	"?(f===" "?f=`
`:!h&&f===`
`&&(f=`

`),u+=f+g.slice(l)+v,f=`
`,h=!0):v===""?f===`
`?u+=`
`:f=`
`:(u+=f+v,f=" ",h=!1)}switch(s.chomp){case"-":break;case"+":for(let p=o;p<a.length;++p)u+=`
`+a[p][0].slice(l);u[u.length-1]!==`
`&&(u+=`
`);break;default:u+=`
`}let m=r+s.length+e.source.length;return{value:u,type:n,comment:s.comment,range:[r,m,m]}}function LE({offset:i,props:e},t,r){if(e[0].type!=="block-scalar-header")return r(e[0],"IMPOSSIBLE","Block scalar header not found"),null;let{source:s}=e[0],n=s[0],a=0,o="",l=-1;for(let f=1;f<s.length;++f){let h=s[f];if(!o&&(h==="-"||h==="+"))o=h;else{let m=Number(h);!a&&m?a=m:l===-1&&(l=i+f)}}l!==-1&&r(l,"UNEXPECTED_TOKEN",`Block scalar header includes extra characters: ${s}`);let c=!1,d="",u=s.length;for(let f=1;f<e.length;++f){let h=e[f];switch(h.type){case"space":c=!0;case"newline":u+=h.source.length;break;case"comment":t&&!c&&r(h,"MISSING_CHAR","Comments must be separated from other tokens by white space characters"),u+=h.source.length,d=h.source.substring(1);break;case"error":r(h,"UNEXPECTED_TOKEN",h.message),u+=h.source.length;break;default:{let m=`Unexpected token in block scalar header: ${h.type}`;r(h,"UNEXPECTED_TOKEN",m);let p=h.source;p&&typeof p=="string"&&(u+=p.length)}}}return{mode:n,indent:a,chomp:o,comment:d,length:u}}function FE(i){let e=i.split(/\n( *)/),t=e[0],r=t.match(/^( *)/),n=[r!=null&&r[1]?[r[1],t.slice(r[1].length)]:["",t]];for(let a=1;a<e.length;a+=2)n.push([e[a],e[a+1]]);return n}var pu=b(()=>{Ie()});function mu(i,e,t){let{offset:r,type:s,source:n,end:a}=i,o,l,c=(f,h,m)=>t(r+f,h,m);switch(s){case"scalar":o=F.PLAIN,l=HE(n,c);break;case"single-quoted-scalar":o=F.QUOTE_SINGLE,l=BE(n,c);break;case"double-quoted-scalar":o=F.QUOTE_DOUBLE,l=WE(n,c);break;default:return t(i,"UNEXPECTED_TOKEN",`Expected a flow scalar value, but found: ${s}`),{value:"",type:null,comment:"",range:[r,r+n.length,r+n.length]}}let d=r+n.length,u=er(a,d,e,t);return{value:l,type:o,comment:u.comment,range:[r,d,u.offset]}}function HE(i,e){let t="";switch(i[0]){case"	":t="a tab character";break;case",":t="flow indicator character ,";break;case"%":t="directive indicator character %";break;case"|":case">":{t=`block scalar indicator ${i[0]}`;break}case"@":case"`":{t=`reserved character ${i[0]}`;break}}return t&&e(0,"BAD_SCALAR_START",`Plain value cannot start with ${t}`),ky(i)}function BE(i,e){return(i[i.length-1]!=="'"||i.length===1)&&e(i.length,"MISSING_CHAR","Missing closing 'quote"),ky(i.slice(1,-1)).replace(/''/g,"'")}function ky(i){var l;let e,t;try{e=new RegExp(`(.*?)(?<![ 	])[ 	]*\r?
`,"sy"),t=new RegExp(`[ 	]*(.*?)(?:(?<![ 	])[ 	]*)?\r?
`,"sy")}catch(c){e=/(.*?)[ \t]*\r?\n/sy,t=/[ \t]*(.*?)[ \t]*\r?\n/sy}let r=e.exec(i);if(!r)return i;let s=r[1],n=" ",a=e.lastIndex;for(t.lastIndex=a;r=t.exec(i);)r[1]===""?n===`
`?s+=n:n=`
`:(s+=n+r[1],n=" "),a=t.lastIndex;let o=/[ \t]*(.*)/sy;return o.lastIndex=a,r=o.exec(i),s+n+((l=r==null?void 0:r[1])!=null?l:"")}function WE(i,e){let t="";for(let r=1;r<i.length-1;++r){let s=i[r];if(!(s==="\r"&&i[r+1]===`
`))if(s===`
`){let{fold:n,offset:a}=UE(i,r);t+=n,r=a}else if(s==="\\"){let n=i[++r],a=$E[n];if(a)t+=a;else if(n===`
`)for(n=i[r+1];n===" "||n==="	";)n=i[++r+1];else if(n==="\r"&&i[r+1]===`
`)for(n=i[++r+1];n===" "||n==="	";)n=i[++r+1];else if(n==="x"||n==="u"||n==="U"){let o={x:2,u:4,U:8}[n];t+=VE(i,r+1,o,e),r+=o}else{let o=i.substr(r-1,2);e(r-1,"BAD_DQ_ESCAPE",`Invalid escape sequence ${o}`),t+=o}}else if(s===" "||s==="	"){let n=r,a=i[r+1];for(;a===" "||a==="	";)a=i[++r+1];a!==`
`&&!(a==="\r"&&i[r+2]===`
`)&&(t+=r>n?i.slice(n,r+1):s)}else t+=s}return(i[i.length-1]!=='"'||i.length===1)&&e(i.length,"MISSING_CHAR",'Missing closing "quote'),t}function UE(i,e){let t="",r=i[e+1];for(;(r===" "||r==="	"||r===`
`||r==="\r")&&!(r==="\r"&&i[e+2]!==`
`);)r===`
`&&(t+=`
`),e+=1,r=i[e+1];return t||(t=" "),{fold:t,offset:e}}function VE(i,e,t,r){let s=i.substr(e,t),a=s.length===t&&/^[0-9a-fA-F]+$/.test(s)?parseInt(s,16):NaN;if(isNaN(a)){let o=i.substr(e-2,t+2);return r(e-2,"BAD_DQ_ESCAPE",`Invalid escape sequence ${o}`),o}return String.fromCodePoint(a)}var $E,gu=b(()=>{Ie();_i();$E={0:"\0",a:"\x07",b:"\b",e:"\x1B",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",N:"\x85",_:"\xA0",L:"\u2028",P:"\u2029"," ":" ",'"':'"',"/":"/","\\":"\\","	":"	"}});function yu(i,e,t,r){let{value:s,type:n,comment:a,range:o}=e.type==="block-scalar"?hu(i,e,r):mu(e,i.options.strict,r),l=t?i.directives.tagName(t.source,u=>r(t,"TAG_RESOLVE_FAILED",u)):null,c;i.options.stringKeys&&i.atKey?c=i.schema[ut]:l?c=zE(i.schema,s,l,t,r):e.type==="scalar"?c=jE(i,s,e,r):c=i.schema[ut];let d;try{let u=c.resolve(s,f=>r(t!=null?t:e,"TAG_RESOLVE_FAILED",f),i.options);d=Y(u)?u:new F(u)}catch(u){let f=u instanceof Error?u.message:String(u);r(t!=null?t:e,"TAG_RESOLVE_FAILED",f),d=new F(s)}return d.range=o,d.source=s,n&&(d.type=n),l&&(d.tag=l),c.format&&(d.format=c.format),a&&(d.comment=a),d}function zE(i,e,t,r,s){var o;if(t==="!")return i[ut];let n=[];for(let l of i.tags)if(!l.collection&&l.tag===t)if(l.default&&l.test)n.push(l);else return l;for(let l of n)if((o=l.test)!=null&&o.test(e))return l;let a=i.knownTags[t];return a&&!a.collection?(i.tags.push(Object.assign({},a,{default:!1,test:void 0})),a):(s(r,"TAG_RESOLVE_FAILED",`Unresolved tag: ${t}`,t!=="tag:yaml.org,2002:str"),i[ut])}function jE({atKey:i,directives:e,schema:t},r,s,n){var o;let a=t.tags.find(l=>{var c;return(l.default===!0||i&&l.default==="key")&&((c=l.test)==null?void 0:c.test(r))})||t[ut];if(t.compat){let l=(o=t.compat.find(c=>{var d;return c.default&&((d=c.test)==null?void 0:d.test(r))}))!=null?o:t[ut];if(a.tag!==l.tag){let c=e.tagString(a.tag),d=e.tagString(l.tag),u=`Value may be parsed as either ${c} or ${d}`;n(s,"TAG_RESOLVE_FAILED",u,!0)}}return a}var Dy=b(()=>{ie();Ie();pu();gu()});function Sy(i,e,t){if(e){t!=null||(t=e.length);for(let r=t-1;r>=0;--r){let s=e[r];switch(s.type){case"space":case"comment":case"newline":i-=s.source.length;continue}for(s=e[++r];(s==null?void 0:s.type)==="space";)i+=s.source.length,s=e[++r];break}}return i}var Cy=b(()=>{});function vu(i,e,t,r){let s=i.atKey,{spaceBefore:n,comment:a,anchor:o,tag:l}=t,c,d=!0;switch(e.type){case"alias":c=YE(i,e,r),(o||l)&&r(e,"ALIAS_PROPS","An alias node must not specify any properties");break;case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"block-scalar":c=yu(i,e,l,r),o&&(c.anchor=o.source.substring(1));break;case"block-map":case"block-seq":case"flow-collection":c=Ty(qE,i,e,t,r),o&&(c.anchor=o.source.substring(1));break;default:{let u=e.type==="error"?e.message:`Unsupported token (type: ${e.type})`;r(e,"UNEXPECTED_TOKEN",u),c=ul(i,e.offset,void 0,null,t,r),d=!1}}if(o&&c.anchor===""&&r(o,"BAD_ALIAS","Anchor cannot be an empty string"),s&&i.options.stringKeys&&(!Y(c)||typeof c.value!="string"||c.tag&&c.tag!=="tag:yaml.org,2002:str")){let u="With stringKeys, all keys must be strings";r(l!=null?l:e,"NON_STRING_KEY",u)}return n&&(c.spaceBefore=!0),a&&(e.type==="scalar"&&e.source===""?c.comment=a:c.commentBefore=a),i.options.keepSourceTokens&&d&&(c.srcToken=e),c}function ul(i,e,t,r,{spaceBefore:s,comment:n,anchor:a,tag:o,end:l},c){let d={type:"scalar",offset:Sy(e,t,r),indent:-1,source:""},u=yu(i,d,o,c);return a&&(u.anchor=a.source.substring(1),u.anchor===""&&c(a,"BAD_ALIAS","Anchor cannot be an empty string")),s&&(u.spaceBefore=!0),n&&(u.comment=n,u.range[2]=l),u}function YE({options:i},{offset:e,source:t,end:r},s){let n=new wr(t.substring(1));n.source===""&&s(e,"BAD_ALIAS","Alias cannot be an empty string"),n.source.endsWith(":")&&s(e+t.length-1,"BAD_ALIAS","Alias ending in : is ambiguous",!0);let a=e+t.length,o=er(r,a,i.strict,s);return n.range=[e,a,o.offset],o.comment&&(n.comment=o.comment),n}var qE,_y=b(()=>{xn();ie();Ey();Dy();_i();Cy();qE={composeNode:vu,composeEmptyNode:ul}});function xy(i,e,{offset:t,start:r,value:s,end:n},a){let o=Object.assign({_directives:e},i),l=new Ut(void 0,o),c={atKey:!1,atRoot:!0,directives:l.directives,options:l.options,schema:l.schema},d=Jt(r,{indicator:"doc-start",next:s!=null?s:n==null?void 0:n[0],offset:t,onError:a,parentIndent:0,startOnNewline:!0});d.found&&(l.directives.docStart=!0,s&&(s.type==="block-map"||s.type==="block-seq")&&!d.hasNewline&&a(d.end,"MISSING_CHAR","Block collection cannot start on same line with directives-end marker")),l.contents=s?vu(c,s,d,a):ul(c,d.end,r,null,d,a);let u=l.contents.range[2],f=er(n,u,!1,a);return f.comment&&(l.comment=f.comment),l.range=[t,u,f.offset],l}var My=b(()=>{zn();_y();_i();Qn()});function Kn(i){if(typeof i=="number")return[i,i+1];if(Array.isArray(i))return i.length===2?i:[i[0],i[1]];let{offset:e,source:t}=i;return[e,e+(typeof t=="string"?t.length:1)]}function Ay(i){var s;let e="",t=!1,r=!1;for(let n=0;n<i.length;++n){let a=i[n];switch(a[0]){case"#":e+=(e===""?"":r?`

`:`
`)+(a.substring(1)||" "),t=!0,r=!1;break;case"%":((s=i[n+1])==null?void 0:s[0])!=="#"&&(n+=1),t=!1;break;default:t||(r=!0),t=!1}}return{comment:e,afterEmptyLine:r}}var Zn,bu=b(()=>{Rd();zn();Yn();ie();My();_i();Zn=class{constructor(e={}){this.doc=null,this.atDirectives=!1,this.prelude=[],this.errors=[],this.warnings=[],this.onError=(t,r,s,n)=>{let a=Kn(t);n?this.warnings.push(new qn(a,r,s)):this.errors.push(new $t(a,r,s))},this.directives=new Ne({version:e.version||"1.2"}),this.options=e}decorate(e,t){let{comment:r,afterEmptyLine:s}=Ay(this.prelude);if(r){let n=e.contents;if(t)e.comment=e.comment?`${e.comment}
${r}`:r;else if(s||e.directives.docStart||!n)e.commentBefore=r;else if(he(n)&&!n.flow&&n.items.length>0){let a=n.items[0];Q(a)&&(a=a.key);let o=a.commentBefore;a.commentBefore=o?`${r}
${o}`:r}else{let a=n.commentBefore;n.commentBefore=a?`${r}
${a}`:r}}t?(Array.prototype.push.apply(e.errors,this.errors),Array.prototype.push.apply(e.warnings,this.warnings)):(e.errors=this.errors,e.warnings=this.warnings),this.prelude=[],this.errors=[],this.warnings=[]}streamInfo(){return{comment:Ay(this.prelude).comment,directives:this.directives,errors:this.errors,warnings:this.warnings}}*compose(e,t=!1,r=-1){for(let s of e)yield*this.next(s);yield*this.end(t,r)}*next(e){switch(e.type){case"directive":this.directives.add(e.source,(t,r,s)=>{let n=Kn(e);n[0]+=t,this.onError(n,"BAD_DIRECTIVE",r,s)}),this.prelude.push(e.source),this.atDirectives=!0;break;case"document":{let t=xy(this.options,this.directives,e,this.onError);this.atDirectives&&!t.directives.docStart&&this.onError(e,"MISSING_CHAR","Missing directives-end/doc-start indicator line"),this.decorate(t,!1),this.doc&&(yield this.doc),this.doc=t,this.atDirectives=!1;break}case"byte-order-mark":case"space":break;case"comment":case"newline":this.prelude.push(e.source);break;case"error":{let t=e.source?`${e.message}: ${JSON.stringify(e.source)}`:e.message,r=new $t(Kn(e),"UNEXPECTED_TOKEN",t);this.atDirectives||!this.doc?this.errors.push(r):this.doc.errors.push(r);break}case"doc-end":{if(!this.doc){let r="Unexpected doc-end without preceding document";this.errors.push(new $t(Kn(e),"UNEXPECTED_TOKEN",r));break}this.doc.directives.docEnd=!0;let t=er(e.end,e.offset+e.source.length,this.doc.options.strict,this.onError);if(this.decorate(this.doc,!0),t.comment){let r=this.doc.comment;this.doc.comment=r?`${r}
${t.comment}`:t.comment}this.doc.range[2]=t.offset;break}default:this.errors.push(new $t(Kn(e),"UNEXPECTED_TOKEN",`Unsupported token ${e.type}`))}}*end(e=!1,t=-1){if(this.doc)this.decorate(this.doc,!0),yield this.doc,this.doc=null;else if(e){let r=Object.assign({_directives:this.directives},this.options),s=new Ut(void 0,r);this.atDirectives&&this.onError(t,"MISSING_CHAR","Missing directives-end indicator line"),s.range=[0,t,t],this.decorate(s,!1),yield s}}}});var Iy=b(()=>{pu();gu();Yn();On()});var Py=b(()=>{});function Ns(i,e){"type"in i&&i.type==="document"&&(i={start:i.start,value:i.value}),Ny(Object.freeze([]),i,e)}function Ny(i,e,t){let r=t(e,i);if(typeof r=="symbol")return r;for(let s of["key","value"]){let n=e[s];if(n&&"items"in n){for(let a=0;a<n.items.length;++a){let o=Ny(Object.freeze(i.concat([[s,a]])),n.items[a],t);if(typeof o=="number")a=o-1;else{if(o===wu)return wu;o===Ry&&(n.items.splice(a,1),a-=1)}}typeof r=="function"&&s==="key"&&(r=r(e,i))}}return typeof r=="function"?r(e,i):r}var wu,QE,Ry,Oy=b(()=>{wu=Symbol("break visit"),QE=Symbol("skip children"),Ry=Symbol("remove item");Ns.BREAK=wu;Ns.SKIP=QE;Ns.REMOVE=Ry;Ns.itemAtPath=(i,e)=>{let t=i;for(let[r,s]of e){let n=t==null?void 0:t[r];if(n&&"items"in n)t=n.items[s];else return}return t};Ns.parentCollection=(i,e)=>{let t=Ns.itemAtPath(i,e.slice(0,-1)),r=e[e.length-1][0],s=t==null?void 0:t[r];if(s&&"items"in s)return s;throw new Error("Parent collection not found")}});function Ly(i){switch(i){case Tu:return"byte-order-mark";case Eu:return"doc-mode";case ku:return"flow-error-end";case fl:return"scalar";case"---":return"doc-start";case"...":return"doc-end";case"":case`
`:case`\r
`:return"newline";case"-":return"seq-item-ind";case"?":return"explicit-key-ind";case":":return"map-value-ind";case"{":return"flow-map-start";case"}":return"flow-map-end";case"[":return"flow-seq-start";case"]":return"flow-seq-end";case",":return"comma"}switch(i[0]){case" ":case"	":return"space";case"#":return"comment";case"%":return"directive-line";case"*":return"alias";case"&":return"anchor";case"!":return"tag";case"'":return"single-quoted-scalar";case'"':return"double-quoted-scalar";case"|":case">":return"block-scalar-header"}return null}var Tu,Eu,ku,fl,hl=b(()=>{Iy();Py();Oy();Tu="\uFEFF",Eu="",ku="",fl=""});function Vt(i){switch(i){case void 0:case" ":case`
`:case"\r":case"	":return!0;default:return!1}}var Fy,KE,pl,ZE,Du,Xn,Su=b(()=>{hl();Fy=new Set("0123456789ABCDEFabcdef"),KE=new Set("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-#;/?:@&=+$_.!~*'()"),pl=new Set(",[]{}"),ZE=new Set(` ,[]{}
\r	`),Du=i=>!i||ZE.has(i),Xn=class{constructor(){this.atEnd=!1,this.blockScalarIndent=-1,this.blockScalarKeep=!1,this.buffer="",this.flowKey=!1,this.flowLevel=0,this.indentNext=0,this.indentValue=0,this.lineEndPos=null,this.next=null,this.pos=0}*lex(e,t=!1){var s;if(e){if(typeof e!="string")throw TypeError("source is not a string");this.buffer=this.buffer?this.buffer+e:e,this.lineEndPos=null}this.atEnd=!t;let r=(s=this.next)!=null?s:"stream";for(;r&&(t||this.hasChars(1));)r=yield*this.parseNext(r)}atLineEnd(){let e=this.pos,t=this.buffer[e];for(;t===" "||t==="	";)t=this.buffer[++e];return!t||t==="#"||t===`
`?!0:t==="\r"?this.buffer[e+1]===`
`:!1}charAt(e){return this.buffer[this.pos+e]}continueScalar(e){let t=this.buffer[e];if(this.indentNext>0){let r=0;for(;t===" ";)t=this.buffer[++r+e];if(t==="\r"){let s=this.buffer[r+e+1];if(s===`
`||!s&&!this.atEnd)return e+r+1}return t===`
`||r>=this.indentNext||!t&&!this.atEnd?e+r:-1}if(t==="-"||t==="."){let r=this.buffer.substr(e,3);if((r==="---"||r==="...")&&Vt(this.buffer[e+3]))return-1}return e}getLine(){let e=this.lineEndPos;return(typeof e!="number"||e!==-1&&e<this.pos)&&(e=this.buffer.indexOf(`
`,this.pos),this.lineEndPos=e),e===-1?this.atEnd?this.buffer.substring(this.pos):null:(this.buffer[e-1]==="\r"&&(e-=1),this.buffer.substring(this.pos,e))}hasChars(e){return this.pos+e<=this.buffer.length}setNext(e){return this.buffer=this.buffer.substring(this.pos),this.pos=0,this.lineEndPos=null,this.next=e,null}peek(e){return this.buffer.substr(this.pos,e)}*parseNext(e){switch(e){case"stream":return yield*this.parseStream();case"line-start":return yield*this.parseLineStart();case"block-start":return yield*this.parseBlockStart();case"doc":return yield*this.parseDocument();case"flow":return yield*this.parseFlowCollection();case"quoted-scalar":return yield*this.parseQuotedScalar();case"block-scalar":return yield*this.parseBlockScalar();case"plain-scalar":return yield*this.parsePlainScalar()}}*parseStream(){let e=this.getLine();if(e===null)return this.setNext("stream");if(e[0]===Tu&&(yield*this.pushCount(1),e=e.substring(1)),e[0]==="%"){let t=e.length,r=e.indexOf("#");for(;r!==-1;){let n=e[r-1];if(n===" "||n==="	"){t=r-1;break}else r=e.indexOf("#",r+1)}for(;;){let n=e[t-1];if(n===" "||n==="	")t-=1;else break}let s=(yield*this.pushCount(t))+(yield*this.pushSpaces(!0));return yield*this.pushCount(e.length-s),this.pushNewline(),"stream"}if(this.atLineEnd()){let t=yield*this.pushSpaces(!0);return yield*this.pushCount(e.length-t),yield*this.pushNewline(),"stream"}return yield Eu,yield*this.parseLineStart()}*parseLineStart(){let e=this.charAt(0);if(!e&&!this.atEnd)return this.setNext("line-start");if(e==="-"||e==="."){if(!this.atEnd&&!this.hasChars(4))return this.setNext("line-start");let t=this.peek(3);if((t==="---"||t==="...")&&Vt(this.charAt(3)))return yield*this.pushCount(3),this.indentValue=0,this.indentNext=0,t==="---"?"doc":"stream"}return this.indentValue=yield*this.pushSpaces(!1),this.indentNext>this.indentValue&&!Vt(this.charAt(1))&&(this.indentNext=this.indentValue),yield*this.parseBlockStart()}*parseBlockStart(){let[e,t]=this.peek(2);if(!t&&!this.atEnd)return this.setNext("block-start");if((e==="-"||e==="?"||e===":")&&Vt(t)){let r=(yield*this.pushCount(1))+(yield*this.pushSpaces(!0));return this.indentNext=this.indentValue+1,this.indentValue+=r,yield*this.parseBlockStart()}return"doc"}*parseDocument(){yield*this.pushSpaces(!0);let e=this.getLine();if(e===null)return this.setNext("doc");let t=yield*this.pushIndicators();switch(e[t]){case"#":yield*this.pushCount(e.length-t);case void 0:return yield*this.pushNewline(),yield*this.parseLineStart();case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel=1,"flow";case"}":case"]":return yield*this.pushCount(1),"doc";case"*":return yield*this.pushUntil(Du),"doc";case'"':case"'":return yield*this.parseQuotedScalar();case"|":case">":return t+=yield*this.parseBlockScalarHeader(),t+=yield*this.pushSpaces(!0),yield*this.pushCount(e.length-t),yield*this.pushNewline(),yield*this.parseBlockScalar();default:return yield*this.parsePlainScalar()}}*parseFlowCollection(){let e,t,r=-1;do e=yield*this.pushNewline(),e>0?(t=yield*this.pushSpaces(!1),this.indentValue=r=t):t=0,t+=yield*this.pushSpaces(!0);while(e+t>0);let s=this.getLine();if(s===null)return this.setNext("flow");if((r!==-1&&r<this.indentNext&&s[0]!=="#"||r===0&&(s.startsWith("---")||s.startsWith("..."))&&Vt(s[3]))&&!(r===this.indentNext-1&&this.flowLevel===1&&(s[0]==="]"||s[0]==="}")))return this.flowLevel=0,yield ku,yield*this.parseLineStart();let n=0;for(;s[n]===",";)n+=yield*this.pushCount(1),n+=yield*this.pushSpaces(!0),this.flowKey=!1;switch(n+=yield*this.pushIndicators(),s[n]){case void 0:return"flow";case"#":return yield*this.pushCount(s.length-n),"flow";case"{":case"[":return yield*this.pushCount(1),this.flowKey=!1,this.flowLevel+=1,"flow";case"}":case"]":return yield*this.pushCount(1),this.flowKey=!0,this.flowLevel-=1,this.flowLevel?"flow":"doc";case"*":return yield*this.pushUntil(Du),"flow";case'"':case"'":return this.flowKey=!0,yield*this.parseQuotedScalar();case":":{let a=this.charAt(1);if(this.flowKey||Vt(a)||a===",")return this.flowKey=!1,yield*this.pushCount(1),yield*this.pushSpaces(!0),"flow"}default:return this.flowKey=!1,yield*this.parsePlainScalar()}}*parseQuotedScalar(){let e=this.charAt(0),t=this.buffer.indexOf(e,this.pos+1);if(e==="'")for(;t!==-1&&this.buffer[t+1]==="'";)t=this.buffer.indexOf("'",t+2);else for(;t!==-1;){let n=0;for(;this.buffer[t-1-n]==="\\";)n+=1;if(n%2===0)break;t=this.buffer.indexOf('"',t+1)}let r=this.buffer.substring(0,t),s=r.indexOf(`
`,this.pos);if(s!==-1){for(;s!==-1;){let n=this.continueScalar(s+1);if(n===-1)break;s=r.indexOf(`
`,n)}s!==-1&&(t=s-(r[s-1]==="\r"?2:1))}if(t===-1){if(!this.atEnd)return this.setNext("quoted-scalar");t=this.buffer.length}return yield*this.pushToIndex(t+1,!1),this.flowLevel?"flow":"doc"}*parseBlockScalarHeader(){this.blockScalarIndent=-1,this.blockScalarKeep=!1;let e=this.pos;for(;;){let t=this.buffer[++e];if(t==="+")this.blockScalarKeep=!0;else if(t>"0"&&t<="9")this.blockScalarIndent=Number(t)-1;else if(t!=="-")break}return yield*this.pushUntil(t=>Vt(t)||t==="#")}*parseBlockScalar(){let e=this.pos-1,t=0,r;e:for(let n=this.pos;r=this.buffer[n];++n)switch(r){case" ":t+=1;break;case`
`:e=n,t=0;break;case"\r":{let a=this.buffer[n+1];if(!a&&!this.atEnd)return this.setNext("block-scalar");if(a===`
`)break}default:break e}if(!r&&!this.atEnd)return this.setNext("block-scalar");if(t>=this.indentNext){this.blockScalarIndent===-1?this.indentNext=t:this.indentNext=this.blockScalarIndent+(this.indentNext===0?1:this.indentNext);do{let n=this.continueScalar(e+1);if(n===-1)break;e=this.buffer.indexOf(`
`,n)}while(e!==-1);if(e===-1){if(!this.atEnd)return this.setNext("block-scalar");e=this.buffer.length}}let s=e+1;for(r=this.buffer[s];r===" ";)r=this.buffer[++s];if(r==="	"){for(;r==="	"||r===" "||r==="\r"||r===`
`;)r=this.buffer[++s];e=s-1}else if(!this.blockScalarKeep)do{let n=e-1,a=this.buffer[n];a==="\r"&&(a=this.buffer[--n]);let o=n;for(;a===" ";)a=this.buffer[--n];if(a===`
`&&n>=this.pos&&n+1+t>o)e=n;else break}while(!0);return yield fl,yield*this.pushToIndex(e+1,!0),yield*this.parseLineStart()}*parsePlainScalar(){let e=this.flowLevel>0,t=this.pos-1,r=this.pos-1,s;for(;s=this.buffer[++r];)if(s===":"){let n=this.buffer[r+1];if(Vt(n)||e&&pl.has(n))break;t=r}else if(Vt(s)){let n=this.buffer[r+1];if(s==="\r"&&(n===`
`?(r+=1,s=`
`,n=this.buffer[r+1]):t=r),n==="#"||e&&pl.has(n))break;if(s===`
`){let a=this.continueScalar(r+1);if(a===-1)break;r=Math.max(r,a-2)}}else{if(e&&pl.has(s))break;t=r}return!s&&!this.atEnd?this.setNext("plain-scalar"):(yield fl,yield*this.pushToIndex(t+1,!0),e?"flow":"doc")}*pushCount(e){return e>0?(yield this.buffer.substr(this.pos,e),this.pos+=e,e):0}*pushToIndex(e,t){let r=this.buffer.slice(this.pos,e);return r?(yield r,this.pos+=r.length,r.length):(t&&(yield""),0)}*pushIndicators(){switch(this.charAt(0)){case"!":return(yield*this.pushTag())+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"&":return(yield*this.pushUntil(Du))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators());case"-":case"?":case":":{let e=this.flowLevel>0,t=this.charAt(1);if(Vt(t)||e&&pl.has(t))return e?this.flowKey&&(this.flowKey=!1):this.indentNext=this.indentValue+1,(yield*this.pushCount(1))+(yield*this.pushSpaces(!0))+(yield*this.pushIndicators())}}return 0}*pushTag(){if(this.charAt(1)==="<"){let e=this.pos+2,t=this.buffer[e];for(;!Vt(t)&&t!==">";)t=this.buffer[++e];return yield*this.pushToIndex(t===">"?e+1:e,!1)}else{let e=this.pos+1,t=this.buffer[e];for(;t;)if(KE.has(t))t=this.buffer[++e];else if(t==="%"&&Fy.has(this.buffer[e+1])&&Fy.has(this.buffer[e+2]))t=this.buffer[e+=3];else break;return yield*this.pushToIndex(e,!1)}}*pushNewline(){let e=this.buffer[this.pos];return e===`
`?yield*this.pushCount(1):e==="\r"&&this.charAt(1)===`
`?yield*this.pushCount(2):0}*pushSpaces(e){let t=this.pos-1,r;do r=this.buffer[++t];while(r===" "||e&&r==="	");let s=t-this.pos;return s>0&&(yield this.buffer.substr(this.pos,s),this.pos=t),s}*pushUntil(e){let t=this.pos,r=this.buffer[t];for(;!e(r);)r=this.buffer[++t];return yield*this.pushToIndex(t,!1)}}});var Jn,Cu=b(()=>{Jn=class{constructor(){this.lineStarts=[],this.addNewLine=e=>this.lineStarts.push(e),this.linePos=e=>{let t=0,r=this.lineStarts.length;for(;t<r;){let n=t+r>>1;this.lineStarts[n]<e?t=n+1:r=n}if(this.lineStarts[t]===e)return{line:t+1,col:1};if(t===0)return{line:0,col:e};let s=this.lineStarts[t-1];return{line:t,col:e-s+1}}}}});function es(i,e){for(let t=0;t<i.length;++t)if(i[t].type===e)return!0;return!1}function Hy(i){for(let e=0;e<i.length;++e)switch(i[e].type){case"space":case"comment":case"newline":break;default:return e}return-1}function Wy(i){switch(i==null?void 0:i.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":case"flow-collection":return!0;default:return!1}}function ml(i){var e;switch(i.type){case"document":return i.start;case"block-map":{let t=i.items[i.items.length-1];return(e=t.sep)!=null?e:t.start}case"block-seq":return i.items[i.items.length-1].start;default:return[]}}function xi(i){var t;if(i.length===0)return[];let e=i.length;e:for(;--e>=0;)switch(i[e].type){case"doc-start":case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":case"newline":break e}for(;((t=i[++e])==null?void 0:t.type)==="space";);return i.splice(e,i.length)}function By(i){if(i.start.type==="flow-seq-start")for(let e of i.items)e.sep&&!e.value&&!es(e.start,"explicit-key-ind")&&!es(e.sep,"map-value-ind")&&(e.key&&(e.value=e.key),delete e.key,Wy(e.value)?e.value.end?Array.prototype.push.apply(e.value.end,e.sep):e.value.end=e.sep:Array.prototype.push.apply(e.start,e.sep),delete e.sep)}var ea,_u=b(()=>{hl();Su();ea=class{constructor(e){this.atNewLine=!0,this.atScalar=!1,this.indent=0,this.offset=0,this.onKeyLine=!1,this.stack=[],this.source="",this.type="",this.lexer=new Xn,this.onNewLine=e}*parse(e,t=!1){this.onNewLine&&this.offset===0&&this.onNewLine(0);for(let r of this.lexer.lex(e,t))yield*this.next(r);t||(yield*this.end())}*next(e){if(this.source=e,this.atScalar){this.atScalar=!1,yield*this.step(),this.offset+=e.length;return}let t=Ly(e);if(t)if(t==="scalar")this.atNewLine=!1,this.atScalar=!0,this.type="scalar";else{switch(this.type=t,yield*this.step(),t){case"newline":this.atNewLine=!0,this.indent=0,this.onNewLine&&this.onNewLine(this.offset+e.length);break;case"space":this.atNewLine&&e[0]===" "&&(this.indent+=e.length);break;case"explicit-key-ind":case"map-value-ind":case"seq-item-ind":this.atNewLine&&(this.indent+=e.length);break;case"doc-mode":case"flow-error-end":return;default:this.atNewLine=!1}this.offset+=e.length}else{let r=`Not a YAML token: ${e}`;yield*this.pop({type:"error",offset:this.offset,message:r,source:e}),this.offset+=e.length}}*end(){for(;this.stack.length>0;)yield*this.pop()}get sourceToken(){return{type:this.type,offset:this.offset,indent:this.indent,source:this.source}}*step(){let e=this.peek(1);if(this.type==="doc-end"&&(!e||e.type!=="doc-end")){for(;this.stack.length>0;)yield*this.pop();this.stack.push({type:"doc-end",offset:this.offset,source:this.source});return}if(!e)return yield*this.stream();switch(e.type){case"document":return yield*this.document(e);case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return yield*this.scalar(e);case"block-scalar":return yield*this.blockScalar(e);case"block-map":return yield*this.blockMap(e);case"block-seq":return yield*this.blockSequence(e);case"flow-collection":return yield*this.flowCollection(e);case"doc-end":return yield*this.documentEnd(e)}yield*this.pop()}peek(e){return this.stack[this.stack.length-e]}*pop(e){let t=e!=null?e:this.stack.pop();if(t)if(this.stack.length===0)yield t;else{let r=this.peek(1);switch(t.type==="block-scalar"?t.indent="indent"in r?r.indent:0:t.type==="flow-collection"&&r.type==="document"&&(t.indent=0),t.type==="flow-collection"&&By(t),r.type){case"document":r.value=t;break;case"block-scalar":r.props.push(t);break;case"block-map":{let s=r.items[r.items.length-1];if(s.value){r.items.push({start:[],key:t,sep:[]}),this.onKeyLine=!0;return}else if(s.sep)s.value=t;else{Object.assign(s,{key:t,sep:[]}),this.onKeyLine=!s.explicitKey;return}break}case"block-seq":{let s=r.items[r.items.length-1];s.value?r.items.push({start:[],value:t}):s.value=t;break}case"flow-collection":{let s=r.items[r.items.length-1];!s||s.value?r.items.push({start:[],key:t,sep:[]}):s.sep?s.value=t:Object.assign(s,{key:t,sep:[]});return}default:yield*this.pop(),yield*this.pop(t)}if((r.type==="document"||r.type==="block-map"||r.type==="block-seq")&&(t.type==="block-map"||t.type==="block-seq")){let s=t.items[t.items.length-1];s&&!s.sep&&!s.value&&s.start.length>0&&Hy(s.start)===-1&&(t.indent===0||s.start.every(n=>n.type!=="comment"||n.indent<t.indent))&&(r.type==="document"?r.end=s.start:r.items.push({start:s.start}),t.items.splice(-1,1))}}else{let r="Tried to pop an empty stack";yield{type:"error",offset:this.offset,source:"",message:r}}}*stream(){switch(this.type){case"directive-line":yield{type:"directive",offset:this.offset,source:this.source};return;case"byte-order-mark":case"space":case"comment":case"newline":yield this.sourceToken;return;case"doc-mode":case"doc-start":{let e={type:"document",offset:this.offset,start:[]};this.type==="doc-start"&&e.start.push(this.sourceToken),this.stack.push(e);return}}yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML stream`,source:this.source}}*document(e){if(e.value)return yield*this.lineEnd(e);switch(this.type){case"doc-start":{Hy(e.start)!==-1?(yield*this.pop(),yield*this.step()):e.start.push(this.sourceToken);return}case"anchor":case"tag":case"space":case"comment":case"newline":e.start.push(this.sourceToken);return}let t=this.startBlockValue(e);t?this.stack.push(t):yield{type:"error",offset:this.offset,message:`Unexpected ${this.type} token in YAML document`,source:this.source}}*scalar(e){if(this.type==="map-value-ind"){let t=ml(this.peek(2)),r=xi(t),s;e.end?(s=e.end,s.push(this.sourceToken),delete e.end):s=[this.sourceToken];let n={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:r,key:e,sep:s}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=n}else yield*this.lineEnd(e)}*blockScalar(e){switch(this.type){case"space":case"comment":case"newline":e.props.push(this.sourceToken);return;case"scalar":if(e.source=this.source,this.atNewLine=!0,this.indent=0,this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}yield*this.pop();break;default:yield*this.pop(),yield*this.step()}}*blockMap(e){var r;let t=e.items[e.items.length-1];switch(this.type){case"newline":if(this.onKeyLine=!1,t.value){let s="end"in t.value?t.value.end:void 0,n=Array.isArray(s)?s[s.length-1]:void 0;(n==null?void 0:n.type)==="comment"?s==null||s.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else if(t.sep)t.sep.push(this.sourceToken);else{if(this.atIndentedComment(t.start,e.indent)){let s=e.items[e.items.length-2],n=(r=s==null?void 0:s.value)==null?void 0:r.end;if(Array.isArray(n)){Array.prototype.push.apply(n,t.start),n.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return}if(this.indent>=e.indent){let s=!this.onKeyLine&&this.indent===e.indent,n=s&&(t.sep||t.explicitKey)&&this.type!=="seq-item-ind",a=[];if(n&&t.sep&&!t.value){let o=[];for(let l=0;l<t.sep.length;++l){let c=t.sep[l];switch(c.type){case"newline":o.push(l);break;case"space":break;case"comment":c.indent>e.indent&&(o.length=0);break;default:o.length=0}}o.length>=2&&(a=t.sep.splice(o[1]))}switch(this.type){case"anchor":case"tag":n||t.value?(a.push(this.sourceToken),e.items.push({start:a}),this.onKeyLine=!0):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"explicit-key-ind":!t.sep&&!t.explicitKey?(t.start.push(this.sourceToken),t.explicitKey=!0):n||t.value?(a.push(this.sourceToken),e.items.push({start:a,explicitKey:!0})):this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken],explicitKey:!0}]}),this.onKeyLine=!0;return;case"map-value-ind":if(t.explicitKey)if(t.sep)if(t.value)e.items.push({start:[],key:null,sep:[this.sourceToken]});else if(es(t.sep,"map-value-ind"))this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:a,key:null,sep:[this.sourceToken]}]});else if(Wy(t.key)&&!es(t.sep,"newline")){let o=xi(t.start),l=t.key,c=t.sep;c.push(this.sourceToken),delete t.key,delete t.sep,this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:l,sep:c}]})}else a.length>0?t.sep=t.sep.concat(a,this.sourceToken):t.sep.push(this.sourceToken);else if(es(t.start,"newline"))Object.assign(t,{key:null,sep:[this.sourceToken]});else{let o=xi(t.start);this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:o,key:null,sep:[this.sourceToken]}]})}else t.sep?t.value||n?e.items.push({start:a,key:null,sep:[this.sourceToken]}):es(t.sep,"map-value-ind")?this.stack.push({type:"block-map",offset:this.offset,indent:this.indent,items:[{start:[],key:null,sep:[this.sourceToken]}]}):t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});this.onKeyLine=!0;return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let o=this.flowScalar(this.type);n||t.value?(e.items.push({start:a,key:o,sep:[]}),this.onKeyLine=!0):t.sep?this.stack.push(o):(Object.assign(t,{key:o,sep:[]}),this.onKeyLine=!0);return}default:{let o=this.startBlockValue(e);if(o){if(o.type==="block-seq"){if(!t.explicitKey&&t.sep&&!es(t.sep,"newline")){yield*this.pop({type:"error",offset:this.offset,message:"Unexpected block-seq-ind on same line with key",source:this.source});return}}else s&&e.items.push({start:a});this.stack.push(o);return}}}}yield*this.pop(),yield*this.step()}*blockSequence(e){var r;let t=e.items[e.items.length-1];switch(this.type){case"newline":if(t.value){let s="end"in t.value?t.value.end:void 0,n=Array.isArray(s)?s[s.length-1]:void 0;(n==null?void 0:n.type)==="comment"?s==null||s.push(this.sourceToken):e.items.push({start:[this.sourceToken]})}else t.start.push(this.sourceToken);return;case"space":case"comment":if(t.value)e.items.push({start:[this.sourceToken]});else{if(this.atIndentedComment(t.start,e.indent)){let s=e.items[e.items.length-2],n=(r=s==null?void 0:s.value)==null?void 0:r.end;if(Array.isArray(n)){Array.prototype.push.apply(n,t.start),n.push(this.sourceToken),e.items.pop();return}}t.start.push(this.sourceToken)}return;case"anchor":case"tag":if(t.value||this.indent<=e.indent)break;t.start.push(this.sourceToken);return;case"seq-item-ind":if(this.indent!==e.indent)break;t.value||es(t.start,"seq-item-ind")?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return}if(this.indent>e.indent){let s=this.startBlockValue(e);if(s){this.stack.push(s);return}}yield*this.pop(),yield*this.step()}*flowCollection(e){let t=e.items[e.items.length-1];if(this.type==="flow-error-end"){let r;do yield*this.pop(),r=this.peek(1);while(r&&r.type==="flow-collection")}else if(e.end.length===0){switch(this.type){case"comma":case"explicit-key-ind":!t||t.sep?e.items.push({start:[this.sourceToken]}):t.start.push(this.sourceToken);return;case"map-value-ind":!t||t.value?e.items.push({start:[],key:null,sep:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):Object.assign(t,{key:null,sep:[this.sourceToken]});return;case"space":case"comment":case"newline":case"anchor":case"tag":!t||t.value?e.items.push({start:[this.sourceToken]}):t.sep?t.sep.push(this.sourceToken):t.start.push(this.sourceToken);return;case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":{let s=this.flowScalar(this.type);!t||t.value?e.items.push({start:[],key:s,sep:[]}):t.sep?this.stack.push(s):Object.assign(t,{key:s,sep:[]});return}case"flow-map-end":case"flow-seq-end":e.end.push(this.sourceToken);return}let r=this.startBlockValue(e);r?this.stack.push(r):(yield*this.pop(),yield*this.step())}else{let r=this.peek(2);if(r.type==="block-map"&&(this.type==="map-value-ind"&&r.indent===e.indent||this.type==="newline"&&!r.items[r.items.length-1].sep))yield*this.pop(),yield*this.step();else if(this.type==="map-value-ind"&&r.type!=="flow-collection"){let s=ml(r),n=xi(s);By(e);let a=e.end.splice(1,e.end.length);a.push(this.sourceToken);let o={type:"block-map",offset:e.offset,indent:e.indent,items:[{start:n,key:e,sep:a}]};this.onKeyLine=!0,this.stack[this.stack.length-1]=o}else yield*this.lineEnd(e)}}flowScalar(e){if(this.onNewLine){let t=this.source.indexOf(`
`)+1;for(;t!==0;)this.onNewLine(this.offset+t),t=this.source.indexOf(`
`,t)+1}return{type:e,offset:this.offset,indent:this.indent,source:this.source}}startBlockValue(e){switch(this.type){case"alias":case"scalar":case"single-quoted-scalar":case"double-quoted-scalar":return this.flowScalar(this.type);case"block-scalar-header":return{type:"block-scalar",offset:this.offset,indent:this.indent,props:[this.sourceToken],source:""};case"flow-map-start":case"flow-seq-start":return{type:"flow-collection",offset:this.offset,indent:this.indent,start:this.sourceToken,items:[],end:[]};case"seq-item-ind":return{type:"block-seq",offset:this.offset,indent:this.indent,items:[{start:[this.sourceToken]}]};case"explicit-key-ind":{this.onKeyLine=!0;let t=ml(e),r=xi(t);return r.push(this.sourceToken),{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,explicitKey:!0}]}}case"map-value-ind":{this.onKeyLine=!0;let t=ml(e),r=xi(t);return{type:"block-map",offset:this.offset,indent:this.indent,items:[{start:r,key:null,sep:[this.sourceToken]}]}}}return null}atIndentedComment(e,t){return this.type!=="comment"||this.indent<=t?!1:e.every(r=>r.type==="newline"||r.type==="space")}*documentEnd(e){this.type!=="doc-mode"&&(e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop()))}*lineEnd(e){switch(this.type){case"comma":case"doc-start":case"doc-end":case"flow-seq-end":case"flow-map-end":case"map-value-ind":yield*this.pop(),yield*this.step();break;case"newline":this.onKeyLine=!1;case"space":case"comment":default:e.end?e.end.push(this.sourceToken):e.end=[this.sourceToken],this.type==="newline"&&(yield*this.pop())}}}});function XE(i){let e=i.prettyErrors!==!1;return{lineCounter:i.lineCounter||e&&new Jn||null,prettyErrors:e}}function Uy(i,e={}){let{lineCounter:t,prettyErrors:r}=XE(e),s=new ea(t==null?void 0:t.addNewLine),n=new Zn(e),a=null;for(let o of n.compose(s.parse(i),!0,i.length))if(!a)a=o;else if(a.options.logLevel!=="silent"){a.errors.push(new $t(o.range.slice(0,2),"MULTIPLE_DOCS","Source contains multiple documents; please use YAML.parseAllDocuments()"));break}return r&&t&&(a.errors.forEach(ou(i,t)),a.warnings.forEach(ou(i,t))),a}function Mi(i,e,t){let r;typeof e=="function"?r=e:t===void 0&&e&&typeof e=="object"&&(t=e);let s=Uy(i,t);if(!s)return null;if(s.warnings.forEach(n=>$o(s.options.logLevel,n)),s.errors.length>0){if(s.options.logLevel!=="silent")throw s.errors[0];s.errors=[]}return s.toJS(Object.assign({reviver:r},t))}function ta(i,e,t){var s;let r=null;if(typeof e=="function"||Array.isArray(e)?r=e:t===void 0&&e&&(t=e),typeof t=="string"&&(t=t.length),typeof t=="number"){let n=Math.round(t);t=n<1?void 0:n>8?{indent:8}:{indent:n}}if(i===void 0){let{keepUndefined:n}=(s=t!=null?t:e)!=null?s:{};if(!n)return}return Ot(i)&&!r?i.toString(t):new Ut(i,r,t).toString(t)}var $y=b(()=>{bu();zn();Yn();Wd();ie();Cu();_u()});var xu=b(()=>{bu();zn();au();Yn();xn();ie();qr();Ie();Qr();Gr();hl();Su();Cu();_u();$y();_n()});var ra=b(()=>{xu();xu()});var st,yl=b(()=>{ra();st=class{static parse(e,t){this.cleanupCache();let r=Date.now(),s=this.cache.get(t);if(s&&r-s.timestamp<this.CACHE_TTL)return s.data;try{let n=Mi(e);return this.cache.set(t,{data:n,timestamp:r}),n}catch(n){return console.error("Error parsing YAML content:",n),null}}static extractFrontmatter(e,t){if(!e.startsWith("---"))return null;let r=e.indexOf("---",3);if(r===-1)return null;let s=e.substring(3,r);return this.parse(s,t)}static clearCacheEntry(e){this.cache.delete(e)}static clearCache(){this.cache.clear()}static cleanupCache(){let e=Date.now();for(let[t,r]of this.cache.entries())e-r.timestamp>this.CACHE_TTL&&this.cache.delete(t);if(this.cache.size>this.MAX_CACHE_SIZE){let t=Array.from(this.cache.entries()).sort((s,n)=>s[1].timestamp-n[1].timestamp),r=t.slice(0,t.length-this.MAX_CACHE_SIZE);for(let[s]of r)this.cache.delete(s)}}};st.cache=new Map,st.CACHE_TTL=5*60*1e3,st.MAX_CACHE_SIZE=100});var Ai,Mu=b(()=>{Ai=class{constructor(e){this.mapping=e}toUserField(e){return this.mapping[e]}mapFromFrontmatter(e,t){if(!e)return{};let r={path:t};if(e[this.mapping.title]!==void 0&&(r.title=e[this.mapping.title]),e[this.mapping.status]!==void 0&&(r.status=e[this.mapping.status]),e[this.mapping.priority]!==void 0&&(r.priority=e[this.mapping.priority]),e[this.mapping.due]!==void 0&&(r.due=e[this.mapping.due]),e[this.mapping.scheduled]!==void 0&&(r.scheduled=e[this.mapping.scheduled]),e[this.mapping.contexts]!==void 0){let s=e[this.mapping.contexts];r.contexts=Array.isArray(s)?s:[s]}return e[this.mapping.timeEstimate]!==void 0&&(r.timeEstimate=e[this.mapping.timeEstimate]),e[this.mapping.completedDate]!==void 0&&(r.completedDate=e[this.mapping.completedDate]),e[this.mapping.recurrence]!==void 0&&(r.recurrence=e[this.mapping.recurrence]),e[this.mapping.dateCreated]!==void 0&&(r.dateCreated=e[this.mapping.dateCreated]),e[this.mapping.dateModified]!==void 0&&(r.dateModified=e[this.mapping.dateModified]),e[this.mapping.timeEntries]!==void 0&&(r.timeEntries=e[this.mapping.timeEntries]),e[this.mapping.completeInstances]!==void 0&&(r.complete_instances=e[this.mapping.completeInstances]),e.tags&&Array.isArray(e.tags)&&(r.tags=e.tags,r.archived=e.tags.includes(this.mapping.archiveTag)),e.timeEntries!==void 0&&(r.timeEntries=e.timeEntries),r}mapToFrontmatter(e,t){let r={};e.title!==void 0&&(r[this.mapping.title]=e.title),e.status!==void 0&&(r[this.mapping.status]=e.status),e.priority!==void 0&&(r[this.mapping.priority]=e.priority),e.due!==void 0&&(r[this.mapping.due]=e.due),e.scheduled!==void 0&&(r[this.mapping.scheduled]=e.scheduled),e.contexts!==void 0&&(r[this.mapping.contexts]=e.contexts),e.timeEstimate!==void 0&&(r[this.mapping.timeEstimate]=e.timeEstimate),e.completedDate!==void 0&&(r[this.mapping.completedDate]=e.completedDate),e.recurrence!==void 0&&(r[this.mapping.recurrence]=e.recurrence),e.dateCreated!==void 0&&(r[this.mapping.dateCreated]=e.dateCreated),e.dateModified!==void 0&&(r[this.mapping.dateModified]=e.dateModified),e.timeEntries!==void 0&&(r[this.mapping.timeEntries]=e.timeEntries),e.complete_instances!==void 0&&(r[this.mapping.completeInstances]=e.complete_instances);let s=e.tags?[...e.tags]:[];return t&&!s.includes(t)&&s.push(t),e.archived===!0&&!s.includes(this.mapping.archiveTag)?s.push(this.mapping.archiveTag):e.archived===!1&&(s=s.filter(n=>n!==this.mapping.archiveTag)),s.length>0&&(r.tags=s),e.timeEntries!==void 0&&(r.timeEntries=e.timeEntries),r}updateMapping(e){this.mapping=e}getMapping(){return{...this.mapping}}static validateMapping(e){let t=[],r=Object.keys(e);for(let a of r)(!e[a]||e[a].trim()==="")&&t.push(`Field "${a}" cannot be empty`);let s=Object.values(e),n=new Set(s);return s.length!==n.size&&t.push("Field mappings must have unique property names"),{valid:t.length===0,errors:t}}}});function le(i){if(!i)throw new Error("Date string cannot be empty");if(i.includes("T")||i.includes("Z")||i.match(/[+-]\d{2}:\d{2}$/)){let e=kn(i);if(!Hr(e))throw new Error(`Invalid timezone-aware date: ${i}`);return e}else{let e=wo(i,"yyyy-MM-dd",new Date);if(!Hr(e))throw new Error(`Invalid date-only string: ${i}`);return e}}function ts(i,e){try{let t=le(i),r=le(e);return gr(t,r)}catch(t){return console.error("Error comparing dates:",{date1:i,date2:e,error:t}),!1}}function kr(i,e){try{let t=Re(le(i)),r=Re(le(e));return Gt(t,r)}catch(t){return console.error("Error comparing dates for before:",{date1:i,date2:e,error:t}),!1}}function Dr(){return k(new Date,"yyyy-MM-dd")}function ia(i){try{let e=le(i);return k(e,"yyyy-MM-dd")}catch(e){return console.error("Error normalizing date string:",{dateString:i,error:e}),i}}function tr(i,e,t){return new Date(i,e,t)}function sa(i){if(!i||i.trim()==="")return!0;try{return le(i),!0}catch(e){return!1}}function na(i){try{let e=le(i);return Re(e)}catch(e){throw console.error("Error getting start of day for date string:",{dateString:i,error:e}),e}}function rs(i){return ts(i,Dr())}function Ii(i){return kr(i,Dr())}function Au(i,e="MMM d, yyyy"){try{let t=le(i);return k(t,e)}catch(t){return console.error("Error formatting date for display:",{dateString:i,error:t}),i}}function we(){let i=new Date,e=-i.getTimezoneOffset(),t=e>=0?"+":"-",r=h=>String(Math.abs(h)).padStart(2,"0"),s=r(Math.floor(Math.abs(e)/60)),n=r(Math.abs(e)%60),a=i.getFullYear(),o=r(i.getMonth()+1),l=r(i.getDate()),c=r(i.getHours()),d=r(i.getMinutes()),u=r(i.getSeconds()),f=String(i.getMilliseconds()).padStart(3,"0");return`${a}-${o}-${l}T${c}:${d}:${u}.${f}${t}${s}:${n}`}function aa(){return k(new Date,"yyyy-MM-dd")}function ss(i){try{if(!i)throw new Error("Timestamp string cannot be empty");let e=kn(i);if(!Hr(e))throw new Error(`Invalid timestamp: ${i}`);return e}catch(e){throw console.error("Error parsing timestamp:",{timestampString:i,error:e}),e}}function Iu(i,e="MMM d, yyyy h:mm a"){try{let t=ss(i);return k(t,e)}catch(t){return console.error("Error formatting timestamp for display:",{timestampString:i,error:t}),i}}function Je(i){return i?/T\d{2}:\d{2}/.test(i):!1}function ge(i){if(!i)return"";try{let e=le(i);return k(e,"yyyy-MM-dd")}catch(e){return console.error("Error extracting date part:",{dateString:i,error:e}),i}}function Sr(i){if(!i||!Je(i))return null;try{let e=le(i);return k(e,"HH:mm")}catch(e){return console.error("Error extracting time part:",{dateString:i,error:e}),null}}function is(i,e){if(!i)return"";if(!e)return i;try{let t=ge(i);return/^\d{2}:\d{2}$/.test(e)?`${t}T${e}`:(console.warn("Invalid time format, expected HH:mm:",e),i)}catch(t){return console.error("Error combining date and time:",{dateString:i,timeString:e,error:t}),i}}function $e(i,e={}){if(!i)return"";let{dateFormat:t="MMM d, yyyy",timeFormat:r="h:mm a",showTime:s=!0}=e;try{let n=le(i);return Je(i)&&s?!t||t.trim()===""?k(n,r):k(n,`${t} ${r}`):!t||t.trim()===""?"":k(n,t)}catch(n){return console.error("Error formatting datetime for display:",{dateString:i,error:n}),i}}function Pu(i,e){try{let t=le(i),r=le(e);if(Je(i)&&Je(e))return Gt(t,r);if(!Je(i)&&!Je(e))return Gt(Re(t),Re(r));let s=Je(i)?t:Ts(t),n=Je(e)?r:Ts(r);return Gt(s,n)}catch(t){return console.error("Error comparing dates time-aware:",{date1:i,date2:e,error:t}),!1}}function kt(i){if(!i)return!1;try{let e=le(i),t=new Date;if(Je(i))return Gt(e,t);let r=Re(t),s=Re(e);return Gt(s,r)}catch(e){return console.error("Error checking overdue status:",{dateString:i,error:e}),!1}}function oa(i){if(!i)return!1;try{let e=le(i),t=new Date;return gr(e,t)}catch(e){return console.error("Error checking if today:",{dateString:i,error:e}),!1}}function vl(i,e){if(!i||i.trim()==="")return!0;try{if(!sa(i))return!1;if(e&&e.trim()!==""){if(!/^\d{2}:\d{2}$/.test(e))return!1;let t=is(i,e);return sa(t)}return!0}catch(t){return!1}}var _e=b(()=>{Me()});function Nu(i,e){let t=null;return function(...s){t&&clearTimeout(t),t=setTimeout(()=>{i(...s),t=null},e)}}async function Pi(i,e){try{let r=(0,Ru.normalizePath)(e).split("/").filter(n=>n.length>0),s="";for(let n of r)s=s?`${s}/${n}`:n,i.getAbstractFileByPath(s)||await i.createFolder(s)}catch(t){let r=t instanceof Error?t.message:String(t),s=t instanceof Error?t.stack:void 0;console.error("Error creating folder structure:",{error:r,stack:s,folderPath:e,normalizedPath:(0,Ru.normalizePath)(e)});let n=new Error(`Failed to create folder "${e}": ${r}`);throw s&&(n.stack=s),n}}function ek(i,e){try{let t=new Date(i),r=new Date(e);if(isNaN(t.getTime())||isNaN(r.getTime()))return console.error("Invalid timestamps for duration calculation:",{startTime:i,endTime:e}),0;if(r<=t)return console.error("End time is not after start time:",{startTime:i,endTime:e}),0;let s=r.getTime()-t.getTime(),n=Math.round(s/(1e3*60));return Math.max(0,n)}catch(t){return console.error("Error calculating duration:",t,{startTime:i,endTime:e}),0}}function Ou(i){return!i||!Array.isArray(i)?0:i.reduce((e,t)=>{if(!t.startTime||!t.endTime)return e;let r=ek(t.startTime,t.endTime);return e+r},0)}function Vy(i){return!i||!Array.isArray(i)?null:i.find(e=>e.startTime&&!e.endTime)||null}function zy(i){if(!i||i===0||isNaN(i))return"0m";let e=Math.floor(i/60),t=i%60;return e===0?`${t}m`:t===0?`${e}h`:`${e}h ${t}m`}function Lu(i,e){if(e)return tk(e,i);let t=k(i,"yyyy-MM-dd"),r=k(i,"eeee, MMMM do, yyyy");return`---
${ta({date:t,tags:["daily"]})}---

# ${r}

## Notes

`}function tk(i,e){let t=i,r=k(e,"yyyy-MM-dd");t=t.replace(/\{\{title\}\}/g,r),t=t.replace(/\{\{date(?::([^}]+))?\}\}/g,(n,a)=>{if(a){let o=bl(a);return k(e,o)}else return k(e,"yyyy-MM-dd")});let s=new Date;return t=t.replace(/\{\{time(?::([^}]+))?\}\}/g,(n,a)=>{if(a){let o=bl(a);return k(s,o)}else return k(s,"HH:mm")}),t}function bl(i){let e=i;e=e.replace(/\[([^\]]+)\]/g,"'$1'");let t=e.split(/'([^']*?)'/);for(let r=0;r<t.length;r+=2){let s=t[r];[["gggg","RRRR"],["dddd","EEEE"],["YYYY","yyyy"],["MMMM","MMMM"],["MMM","MMM"],["ddd","EEE"],["gg","RR"],["ww","II"],["dd","EEEEEE"],["DD","dd"],["MM","MM"],["HH","HH"],["hh","hh"],["mm","mm"],["ss","ss"],["YY","yy"],["M","M"],["D","d"],["H","H"],["h","h"],["m","m"],["s","s"],["w","I"],["A","a"],["a","a"]].forEach(([a,o])=>{let l=new RegExp(a,"g");s=s.replace(l,o)}),t[r]=s}return e=t.join("'"),e}function jy(i,e){return rk(i,e)}function rk(i,e){var a;let t=i,r=new Date;t=t.replace(/\{\{title\}\}/g,e.title||""),t=t.replace(/\{\{priority\}\}/g,e.priority||""),t=t.replace(/\{\{status\}\}/g,e.status||"");let s=Array.isArray(e.contexts)?e.contexts.join(", "):e.contexts||"";t=t.replace(/\{\{contexts\}\}/g,s);let n=Array.isArray(e.tags)?e.tags.join(", "):e.tags||"";return t=t.replace(/\{\{tags\}\}/g,n),t=t.replace(/\{\{timeEstimate\}\}/g,((a=e.timeEstimate)==null?void 0:a.toString())||""),t=t.replace(/\{\{dueDate\}\}/g,e.dueDate||""),t=t.replace(/\{\{scheduledDate\}\}/g,e.scheduledDate||""),t=t.replace(/\{\{date(?::([^}]+))?\}\}/g,(o,l)=>{if(l){let c=bl(l);return k(r,c)}else return k(r,"yyyy-MM-dd")}),t=t.replace(/\{\{time(?::([^}]+))?\}\}/g,(o,l)=>{if(l){let c=bl(l);return k(r,c)}else return k(r,"HH:mm")}),t}function Fu(i){if(i==="none")return"";let e=new Date,t;switch(i){case"today":t=e;break;case"tomorrow":t=new Date(e),t.setDate(e.getDate()+1);break;case"next-week":t=new Date(e),t.setDate(e.getDate()+7);break;default:return""}return k(t,"yyyy-MM-dd")}function la(i,e){return i.getFullYear()===e.getFullYear()&&i.getMonth()===e.getMonth()&&i.getDate()===e.getDate()}function qy(i,e,t){var s;if(i.startsWith("---")&&i.indexOf("---",3)!==-1){let a=st.extractFrontmatter(i,e);if(a)if(t){let o=t.mapFromFrontmatter(a,e);return{title:o.title||"Untitled task",status:o.status||"open",priority:o.priority||"normal",due:o.due,scheduled:o.scheduled,path:e,archived:o.archived||!1,tags:o.tags||[],contexts:o.contexts||[],recurrence:o.recurrence,complete_instances:o.complete_instances,completedDate:o.completedDate,timeEstimate:o.timeEstimate,timeEntries:o.timeEntries,dateCreated:o.dateCreated,dateModified:o.dateModified}}else{let l=new Ai(ko).mapFromFrontmatter(a,e);return{title:l.title||"Untitled task",status:l.status||"open",priority:l.priority||"normal",due:l.due,scheduled:l.scheduled,path:e,archived:l.archived||!1,tags:l.tags||[],contexts:l.contexts||[],recurrence:l.recurrence,complete_instances:l.complete_instances,completedDate:l.completedDate,timeEstimate:l.timeEstimate,timeEntries:l.timeEntries,dateCreated:l.dateCreated,dateModified:l.dateModified}}}return{title:((s=e.split("/").pop())==null?void 0:s.replace(".md",""))||"Untitled",status:"open",priority:"normal",path:e,archived:!1}}function Os(i,e){if(!i.recurrence)return!0;let t=i.recurrence.frequency,r=le(k(e,"yyyy-MM-dd")),s=r.getDay(),n=r.getDate(),a=r.getMonth()+1,o=["sun","mon","tue","wed","thu","fri","sat"];switch(t){case"daily":return!0;case"weekly":return(i.recurrence.days_of_week||[]).includes(o[s]);case"monthly":return n===i.recurrence.day_of_month;case"yearly":if(i.recurrence.month_of_year&&i.recurrence.day_of_month)return n===i.recurrence.day_of_month&&a===i.recurrence.month_of_year;if(i.due)try{let c=le(i.due);return c.getDate()===n&&c.getMonth()===r.getMonth()}catch(c){return console.error(`Error parsing due date ${i.due}:`,c),!1}return!1;default:return!1}}function Hu(i,e){if(!i.recurrence)return i.status||"open";let t=k(e,"yyyy-MM-dd");return(Array.isArray(i.complete_instances)?i.complete_instances:[]).includes(t)?"done":"open"}function Yy(i,e,t){var o;let r=((o=e.split("/").pop())==null?void 0:o.replace(".md",""))||"Untitled",s=[],n,a=t==null?void 0:t.stat.mtime;if(i.startsWith("---")){let l=st.extractFrontmatter(i,e);l&&(l.title&&(r=l.title),l.tags&&Array.isArray(l.tags)&&(s=l.tags),l.dateCreated?n=l.dateCreated:l.date&&(n=l.date))}if(r==="Untitled"){let l=i.match(/^#\s+(.+)$/m);l&&l[1]&&(r=l[1].trim())}if(!n&&t&&(n=k(new Date(t.stat.ctime),"yyyy-MM-dd'T'HH:mm:ss")),n&&!n.match(/^\d{4}-\d{2}-\d{2}$/))try{let l=le(n);isNaN(l.getTime())||(n=k(l,"yyyy-MM-dd"))}catch(l){console.error(`Error parsing date ${n}:`,l)}return{title:r,tags:s,path:e,createdDate:n,lastModified:a}}var Ru,rr=b(()=>{Ru=require("obsidian");Me();ra();yl();Mu();Id();_e()});var Ew={};ws(Ew,{DEFAULT_TASK_CARD_OPTIONS:()=>Zh,createTaskCard:()=>gs,showDeleteConfirmationModal:()=>Tw,showTaskContextMenu:()=>Ja,updateTaskCard:()=>pr});function gs(i,e,t={}){let r={...Zh,...t},s=r.targetDate||e.selectedDate,n=i.recurrence?Hu(i,s):i.status,a=document.createElement("div"),o=e.getActiveTimeSession(i)!==null,l=e.statusManager.isCompletedStatus(n),c=!!i.recurrence,d=["task-card"];l&&d.push("task-card--completed"),i.archived&&d.push("task-card--archived"),o&&d.push("task-card--actively-tracked"),c&&d.push("task-card--recurring"),r.showCheckbox&&d.push("task-card--checkbox-enabled"),i.priority&&d.push(`task-card--priority-${i.priority}`),n&&d.push(`task-card--status-${n}`),a.className=d.join(" "),a.dataset.taskPath=i.path,a.dataset.key=i.path,a.dataset.status=n;let u=e.priorityManager.getPriorityConfig(i.priority);u&&(a.style.setProperty("--priority-color",u.color),a.style.borderLeftColor=u.color);let f=e.statusManager.getStatusConfig(n);if(f&&a.style.setProperty("--current-status-color",f.color),r.showCheckbox){let E=a.createEl("input",{type:"checkbox",cls:"task-card__checkbox"});E.checked=e.statusManager.isCompletedStatus(n),E.addEventListener("click",async S=>{S.stopPropagation();try{i.recurrence?await e.toggleRecurringTaskComplete(i,s):await e.toggleTaskStatus(i)}catch(D){let A=D instanceof Error?D.message:String(D);console.error("Error in task checkbox handler:",{error:A,taskPath:i.path}),new Pe.Notice(`Failed to toggle task status: ${A}`)}})}let h=a.createEl("span",{cls:"task-card__status-dot"});if(f&&(h.style.backgroundColor=f.color),i.recurrence){let E=a.createEl("div",{cls:"task-card__recurring-indicator",attr:{"aria-label":`Recurring: ${i.recurrence.frequency}`}});(0,Pe.setIcon)(E,"rotate-ccw")}let m=a.createEl("div",{cls:"task-card__content"}),p=a.createEl("div",{cls:"task-card__context-menu",attr:{"aria-label":"Task options",title:"More options"}});(0,Pe.setIcon)(p,"pencil"),p.addEventListener("click",async E=>{E.stopPropagation(),E.preventDefault(),await Ja(E,i.path,e,s)});let g=m.createEl("div",{cls:"task-card__title",text:i.title});e.statusManager.isCompletedStatus(n)&&g.classList.add("completed");let v=m.createEl("div",{cls:"task-card__metadata"}),w=[];if(i.recurrence&&w.push(`Recurring: ${i.recurrence.frequency}`),i.due){let E=oa(i.due),S=kt(i.due);if(E){let D=$e(i.due,{dateFormat:"",timeFormat:"h:mm a",showTime:!0});D.trim()===""?w.push("Due: Today"):w.push(`Due: Today at ${D}`)}else if(S){let D=$e(i.due,{dateFormat:"MMM d",timeFormat:"h:mm a",showTime:!0});w.push(`Due: ${D} (overdue)`)}else{let D=$e(i.due,{dateFormat:"MMM d",timeFormat:"h:mm a",showTime:!0});w.push(`Due: ${D}`)}}if(i.scheduled){let E=oa(i.scheduled),S=kt(i.scheduled);if(E){let D=$e(i.scheduled,{dateFormat:"",timeFormat:"h:mm a",showTime:!0});D.trim()===""?w.push("Scheduled: Today"):w.push(`Scheduled: Today at ${D}`)}else if(S){let D=$e(i.scheduled,{dateFormat:"MMM d",timeFormat:"h:mm a",showTime:!0});w.push(`Scheduled: ${D} (past)`)}else{let D=$e(i.scheduled,{dateFormat:"MMM d",timeFormat:"h:mm a",showTime:!0});w.push(`Scheduled: ${D}`)}}i.contexts&&i.contexts.length>0&&w.push(`@${i.contexts.join(", @")}`);let _=Ou(i.timeEntries||[]);if(i.timeEstimate||_>0){let E=[];_>0&&E.push(`${e.formatTime(_)} spent`),i.timeEstimate&&E.push(`${e.formatTime(i.timeEstimate)} estimated`),w.push(E.join(", "))}return w.length>0?v.textContent=w.join(" \u2022 "):v.style.display="none",a.addEventListener("click",async E=>{if(E.target!==a.querySelector(".task-card__checkbox"))if(E.ctrlKey||E.metaKey){let S=e.app.vault.getAbstractFileByPath(i.path);S instanceof Pe.TFile&&e.app.workspace.getLeaf(!1).openFile(S)}else await e.openTaskEditModal(i)}),a.addEventListener("contextmenu",async E=>{E.preventDefault();let S=a.dataset.taskPath;S&&await Ja(E,S,e,s)}),a.addEventListener("mouseover",E=>{e.app.vault.getAbstractFileByPath(i.path)&&e.app.workspace.trigger("hover-link",{event:E,source:"tasknotes-task-card",hoverParent:a,targetEl:a,linktext:i.path,sourcePath:i.path})}),a}async function Ja(i,e,t,r){var s;try{let n=await t.cacheManager.getTaskInfo(e,!0);if(!n){console.error(`No task found for path: ${e}`);return}let a=new Pe.Menu;if((n.recurrence?t.statusManager.getNonCompletionStatuses():t.statusManager.getAllStatuses()).forEach(l=>{a.addItem(c=>{let d=n.status===l.value;c.setTitle(`${l.label}`),c.setIcon("circle"),d&&c.setIcon("check"),c.onClick(async()=>{try{await t.updateTaskProperty(n,"status",l.value)}catch(u){let f=u instanceof Error?u.message:String(u);console.error("Error updating task status:",{error:f,taskPath:n.path}),new Pe.Notice(`Failed to update task status: ${f}`)}})})}),n.recurrence){a.addSeparator();let l=k(r,"yyyy-MM-dd"),c=((s=n.complete_instances)==null?void 0:s.includes(l))||!1;a.addItem(d=>{d.setTitle(c?"Mark incomplete for this date":"Mark complete for this date"),d.setIcon(c?"x":"check"),d.onClick(async()=>{try{await t.toggleRecurringTaskComplete(n,r)}catch(u){let f=u instanceof Error?u.message:String(u);console.error("Error toggling recurring task completion:",{error:f,taskPath:n.path}),new Pe.Notice(`Failed to toggle recurring task completion: ${f}`)}})})}a.addSeparator(),t.priorityManager.getPrioritiesByWeight().forEach(l=>{a.addItem(c=>{let d=n.priority===l.value;c.setTitle(`Priority: ${l.label}`),c.setIcon("flag"),d&&c.setIcon("check"),c.onClick(async()=>{try{await t.updateTaskProperty(n,"priority",l.value)}catch(u){let f=u instanceof Error?u.message:String(u);console.error("Error updating task priority:",{error:f,taskPath:n.path}),new Pe.Notice(`Failed to update task priority: ${f}`)}})})}),a.addSeparator(),a.addItem(l=>{l.setTitle("Set due date..."),l.setIcon("calendar"),l.onClick(()=>{t.openDueDateModal(n)})}),a.addItem(l=>{l.setTitle("Set scheduled date..."),l.setIcon("calendar-clock"),l.onClick(()=>{t.openScheduledDateModal(n)})}),a.addSeparator(),a.addItem(l=>{let c=t.getActiveTimeSession(n);l.setTitle(c?"Stop time tracking":"Start time tracking"),l.setIcon(c?"pause":"play"),l.onClick(async()=>{t.getActiveTimeSession(n)?await t.stopTimeTracking(n):await t.startTimeTracking(n)})}),a.addItem(l=>{l.setTitle(n.archived?"Unarchive":"Archive"),l.setIcon(n.archived?"archive-restore":"archive"),l.onClick(async()=>{try{await t.toggleTaskArchive(n)}catch(c){let d=c instanceof Error?c.message:String(c);console.error("Error toggling task archive:",{error:d,taskPath:n.path}),new Pe.Notice(`Failed to toggle task archive: ${d}`)}})}),a.addSeparator(),a.addItem(l=>{l.setTitle("Open note"),l.setIcon("file-text"),l.onClick(()=>{let c=t.app.vault.getAbstractFileByPath(e);c instanceof Pe.TFile&&t.app.workspace.getLeaf(!1).openFile(c)})}),a.addItem(l=>{l.setTitle("Copy task title"),l.setIcon("copy"),l.onClick(()=>{navigator.clipboard.writeText(n.title)})}),a.addSeparator(),a.addItem(l=>{l.setTitle("Delete task"),l.setIcon("trash"),l.onClick(async()=>{try{await Tw(n,t)}catch(c){let d=c instanceof Error?c.message:String(c);console.error("Error deleting task:",{error:d,taskPath:n.path}),new Pe.Notice(`Failed to delete task: ${d}`)}})}),a.showAtMouseEvent(i)}catch(n){let a=n instanceof Error?n.message:String(n);console.error("Error creating context menu:",{error:a,taskPath:e}),new Pe.Notice(`Failed to create context menu: ${a}`)}}function pr(i,e,t,r={}){let n={...Zh,...r}.targetDate||t.selectedDate,a=e.recurrence?Hu(e,n):e.status,o=t.getActiveTimeSession(e)!==null,l=t.statusManager.isCompletedStatus(a),c=!!e.recurrence,d=["task-card"];l&&d.push("task-card--completed"),e.archived&&d.push("task-card--archived"),o&&d.push("task-card--actively-tracked"),c&&d.push("task-card--recurring"),e.priority&&d.push(`task-card--priority-${e.priority}`),a&&d.push(`task-card--status-${a}`),i.className=d.join(" "),i.dataset.status=a;let u=t.priorityManager.getPriorityConfig(e.priority);u&&(i.style.setProperty("--priority-color",u.color),i.style.borderLeftColor=u.color);let f=t.statusManager.getStatusConfig(a);f&&i.style.setProperty("--current-status-color",f.color);let h=i.querySelector(".task-card__checkbox");h&&(h.checked=t.statusManager.isCompletedStatus(a));let m=i.querySelector(".task-card__status-dot");m&&f&&(m.style.backgroundColor=f.color);let p=i.querySelector(".task-card__recurring-indicator");if(e.recurrence&&!p){let w=i.createEl("span",{cls:"task-card__recurring-indicator",attr:{"aria-label":`Recurring: ${e.recurrence.frequency}`}});m==null||m.insertAdjacentElement("afterend",w)}else!e.recurrence&&p?p.remove():e.recurrence&&p&&p.setAttribute("aria-label",`Recurring: ${e.recurrence.frequency}`);let g=i.querySelector(".task-card__title");g&&(g.textContent=e.title,g.classList.toggle("completed",t.statusManager.isCompletedStatus(a)));let v=i.querySelector(".task-card__metadata");if(v){let w=[];if(e.recurrence&&w.push(`Recurring: ${e.recurrence.frequency}`),e.due){let E=oa(e.due),S=kt(e.due);if(E){let D=$e(e.due,{dateFormat:"",timeFormat:"h:mm a",showTime:!0});D.trim()===""?w.push("Due: Today"):w.push(`Due: Today at ${D}`)}else if(S){let D=$e(e.due,{dateFormat:"MMM d",timeFormat:"h:mm a",showTime:!0});w.push(`Due: ${D} (overdue)`)}else{let D=$e(e.due,{dateFormat:"MMM d",timeFormat:"h:mm a",showTime:!0});w.push(`Due: ${D}`)}}if(e.scheduled){let E=oa(e.scheduled),S=kt(e.scheduled);if(E){let D=$e(e.scheduled,{dateFormat:"",timeFormat:"h:mm a",showTime:!0});D.trim()===""?w.push("Scheduled: Today"):w.push(`Scheduled: Today at ${D}`)}else if(S){let D=$e(e.scheduled,{dateFormat:"MMM d",timeFormat:"h:mm a",showTime:!0});w.push(`Scheduled: ${D} (past)`)}else{let D=$e(e.scheduled,{dateFormat:"MMM d",timeFormat:"h:mm a",showTime:!0});w.push(`Scheduled: ${D}`)}}e.contexts&&e.contexts.length>0&&w.push(`@${e.contexts.join(", @")}`);let _=Ou(e.timeEntries||[]);if(e.timeEstimate||_>0){let E=[];_>0&&E.push(`${t.formatTime(_)} spent`),e.timeEstimate&&E.push(`${t.formatTime(e.timeEstimate)} estimated`),w.push(E.join(", "))}w.length>0?(v.textContent=w.join(" \u2022 "),v.style.display=""):v.style.display="none"}}async function Tw(i,e){return new Promise((t,r)=>{new Kh(e.app,i,e,async()=>{try{await e.taskService.deleteTask(i),t()}catch(n){r(n)}}).open()})}var Pe,Zh,Kh,en=b(()=>{Me();Pe=require("obsidian");rr();_e();Zh={showDueDate:!0,showCheckbox:!1,showArchiveButton:!1,showTimeTracking:!1,showRecurringControls:!0,groupByDate:!1};Kh=class extends Pe.Modal{constructor(t,r,s,n){super(t);this.task=r,this.plugin=s,this.onConfirm=n}onOpen(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:"Delete Task"});let r=t.createEl("p");r.innerHTML=`Are you sure you want to delete the task "<strong>${this.task.title}</strong>"?`;let s=t.createEl("p",{cls:"mod-warning",text:"This action cannot be undone. The task file will be permanently deleted."}),n=t.createEl("div",{cls:"modal-button-container"});n.style.display="flex",n.style.gap="10px",n.style.justifyContent="flex-end",n.style.marginTop="20px";let a=n.createEl("button",{text:"Cancel"});a.addEventListener("click",()=>{this.close()});let o=n.createEl("button",{text:"Delete",cls:"mod-warning"});o.style.backgroundColor="var(--color-red)",o.style.color="white",o.addEventListener("click",async()=>{try{await this.onConfirm(),this.close(),new Pe.Notice("Task deleted successfully")}catch(l){let c=l instanceof Error?l.message:String(l);new Pe.Notice(`Failed to delete task: ${c}`),console.error("Error in delete confirmation:",l)}}),a.focus()}onClose(){let{contentEl:t}=this;t.empty()}}});var It,jc=b(()=>{Me();_e();It=class{static parseTaskLine(e){if(typeof e!="string")return{isTaskLine:!1,originalText:"",error:"Invalid input: line must be a string"};if(e.length>2e3)return{isTaskLine:!1,originalText:e,error:"Line too long to process safely"};let r=e.trim().match(this.CHECKBOX_PATTERN);if(!r)return{isTaskLine:!1,originalText:e};try{let[,s,n,a,o]=r;if(typeof n!="string"||typeof o!="string")return{isTaskLine:!0,originalText:e,error:"Invalid checkbox format"};let l=n.toLowerCase()==="x",c=this.parseTaskContent(o,l);return!c||!c.title||c.title.trim().length===0?{isTaskLine:!0,originalText:e,error:"Task must have a title"}:{isTaskLine:!0,originalText:e,parsedData:c}}catch(s){return{isTaskLine:!0,originalText:e,error:`Failed to parse task: ${s instanceof Error?s.message:"Unknown error"}`}}}static parseTaskContent(e,t){if(typeof e!="string")throw new Error("Content must be a string");if(e.length>1e3)throw new Error("Content too long to process safely");let r=e;try{let s=this.extractDate(r,this.EMOJI_PATTERNS.DUE_DATE),n=this.extractDate(r,this.EMOJI_PATTERNS.SCHEDULED_DATE),a=this.extractDate(r,this.EMOJI_PATTERNS.START_DATE),o=this.extractDate(r,this.EMOJI_PATTERNS.CREATED_DATE),l=this.extractDate(r,this.EMOJI_PATTERNS.DONE_DATE),c=this.extractPriority(r),{recurrence:d,recurrenceData:u}=this.extractRecurrence(r),f=this.extractCleanTitle(r);if(!f||f.trim().length===0)throw new Error("Title cannot be empty after parsing");if(f.length>200)throw new Error("Title too long (max 200 characters)");let h="open";if(t||l)h="done";else if(a)try{!Ii(a)&&!rs(a)&&(h="scheduled")}catch(m){}return{title:f.trim(),status:h,priority:c,dueDate:s,scheduledDate:n,startDate:a,createdDate:o,doneDate:l,recurrence:d,recurrenceData:u,isCompleted:t}}catch(s){throw new Error(`Failed to parse task content: ${s instanceof Error?s.message:"Unknown error"}`)}}static extractDate(e,t){if(!(typeof e!="string"||!t))try{let s=new RegExp(t.source,"g").exec(e);if(s&&s[1]){let n=s[1].trim();if(!/^\d{4}-\d{2}-\d{2}$/.test(n))return;try{let a=le(n);if(isNaN(a.getTime()))return;let o=a.getFullYear();return o<1900||o>2100?void 0:k(a,"yyyy-MM-dd")}catch(a){return}}}catch(r){console.debug("Error extracting date:",r)}}static extractPriority(e){return new RegExp(this.EMOJI_PATTERNS.HIGH_PRIORITY.source).test(e)?"high":new RegExp(this.EMOJI_PATTERNS.MEDIUM_PRIORITY.source).test(e)?"medium":new RegExp(this.EMOJI_PATTERNS.LOW_PRIORITY.source).test(e)?"low":"normal"}static extractRecurrence(e){let r=new RegExp(this.EMOJI_PATTERNS.RECURRENCE.source,"g").exec(e);if(!r||!r[1])return{};let s=r[1].trim();if(s.includes("every day"))return{recurrence:"daily",recurrenceData:{frequency:"daily"}};if(s.includes("every week"))return{recurrence:"weekly",recurrenceData:{frequency:"weekly"}};if(s.includes("every month"))return{recurrence:"monthly",recurrenceData:{frequency:"monthly"}};if(s.includes("every year"))return{recurrence:"yearly",recurrenceData:{frequency:"yearly"}};let n=s.match(/every\s+(monday|tuesday|wednesday|thursday|friday|saturday|sunday)/i);return n?{recurrence:"weekly",recurrenceData:{frequency:"weekly",days_of_week:[n[1].toLowerCase().substring(0,3)]}}:{recurrence:"custom",recurrenceData:{frequency:"custom",raw:s}}}static extractCleanTitle(e){if(typeof e!="string")return"";try{let t=e;Object.values(this.EMOJI_PATTERNS).forEach(s=>{try{let n=new RegExp(s.source,"g");t=t.replace(n,"")}catch(n){console.debug("Error applying emoji pattern:",n)}});let r=t.replace(/\s+/g," ").trim();return r.length===0?"Untitled Task":r}catch(t){return console.debug("Error extracting clean title:",t),"Untitled Task"}}static isTasksPluginFormat(e){if(typeof e!="string"||e.length>1e3)return!1;try{let t=e.trim();return this.CHECKBOX_PATTERN.test(t)?Object.values(this.EMOJI_PATTERNS).some(n=>{try{return new RegExp(n.source).test(t)}catch(a){return!1}}):!1}catch(t){return console.debug("Error validating Tasks plugin format:",t),!1}}static getSummary(e){let t=[];return t.push(`Title: "${e.title}"`),t.push(`Status: ${e.status}`),t.push(`Priority: ${e.priority}`),e.dueDate&&t.push(`Due: ${e.dueDate}`),e.startDate&&t.push(`Start: ${e.startDate}`),e.scheduledDate&&t.push(`Scheduled: ${e.scheduledDate}`),e.createdDate&&t.push(`Created: ${e.createdDate}`),e.doneDate&&t.push(`Done: ${e.doneDate}`),e.recurrence&&t.push(`Recurrence: ${e.recurrence}`),t.join(" | ")}};It.EMOJI_PATTERNS={DUE_DATE:/📅\s*(\d{4}-\d{2}-\d{2})/g,SCHEDULED_DATE:/⏳\s*(\d{4}-\d{2}-\d{2})/g,START_DATE:/🛫\s*(\d{4}-\d{2}-\d{2})/g,CREATED_DATE:/➕\s*(\d{4}-\d{2}-\d{2})/g,DONE_DATE:/✅\s*(\d{4}-\d{2}-\d{2})/g,HIGH_PRIORITY:/⏫/g,MEDIUM_PRIORITY:/🔼/g,LOW_PRIORITY:/⏬/g,RECURRENCE:/🔁\s*([^📅⏳🛫➕✅⏫🔼⏬🔁]+?)(?=\s*[📅⏳🛫➕✅⏫🔼⏬🔁]|$)/g},It.CHECKBOX_PATTERN=/^(\s*[-*+]\s+\[)([ xX])(\]\s+)(.*)/});var xw={};ws(xw,{TaskLinkDetectionService:()=>ro});var sp,ro,ip=b(()=>{sp=require("obsidian"),ro=class{constructor(e){this.linkCache=new Map;this.plugin=e}async detectTaskLink(e,t){let r=this.parseWikilink(e);if(!r)return{isValidTaskLink:!1};let{linkPath:s,displayText:n}=r,a=`${t}:${s}`,o=this.linkCache.get(a);if(o){let u=this.plugin.app.vault.getAbstractFileByPath(s);if(u instanceof sp.TFile&&u.stat.mtime===o.lastModified)return o.result}let l=this.resolveLinkPath(s,t);if(!l){let u={isValidTaskLink:!1};return this.cacheResult(a,u,0),u}let c=this.plugin.app.vault.getAbstractFileByPath(l);if(!(c instanceof sp.TFile)){let u={isValidTaskLink:!1};return this.cacheResult(a,u,0),u}try{let u=await this.plugin.cacheManager.getTaskInfo(l);if(u){let f={isValidTaskLink:!0,taskPath:l,taskInfo:u,displayText:n};return this.cacheResult(a,f,c.stat.mtime),f}}catch(u){console.debug("TaskLinkDetectionService: Error checking task info for link:",l,u)}let d={isValidTaskLink:!1};return this.cacheResult(a,d,c.stat.mtime),d}parseWikilink(e){let t=e.slice(2,-2).trim();if(!t)return null;let r=t.indexOf("|");return r!==-1?{linkPath:t.slice(0,r).trim(),displayText:t.slice(r+1).trim()}:{linkPath:t}}resolveLinkPath(e,t){try{let r=this.plugin.app.metadataCache.getFirstLinkpathDest(e,t);return(r==null?void 0:r.path)||null}catch(r){return console.debug("Error resolving link path:",e,r),null}}cacheResult(e,t,r){if(this.linkCache.set(e,{result:t,lastModified:r}),this.linkCache.size>1e3){let s=this.linkCache.keys().next().value;this.linkCache.delete(s)}}clearCacheForFile(e){for(let[t]of this.linkCache)t.includes(e)&&this.linkCache.delete(t)}clearCache(){this.linkCache.clear()}findWikilinks(e){let t=[],r=/\[\[([^\]]+)\]\]/g,s;for(;(s=r.exec(e))!==null;)t.push({match:s[0],start:s.index,end:s.index+s[0].length});return t}cleanup(){this.linkCache.clear()}}});var Rw={};ws(Rw,{InstantTaskConvertService:()=>np});var Qt,np,Nw=b(()=>{Qt=require("obsidian");jc();_e();np=class{constructor(e){this.plugin=e}async instantConvertTask(e,t){try{let r=this.validateInputParameters(e,t);if(!r.isValid){new Qt.Notice(r.error||"Invalid input parameters.");return}let s=e.getLine(t),n=It.parseTaskLine(s);if(!n.isTaskLine){new Qt.Notice("Current line is not a task.");return}if(n.error){new Qt.Notice(`Error parsing task: ${n.error}`);return}if(!n.parsedData){new Qt.Notice("Failed to parse task data from current line.");return}let a=this.validateTaskData(n.parsedData);if(!a.isValid){new Qt.Notice(a.error||"Invalid task data.");return}let o=await this.createTaskFile(n.parsedData),l=await this.replaceOriginalTaskLine(e,t,o,n.parsedData.title,s);if(!l.success){new Qt.Notice(l.error||"Failed to replace task line.");try{await this.plugin.app.vault.delete(o)}catch(c){console.warn("Failed to clean up created file after replacement failure:",c)}return}new Qt.Notice(`Task converted: ${n.parsedData.title}`)}catch(r){console.error("Error during instant task conversion:",r),r.message.includes("file already exists")?new Qt.Notice("A file with this name already exists. Please try again or rename the task."):r.message.includes("invalid characters")?new Qt.Notice("Task title contains invalid characters for filename."):new Qt.Notice("Failed to convert task. Please try again.")}}validateInputParameters(e,t){if(!e)return{isValid:!1,error:"Editor is not available."};let r=e.lineCount();if(t<0||t>=r)return{isValid:!1,error:`Line number ${t} is out of bounds (0-${r-1}).`};let s=e.getLine(t);return s==null?{isValid:!1,error:`Cannot read line ${t}.`}:{isValid:!0}}validateTaskData(e){if(!e.title||e.title.trim().length===0)return{isValid:!1,error:"Task title cannot be empty."};if(e.title.length>200)return{isValid:!1,error:"Task title is too long (max 200 characters)."};if(/[<>:"/\\|?*\x00-\x1f\x7f]/.test(e.title))return{isValid:!1,error:"Task title contains invalid characters for file operations."};let r=["dueDate","scheduledDate","startDate","createdDate","doneDate"];for(let s of r){let n=e[s];if(n&&!this.isValidDateFormat(n))return{isValid:!1,error:`Invalid date format in ${s}: ${n}`}}return{isValid:!0}}isValidDateFormat(e){if(!/^\d{4}-\d{2}-\d{2}$/.test(e))return!1;let r=new Date(e);return r instanceof Date&&!isNaN(r.getTime())&&r.toISOString().slice(0,10)===e}async createTaskFile(e){let t=this.sanitizeTitle(e.title)||"Untitled Task",r=this.sanitizePriority(e.priority)||this.plugin.settings.defaultTaskPriority,s=this.sanitizeStatus(e.status)||this.plugin.settings.defaultTaskStatus,n=this.sanitizeDate(e.dueDate)||void 0,a=this.sanitizeDate(e.scheduledDate)||void 0,o=[],l=[this.plugin.settings.taskTag],c={title:t,status:s,priority:r,due:n,scheduled:a,contexts:o.length>0?o:void 0,tags:l,details:`# ${t}

<!-- Add task details below -->`,dateCreated:we(),dateModified:we()},{file:d}=await this.plugin.taskService.createTask(c);return d}sanitizeTitle(e){return e?e.trim().substring(0,200):""}sanitizePriority(e){return["low","normal","medium","high"].includes(e)?e:"normal"}sanitizeStatus(e){return["open","in-progress","done","scheduled"].includes(e)?e:"open"}sanitizeDate(e){return!e||!this.isValidDateFormat(e)?"":e}async replaceOriginalTaskLine(e,t,r,s,n){var a;try{if(!e||!r)return{success:!1,error:"Invalid editor or file reference."};let o=e.lineCount();if(t<0||t>=o)return{success:!1,error:`Line number ${t} is no longer valid (current line count: ${o}).`};let l=e.getLine(t);if(l!==n)return{success:!1,error:"Line content has changed since parsing. Please try again."};if(!It.parseTaskLine(l).isTaskLine)return{success:!1,error:"Line is no longer a valid task."};let d=this.sanitizeTitle(s);if(!d)return{success:!1,error:"Cannot create link with empty title."};let f=`${((a=l.match(/^(\s*)/))==null?void 0:a[1])||""}- [[${r.path}|${d}]]`;if(f.length>500)return{success:!1,error:"Generated link text is too long."};let h={line:t,ch:0},m={line:t,ch:l.length};return e.replaceRange(f,h,m),{success:!0}}catch(o){return console.error("Error replacing task line:",o),{success:!1,error:`Failed to replace line: ${o.message}`}}}}});var Lw={};ws(Lw,{createInstantConvertButtons:()=>G_,createInstantConvertField:()=>Ow});function Ow(i){return Qc.StateField.define({create(){return Rt.Decoration.none},update(e,t){if(!i||!t)return Rt.Decoration.none;if(!i.settings||!i.settings.enableInstantTaskConvert)return Rt.Decoration.none;if(!t.state)return console.warn("Invalid transaction state in instant convert field update"),Rt.Decoration.none;try{return!t.docChanged&&e!==Rt.Decoration.none?e.map(t.changes):Q_(t.state,i)}catch(r){return console.error("Error updating instant convert decorations:",r),Rt.Decoration.none}},provide(e){return Rt.EditorView.decorations.from(e)}})}function Q_(i,e){let t=new Qc.RangeSetBuilder,r=i.doc;if(!r||!e)return console.warn("Invalid state or plugin for building convert button decorations"),t.finish();if(typeof r.lines!="number"||r.lines<0)return console.warn("Invalid document lines count:",r.lines),t.finish();for(let s=0;s<r.lines;s++)try{let n=r.line(s+1);if(!n||typeof n.text!="string")continue;let a=n.text;if(a.length>1e3)continue;let o=It.parseTaskLine(a);if(o.isTaskLine&&o.parsedData){if(!o.parsedData.title||o.parsedData.title.trim().length===0||typeof n.to!="number"||n.to<0)continue;let l=new so(e,s),c=Rt.Decoration.widget({widget:l,side:1});t.add(n.to,n.to,c)}}catch(n){console.debug("Error processing line",s,":",n);continue}return t.finish()}function G_(i){return Ow(i)}var Qc,Rt,Gc,so,Fw=b(()=>{Qc=require("@codemirror/state"),Rt=require("@codemirror/view"),Gc=require("obsidian");jc();so=class extends Rt.WidgetType{constructor(t,r){super();this.plugin=t,this.lineNumber=r}toDOM(t){let r=document.createElement("span");r.className="tasknotes-plugin";let s=r.createEl("button",{cls:"instant-convert-button"});s.setAttribute("title","Convert to TaskNote"),s.setAttribute("aria-label","Convert to TaskNote");let n=s.createEl("span",{cls:"instant-convert-button__icon"});return(0,Gc.setIcon)(n,"file-plus"),s.addEventListener("click",async a=>{a.preventDefault(),a.stopPropagation();try{if(!this.validateButtonClick())return;let o=this.plugin.app.workspace.getActiveViewOfType(Gc.MarkdownView);if(!o){console.warn("No active markdown view available for task conversion");return}let l=o.editor;if(!this.validateEditorState(l))return;this.plugin.instantTaskConvertService&&l&&await this.plugin.instantTaskConvertService.instantConvertTask(l,this.lineNumber)}catch(o){console.error("Error in convert button click handler:",o)}}),r}eq(t){return t instanceof so&&t.plugin===this.plugin&&t.lineNumber===this.lineNumber}get estimatedHeight(){return-1}ignoreEvent(){return!1}validateButtonClick(){return this.plugin?this.plugin.settings.enableInstantTaskConvert?typeof this.lineNumber!="number"||this.lineNumber<0?(console.warn("Invalid line number for task conversion:",this.lineNumber),!1):!0:(console.warn("Instant task conversion is disabled"),!1):(console.warn("Plugin not available for task conversion"),!1)}validateEditorState(t){if(!t)return console.warn("Editor not available for task conversion"),!1;let r=t.lineCount();if(this.lineNumber>=r)return console.warn(`Line number ${this.lineNumber} is out of bounds (total lines: ${r})`),!1;try{let s=t.getLine(this.lineNumber);return s?It.parseTaskLine(s).isTaskLine?!0:(console.warn(`Line ${this.lineNumber} is no longer a task`),!1):(console.warn(`Cannot read line ${this.lineNumber}`),!1)}catch(s){return console.warn("Error validating line content:",s),!1}}}});var Hw={};ws(Hw,{DueDateModal:()=>ap});var cn,ap,Bw=b(()=>{cn=require("obsidian");Me();_e();ap=class extends cn.Modal{constructor(t,r,s){super(t);this.task=r,this.plugin=s}onOpen(){let{contentEl:t}=this;t.empty(),t.addClass("tasknotes-plugin"),this.titleEl.setText("Set Due Date"),this.titleEl.setAttribute("id","due-date-modal-title"),this.containerEl.setAttribute("aria-labelledby","due-date-modal-title"),this.containerEl.setAttribute("role","dialog"),this.containerEl.setAttribute("aria-modal","true"),new cn.Setting(t).setName("Set due date").setHeading(),t.createEl("p",{text:`Task: ${this.task.title}`,cls:"due-date-modal__task-title"});let s=new cn.Setting(t).setName("Due Date & Time").setDesc("Enter due date and optional time (leave time empty for date-only)").controlEl.createDiv({cls:"modal-form__datetime-container"});this.dueDateInput=s.createEl("input",{type:"date",cls:"modal-form__input modal-form__input--date",attr:{"aria-label":"Due date for task",placeholder:"YYYY-MM-DD"}}),this.dueDateInput.value=ge(this.task.due||""),this.dueTimeInput=s.createEl("input",{type:"time",cls:"modal-form__input modal-form__input--time",attr:{"aria-label":"Due time for task (optional)",placeholder:"HH:MM"}}),this.dueTimeInput.value=Sr(this.task.due||"")||"",this.dueDateInput.addEventListener("keydown",p=>{p.key==="Enter"?this.save():p.key==="Escape"&&this.close()}),this.dueTimeInput.addEventListener("keydown",p=>{p.key==="Enter"?this.save():p.key==="Escape"&&this.close()}),setTimeout(()=>this.dueDateInput.focus(),100);let n=t.createDiv({cls:"modal-form__group"});new cn.Setting(n).setName("Quick options").setHeading();let a=n.createDiv({cls:"modal-form__quick-actions"});a.createEl("button",{text:"Today",cls:"modal-form__button modal-form__button--quick-date",attr:{"aria-label":"Set due date to today"}}).addEventListener("click",()=>{this.dueDateInput.value=k(new Date,"yyyy-MM-dd")}),a.createEl("button",{text:"Tomorrow",cls:"modal-form__button modal-form__button--quick-date",attr:{"aria-label":"Set due date to tomorrow"}}).addEventListener("click",()=>{this.dueDateInput.value=k(Fr(new Date,{days:1}),"yyyy-MM-dd")}),a.createEl("button",{text:"Next week",cls:"modal-form__button modal-form__button--quick-date",attr:{"aria-label":"Set due date to next week"}}).addEventListener("click",()=>{this.dueDateInput.value=k(Fr(new Date,{weeks:1}),"yyyy-MM-dd")}),a.createEl("button",{text:"Now",cls:"modal-form__button modal-form__button--quick-date",attr:{"aria-label":"Set due date and time to now"}}).addEventListener("click",()=>{let p=new Date;this.dueDateInput.value=k(p,"yyyy-MM-dd"),this.dueTimeInput.value=k(p,"HH:mm")}),a.createEl("button",{text:"Clear",cls:"modal-form__button modal-form__button--quick-date modal-form__button--quick-date--clear",attr:{"aria-label":"Clear due date"}}).addEventListener("click",()=>{this.dueDateInput.value="",this.dueTimeInput.value=""});let f=t.createDiv({cls:"modal-form__buttons"});f.createEl("button",{text:"Save",cls:"modal-form__button modal-form__button--primary"}).addEventListener("click",()=>this.save()),f.createEl("button",{text:"Cancel",cls:"modal-form__button modal-form__button--secondary"}).addEventListener("click",()=>this.close())}async save(){let t=this.dueDateInput.value.trim(),r=this.dueTimeInput.value.trim(),s;if(t?r?s=is(t,r):s=t:s=void 0,!vl(t,r)){let n=this.contentEl.createEl("div",{text:"Please enter a valid date and time format",cls:"modal-form__error",attr:{role:"alert","aria-live":"assertive"}});this.dueDateInput.setAttribute("aria-invalid","true"),this.dueDateInput.setAttribute("aria-describedby","due-date-error"),n.setAttribute("id","due-date-error"),setTimeout(()=>{n.remove(),this.dueDateInput.removeAttribute("aria-invalid"),this.dueDateInput.removeAttribute("aria-describedby")},3e3);return}try{await this.plugin.taskService.updateProperty(this.task,"due",s),this.close()}catch(n){console.error("Failed to update due date:",n);let a=this.contentEl.createEl("div",{text:"Failed to update due date. Please try again.",cls:"modal-form__error"});setTimeout(()=>a.remove(),3e3)}}onClose(){let{contentEl:t}=this;t.empty()}}});var Ww={};ws(Ww,{ScheduledDateModal:()=>op});var dn,op,Uw=b(()=>{dn=require("obsidian");Me();_e();op=class extends dn.Modal{constructor(t,r,s){super(t);this.task=r,this.plugin=s}onOpen(){let{contentEl:t}=this;t.empty(),t.addClass("tasknotes-plugin"),this.titleEl.setText("Set Scheduled Date"),this.titleEl.setAttribute("id","scheduled-date-modal-title"),this.containerEl.setAttribute("aria-labelledby","scheduled-date-modal-title"),this.containerEl.setAttribute("role","dialog"),this.containerEl.setAttribute("aria-modal","true"),new dn.Setting(t).setName("Set scheduled date").setHeading(),t.createEl("p",{text:`Task: ${this.task.title}`,cls:"scheduled-date-modal__task-title"});let s=new dn.Setting(t).setName("Scheduled Date & Time").setDesc("Enter scheduled date and optional time (leave time empty for date-only)").controlEl.createDiv({cls:"modal-form__datetime-container"});this.scheduledDateInput=s.createEl("input",{type:"date",cls:"modal-form__input modal-form__input--date",attr:{"aria-label":"Scheduled date for task",placeholder:"YYYY-MM-DD"}}),this.scheduledDateInput.value=ge(this.task.scheduled||""),this.scheduledTimeInput=s.createEl("input",{type:"time",cls:"modal-form__input modal-form__input--time",attr:{"aria-label":"Scheduled time for task (optional)",placeholder:"HH:MM"}}),this.scheduledTimeInput.value=Sr(this.task.scheduled||"")||"",this.scheduledDateInput.addEventListener("keydown",p=>{p.key==="Enter"?this.save():p.key==="Escape"&&this.close()}),this.scheduledTimeInput.addEventListener("keydown",p=>{p.key==="Enter"?this.save():p.key==="Escape"&&this.close()}),setTimeout(()=>this.scheduledDateInput.focus(),100);let n=t.createDiv({cls:"modal-form__group"});new dn.Setting(n).setName("Quick options").setHeading();let a=n.createDiv({cls:"modal-form__quick-actions"});a.createEl("button",{text:"Today",cls:"modal-form__button modal-form__button--quick-date",attr:{"aria-label":"Set scheduled date to today"}}).addEventListener("click",()=>{this.scheduledDateInput.value=k(new Date,"yyyy-MM-dd")}),a.createEl("button",{text:"Tomorrow",cls:"modal-form__button modal-form__button--quick-date",attr:{"aria-label":"Set scheduled date to tomorrow"}}).addEventListener("click",()=>{this.scheduledDateInput.value=k(Fr(new Date,{days:1}),"yyyy-MM-dd")}),a.createEl("button",{text:"Next week",cls:"modal-form__button modal-form__button--quick-date",attr:{"aria-label":"Set scheduled date to next week"}}).addEventListener("click",()=>{this.scheduledDateInput.value=k(Fr(new Date,{weeks:1}),"yyyy-MM-dd")}),a.createEl("button",{text:"Now",cls:"modal-form__button modal-form__button--quick-date",attr:{"aria-label":"Set scheduled date and time to now"}}).addEventListener("click",()=>{let p=new Date;this.scheduledDateInput.value=k(p,"yyyy-MM-dd"),this.scheduledTimeInput.value=k(p,"HH:mm")}),a.createEl("button",{text:"Clear",cls:"modal-form__button modal-form__button--quick-date modal-form__button--quick-date--clear",attr:{"aria-label":"Clear scheduled date"}}).addEventListener("click",()=>{this.scheduledDateInput.value="",this.scheduledTimeInput.value=""});let f=t.createDiv({cls:"modal-form__buttons"});f.createEl("button",{text:"Save",cls:"modal-form__button modal-form__button--primary"}).addEventListener("click",()=>this.save()),f.createEl("button",{text:"Cancel",cls:"modal-form__button modal-form__button--secondary"}).addEventListener("click",()=>this.close())}async save(){let t=this.scheduledDateInput.value.trim(),r=this.scheduledTimeInput.value.trim(),s;if(t?r?s=is(t,r):s=t:s=void 0,!vl(t,r)){let n=this.contentEl.createEl("div",{text:"Please enter a valid date and time format",cls:"modal-form__error",attr:{role:"alert","aria-live":"assertive"}});this.scheduledDateInput.setAttribute("aria-invalid","true"),this.scheduledDateInput.setAttribute("aria-describedby","scheduled-date-error"),n.setAttribute("id","scheduled-date-error"),setTimeout(()=>{n.remove(),this.scheduledDateInput.removeAttribute("aria-invalid"),this.scheduledDateInput.removeAttribute("aria-describedby")},3e3);return}try{await this.plugin.taskService.updateProperty(this.task,"scheduled",s),this.close()}catch(n){console.error("Failed to update scheduled date:",n);let a=this.contentEl.createEl("div",{text:"Failed to update scheduled date. Please try again.",cls:"modal-form__error"});setTimeout(()=>a.remove(),3e3)}}onClose(){let{contentEl:t}=this;t.empty()}}});var Z_={};ws(Z_,{default:()=>K_});module.exports=Qw(Z_);var ne=require("obsidian");Me();Id();var Wr="tasknotes-mini-calendar-view",_s="tasknotes-advanced-calendar-view",xs="tasknotes-task-list-view",Dn="tasknotes-notes-view",Ms="tasknotes-agenda-view",Sn="tasknotes-pomodoro-view",Cn="tasknotes-pomodoro-stats-view",As="tasknotes-kanban-view",Ur="date-selected";var tt="data-changed",Ae="task-updated",Ig="task-deleted",Do="pomodoro-start",So="pomodoro-complete",Co="pomodoro-interrupt",$r="pomodoro-tick";var Cr=require("obsidian");Me();rr();var Ls=class{constructor(){this.metrics=new Map;this.markers=new Map;this.enabled=!0;this.mutationObservers=new Set;this.performanceObservers=new Set}static getInstance(){return Ls.instance||(Ls.instance=new Ls),Ls.instance}startTimer(e){this.enabled&&this.markers.set(e,performance.now())}endTimer(e){if(!this.enabled)return 0;let t=this.markers.get(e);if(t===void 0)return e.includes("-measure-")||console.warn(`No start marker found for operation: ${e}`),0;let r=performance.now()-t;return this.recordMetric(e,r),this.markers.delete(e),r}async measure(e,t){if(!this.enabled)return t();let r=performance.now();try{return await t()}finally{let s=performance.now()-r;this.recordMetric(e,s)}}measureSync(e,t){if(!this.enabled)return t();let r=performance.now();try{return t()}finally{let s=performance.now()-r;this.recordMetric(e,s)}}recordMetric(e,t){if(!this.enabled)return;this.metrics.has(e)||this.metrics.set(e,[]);let r=this.metrics.get(e);r.push(t),r.length>50&&r.splice(0,r.length-50)}getStats(e){let t=this.metrics.get(e);if(!t||t.length===0)return null;let r=[...t].sort((a,o)=>a-o),s=r.length,n=r.reduce((a,o)=>a+o,0);return{count:s,average:n/s,min:r[0],max:r[s-1],median:r[Math.floor(s/2)],p95:r[Math.floor(s*.95)]}}getAllStats(){let e={};for(let[t]of this.metrics)e[t]=this.getStats(t);return e}logSummary(){if(!this.enabled)return;console.group("[Performance Summary]");let e=this.getAllStats();["cache-file-read","task-list-render","calendar-render","task-update","file-index","dom-update"].forEach(r=>{let s=e[r];s&&console.log(`${r}:`,{average:`${s.average.toFixed(2)}ms`,p95:`${s.p95.toFixed(2)}ms`,count:s.count})}),console.groupEnd()}monitorDOMMutations(e){if(!this.enabled)return()=>{};let t=0,r=performance.now(),s=new MutationObserver(n=>{t+=n.length;let a=performance.now()-r;t>100&&a<1e3&&console.warn(`High DOM mutation rate: ${t} mutations in ${a.toFixed(2)}ms`)});return s.observe(e,{childList:!0,subtree:!0,attributes:!0}),this.mutationObservers.add(s),()=>{s.disconnect(),this.mutationObservers.delete(s),this.recordMetric("dom-mutations",t)}}recordMemoryUsage(e){if(!this.enabled||!("memory"in performance))return;let t=performance.memory,r={used:t.usedJSHeapSize/1024/1024,total:t.totalJSHeapSize/1024/1024,limit:t.jsHeapSizeLimit/1024/1024},s=e?`memory-${e}`:"memory-usage";this.recordMetric(s,r.used),r.used>100&&console.warn(`High memory usage: ${r.used.toFixed(2)}MB`)}trackLongTasks(){if(!this.enabled||!("PerformanceObserver"in window))return()=>{};let e=new PerformanceObserver(t=>{for(let r of t.getEntries())r.duration>50&&(console.warn(`Long task detected: ${r.duration.toFixed(2)}ms`),this.recordMetric("long-task",r.duration))});try{e.observe({entryTypes:["longtask"]}),this.performanceObservers.add(e)}catch(t){console.warn("Long task monitoring not supported")}return()=>{e.disconnect(),this.performanceObservers.delete(e)}}mark(e){if(this.enabled)try{performance.mark(`tasknotes-${e}`)}catch(t){}}measureBetweenMarks(e,t,r){if(this.enabled)try{performance.measure(`tasknotes-${r}`,`tasknotes-${e}`,`tasknotes-${t}`)}catch(s){}}clear(){this.metrics.clear(),this.markers.clear()}destroy(){for(let e of this.mutationObservers)e.disconnect();this.mutationObservers.clear();for(let e of this.performanceObservers)e.disconnect();this.performanceObservers.clear(),this.clear(),Ls.instance=null}setEnabled(e){this.enabled=e,e||this.clear()}exportData(){let e={timestamp:new Date().toISOString(),stats:this.getAllStats(),userAgent:navigator.userAgent,memoryInfo:"memory"in performance?performance.memory:null};return JSON.stringify(e,null,2)}},wl=Ls;wl.instance=null;var sr=wl.getInstance();_e();var da=class extends Cr.ItemView{constructor(t,r){super(t);this.colorizeMode="tasks";this.listeners=[];this.monthCalculationCache=new Map;this.debouncedRefresh=null;this.currentCacheKey="";this.calendarDayElements=null;this.elementToDateMap=new Map;this.plugin=r;let s=this.plugin.selectedDate;this.displayedMonth=s.getMonth(),this.displayedYear=s.getFullYear(),this.registerEvents()}registerEvents(){this.listeners.forEach(n=>n()),this.listeners=[];let t=this.plugin.emitter.on(tt,()=>{this.refresh()});this.listeners.push(t);let r=this.plugin.emitter.on(Ur,n=>{this.displayedMonth!==n.getMonth()||this.displayedYear!==n.getFullYear()?(this.displayedMonth=n.getMonth(),this.displayedYear=n.getFullYear(),this.clearMonthCalculationCache(),this.colorizeMode==="daily"&&this.plugin.cacheManager.rebuildDailyNotesCache(n.getFullYear(),n.getMonth()),this.refresh()):(this.updateSelectedDate(n),this.updateMonthDisplay())});this.listeners.push(r);let s=this.plugin.emitter.on(Ae,({path:n,originalTask:a,updatedTask:o})=>{if(!n||!o){console.error("EVENT_TASK_UPDATED received invalid data:",{path:n,originalTask:a,updatedTask:o});return}this.handleTaskUpdate(a,o)});this.listeners.push(s)}getViewType(){return Wr}getDisplayText(){return"Mini Calendar"}getIcon(){return"calendar-days"}async onOpen(){await this.plugin.onReady();let t=this.contentEl;t.empty();let r=t.createDiv({cls:"tasknotes-plugin mini-calendar-view"});this.showLoadingIndicator(),this.renderView(r),await this.refresh(),this.registerKeyboardNavigation()}renderView(t){t.empty(),this.createCalendarControls(t),this.createCalendarGrid(t),this.colorizeCalendar()}colorizeCalendar(){switch(this.colorizeMode){case"tasks":this.colorizeCalendarForTasks();break;case"notes":this.colorizeCalendarForNotes();break;case"daily":this.colorizeCalendarForDailyNotes();break}}async navigateToPreviousPeriod(){let t=new Date(this.plugin.selectedDate),r=new Date(t);r.setMonth(r.getMonth()-1),this.plugin.setSelectedDate(r)}async navigateToNextPeriod(){let t=new Date(this.plugin.selectedDate),r=new Date(t);r.setMonth(r.getMonth()+1),this.plugin.setSelectedDate(r)}async navigateToToday(){let t=new Date;this.plugin.setSelectedDate(t)}async onClose(){this.listeners.forEach(t=>t()),this.monthCalculationCache.clear(),this.elementToDateMap.clear(),this.calendarDayElements=null,this.currentCacheKey="",this.contentEl.empty()}registerKeyboardNavigation(){this.registerDomEvent(document,"keydown",async t=>{if(!this.isThisViewActive())return;let r=new Date(this.plugin.selectedDate),s;switch(t.key){case"ArrowLeft":s=new Date(r),s.setDate(r.getDate()-1);break;case"ArrowRight":s=new Date(r),s.setDate(r.getDate()+1);break;case"ArrowUp":s=new Date(r),s.setDate(r.getDate()-7);break;case"ArrowDown":s=new Date(r),s.setDate(r.getDate()+7);break;case"Enter":t.preventDefault(),this.plugin.navigateToDailyNote(r);return;default:return}s&&(t.preventDefault(),this.plugin.setSelectedDate(s))})}isThisViewActive(){return this.app.workspace.getActiveViewOfType(da)===this}navigateDate(t,r){let s=new Date(this.plugin.selectedDate),n=new Date(s);n.setDate(s.getDate()+r*7+t),this.plugin.setSelectedDate(n)}async refresh(){this.showLoadingIndicator();try{let t=this.contentEl.querySelector(".mini-calendar-view");t||(t=this.contentEl.createDiv({cls:"tasknotes-plugin mini-calendar-view"})),this.renderView(t)}finally{this.hideLoadingIndicator()}}updateSelectedDate(t){let r=this.contentEl.querySelectorAll(".mini-calendar-view__day");r.forEach(n=>{n.classList.remove("mini-calendar-view__day--selected"),n.setAttribute("aria-selected","false"),n.setAttribute("tabindex","-1")});let s=k(t,"yyyy-MM-dd");r.forEach(n=>{let a=n;(a.getAttribute("aria-label")||"").includes(k(t,"EEEE, MMMM d, yyyy"))&&(a.classList.add("mini-calendar-view__day--selected"),a.setAttribute("aria-selected","true"),a.setAttribute("tabindex","0"),a.focus())}),this.plugin.selectedDate=t}updateMonthDisplay(){let t=this.contentEl.querySelector(".mini-calendar-view__month-display");t&&(t.textContent=k(this.plugin.selectedDate,"MMMM yyyy"))}showLoadingIndicator(){let t=this.contentEl.querySelector(".mini-calendar-view")||this.contentEl;if(t.querySelector(".cache-loading-indicator"))return;let r=document.createElement("div");r.className="cache-loading-indicator",r.textContent="Loading calendar data...",t.prepend(r)}hideLoadingIndicator(){let t=this.contentEl.querySelector(".cache-loading-indicator");t&&t.remove()}createCalendarControls(t){let s=t.createDiv({cls:"mini-calendar-view__controls"}).createDiv({cls:"mini-calendar-view__header"}),n=s.createEl("select",{cls:"mini-calendar-view__view-selector",attr:{title:"Change view","aria-label":"Change calendar view"}});[{value:"tasks",text:"Tasks"},{value:"notes",text:"Notes"},{value:"daily",text:"Daily notes"}].forEach(f=>{let h=n.createEl("option",{value:f.value,text:f.text});f.value===this.colorizeMode&&(h.selected=!0)}),n.addEventListener("change",async()=>{let f=n.value;this.showLoadingIndicator();try{await this.setColorizeMode(f)}finally{this.hideLoadingIndicator()}});let o=s.createDiv({cls:"mini-calendar-view__navigation"});o.createEl("button",{text:"\u2039",cls:"mini-calendar-view__nav-button mini-calendar-view__nav-button--prev",attr:{"aria-label":"Previous month",title:"Previous month"}}).addEventListener("click",()=>{this.navigateToPreviousPeriod()});let c=o.createDiv({cls:"mini-calendar-view__month-display",text:k(this.plugin.selectedDate,"MMMM yyyy")});o.createEl("button",{text:"\u203A",cls:"mini-calendar-view__nav-button mini-calendar-view__nav-button--next",attr:{"aria-label":"Next month",title:"Next month"}}).addEventListener("click",()=>{this.navigateToNextPeriod()}),s.createEl("button",{text:"Today",cls:"mini-calendar-view__today-button",attr:{"aria-label":"Go to today",title:"Go to today"}}).addEventListener("click",()=>{this.navigateToToday()})}async setColorizeMode(t){if(this.colorizeMode!==t){if(this.colorizeMode=t,t==="daily"){let r=this.plugin.selectedDate.getFullYear(),s=this.plugin.selectedDate.getMonth();await this.plugin.cacheManager.rebuildDailyNotesCache(r,s)}this.colorizeCalendar()}}createCalendarGrid(t){let r=t.createDiv({cls:"mini-calendar-view__grid-container"}),s=r.createEl("a",{cls:"a11y-skip-link",text:"Skip to calendar content",attr:{href:"#calendar-grid","aria-label":"Skip to calendar content"}}),n=this.plugin.selectedDate,a=n.getMonth(),o=n.getFullYear(),l=new Date(o,a,1),c=new Date(o,a+1,0),d=l.getDay(),u=r.createDiv({cls:"mini-calendar-view__grid",attr:{role:"grid","aria-label":`Calendar for ${k(this.plugin.selectedDate,"MMMM yyyy")}`,id:"calendar-grid"}}),f=u.createDiv({cls:"mini-calendar-view__grid-header",attr:{role:"row"}});["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].forEach((S,D)=>{f.createDiv({text:S,cls:"mini-calendar-view__day-header",attr:{role:"columnheader","aria-label":S}})});let m=d,p=42,g=c.getDate(),v=p-g-m,w=new Date(o,a,0).getDate(),_=u.createDiv({cls:"mini-calendar-view__week",attr:{role:"row"}});for(let S=0;S<m;S++){let D=w-m+S+1,A=new Date(o,a-1,D),C=la(A,n),B=_.createDiv({cls:`mini-calendar-view__day mini-calendar-view__day--outside-month${C?" mini-calendar-view__day--selected":""}`,text:D.toString(),attr:{role:"gridcell",tabindex:C?"0":"-1","aria-label":k(A,"EEEE, MMMM d, yyyy"),"aria-selected":C?"true":"false"}});B.addEventListener("click",()=>{this.plugin.setSelectedDate(A)}),B.addEventListener("mouseover",$=>{this.showDayPreview($,A,B)}),B.addEventListener("keydown",$=>{($.key==="Enter"||$.key===" ")&&($.preventDefault(),this.plugin.setSelectedDate(A))}),this.addDropHandlers(B,A)}let E=new Date;for(let S=1;S<=g;S++){(S+m)%7===1&&(_=u.createDiv({cls:"mini-calendar-view__week",attr:{role:"row"}}));let D=new Date(o,a,S),A=la(D,E),C=la(D,n),B="mini-calendar-view__day";A&&(B+=" mini-calendar-view__day--today"),C&&(B+=" mini-calendar-view__day--selected");let $=_.createDiv({cls:B,text:S.toString(),attr:{role:"gridcell",tabindex:C?"0":"-1","aria-label":k(D,"EEEE, MMMM d, yyyy")+(A?" (Today)":""),"aria-selected":C?"true":"false","aria-current":A?"date":null}});$.addEventListener("click",()=>{this.plugin.setSelectedDate(D)}),$.addEventListener("mouseover",K=>{this.showDayPreview(K,D,$)}),$.addEventListener("keydown",K=>{(K.key==="Enter"||K.key===" ")&&(K.preventDefault(),this.plugin.setSelectedDate(D))}),this.addDropHandlers($,D)}for(let S=1;S<=v;S++){(S+m+g)%7===1&&(_=u.createDiv({cls:"mini-calendar-view__week",attr:{role:"row"}}));let D=new Date(o,a+1,S),A=la(D,n),C=_.createDiv({cls:`mini-calendar-view__day mini-calendar-view__day--outside-month${A?" mini-calendar-view__day--selected":""}`,text:S.toString(),attr:{role:"gridcell",tabindex:A?"0":"-1","aria-label":k(D,"EEEE, MMMM d, yyyy"),"aria-selected":A?"true":"false"}});C.addEventListener("click",()=>{this.plugin.setSelectedDate(D)}),C.addEventListener("mouseover",B=>{this.showDayPreview(B,D,C)}),C.addEventListener("keydown",B=>{(B.key==="Enter"||B.key===" ")&&(B.preventDefault(),this.plugin.setSelectedDate(D))}),this.addDropHandlers(C,D)}}clearCalendarColorization(){this.contentEl.querySelectorAll(".mini-calendar-view__day").forEach(r=>{r.querySelectorAll(".note-indicator, .task-indicator, .daily-note-indicator").forEach(s=>s.remove()),r.classList.remove("mini-calendar-view__day--has-notes-few","mini-calendar-view__day--has-notes-some","mini-calendar-view__day--has-notes-many","mini-calendar-view__day--has-tasks","mini-calendar-view__day--has-completed-tasks","mini-calendar-view__day--has-archived-tasks","mini-calendar-view__day--has-scheduled-tasks","mini-calendar-view__day--has-daily-note")})}async colorizeCalendarForNotes(){return sr.measure("calendar-colorize-notes",async()=>{this.clearCalendarColorization();let t=this.plugin.selectedDate.getFullYear(),r=this.plugin.selectedDate.getMonth(),s;try{s=await this.plugin.cacheManager.getCalendarData(t,r)}catch(o){console.warn("Failed to get calendar data from unified cache manager:",o),s=await this.plugin.cacheManager.getCalendarData(t,r)}let n=s.notes;this.contentEl.querySelectorAll(".mini-calendar-view__day").forEach(o=>{let l=o.innerText.trim();if(l){let c=this.plugin.selectedDate.getFullYear(),d=this.plugin.selectedDate.getMonth(),u=parseInt(l);if(isNaN(u))return;let f=d;o.classList.contains("mini-calendar-view__day--outside-month")&&(u>15?f=d===0?11:d-1:f=d===11?0:d+1);let h=tr(c,f,u),m=k(h,"yyyy-MM-dd"),p=n.get(m)||0;if(p>0){let g=document.createElement("div");g.className="note-indicator";let v="";p>=5?(v="many-notes",o.classList.add("mini-calendar-view__day--has-notes-many")):p>=2?(v="some-notes",o.classList.add("mini-calendar-view__day--has-notes-some")):(v="few-notes",o.classList.add("mini-calendar-view__day--has-notes-few")),g.classList.add(v),g.setAttribute("aria-label",`${p} note${p>1?"s":""}`),g.setAttribute("title",`${p} note${p>1?"s":""}`),o.appendChild(g)}}})})}async colorizeCalendarForTasks(){this.clearCalendarColorization();let t=this.plugin.selectedDate.getFullYear(),r=this.plugin.selectedDate.getMonth(),n=(await this.plugin.cacheManager.getCalendarData(t,r)).tasks;this.contentEl.querySelectorAll(".mini-calendar-view__day").forEach(o=>{let l=o.innerText.trim();if(l){let c=this.plugin.selectedDate.getFullYear(),d=this.plugin.selectedDate.getMonth(),u=parseInt(l);if(isNaN(u))return;let f=`${c}-${d}-${u}-${o.classList.contains("mini-calendar-view__day--outside-month")}`,h=this.monthCalculationCache.get(f);if(!h){let g=d;o.classList.contains("mini-calendar-view__day--outside-month")&&(u>15?g=d===0?11:d-1:g=d===11?0:d+1);let v=tr(c,g,u),w=k(v,"yyyy-MM-dd");h={actualMonth:g,dateObj:v,dateKey:w},this.monthCalculationCache.set(f,h)}let{dateKey:m}=h,p=n.get(m);if(p&&(p.hasDue||p.hasScheduled)){let g=document.createElement("div");g.className="task-indicator";let v="";p.hasArchived?(o.classList.add("mini-calendar-view__day--has-archived-tasks"),g.classList.add("archived-tasks"),v="Archived"):p.hasCompleted?(o.classList.add("mini-calendar-view__day--has-completed-tasks"),g.classList.add("completed-tasks"),v="Completed"):p.hasDue?(o.classList.add("mini-calendar-view__day--has-tasks"),g.classList.add("due-tasks"),v="Due"):p.hasScheduled&&(o.classList.add("mini-calendar-view__day--has-scheduled-tasks"),g.classList.add("scheduled-tasks"),v="Scheduled"),g.setAttribute("aria-label",`${v} tasks (${p.count})`),g.setAttribute("title",`${v} tasks (${p.count})`),o.appendChild(g)}}})}async colorizeCalendarForDailyNotes(){this.clearCalendarColorization();let t=this.plugin.selectedDate.getFullYear(),r=this.plugin.selectedDate.getMonth(),s;da.dailyNotesInitialized?s=(await this.plugin.cacheManager.getCalendarData(t,r)).dailyNotes:(s=await this.plugin.cacheManager.rebuildDailyNotesCache(t,r),da.dailyNotesInitialized=!0),this.contentEl.querySelectorAll(".mini-calendar-view__day").forEach(a=>{let o=a.innerText.trim();if(o){let l=this.plugin.selectedDate.getFullYear(),c=this.plugin.selectedDate.getMonth(),d=parseInt(o);if(isNaN(d))return;let u=`${l}-${c}-${d}-${a.classList.contains("mini-calendar-view__day--outside-month")}`,f=this.monthCalculationCache.get(u);if(!f){let m=c;a.classList.contains("mini-calendar-view__day--outside-month")&&(d>15?m=c===0?11:c-1:m=c===11?0:c+1);let p=tr(l,m,d),g=k(p,"yyyy-MM-dd");f={actualMonth:m,dateObj:p,dateKey:g},this.monthCalculationCache.set(u,f)}let h=f.dateKey;if(s.has(h)){let m=document.createElement("div");m.className="daily-note-indicator",a.classList.add("mini-calendar-view__day--has-daily-note"),m.setAttribute("aria-label","Daily note exists"),m.setAttribute("title","Daily note exists"),a.appendChild(m)}}})}handleTaskUpdate(t,r){if(this.colorizeMode!=="tasks")return;let s=new Set;t!=null&&t.due&&s.add(ia(t.due)),r.due&&s.add(ia(r.due)),t!=null&&t.scheduled&&s.add(ia(t.scheduled)),r.scheduled&&s.add(ia(r.scheduled)),s.size!==0&&this.updateCalendarCellsForDates(Array.from(s))}async updateCalendarCellsForDates(t){if(t.length===0)return;let r=this.plugin.selectedDate.getFullYear(),s=this.plugin.selectedDate.getMonth(),a=(await this.plugin.cacheManager.getCalendarData(r,s)).tasks,o=`${r}-${s}`;(this.currentCacheKey!==o||!this.calendarDayElements)&&(this.calendarDayElements=this.contentEl.querySelectorAll(".mini-calendar-view__day"),this.currentCacheKey=o,this.buildElementToDateMap(r,s));let l=new Set(t),c=[],d=t.filter(u=>{let f=new Date(u);return f.getFullYear()===r&&Math.abs(f.getMonth()-s)<=1});for(let[u,f]of this.elementToDateMap)l.has(f.dateKey)&&c.push({element:u,dateKey:f.dateKey});requestAnimationFrame(()=>{c.forEach(({element:u,dateKey:f})=>{this.updateSingleCalendarCell(u,f,a)})})}updateSingleCalendarCell(t,r,s){t.querySelectorAll(".task-indicator").forEach(a=>a.remove()),t.classList.remove("has-tasks","has-scheduled-tasks","has-completed-tasks","has-archived-tasks");let n=s.get(r);if(n&&(n.hasDue||n.hasScheduled)){let a=document.createElement("div");a.className="task-indicator";let o="";n.hasArchived?(t.classList.add("has-archived-tasks"),a.classList.add("archived-tasks"),o="Archived"):n.hasCompleted?(t.classList.add("has-completed-tasks"),a.classList.add("completed-tasks"),o="Completed"):n.hasDue?(t.classList.add("has-tasks"),a.classList.add("due-tasks"),o="Due"):n.hasScheduled&&(t.classList.add("has-scheduled-tasks"),a.classList.add("scheduled-tasks"),o="Scheduled"),a.setAttribute("aria-label",`${o} tasks (${n.count})`),a.setAttribute("title",`${o} tasks (${n.count})`),t.appendChild(a)}}getCellDate(t,r,s,n){let a=n;t.classList.contains("outside-month")&&(r>15?a=n===0?11:n-1:a=n===11?0:n+1);try{return tr(s,a,r)}catch(o){return console.error("Error creating date:",o),null}}buildElementToDateMap(t,r){this.elementToDateMap.clear(),this.calendarDayElements&&this.calendarDayElements.forEach(s=>{let n=s,a=n.innerText.trim();if(!a||isNaN(parseInt(a)))return;let o=parseInt(a),l=this.getCellDate(n,o,t,r);if(l){let c=k(l,"yyyy-MM-dd");this.elementToDateMap.set(s,{date:o,dateKey:c})}})}clearMonthCalculationCache(){let t=`${this.plugin.selectedDate.getFullYear()}-${this.plugin.selectedDate.getMonth()}`;for(let[r]of this.monthCalculationCache)r.startsWith(t)||this.monthCalculationCache.delete(r)}initializeDebouncedRefresh(){this.debouncedRefresh||(this.debouncedRefresh=this.debounce(()=>{this.refresh()},150))}debounce(t,r){let s;return(...n)=>{clearTimeout(s),s=setTimeout(()=>t.apply(this,n),r)}}getViewStartDate(){return tr(this.plugin.selectedDate.getFullYear(),this.plugin.selectedDate.getMonth(),1)}getViewEndDate(){return tr(this.plugin.selectedDate.getFullYear(),this.plugin.selectedDate.getMonth()+1,0)}showDayPreview(t,r,s){let n=this.getDailyNotePath(r),a=this.app.vault.getAbstractFileByPath(n);a&&a instanceof Cr.TFile&&this.app.workspace.trigger("hover-link",{event:t,source:"tasknotes-calendar",hoverParent:this,targetEl:s,linktext:n,sourcePath:n})}getDailyNotePath(t){let r=k(t,"yyyy-MM-dd");return(0,Cr.normalizePath)(`${this.plugin.settings.dailyNotesFolder}/${r}.md`)}addDropHandlers(t,r){t.addEventListener("dragover",s=>{s.preventDefault(),s.dataTransfer.dropEffect="move",t.classList.add("mini-calendar-view__day--dragover")}),t.addEventListener("dragleave",s=>{t.contains(s.relatedTarget)||t.classList.remove("mini-calendar-view__day--dragover")}),t.addEventListener("drop",async s=>{var n,a;s.preventDefault(),s.stopPropagation(),t.classList.remove("mini-calendar-view__day--dragover");try{let o=((n=s.dataTransfer)==null?void 0:n.getData("text/plain"))||((a=s.dataTransfer)==null?void 0:a.getData("application/x-task-path"));if(!o){console.warn("No task path found in drop data");return}let l=await this.plugin.cacheManager.getTaskInfo(o);if(!l){console.warn("Task not found:",o);return}let c=k(r,"yyyy-MM-dd");await this.plugin.taskService.updateProperty(l,"due",c),console.log(`Task "${l.title}" due date set to ${c}`),new Cr.Notice(`Task "${l.title}" due date set to ${k(r,"MMM d, yyyy")}`),this.refresh()}catch(o){console.error("Error handling task drop on mini calendar:",o),new Cr.Notice("Failed to update task due date")}})}},ca=da;ca.dailyNotesInitialized=!1;var ys=require("obsidian");Me();var Sl,U,Xy,Wu,Ri,Fs,Qy,Jy,ev,El={},tv=[],sk=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function ns(i,e){for(var t in e)i[t]=e[t];return i}function rv(i){var e=i.parentNode;e&&e.removeChild(i)}function y(i,e,t){var r,s,n,a={};for(n in e)n=="key"?r=e[n]:n=="ref"?s=e[n]:a[n]=e[n];if(arguments.length>2&&(a.children=arguments.length>3?Sl.call(arguments,2):t),typeof i=="function"&&i.defaultProps!=null)for(n in i.defaultProps)a[n]===void 0&&(a[n]=i.defaultProps[n]);return Tl(i,a,r,s,null)}function Tl(i,e,t,r,s){var n={type:i,props:e,key:t,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s==null?++Xy:s};return s==null&&U.vnode!=null&&U.vnode(n),n}function Se(){return{current:null}}function fe(i){return i.children}function ik(i,e,t,r,s){var n;for(n in t)n==="children"||n==="key"||n in e||kl(i,n,null,t[n],r);for(n in e)s&&typeof e[n]!="function"||n==="children"||n==="key"||n==="value"||n==="checked"||t[n]===e[n]||kl(i,n,e[n],t[n],r)}function Gy(i,e,t){e[0]==="-"?i.setProperty(e,t==null?"":t):i[e]=t==null?"":typeof t!="number"||sk.test(e)?t:t+"px"}function kl(i,e,t,r,s){var n;e:if(e==="style")if(typeof t=="string")i.style.cssText=t;else{if(typeof r=="string"&&(i.style.cssText=r=""),r)for(e in r)t&&e in t||Gy(i.style,e,"");if(t)for(e in t)r&&t[e]===r[e]||Gy(i.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")n=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in i?e.toLowerCase().slice(2):e.slice(2),i.l||(i.l={}),i.l[e+n]=t,t?r||i.addEventListener(e,n?Zy:Ky,n):i.removeEventListener(e,n?Zy:Ky,n);else if(e!=="dangerouslySetInnerHTML"){if(s)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="width"&&e!=="height"&&e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in i)try{i[e]=t==null?"":t;break e}catch(a){}typeof t=="function"||(t==null||t===!1&&e.indexOf("-")==-1?i.removeAttribute(e):i.setAttribute(e,t))}}function Ky(i){Ri=!0;try{return this.l[i.type+!1](U.event?U.event(i):i)}finally{Ri=!1}}function Zy(i){Ri=!0;try{return this.l[i.type+!0](U.event?U.event(i):i)}finally{Ri=!1}}function qe(i,e){this.props=i,this.context=e}function ua(i,e){if(e==null)return i.__?ua(i.__,i.__.__k.indexOf(i)+1):null;for(var t;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null)return t.__e;return typeof i.type=="function"?ua(i):null}function sv(i){var e,t;if((i=i.__)!=null&&i.__c!=null){for(i.__e=i.__c.base=null,e=0;e<i.__k.length;e++)if((t=i.__k[e])!=null&&t.__e!=null){i.__e=i.__c.base=t.__e;break}return sv(i)}}function nk(i){Ri?setTimeout(i):Jy(i)}function Bu(i){(!i.__d&&(i.__d=!0)&&Fs.push(i)&&!Dl.__r++||Qy!==U.debounceRendering)&&((Qy=U.debounceRendering)||nk)(Dl)}function Dl(){var i,e,t,r,s,n,a,o;for(Fs.sort(function(l,c){return l.__v.__b-c.__v.__b});i=Fs.shift();)i.__d&&(e=Fs.length,r=void 0,s=void 0,a=(n=(t=i).__v).__e,(o=t.__P)&&(r=[],(s=ns({},n)).__v=n.__v+1,Uu(o,n,s,t.__n,o.ownerSVGElement!==void 0,n.__h!=null?[a]:null,r,a==null?ua(n):a,n.__h),lv(r,n),n.__e!=a&&sv(n)),Fs.length>e&&Fs.sort(function(l,c){return l.__v.__b-c.__v.__b}));Dl.__r=0}function iv(i,e,t,r,s,n,a,o,l,c){var d,u,f,h,m,p,g,v=r&&r.__k||tv,w=v.length;for(t.__k=[],d=0;d<e.length;d++)if((h=t.__k[d]=(h=e[d])==null||typeof h=="boolean"?null:typeof h=="string"||typeof h=="number"||typeof h=="bigint"?Tl(null,h,null,null,h):Array.isArray(h)?Tl(fe,{children:h},null,null,null):h.__b>0?Tl(h.type,h.props,h.key,h.ref?h.ref:null,h.__v):h)!=null){if(h.__=t,h.__b=t.__b+1,(f=v[d])===null||f&&h.key==f.key&&h.type===f.type)v[d]=void 0;else for(u=0;u<w;u++){if((f=v[u])&&h.key==f.key&&h.type===f.type){v[u]=void 0;break}f=null}Uu(i,h,f=f||El,s,n,a,o,l,c),m=h.__e,(u=h.ref)&&f.ref!=u&&(g||(g=[]),f.ref&&g.push(f.ref,null,h),g.push(u,h.__c||m,h)),m!=null?(p==null&&(p=m),typeof h.type=="function"&&h.__k===f.__k?h.__d=l=nv(h,l,i):l=av(i,h,f,v,m,l),typeof t.type=="function"&&(t.__d=l)):l&&f.__e==l&&l.parentNode!=i&&(l=ua(f))}for(t.__e=p,d=w;d--;)v[d]!=null&&(typeof t.type=="function"&&v[d].__e!=null&&v[d].__e==t.__d&&(t.__d=ov(r).nextSibling),dv(v[d],v[d]));if(g)for(d=0;d<g.length;d++)cv(g[d],g[++d],g[++d])}function nv(i,e,t){for(var r,s=i.__k,n=0;s&&n<s.length;n++)(r=s[n])&&(r.__=i,e=typeof r.type=="function"?nv(r,e,t):av(t,r,r,s,r.__e,e));return e}function fa(i,e){return e=e||[],i==null||typeof i=="boolean"||(Array.isArray(i)?i.some(function(t){fa(t,e)}):e.push(i)),e}function av(i,e,t,r,s,n){var a,o,l;if(e.__d!==void 0)a=e.__d,e.__d=void 0;else if(t==null||s!=n||s.parentNode==null)e:if(n==null||n.parentNode!==i)i.appendChild(s),a=null;else{for(o=n,l=0;(o=o.nextSibling)&&l<r.length;l+=1)if(o==s)break e;i.insertBefore(s,n),a=n}return a!==void 0?a:s.nextSibling}function ov(i){var e,t,r;if(i.type==null||typeof i.type=="string")return i.__e;if(i.__k){for(e=i.__k.length-1;e>=0;e--)if((t=i.__k[e])&&(r=ov(t)))return r}return null}function Uu(i,e,t,r,s,n,a,o,l){var c,d,u,f,h,m,p,g,v,w,_,E,S,D,A,C=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(l=t.__h,o=e.__e=t.__e,e.__h=null,n=[o]),(c=U.__b)&&c(e);try{e:if(typeof C=="function"){if(g=e.props,v=(c=C.contextType)&&r[c.__c],w=c?v?v.props.value:c.__:r,t.__c?p=(d=e.__c=t.__c).__=d.__E:("prototype"in C&&C.prototype.render?e.__c=d=new C(g,w):(e.__c=d=new qe(g,w),d.constructor=C,d.render=ok),v&&v.sub(d),d.props=g,d.state||(d.state={}),d.context=w,d.__n=r,u=d.__d=!0,d.__h=[],d._sb=[]),d.__s==null&&(d.__s=d.state),C.getDerivedStateFromProps!=null&&(d.__s==d.state&&(d.__s=ns({},d.__s)),ns(d.__s,C.getDerivedStateFromProps(g,d.__s))),f=d.props,h=d.state,d.__v=e,u)C.getDerivedStateFromProps==null&&d.componentWillMount!=null&&d.componentWillMount(),d.componentDidMount!=null&&d.__h.push(d.componentDidMount);else{if(C.getDerivedStateFromProps==null&&g!==f&&d.componentWillReceiveProps!=null&&d.componentWillReceiveProps(g,w),!d.__e&&d.shouldComponentUpdate!=null&&d.shouldComponentUpdate(g,d.__s,w)===!1||e.__v===t.__v){for(e.__v!==t.__v&&(d.props=g,d.state=d.__s,d.__d=!1),e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(B){B&&(B.__=e)}),_=0;_<d._sb.length;_++)d.__h.push(d._sb[_]);d._sb=[],d.__h.length&&a.push(d);break e}d.componentWillUpdate!=null&&d.componentWillUpdate(g,d.__s,w),d.componentDidUpdate!=null&&d.__h.push(function(){d.componentDidUpdate(f,h,m)})}if(d.context=w,d.props=g,d.__P=i,E=U.__r,S=0,"prototype"in C&&C.prototype.render){for(d.state=d.__s,d.__d=!1,E&&E(e),c=d.render(d.props,d.state,d.context),D=0;D<d._sb.length;D++)d.__h.push(d._sb[D]);d._sb=[]}else do d.__d=!1,E&&E(e),c=d.render(d.props,d.state,d.context),d.state=d.__s;while(d.__d&&++S<25);d.state=d.__s,d.getChildContext!=null&&(r=ns(ns({},r),d.getChildContext())),u||d.getSnapshotBeforeUpdate==null||(m=d.getSnapshotBeforeUpdate(f,h)),A=c!=null&&c.type===fe&&c.key==null?c.props.children:c,iv(i,Array.isArray(A)?A:[A],e,t,r,s,n,a,o,l),d.base=e.__e,e.__h=null,d.__h.length&&a.push(d),p&&(d.__E=d.__=null),d.__e=!1}else n==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=ak(t.__e,e,t,r,s,n,a,l);(c=U.diffed)&&c(e)}catch(B){e.__v=null,(l||n!=null)&&(e.__e=o,e.__h=!!l,n[n.indexOf(o)]=null),U.__e(B,e,t)}}function lv(i,e){U.__c&&U.__c(e,i),i.some(function(t){try{i=t.__h,t.__h=[],i.some(function(r){r.call(t)})}catch(r){U.__e(r,t.__v)}})}function ak(i,e,t,r,s,n,a,o){var l,c,d,u=t.props,f=e.props,h=e.type,m=0;if(h==="svg"&&(s=!0),n!=null){for(;m<n.length;m++)if((l=n[m])&&"setAttribute"in l==!!h&&(h?l.localName===h:l.nodeType===3)){i=l,n[m]=null;break}}if(i==null){if(h===null)return document.createTextNode(f);i=s?document.createElementNS("http://www.w3.org/2000/svg",h):document.createElement(h,f.is&&f),n=null,o=!1}if(h===null)u===f||o&&i.data===f||(i.data=f);else{if(n=n&&Sl.call(i.childNodes),c=(u=t.props||El).dangerouslySetInnerHTML,d=f.dangerouslySetInnerHTML,!o){if(n!=null)for(u={},m=0;m<i.attributes.length;m++)u[i.attributes[m].name]=i.attributes[m].value;(d||c)&&(d&&(c&&d.__html==c.__html||d.__html===i.innerHTML)||(i.innerHTML=d&&d.__html||""))}if(ik(i,f,u,s,o),d)e.__k=[];else if(m=e.props.children,iv(i,Array.isArray(m)?m:[m],e,t,r,s&&h!=="foreignObject",n,a,n?n[0]:t.__k&&ua(t,0),o),n!=null)for(m=n.length;m--;)n[m]!=null&&rv(n[m]);o||("value"in f&&(m=f.value)!==void 0&&(m!==i.value||h==="progress"&&!m||h==="option"&&m!==u.value)&&kl(i,"value",m,u.value,!1),"checked"in f&&(m=f.checked)!==void 0&&m!==i.checked&&kl(i,"checked",m,u.checked,!1))}return i}function cv(i,e,t){try{typeof i=="function"?i(e):i.current=e}catch(r){U.__e(r,t)}}function dv(i,e,t){var r,s;if(U.unmount&&U.unmount(i),(r=i.ref)&&(r.current&&r.current!==i.__e||cv(r,null,e)),(r=i.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(n){U.__e(n,e)}r.base=r.__P=null,i.__c=void 0}if(r=i.__k)for(s=0;s<r.length;s++)r[s]&&dv(r[s],e,t||typeof i.type!="function");t||i.__e==null||rv(i.__e),i.__=i.__e=i.__d=void 0}function ok(i,e,t){return this.constructor(i,t)}function as(i,e,t){var r,s,n;U.__&&U.__(i,e),s=(r=typeof t=="function")?null:t&&t.__k||e.__k,n=[],Uu(e,i=(!r&&t||e).__k=y(fe,null,[i]),s||El,El,e.ownerSVGElement!==void 0,!r&&t?[t]:s?null:e.firstChild?Sl.call(e.childNodes):null,n,!r&&t?t:s?s.__e:e.firstChild,r),lv(n,i)}function Cl(i,e){var t={__c:e="__cC"+ev++,__:i,Consumer:function(r,s){return r.children(s)},Provider:function(r){var s,n;return this.getChildContext||(s=[],(n={})[e]=this,this.getChildContext=function(){return n},this.shouldComponentUpdate=function(a){this.props.value!==a.value&&s.some(function(o){o.__e=!0,Bu(o)})},this.sub=function(a){s.push(a);var o=a.componentWillUnmount;a.componentWillUnmount=function(){s.splice(s.indexOf(a),1),o&&o.call(a)}}),r.children}};return t.Provider.__=t.Consumer.contextType=t}Sl=tv.slice,U={__e:function(i,e,t,r){for(var s,n,a;e=e.__;)if((s=e.__c)&&!s.__)try{if((n=s.constructor)&&n.getDerivedStateFromError!=null&&(s.setState(n.getDerivedStateFromError(i)),a=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(i,r||{}),a=s.__d),a)return s.__E=s}catch(o){i=o}throw i}},Xy=0,Wu=function(i){return i!=null&&i.constructor===void 0},Ri=!1,qe.prototype.setState=function(i,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=ns({},this.state),typeof i=="function"&&(i=i(ns({},t),this.props)),i&&ns(t,i),i!=null&&this.__v&&(e&&this._sb.push(e),Bu(this))},qe.prototype.forceUpdate=function(i){this.__v&&(this.__e=!0,i&&this.__h.push(i),Bu(this))},qe.prototype.render=fe,Fs=[],Jy=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Dl.__r=0,ev=0;var ck,ir,$u,uv;var vv=[],Vu=[],fv=U.__b,hv=U.__r,pv=U.diffed,mv=U.__c,gv=U.unmount;function dk(){for(var i;i=vv.shift();)if(i.__P&&i.__H)try{i.__H.__h.forEach(_l),i.__H.__h.forEach(zu),i.__H.__h=[]}catch(e){i.__H.__h=[],U.__e(e,i.__v)}}U.__b=function(i){ir=null,fv&&fv(i)},U.__r=function(i){hv&&hv(i),ck=0;var e=(ir=i.__c).__H;e&&($u===ir?(e.__h=[],ir.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=Vu,t.__N=t.i=void 0})):(e.__h.forEach(_l),e.__h.forEach(zu),e.__h=[])),$u=ir},U.diffed=function(i){pv&&pv(i);var e=i.__c;e&&e.__H&&(e.__H.__h.length&&(vv.push(e)!==1&&uv===U.requestAnimationFrame||((uv=U.requestAnimationFrame)||uk)(dk)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==Vu&&(t.__=t.__V),t.i=void 0,t.__V=Vu})),$u=ir=null},U.__c=function(i,e){e.some(function(t){try{t.__h.forEach(_l),t.__h=t.__h.filter(function(r){return!r.__||zu(r)})}catch(r){e.some(function(s){s.__h&&(s.__h=[])}),e=[],U.__e(r,t.__v)}}),mv&&mv(i,e)},U.unmount=function(i){gv&&gv(i);var e,t=i.__c;t&&t.__H&&(t.__H.__.forEach(function(r){try{_l(r)}catch(s){e=s}}),t.__H=void 0,e&&U.__e(e,t.__v))};var yv=typeof requestAnimationFrame=="function";function uk(i){var e,t=function(){clearTimeout(r),yv&&cancelAnimationFrame(e),setTimeout(i)},r=setTimeout(t,100);yv&&(e=requestAnimationFrame(t))}function _l(i){var e=ir,t=i.__c;typeof t=="function"&&(i.__c=void 0,t()),ir=e}function zu(i){var e=ir;i.__c=i.__(),ir=e}function fk(i,e){for(var t in e)i[t]=e[t];return i}function bv(i,e){for(var t in i)if(t!=="__source"&&!(t in e))return!0;for(var r in e)if(r!=="__source"&&i[r]!==e[r])return!0;return!1}function wv(i){this.props=i}(wv.prototype=new qe).isPureReactComponent=!0,wv.prototype.shouldComponentUpdate=function(i,e){return bv(this.props,i)||bv(this.state,e)};var Tv=U.__b;U.__b=function(i){i.type&&i.type.__f&&i.ref&&(i.props.ref=i.ref,i.ref=null),Tv&&Tv(i)};var _V=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;var hk=U.__e;U.__e=function(i,e,t,r){if(i.then){for(var s,n=e;n=n.__;)if((s=n.__c)&&s.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),s.__c(i,e)}hk(i,e,t,r)};var Ev=U.unmount;function xv(i,e,t){return i&&(i.__c&&i.__c.__H&&(i.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),i.__c.__H=null),(i=fk({},i)).__c!=null&&(i.__c.__P===t&&(i.__c.__P=e),i.__c=null),i.__k=i.__k&&i.__k.map(function(r){return xv(r,e,t)})),i}function Mv(i,e,t){return i&&(i.__v=null,i.__k=i.__k&&i.__k.map(function(r){return Mv(r,e,t)}),i.__c&&i.__c.__P===e&&(i.__e&&t.insertBefore(i.__e,i.__d),i.__c.__e=!0,i.__c.__P=t)),i}function ju(){this.__u=0,this.t=null,this.__b=null}function Av(i){var e=i.__.__c;return e&&e.__a&&e.__a(i)}function xl(){this.u=null,this.o=null}U.unmount=function(i){var e=i.__c;e&&e.__R&&e.__R(),e&&i.__h===!0&&(i.type=null),Ev&&Ev(i)},(ju.prototype=new qe).__c=function(i,e){var t=e.__c,r=this;r.t==null&&(r.t=[]),r.t.push(t);var s=Av(r.__v),n=!1,a=function(){n||(n=!0,t.__R=null,s?s(o):o())};t.__R=a;var o=function(){if(!--r.__u){if(r.state.__a){var c=r.state.__a;r.__v.__k[0]=Mv(c,c.__c.__P,c.__c.__O)}var d;for(r.setState({__a:r.__b=null});d=r.t.pop();)d.forceUpdate()}},l=e.__h===!0;r.__u++||l||r.setState({__a:r.__b=r.__v.__k[0]}),i.then(a,a)},ju.prototype.componentWillUnmount=function(){this.t=[]},ju.prototype.render=function(i,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=xv(this.__b,t,r.__O=r.__P)}this.__b=null}var s=e.__a&&y(fe,null,i.fallback);return s&&(s.__h=null),[y(fe,null,e.__a?null:i.children),s]};var kv=function(i,e,t){if(++t[1]===t[0]&&i.o.delete(e),i.props.revealOrder&&(i.props.revealOrder[0]!=="t"||!i.o.size))for(t=i.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;i.u=t=t[2]}};function pk(i){return this.getChildContext=function(){return i.context},i.children}function mk(i){var e=this,t=i.i;e.componentWillUnmount=function(){as(null,e.l),e.l=null,e.i=null},e.i&&e.i!==t&&e.componentWillUnmount(),i.__v?(e.l||(e.i=t,e.l={nodeType:1,parentNode:t,childNodes:[],appendChild:function(r){this.childNodes.push(r),e.i.appendChild(r)},insertBefore:function(r,s){this.childNodes.push(r),e.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),e.i.removeChild(r)}}),as(y(pk,{context:e.context},i.__v),e.l)):e.l&&e.componentWillUnmount()}function Iv(i,e){var t=y(mk,{__v:i,i:e});return t.containerInfo=e,t}(xl.prototype=new qe).__a=function(i){var e=this,t=Av(e.__v),r=e.o.get(i);return r[0]++,function(s){var n=function(){e.props.revealOrder?(r.push(s),kv(e,i,r)):s()};t?t(n):n()}},xl.prototype.render=function(i){this.u=null,this.o=new Map;var e=fa(i.children);i.revealOrder&&i.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return i.children},xl.prototype.componentDidUpdate=xl.prototype.componentDidMount=function(){var i=this;this.o.forEach(function(e,t){kv(i,t,e)})};var gk=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,yk=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,vk=typeof document!="undefined",bk=function(i){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(i)};qe.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(i){Object.defineProperty(qe.prototype,i,{configurable:!0,get:function(){return this["UNSAFE_"+i]},set:function(e){Object.defineProperty(this,i,{configurable:!0,writable:!0,value:e})}})});var Dv=U.event;function wk(){}function Tk(){return this.cancelBubble}function Ek(){return this.defaultPrevented}U.event=function(i){return Dv&&(i=Dv(i)),i.persist=wk,i.isPropagationStopped=Tk,i.isDefaultPrevented=Ek,i.nativeEvent=i};var kk,Sv={configurable:!0,get:function(){return this.class}},Cv=U.vnode;U.vnode=function(i){var e=i.type,t=i.props,r=t;if(typeof e=="string"){var s=e.indexOf("-")===-1;for(var n in r={},t){var a=t[n];vk&&n==="children"&&e==="noscript"||n==="value"&&"defaultValue"in t&&a==null||(n==="defaultValue"&&"value"in t&&t.value==null?n="value":n==="download"&&a===!0?a="":/ondoubleclick/i.test(n)?n="ondblclick":/^onchange(textarea|input)/i.test(n+e)&&!bk(t.type)?n="oninput":/^onfocus$/i.test(n)?n="onfocusin":/^onblur$/i.test(n)?n="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(n)?n=n.toLowerCase():s&&yk.test(n)?n=n.replace(/[A-Z0-9]/g,"-$&").toLowerCase():a===null&&(a=void 0),/^oninput$/i.test(n)&&(n=n.toLowerCase(),r[n]&&(n="oninputCapture")),r[n]=a)}e=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=fa(t.children).forEach(function(o){o.props.selected=r.value.indexOf(o.props.value)!=-1})),e=="select"&&r.defaultValue!=null&&(r.value=fa(t.children).forEach(function(o){o.props.selected=r.multiple?r.defaultValue.indexOf(o.props.value)!=-1:r.defaultValue==o.props.value})),i.props=r,t.class!=t.className&&(Sv.enumerable="className"in t,t.className!=null&&(r.class=t.className),Object.defineProperty(r,"className",Sv))}i.$$typeof=gk,Cv&&Cv(i)};var _v=U.__r;U.__r=function(i){_v&&_v(i),kk=i.__c};var jv=[],rf=new Map;function hs(i){jv.push(i),rf.forEach(e=>{Qv(e,i)})}function qv(i){i.isConnected&&i.getRootNode&&Yv(i.getRootNode())}function Yv(i){let e=rf.get(i);if(!e||!e.isConnected){if(e=i.querySelector("style[data-fullcalendar]"),!e){e=document.createElement("style"),e.setAttribute("data-fullcalendar","");let t=Sk();t&&(e.nonce=t);let r=i===document?document.head:i,s=i===document?r.querySelector("script,link[rel=stylesheet],link[as=style],style"):r.firstChild;r.insertBefore(e,s)}rf.set(i,e),Dk(e)}}function Dk(i){for(let e of jv)Qv(i,e)}function Qv(i,e){let{sheet:t}=i,r=t.cssRules.length;e.split("}").forEach((s,n)=>{s=s.trim(),s&&t.insertRule(s+"}",r+n)})}var qu;function Sk(){return qu===void 0&&(qu=Ck()),qu}function Ck(){let i=document.querySelector('meta[name="csp-nonce"]');if(i&&i.hasAttribute("content"))return i.getAttribute("content");let e=document.querySelector("script[nonce]");return e&&e.nonce||""}typeof document!="undefined"&&Yv(document);var _k=':root{--fc-small-font-size:.85em;--fc-page-bg-color:#fff;--fc-neutral-bg-color:hsla(0,0%,82%,.3);--fc-neutral-text-color:grey;--fc-border-color:#ddd;--fc-button-text-color:#fff;--fc-button-bg-color:#2c3e50;--fc-button-border-color:#2c3e50;--fc-button-hover-bg-color:#1e2b37;--fc-button-hover-border-color:#1a252f;--fc-button-active-bg-color:#1a252f;--fc-button-active-border-color:#151e27;--fc-event-bg-color:#3788d8;--fc-event-border-color:#3788d8;--fc-event-text-color:#fff;--fc-event-selected-overlay-color:rgba(0,0,0,.25);--fc-more-link-bg-color:#d0d0d0;--fc-more-link-text-color:inherit;--fc-event-resizer-thickness:8px;--fc-event-resizer-dot-total-width:8px;--fc-event-resizer-dot-border-width:1px;--fc-non-business-color:hsla(0,0%,84%,.3);--fc-bg-event-color:#8fdf82;--fc-bg-event-opacity:0.3;--fc-highlight-color:rgba(188,232,241,.3);--fc-today-bg-color:rgba(255,220,40,.15);--fc-now-indicator-color:red}.fc-not-allowed,.fc-not-allowed .fc-event{cursor:not-allowed}.fc{display:flex;flex-direction:column;font-size:1em}.fc,.fc *,.fc :after,.fc :before{box-sizing:border-box}.fc table{border-collapse:collapse;border-spacing:0;font-size:1em}.fc th{text-align:center}.fc td,.fc th{padding:0;vertical-align:top}.fc a[data-navlink]{cursor:pointer}.fc a[data-navlink]:hover{text-decoration:underline}.fc-direction-ltr{direction:ltr;text-align:left}.fc-direction-rtl{direction:rtl;text-align:right}.fc-theme-standard td,.fc-theme-standard th{border:1px solid var(--fc-border-color)}.fc-liquid-hack td,.fc-liquid-hack th{position:relative}@font-face{font-family:fcicons;font-style:normal;font-weight:400;src:url("data:application/x-font-ttf;charset=utf-8;base64,AAEAAAALAIAAAwAwT1MvMg8SBfAAAAC8AAAAYGNtYXAXVtKNAAABHAAAAFRnYXNwAAAAEAAAAXAAAAAIZ2x5ZgYydxIAAAF4AAAFNGhlYWQUJ7cIAAAGrAAAADZoaGVhB20DzAAABuQAAAAkaG10eCIABhQAAAcIAAAALGxvY2ED4AU6AAAHNAAAABhtYXhwAA8AjAAAB0wAAAAgbmFtZXsr690AAAdsAAABhnBvc3QAAwAAAAAI9AAAACAAAwPAAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADpBgPA/8AAQAPAAEAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAOAAAAAoACAACAAIAAQAg6Qb//f//AAAAAAAg6QD//f//AAH/4xcEAAMAAQAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAABAWIAjQKeAskAEwAAJSc3NjQnJiIHAQYUFwEWMjc2NCcCnuLiDQ0MJAz/AA0NAQAMJAwNDcni4gwjDQwM/wANIwz/AA0NDCMNAAAAAQFiAI0CngLJABMAACUBNjQnASYiBwYUHwEHBhQXFjI3AZ4BAA0N/wAMJAwNDeLiDQ0MJAyNAQAMIw0BAAwMDSMM4uINIwwNDQAAAAIA4gC3Ax4CngATACcAACUnNzY0JyYiDwEGFB8BFjI3NjQnISc3NjQnJiIPAQYUHwEWMjc2NCcB87e3DQ0MIw3VDQ3VDSMMDQ0BK7e3DQ0MJAzVDQ3VDCQMDQ3zuLcMJAwNDdUNIwzWDAwNIwy4twwkDA0N1Q0jDNYMDA0jDAAAAgDiALcDHgKeABMAJwAAJTc2NC8BJiIHBhQfAQcGFBcWMjchNzY0LwEmIgcGFB8BBwYUFxYyNwJJ1Q0N1Q0jDA0Nt7cNDQwjDf7V1Q0N1QwkDA0Nt7cNDQwkDLfWDCMN1Q0NDCQMt7gMIw0MDNYMIw3VDQ0MJAy3uAwjDQwMAAADAFUAAAOrA1UAMwBoAHcAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMhMjY1NCYjISIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAAVYRGRkR/qoRGRkRA1UFBAUOCQkVDAsZDf2rDRkLDBUJCA4FBQUFBQUOCQgVDAsZDQJVDRkLDBUJCQ4FBAVVAgECBQMCBwQECAX9qwQJAwQHAwMFAQICAgIBBQMDBwQDCQQCVQUIBAQHAgMFAgEC/oAZEhEZGRESGQAAAAADAFUAAAOrA1UAMwBoAIkAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMzFRQWMzI2PQEzMjY1NCYrATU0JiMiBh0BIyIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAgBkSEhmAERkZEYAZEhIZgBEZGREDVQUEBQ4JCRUMCxkN/asNGQsMFQkIDgUFBQUFBQ4JCBUMCxkNAlUNGQsMFQkJDgUEBVUCAQIFAwIHBAQIBf2rBAkDBAcDAwUBAgICAgEFAwMHBAMJBAJVBQgEBAcCAwUCAQL+gIASGRkSgBkSERmAEhkZEoAZERIZAAABAOIAjQMeAskAIAAAExcHBhQXFjI/ARcWMjc2NC8BNzY0JyYiDwEnJiIHBhQX4uLiDQ0MJAzi4gwkDA0N4uINDQwkDOLiDCQMDQ0CjeLiDSMMDQ3h4Q0NDCMN4uIMIw0MDOLiDAwNIwwAAAABAAAAAQAAa5n0y18PPPUACwQAAAAAANivOVsAAAAA2K85WwAAAAADqwNVAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAOrAAEAAAAAAAAAAAAAAAAAAAALBAAAAAAAAAAAAAAAAgAAAAQAAWIEAAFiBAAA4gQAAOIEAABVBAAAVQQAAOIAAAAAAAoAFAAeAEQAagCqAOoBngJkApoAAQAAAAsAigADAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAcAAAABAAAAAAACAAcAYAABAAAAAAADAAcANgABAAAAAAAEAAcAdQABAAAAAAAFAAsAFQABAAAAAAAGAAcASwABAAAAAAAKABoAigADAAEECQABAA4ABwADAAEECQACAA4AZwADAAEECQADAA4APQADAAEECQAEAA4AfAADAAEECQAFABYAIAADAAEECQAGAA4AUgADAAEECQAKADQApGZjaWNvbnMAZgBjAGkAYwBvAG4Ac1ZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMGZjaWNvbnMAZgBjAGkAYwBvAG4Ac2ZjaWNvbnMAZgBjAGkAYwBvAG4Ac1JlZ3VsYXIAUgBlAGcAdQBsAGEAcmZjaWNvbnMAZgBjAGkAYwBvAG4Ac0ZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=") format("truetype")}.fc-icon{speak:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:inline-block;font-family:fcicons!important;font-style:normal;font-variant:normal;font-weight:400;height:1em;line-height:1;text-align:center;text-transform:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:1em}.fc-icon-chevron-left:before{content:"\\e900"}.fc-icon-chevron-right:before{content:"\\e901"}.fc-icon-chevrons-left:before{content:"\\e902"}.fc-icon-chevrons-right:before{content:"\\e903"}.fc-icon-minus-square:before{content:"\\e904"}.fc-icon-plus-square:before{content:"\\e905"}.fc-icon-x:before{content:"\\e906"}.fc .fc-button{border-radius:0;font-family:inherit;font-size:inherit;line-height:inherit;margin:0;overflow:visible;text-transform:none}.fc .fc-button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}.fc .fc-button{-webkit-appearance:button}.fc .fc-button:not(:disabled){cursor:pointer}.fc .fc-button{background-color:transparent;border:1px solid transparent;border-radius:.25em;display:inline-block;font-size:1em;font-weight:400;line-height:1.5;padding:.4em .65em;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle}.fc .fc-button:hover{text-decoration:none}.fc .fc-button:focus{box-shadow:0 0 0 .2rem rgba(44,62,80,.25);outline:0}.fc .fc-button:disabled{opacity:.65}.fc .fc-button-primary{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:hover{background-color:var(--fc-button-hover-bg-color);border-color:var(--fc-button-hover-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:disabled{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button-primary:not(:disabled).fc-button-active,.fc .fc-button-primary:not(:disabled):active{background-color:var(--fc-button-active-bg-color);border-color:var(--fc-button-active-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:not(:disabled).fc-button-active:focus,.fc .fc-button-primary:not(:disabled):active:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button .fc-icon{font-size:1.5em;vertical-align:middle}.fc .fc-button-group{display:inline-flex;position:relative;vertical-align:middle}.fc .fc-button-group>.fc-button{flex:1 1 auto;position:relative}.fc .fc-button-group>.fc-button.fc-button-active,.fc .fc-button-group>.fc-button:active,.fc .fc-button-group>.fc-button:focus,.fc .fc-button-group>.fc-button:hover{z-index:1}.fc-direction-ltr .fc-button-group>.fc-button:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0;margin-left:-1px}.fc-direction-ltr .fc-button-group>.fc-button:not(:last-child){border-bottom-right-radius:0;border-top-right-radius:0}.fc-direction-rtl .fc-button-group>.fc-button:not(:first-child){border-bottom-right-radius:0;border-top-right-radius:0;margin-right:-1px}.fc-direction-rtl .fc-button-group>.fc-button:not(:last-child){border-bottom-left-radius:0;border-top-left-radius:0}.fc .fc-toolbar{align-items:center;display:flex;justify-content:space-between}.fc .fc-toolbar.fc-header-toolbar{margin-bottom:1.5em}.fc .fc-toolbar.fc-footer-toolbar{margin-top:1.5em}.fc .fc-toolbar-title{font-size:1.75em;margin:0}.fc-direction-ltr .fc-toolbar>*>:not(:first-child){margin-left:.75em}.fc-direction-rtl .fc-toolbar>*>:not(:first-child){margin-right:.75em}.fc-direction-rtl .fc-toolbar-ltr{flex-direction:row-reverse}.fc .fc-scroller{-webkit-overflow-scrolling:touch;position:relative}.fc .fc-scroller-liquid{height:100%}.fc .fc-scroller-liquid-absolute{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-scroller-harness{direction:ltr;overflow:hidden;position:relative}.fc .fc-scroller-harness-liquid{height:100%}.fc-direction-rtl .fc-scroller-harness>.fc-scroller{direction:rtl}.fc-theme-standard .fc-scrollgrid{border:1px solid var(--fc-border-color)}.fc .fc-scrollgrid,.fc .fc-scrollgrid table{table-layout:fixed;width:100%}.fc .fc-scrollgrid table{border-left-style:hidden;border-right-style:hidden;border-top-style:hidden}.fc .fc-scrollgrid{border-bottom-width:0;border-collapse:separate;border-right-width:0}.fc .fc-scrollgrid-liquid{height:100%}.fc .fc-scrollgrid-section,.fc .fc-scrollgrid-section table,.fc .fc-scrollgrid-section>td{height:1px}.fc .fc-scrollgrid-section-liquid>td{height:100%}.fc .fc-scrollgrid-section>*{border-left-width:0;border-top-width:0}.fc .fc-scrollgrid-section-footer>*,.fc .fc-scrollgrid-section-header>*{border-bottom-width:0}.fc .fc-scrollgrid-section-body table,.fc .fc-scrollgrid-section-footer table{border-bottom-style:hidden}.fc .fc-scrollgrid-section-sticky>*{background:var(--fc-page-bg-color);position:sticky;z-index:3}.fc .fc-scrollgrid-section-header.fc-scrollgrid-section-sticky>*{top:0}.fc .fc-scrollgrid-section-footer.fc-scrollgrid-section-sticky>*{bottom:0}.fc .fc-scrollgrid-sticky-shim{height:1px;margin-bottom:-1px}.fc-sticky{position:sticky}.fc .fc-view-harness{flex-grow:1;position:relative}.fc .fc-view-harness-active>.fc-view{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-col-header-cell-cushion{display:inline-block;padding:2px 4px}.fc .fc-bg-event,.fc .fc-highlight,.fc .fc-non-business{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-non-business{background:var(--fc-non-business-color)}.fc .fc-bg-event{background:var(--fc-bg-event-color);opacity:var(--fc-bg-event-opacity)}.fc .fc-bg-event .fc-event-title{font-size:var(--fc-small-font-size);font-style:italic;margin:.5em}.fc .fc-highlight{background:var(--fc-highlight-color)}.fc .fc-cell-shaded,.fc .fc-day-disabled{background:var(--fc-neutral-bg-color)}a.fc-event,a.fc-event:hover{text-decoration:none}.fc-event.fc-event-draggable,.fc-event[href]{cursor:pointer}.fc-event .fc-event-main{position:relative;z-index:2}.fc-event-dragging:not(.fc-event-selected){opacity:.75}.fc-event-dragging.fc-event-selected{box-shadow:0 2px 7px rgba(0,0,0,.3)}.fc-event .fc-event-resizer{display:none;position:absolute;z-index:4}.fc-event-selected .fc-event-resizer,.fc-event:hover .fc-event-resizer{display:block}.fc-event-selected .fc-event-resizer{background:var(--fc-page-bg-color);border-color:inherit;border-radius:calc(var(--fc-event-resizer-dot-total-width)/2);border-style:solid;border-width:var(--fc-event-resizer-dot-border-width);height:var(--fc-event-resizer-dot-total-width);width:var(--fc-event-resizer-dot-total-width)}.fc-event-selected .fc-event-resizer:before{bottom:-20px;content:"";left:-20px;position:absolute;right:-20px;top:-20px}.fc-event-selected,.fc-event:focus{box-shadow:0 2px 5px rgba(0,0,0,.2)}.fc-event-selected:before,.fc-event:focus:before{bottom:0;content:"";left:0;position:absolute;right:0;top:0;z-index:3}.fc-event-selected:after,.fc-event:focus:after{background:var(--fc-event-selected-overlay-color);bottom:-1px;content:"";left:-1px;position:absolute;right:-1px;top:-1px;z-index:1}.fc-h-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-h-event .fc-event-main{color:var(--fc-event-text-color)}.fc-h-event .fc-event-main-frame{display:flex}.fc-h-event .fc-event-time{max-width:100%;overflow:hidden}.fc-h-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-width:0}.fc-h-event .fc-event-title{display:inline-block;left:0;max-width:100%;overflow:hidden;right:0;vertical-align:top}.fc-h-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-start),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-end){border-bottom-left-radius:0;border-left-width:0;border-top-left-radius:0}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-end),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-start){border-bottom-right-radius:0;border-right-width:0;border-top-right-radius:0}.fc-h-event:not(.fc-event-selected) .fc-event-resizer{bottom:0;top:0;width:var(--fc-event-resizer-thickness)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end{cursor:w-resize;left:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start{cursor:e-resize;right:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-h-event.fc-event-selected .fc-event-resizer{margin-top:calc(var(--fc-event-resizer-dot-total-width)*-.5);top:50%}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-start,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-end{left:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-end,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-start{right:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc .fc-popover{box-shadow:0 2px 6px rgba(0,0,0,.15);position:absolute;z-index:9999}.fc .fc-popover-header{align-items:center;display:flex;flex-direction:row;justify-content:space-between;padding:3px 4px}.fc .fc-popover-title{margin:0 2px}.fc .fc-popover-close{cursor:pointer;font-size:1.1em;opacity:.65}.fc-theme-standard .fc-popover{background:var(--fc-page-bg-color);border:1px solid var(--fc-border-color)}.fc-theme-standard .fc-popover-header{background:var(--fc-neutral-bg-color)}';hs(_k);var Ws=class{constructor(e){this.drainedOption=e,this.isRunning=!1,this.isDirty=!1,this.pauseDepths={},this.timeoutId=0}request(e){this.isDirty=!0,this.isPaused()||(this.clearTimeout(),e==null?this.tryDrain():this.timeoutId=setTimeout(this.tryDrain.bind(this),e))}pause(e=""){let{pauseDepths:t}=this;t[e]=(t[e]||0)+1,this.clearTimeout()}resume(e="",t){let{pauseDepths:r}=this;e in r&&(t?delete r[e]:(r[e]-=1,r[e]<=0&&delete r[e]),this.tryDrain())}isPaused(){return Object.keys(this.pauseDepths).length}tryDrain(){if(!this.isRunning&&!this.isPaused()){for(this.isRunning=!0;this.isDirty;)this.isDirty=!1,this.drained();this.isRunning=!1}}clear(){this.clearTimeout(),this.isDirty=!1,this.pauseDepths={}}clearTimeout(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=0)}drained(){this.drainedOption&&this.drainedOption()}};function xa(i){i.parentNode&&i.parentNode.removeChild(i)}function Le(i,e){if(i.closest)return i.closest(e);if(!document.documentElement.contains(i))return null;do{if(Yl(i,e))return i;i=i.parentElement||i.parentNode}while(i!==null&&i.nodeType===1);return null}function Yl(i,e){return(i.matches||i.matchesSelector||i.msMatchesSelector).call(i,e)}function Gv(i,e){let t=i instanceof HTMLElement?[i]:i,r=[];for(let s=0;s<t.length;s+=1){let n=t[s].querySelectorAll(e);for(let a=0;a<n.length;a+=1)r.push(n[a])}return r}var xk=/(top|left|right|bottom|width|height)$/i;function Js(i,e){for(let t in e)pf(i,t,e[t])}function pf(i,e,t){t==null?i.style[e]="":typeof t=="number"&&xk.test(e)?i.style[e]=`${t}px`:i.style[e]=t}function Ql(i){var e,t;return(t=(e=i.composedPath)===null||e===void 0?void 0:e.call(i)[0])!==null&&t!==void 0?t:i.target}var Pv=0;function Ir(){return Pv+=1,"fc-dom-"+Pv}function Ma(i){i.preventDefault()}function Mk(i,e){return t=>{let r=Le(t.target,i);r&&e.call(r,t,r)}}function mf(i,e,t,r){let s=Mk(t,r);return i.addEventListener(e,s),()=>{i.removeEventListener(e,s)}}function Kv(i,e,t,r){let s;return mf(i,"mouseover",e,(n,a)=>{if(a!==s){s=a,t(n,a);let o=l=>{s=null,r(l,a),a.removeEventListener("mouseleave",o)};a.addEventListener("mouseleave",o)}})}var Rv=["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"];function gf(i,e){let t=r=>{e(r),Rv.forEach(s=>{i.removeEventListener(s,t)})};Rv.forEach(r=>{i.addEventListener(r,t)})}function Zv(i){return Object.assign({onClick:i},Xv(i))}function Xv(i){return{tabIndex:0,onKeyDown(e){(e.key==="Enter"||e.key===" ")&&(i(e),e.preventDefault())}}}var Nv=0;function Pr(){return Nv+=1,String(Nv)}function Fi(){document.body.classList.add("fc-not-allowed")}function Hi(){document.body.classList.remove("fc-not-allowed")}function yf(i){i.style.userSelect="none",i.style.webkitUserSelect="none",i.addEventListener("selectstart",Ma)}function vf(i){i.style.userSelect="",i.style.webkitUserSelect="",i.removeEventListener("selectstart",Ma)}function bf(i){i.addEventListener("contextmenu",Ma)}function wf(i){i.removeEventListener("contextmenu",Ma)}function Jv(i){let e=[],t=[],r,s;for(typeof i=="string"?t=i.split(/\s*,\s*/):typeof i=="function"?t=[i]:Array.isArray(i)&&(t=i),r=0;r<t.length;r+=1)s=t[r],typeof s=="string"?e.push(s.charAt(0)==="-"?{field:s.substring(1),order:-1}:{field:s,order:1}):typeof s=="function"&&e.push({func:s});return e}function eb(i,e,t){let r,s;for(r=0;r<t.length;r+=1)if(s=Ak(i,e,t[r]),s)return s;return 0}function Ak(i,e,t){return t.func?t.func(i,e):tb(i[t.field],e[t.field])*(t.order||1)}function tb(i,e){return!i&&!e?0:e==null?-1:i==null?1:typeof i=="string"||typeof e=="string"?String(i).localeCompare(String(e)):i-e}function Bs(i,e){let t=String(i);return"000".substr(0,e-t.length)+t}function Bi(i,e,t){return typeof i=="function"?i(...e):typeof i=="string"?e.reduce((r,s,n)=>r.replace("$"+n,s||""),i):t}function Tf(i,e){return i-e}function ha(i){return i%1===0}function Ik(i){let e=i.querySelector(".fc-scrollgrid-shrink-frame"),t=i.querySelector(".fc-scrollgrid-shrink-cushion");if(!e)throw new Error("needs fc-scrollgrid-shrink-frame className");if(!t)throw new Error("needs fc-scrollgrid-shrink-cushion className");return i.getBoundingClientRect().width-e.getBoundingClientRect().width+t.getBoundingClientRect().width}var Ov=["years","months","days","milliseconds"],Pk=/^(-?)(?:(\d+)\.)?(\d+):(\d\d)(?::(\d\d)(?:\.(\d\d\d))?)?/;function j(i,e){return typeof i=="string"?Rk(i):typeof i=="object"&&i?Lv(i):typeof i=="number"?Lv({[e||"milliseconds"]:i}):null}function Rk(i){let e=Pk.exec(i);if(e){let t=e[1]?-1:1;return{years:0,months:0,days:t*(e[2]?parseInt(e[2],10):0),milliseconds:t*((e[3]?parseInt(e[3],10):0)*60*60*1e3+(e[4]?parseInt(e[4],10):0)*60*1e3+(e[5]?parseInt(e[5],10):0)*1e3+(e[6]?parseInt(e[6],10):0))}}return null}function Lv(i){let e={years:i.years||i.year||0,months:i.months||i.month||0,days:i.days||i.day||0,milliseconds:(i.hours||i.hour||0)*60*60*1e3+(i.minutes||i.minute||0)*60*1e3+(i.seconds||i.second||0)*1e3+(i.milliseconds||i.millisecond||i.ms||0)},t=i.weeks||i.week;return t&&(e.days+=t*7,e.specifiedWeeks=!0),e}function Nk(i,e){return i.years===e.years&&i.months===e.months&&i.days===e.days&&i.milliseconds===e.milliseconds}function Aa(i,e){return{years:i.years+e.years,months:i.months+e.months,days:i.days+e.days,milliseconds:i.milliseconds+e.milliseconds}}function rb(i,e){return{years:i.years-e.years,months:i.months-e.months,days:i.days-e.days,milliseconds:i.milliseconds-e.milliseconds}}function Ef(i,e){return{years:i.years*e,months:i.months*e,days:i.days*e,milliseconds:i.milliseconds*e}}function Ok(i){return Ni(i)/365}function Lk(i){return Ni(i)/30}function Ni(i){return ft(i)/864e5}function ft(i){return i.years*(365*864e5)+i.months*(30*864e5)+i.days*864e5+i.milliseconds}function Ia(i,e){let t=null;for(let r=0;r<Ov.length;r+=1){let s=Ov[r];if(e[s]){let n=i[s]/e[s];if(!ha(n)||t!==null&&t!==n)return null;t=n}else if(i[s])return null}return t}function pa(i){let e=i.milliseconds;if(e){if(e%1e3!==0)return{unit:"millisecond",value:e};if(e%(1e3*60)!==0)return{unit:"second",value:e/1e3};if(e%(1e3*60*60)!==0)return{unit:"minute",value:e/(1e3*60)};if(e)return{unit:"hour",value:e/(1e3*60*60)}}return i.days?i.specifiedWeeks&&i.days%7===0?{unit:"week",value:i.days/7}:{unit:"day",value:i.days}:i.months?{unit:"month",value:i.months}:i.years?{unit:"year",value:i.years}:{unit:"millisecond",value:0}}function lr(i,e,t){if(i===e)return!0;let r=i.length,s;if(r!==e.length)return!1;for(s=0;s<r;s+=1)if(!(t?t(i[s],e[s]):i[s]===e[s]))return!1;return!0}var Fk=["sun","mon","tue","wed","thu","fri","sat"];function Gl(i,e){let t=ls(i);return t[2]+=e*7,it(t)}function Fe(i,e){let t=ls(i);return t[2]+=e,it(t)}function nr(i,e){let t=ls(i);return t[6]+=e,it(t)}function kf(i,e){return Rr(i,e)/7}function Rr(i,e){return(e.valueOf()-i.valueOf())/(1e3*60*60*24)}function Hk(i,e){return(e.valueOf()-i.valueOf())/(1e3*60*60)}function Bk(i,e){return(e.valueOf()-i.valueOf())/(1e3*60)}function Wk(i,e){return(e.valueOf()-i.valueOf())/1e3}function sb(i,e){let t=ye(i),r=ye(e);return{years:0,months:0,days:Math.round(Rr(t,r)),milliseconds:e.valueOf()-r.valueOf()-(i.valueOf()-t.valueOf())}}function ib(i,e){let t=Oi(i,e);return t!==null&&t%7===0?t/7:null}function Oi(i,e){return cs(i)===cs(e)?Math.round(Rr(i,e)):null}function ye(i){return it([i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate()])}function Uk(i){return it([i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),i.getUTCHours()])}function $k(i){return it([i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes()])}function Vk(i){return it([i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds()])}function zk(i,e,t){let r=i.getUTCFullYear(),s=Yu(i,r,e,t);if(s<1)return Yu(i,r-1,e,t);let n=Yu(i,r+1,e,t);return n>=1?Math.min(s,n):s}function Yu(i,e,t,r){let s=it([e,0,1+jk(e,t,r)]),n=ye(i),a=Math.round(Rr(s,n));return Math.floor(a/7)+1}function jk(i,e,t){let r=7+e-t;return-((7+it([i,0,r]).getUTCDay()-e)%7)+r-1}function Fv(i){return[i.getFullYear(),i.getMonth(),i.getDate(),i.getHours(),i.getMinutes(),i.getSeconds(),i.getMilliseconds()]}function Hv(i){return new Date(i[0],i[1]||0,i[2]==null?1:i[2],i[3]||0,i[4]||0,i[5]||0)}function ls(i){return[i.getUTCFullYear(),i.getUTCMonth(),i.getUTCDate(),i.getUTCHours(),i.getUTCMinutes(),i.getUTCSeconds(),i.getUTCMilliseconds()]}function it(i){return i.length===1&&(i=i.concat([0])),new Date(Date.UTC(...i))}function Df(i){return!isNaN(i.valueOf())}function cs(i){return i.getUTCHours()*1e3*60*60+i.getUTCMinutes()*1e3*60+i.getUTCSeconds()*1e3+i.getUTCMilliseconds()}function Kl(i,e,t=!1){let r=i.toISOString();return r=r.replace(".000",""),t&&(r=r.replace("T00:00:00Z","")),r.length>10&&(e==null?r=r.replace("Z",""):e!==0&&(r=r.replace("Z",Cf(e,!0)))),r}function Pa(i){return i.toISOString().replace(/T.*$/,"")}function Wi(i){return i.toISOString().match(/^\d{4}-\d{2}/)[0]}function Sf(i){return Bs(i.getUTCHours(),2)+":"+Bs(i.getUTCMinutes(),2)+":"+Bs(i.getUTCSeconds(),2)}function Cf(i,e=!1){let t=i<0?"-":"+",r=Math.abs(i),s=Math.floor(r/60),n=Math.round(r%60);return e?`${t+Bs(s,2)}:${Bs(n,2)}`:`GMT${t}${s}${n?`:${Bs(n,2)}`:""}`}function W(i,e,t){let r,s;return function(...n){if(!r)s=i.apply(this,n);else if(!lr(r,n)){t&&t(s);let a=i.apply(this,n);(!e||!e(a,s))&&(s=a)}return r=n,s}}function Ui(i,e,t){let r,s;return n=>{if(!r)s=i.call(this,n);else if(!et(r,n)){t&&t(s);let a=i.call(this,n);(!e||!e(a,s))&&(s=a)}return r=n,s}}var Qu={week:3,separator:9,omitZeroMinute:9,meridiem:9,omitCommas:9},Ll={timeZoneName:7,era:6,year:5,month:4,day:2,weekday:2,hour:1,minute:1,second:1},Ml=/\s*([ap])\.?m\.?/i,qk=/,/g,Yk=/\s+/g,Qk=/\u200e/g,Gk=/UTC|GMT/,sf=class{constructor(e){let t={},r={},s=9;for(let n in e)n in Qu?(r[n]=e[n],Qu[n]<9&&(s=Math.min(Qu[n],s))):(t[n]=e[n],n in Ll&&(s=Math.min(Ll[n],s)));this.standardDateProps=t,this.extendedSettings=r,this.smallestUnitNum=s,this.buildFormattingFunc=W(Bv)}format(e,t){return this.buildFormattingFunc(this.standardDateProps,this.extendedSettings,t)(e)}formatRange(e,t,r,s){let{standardDateProps:n,extendedSettings:a}=this,o=tD(e.marker,t.marker,r.calendarSystem);if(!o)return this.format(e,r);let l=o;l>1&&(n.year==="numeric"||n.year==="2-digit")&&(n.month==="numeric"||n.month==="2-digit")&&(n.day==="numeric"||n.day==="2-digit")&&(l=1);let c=this.format(e,r),d=this.format(t,r);if(c===d)return c;let u=rD(n,l),f=Bv(u,a,r),h=f(e),m=f(t),p=sD(c,h,d,m),g=a.separator||s||r.defaultSeparator||"";return p?p.before+h+g+m+p.after:c+g+d}getSmallestUnit(){switch(this.smallestUnitNum){case 7:case 6:case 5:return"year";case 4:return"month";case 3:return"week";case 2:return"day";default:return"time"}}};function Bv(i,e,t){let r=Object.keys(i).length;return r===1&&i.timeZoneName==="short"?s=>Cf(s.timeZoneOffset):r===0&&e.week?s=>eD(t.computeWeekNumber(s.marker),t.weekText,t.weekTextLong,t.locale,e.week):Kk(i,e,t)}function Kk(i,e,t){i=Object.assign({},i),e=Object.assign({},e),Zk(i,e),i.timeZone="UTC";let r=new Intl.DateTimeFormat(t.locale.codes,i),s;if(e.omitZeroMinute){let n=Object.assign({},i);delete n.minute,s=new Intl.DateTimeFormat(t.locale.codes,n)}return n=>{let{marker:a}=n,o;s&&!a.getUTCMinutes()?o=s:o=r;let l=o.format(a);return Xk(l,n,i,e,t)}}function Zk(i,e){i.timeZoneName&&(i.hour||(i.hour="2-digit"),i.minute||(i.minute="2-digit")),i.timeZoneName==="long"&&(i.timeZoneName="short"),e.omitZeroMinute&&(i.second||i.millisecond)&&delete e.omitZeroMinute}function Xk(i,e,t,r,s){return i=i.replace(Qk,""),t.timeZoneName==="short"&&(i=Jk(i,s.timeZone==="UTC"||e.timeZoneOffset==null?"UTC":Cf(e.timeZoneOffset))),r.omitCommas&&(i=i.replace(qk,"").trim()),r.omitZeroMinute&&(i=i.replace(":00","")),r.meridiem===!1?i=i.replace(Ml,"").trim():r.meridiem==="narrow"?i=i.replace(Ml,(n,a)=>a.toLocaleLowerCase()):r.meridiem==="short"?i=i.replace(Ml,(n,a)=>`${a.toLocaleLowerCase()}m`):r.meridiem==="lowercase"&&(i=i.replace(Ml,n=>n.toLocaleLowerCase())),i=i.replace(Yk," "),i=i.trim(),i}function Jk(i,e){let t=!1;return i=i.replace(Gk,()=>(t=!0,e)),t||(i+=` ${e}`),i}function eD(i,e,t,r,s){let n=[];return s==="long"?n.push(t):(s==="short"||s==="narrow")&&n.push(e),(s==="long"||s==="short")&&n.push(" "),n.push(r.simpleNumberFormat.format(i)),r.options.direction==="rtl"&&n.reverse(),n.join("")}function tD(i,e,t){return t.getMarkerYear(i)!==t.getMarkerYear(e)?5:t.getMarkerMonth(i)!==t.getMarkerMonth(e)?4:t.getMarkerDay(i)!==t.getMarkerDay(e)?2:cs(i)!==cs(e)?1:0}function rD(i,e){let t={};for(let r in i)(!(r in Ll)||Ll[r]<=e)&&(t[r]=i[r]);return t}function sD(i,e,t,r){let s=0;for(;s<i.length;){let n=i.indexOf(e,s);if(n===-1)break;let a=i.substr(0,n);s=n+e.length;let o=i.substr(s),l=0;for(;l<t.length;){let c=t.indexOf(r,l);if(c===-1)break;let d=t.substr(0,c);l=c+r.length;let u=t.substr(l);if(a===d&&o===u)return{before:a,after:o}}}return null}function Wv(i,e){let t=e.markerToArray(i.marker);return{marker:i.marker,timeZoneOffset:i.timeZoneOffset,array:t,year:t[0],month:t[1],day:t[2],hour:t[3],minute:t[4],second:t[5],millisecond:t[6]}}function Fl(i,e,t,r){let s=Wv(i,t.calendarSystem),n=e?Wv(e,t.calendarSystem):null;return{date:s,start:s,end:n,timeZone:t.timeZone,localeCodes:t.locale.codes,defaultSeparator:r||t.defaultSeparator}}var nf=class{constructor(e){this.cmdStr=e}format(e,t,r){return t.cmdFormatter(this.cmdStr,Fl(e,null,t,r))}formatRange(e,t,r,s){return r.cmdFormatter(this.cmdStr,Fl(e,t,r,s))}},af=class{constructor(e){this.func=e}format(e,t,r){return this.func(Fl(e,null,t,r))}formatRange(e,t,r,s){return this.func(Fl(e,t,r,s))}};function pe(i){return typeof i=="object"&&i?new sf(i):typeof i=="string"?new nf(i):typeof i=="function"?new af(i):null}var _f={navLinkDayClick:T,navLinkWeekClick:T,duration:j,bootstrapFontAwesome:T,buttonIcons:T,customButtons:T,defaultAllDayEventDuration:j,defaultTimedEventDuration:j,nextDayThreshold:j,scrollTime:j,scrollTimeReset:Boolean,slotMinTime:j,slotMaxTime:j,dayPopoverFormat:pe,slotDuration:j,snapDuration:j,headerToolbar:T,footerToolbar:T,defaultRangeSeparator:String,titleRangeSeparator:String,forceEventDuration:Boolean,dayHeaders:Boolean,dayHeaderFormat:pe,dayHeaderClassNames:T,dayHeaderContent:T,dayHeaderDidMount:T,dayHeaderWillUnmount:T,dayCellClassNames:T,dayCellContent:T,dayCellDidMount:T,dayCellWillUnmount:T,initialView:String,aspectRatio:Number,weekends:Boolean,weekNumberCalculation:T,weekNumbers:Boolean,weekNumberClassNames:T,weekNumberContent:T,weekNumberDidMount:T,weekNumberWillUnmount:T,editable:Boolean,viewClassNames:T,viewDidMount:T,viewWillUnmount:T,nowIndicator:Boolean,nowIndicatorClassNames:T,nowIndicatorContent:T,nowIndicatorDidMount:T,nowIndicatorWillUnmount:T,showNonCurrentDates:Boolean,lazyFetching:Boolean,startParam:String,endParam:String,timeZoneParam:String,timeZone:String,locales:T,locale:T,themeSystem:String,dragRevertDuration:Number,dragScroll:Boolean,allDayMaintainDuration:Boolean,unselectAuto:Boolean,dropAccept:T,eventOrder:Jv,eventOrderStrict:Boolean,handleWindowResize:Boolean,windowResizeDelay:Number,longPressDelay:Number,eventDragMinDistance:Number,expandRows:Boolean,height:T,contentHeight:T,direction:String,weekNumberFormat:pe,eventResizableFromStart:Boolean,displayEventTime:Boolean,displayEventEnd:Boolean,weekText:String,weekTextLong:String,progressiveEventRendering:Boolean,businessHours:T,initialDate:T,now:T,eventDataTransform:T,stickyHeaderDates:T,stickyFooterScrollbar:T,viewHeight:T,defaultAllDay:Boolean,eventSourceFailure:T,eventSourceSuccess:T,eventDisplay:String,eventStartEditable:Boolean,eventDurationEditable:Boolean,eventOverlap:T,eventConstraint:T,eventAllow:T,eventBackgroundColor:String,eventBorderColor:String,eventTextColor:String,eventColor:String,eventClassNames:T,eventContent:T,eventDidMount:T,eventWillUnmount:T,selectConstraint:T,selectOverlap:T,selectAllow:T,droppable:Boolean,unselectCancel:String,slotLabelFormat:T,slotLaneClassNames:T,slotLaneContent:T,slotLaneDidMount:T,slotLaneWillUnmount:T,slotLabelClassNames:T,slotLabelContent:T,slotLabelDidMount:T,slotLabelWillUnmount:T,dayMaxEvents:T,dayMaxEventRows:T,dayMinWidth:Number,slotLabelInterval:j,allDayText:String,allDayClassNames:T,allDayContent:T,allDayDidMount:T,allDayWillUnmount:T,slotMinWidth:Number,navLinks:Boolean,eventTimeFormat:pe,rerenderDelay:Number,moreLinkText:T,moreLinkHint:T,selectMinDistance:Number,selectable:Boolean,selectLongPressDelay:Number,eventLongPressDelay:Number,selectMirror:Boolean,eventMaxStack:Number,eventMinHeight:Number,eventMinWidth:Number,eventShortHeight:Number,slotEventOverlap:Boolean,plugins:T,firstDay:Number,dayCount:Number,dateAlignment:String,dateIncrement:j,hiddenDays:T,fixedWeekCount:Boolean,validRange:T,visibleRange:T,titleFormat:T,eventInteractive:Boolean,noEventsText:String,viewHint:T,navLinkHint:T,closeHint:String,timeHint:String,eventHint:String,moreLinkClick:T,moreLinkClassNames:T,moreLinkContent:T,moreLinkDidMount:T,moreLinkWillUnmount:T,monthStartFormat:pe,handleCustomRendering:T,customRenderingMetaMap:T,customRenderingReplaces:Boolean},cr={eventDisplay:"auto",defaultRangeSeparator:" - ",titleRangeSeparator:" \u2013 ",defaultTimedEventDuration:"01:00:00",defaultAllDayEventDuration:{day:1},forceEventDuration:!1,nextDayThreshold:"00:00:00",dayHeaders:!0,initialView:"",aspectRatio:1.35,headerToolbar:{start:"title",center:"",end:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"local",editable:!1,nowIndicator:!1,scrollTime:"06:00:00",scrollTimeReset:!0,slotMinTime:"00:00:00",slotMaxTime:"24:00:00",showNonCurrentDates:!0,lazyFetching:!0,startParam:"start",endParam:"end",timeZoneParam:"timeZone",timeZone:"local",locales:[],locale:"",themeSystem:"standard",dragRevertDuration:500,dragScroll:!0,allDayMaintainDuration:!1,unselectAuto:!0,dropAccept:"*",eventOrder:"start,-duration,allDay,title",dayPopoverFormat:{month:"long",day:"numeric",year:"numeric"},handleWindowResize:!0,windowResizeDelay:100,longPressDelay:1e3,eventDragMinDistance:5,expandRows:!1,navLinks:!1,selectable:!1,eventMinHeight:15,eventMinWidth:30,eventShortHeight:30,monthStartFormat:{month:"long",day:"numeric"}},xf={datesSet:T,eventsSet:T,eventAdd:T,eventChange:T,eventRemove:T,windowResize:T,eventClick:T,eventMouseEnter:T,eventMouseLeave:T,select:T,unselect:T,loading:T,_unmount:T,_beforeprint:T,_afterprint:T,_noEventDrop:T,_noEventResize:T,_resize:T,_scrollRequest:T},Mf={buttonText:T,buttonHints:T,views:T,plugins:T,initialEvents:T,events:T,eventSources:T},ps={headerToolbar:Hs,footerToolbar:Hs,buttonText:Hs,buttonHints:Hs,buttonIcons:Hs,dateIncrement:Hs,plugins:Al,events:Al,eventSources:Al,resources:Al};function Hs(i,e){return typeof i=="object"&&typeof e=="object"&&i&&e?et(i,e):i===e}function Al(i,e){return Array.isArray(i)&&Array.isArray(e)?lr(i,e):i===e}var nb={type:String,component:T,buttonText:String,buttonTextKey:String,dateProfileGeneratorClass:T,usesMinMaxTime:Boolean,classNames:T,content:T,didMount:T,willUnmount:T};function Zl(i){return Xl(i,ps)}function Ra(i,e){let t={},r={};for(let s in e)s in i&&(t[s]=e[s](i[s]));for(let s in i)s in e||(r[s]=i[s]);return{refined:t,extra:r}}function T(i){return i}var{hasOwnProperty:Hl}=Object.prototype;function Xl(i,e){let t={};if(e){for(let r in e)if(e[r]===Hs){let s=[];for(let n=i.length-1;n>=0;n-=1){let a=i[n][r];if(typeof a=="object"&&a)s.unshift(a);else if(a!==void 0){t[r]=a;break}}s.length&&(t[r]=Xl(s))}}for(let r=i.length-1;r>=0;r-=1){let s=i[r];for(let n in s)n in t||(t[n]=s[n])}return t}function _r(i,e){let t={};for(let r in i)e(i[r],r)&&(t[r]=i[r]);return t}function St(i,e){let t={};for(let r in i)t[r]=e(i[r],r);return t}function Af(i){let e={};for(let t of i)e[t]=!0;return e}function Jl(i){let e=[];for(let t in i)e.push(i[t]);return e}function et(i,e){if(i===e)return!0;for(let t in i)if(Hl.call(i,t)&&!(t in e))return!1;for(let t in e)if(Hl.call(e,t)&&i[t]!==e[t])return!1;return!0}var iD=/^on[A-Z]/;function nD(i,e){let t=of(i,e);for(let r of t)if(!iD.test(r))return!1;return!0}function of(i,e){let t=[];for(let r in i)Hl.call(i,r)&&(r in e||t.push(r));for(let r in e)Hl.call(e,r)&&i[r]!==e[r]&&t.push(r);return t}function Nl(i,e,t={}){if(i===e)return!0;for(let r in e)if(!(r in i&&aD(i[r],e[r],t[r])))return!1;for(let r in i)if(!(r in e))return!1;return!0}function aD(i,e,t){return i===e||t===!0?!0:t?t(i,e):!1}function ab(i,e=0,t,r=1){let s=[];t==null&&(t=Object.keys(i).length);for(let n=e;n<t;n+=r){let a=i[n];a!==void 0&&s.push(a)}return s}var ob={};function oD(i,e){ob[i]=e}function lD(i){return new ob[i]}var lf=class{getMarkerYear(e){return e.getUTCFullYear()}getMarkerMonth(e){return e.getUTCMonth()}getMarkerDay(e){return e.getUTCDate()}arrayToMarker(e){return it(e)}markerToArray(e){return ls(e)}};oD("gregory",lf);var cD=/^\s*(\d{4})(-?(\d{2})(-?(\d{2})([T ](\d{2}):?(\d{2})(:?(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/;function lb(i){let e=cD.exec(i);if(e){let t=new Date(Date.UTC(Number(e[1]),e[3]?Number(e[3])-1:0,Number(e[5]||1),Number(e[7]||0),Number(e[8]||0),Number(e[10]||0),e[12]?Number(`0.${e[12]}`)*1e3:0));if(Df(t)){let r=null;return e[13]&&(r=(e[15]==="-"?-1:1)*(Number(e[16]||0)*60+Number(e[18]||0))),{marker:t,isTimeUnspecified:!e[6],timeZoneOffset:r}}}return null}var ma=class{constructor(e){let t=this.timeZone=e.timeZone,r=t!=="local"&&t!=="UTC";e.namedTimeZoneImpl&&r&&(this.namedTimeZoneImpl=new e.namedTimeZoneImpl(t)),this.canComputeOffset=Boolean(!r||this.namedTimeZoneImpl),this.calendarSystem=lD(e.calendarSystem),this.locale=e.locale,this.weekDow=e.locale.week.dow,this.weekDoy=e.locale.week.doy,e.weekNumberCalculation==="ISO"&&(this.weekDow=1,this.weekDoy=4),typeof e.firstDay=="number"&&(this.weekDow=e.firstDay),typeof e.weekNumberCalculation=="function"&&(this.weekNumberFunc=e.weekNumberCalculation),this.weekText=e.weekText!=null?e.weekText:e.locale.options.weekText,this.weekTextLong=(e.weekTextLong!=null?e.weekTextLong:e.locale.options.weekTextLong)||this.weekText,this.cmdFormatter=e.cmdFormatter,this.defaultSeparator=e.defaultSeparator}createMarker(e){let t=this.createMarkerMeta(e);return t===null?null:t.marker}createNowMarker(){return this.canComputeOffset?this.timestampToMarker(new Date().valueOf()):it(Fv(new Date))}createMarkerMeta(e){if(typeof e=="string")return this.parse(e);let t=null;return typeof e=="number"?t=this.timestampToMarker(e):e instanceof Date?(e=e.valueOf(),isNaN(e)||(t=this.timestampToMarker(e))):Array.isArray(e)&&(t=it(e)),t===null||!Df(t)?null:{marker:t,isTimeUnspecified:!1,forcedTzo:null}}parse(e){let t=lb(e);if(t===null)return null;let{marker:r}=t,s=null;return t.timeZoneOffset!==null&&(this.canComputeOffset?r=this.timestampToMarker(r.valueOf()-t.timeZoneOffset*60*1e3):s=t.timeZoneOffset),{marker:r,isTimeUnspecified:t.isTimeUnspecified,forcedTzo:s}}getYear(e){return this.calendarSystem.getMarkerYear(e)}getMonth(e){return this.calendarSystem.getMarkerMonth(e)}getDay(e){return this.calendarSystem.getMarkerDay(e)}add(e,t){let r=this.calendarSystem.markerToArray(e);return r[0]+=t.years,r[1]+=t.months,r[2]+=t.days,r[6]+=t.milliseconds,this.calendarSystem.arrayToMarker(r)}subtract(e,t){let r=this.calendarSystem.markerToArray(e);return r[0]-=t.years,r[1]-=t.months,r[2]-=t.days,r[6]-=t.milliseconds,this.calendarSystem.arrayToMarker(r)}addYears(e,t){let r=this.calendarSystem.markerToArray(e);return r[0]+=t,this.calendarSystem.arrayToMarker(r)}addMonths(e,t){let r=this.calendarSystem.markerToArray(e);return r[1]+=t,this.calendarSystem.arrayToMarker(r)}diffWholeYears(e,t){let{calendarSystem:r}=this;return cs(e)===cs(t)&&r.getMarkerDay(e)===r.getMarkerDay(t)&&r.getMarkerMonth(e)===r.getMarkerMonth(t)?r.getMarkerYear(t)-r.getMarkerYear(e):null}diffWholeMonths(e,t){let{calendarSystem:r}=this;return cs(e)===cs(t)&&r.getMarkerDay(e)===r.getMarkerDay(t)?r.getMarkerMonth(t)-r.getMarkerMonth(e)+(r.getMarkerYear(t)-r.getMarkerYear(e))*12:null}greatestWholeUnit(e,t){let r=this.diffWholeYears(e,t);return r!==null?{unit:"year",value:r}:(r=this.diffWholeMonths(e,t),r!==null?{unit:"month",value:r}:(r=ib(e,t),r!==null?{unit:"week",value:r}:(r=Oi(e,t),r!==null?{unit:"day",value:r}:(r=Hk(e,t),ha(r)?{unit:"hour",value:r}:(r=Bk(e,t),ha(r)?{unit:"minute",value:r}:(r=Wk(e,t),ha(r)?{unit:"second",value:r}:{unit:"millisecond",value:t.valueOf()-e.valueOf()}))))))}countDurationsBetween(e,t,r){let s;return r.years&&(s=this.diffWholeYears(e,t),s!==null)?s/Ok(r):r.months&&(s=this.diffWholeMonths(e,t),s!==null)?s/Lk(r):r.days&&(s=Oi(e,t),s!==null)?s/Ni(r):(t.valueOf()-e.valueOf())/ft(r)}startOf(e,t){return t==="year"?this.startOfYear(e):t==="month"?this.startOfMonth(e):t==="week"?this.startOfWeek(e):t==="day"?ye(e):t==="hour"?Uk(e):t==="minute"?$k(e):t==="second"?Vk(e):null}startOfYear(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e)])}startOfMonth(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e)])}startOfWeek(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e),e.getUTCDate()-(e.getUTCDay()-this.weekDow+7)%7])}computeWeekNumber(e){return this.weekNumberFunc?this.weekNumberFunc(this.toDate(e)):zk(e,this.weekDow,this.weekDoy)}format(e,t,r={}){return t.format({marker:e,timeZoneOffset:r.forcedTzo!=null?r.forcedTzo:this.offsetForMarker(e)},this)}formatRange(e,t,r,s={}){return s.isEndExclusive&&(t=nr(t,-1)),r.formatRange({marker:e,timeZoneOffset:s.forcedStartTzo!=null?s.forcedStartTzo:this.offsetForMarker(e)},{marker:t,timeZoneOffset:s.forcedEndTzo!=null?s.forcedEndTzo:this.offsetForMarker(t)},this,s.defaultSeparator)}formatIso(e,t={}){let r=null;return t.omitTimeZoneOffset||(t.forcedTzo!=null?r=t.forcedTzo:r=this.offsetForMarker(e)),Kl(e,r,t.omitTime)}timestampToMarker(e){return this.timeZone==="local"?it(Fv(new Date(e))):this.timeZone==="UTC"||!this.namedTimeZoneImpl?new Date(e):it(this.namedTimeZoneImpl.timestampToArray(e))}offsetForMarker(e){return this.timeZone==="local"?-Hv(ls(e)).getTimezoneOffset():this.timeZone==="UTC"?0:this.namedTimeZoneImpl?this.namedTimeZoneImpl.offsetForArray(ls(e)):null}toDate(e,t){return this.timeZone==="local"?Hv(ls(e)):this.timeZone==="UTC"?new Date(e.valueOf()):this.namedTimeZoneImpl?new Date(e.valueOf()-this.namedTimeZoneImpl.offsetForArray(ls(e))*1e3*60):new Date(e.valueOf()-(t||0))}},xr=class{constructor(e){this.iconOverrideOption&&this.setIconOverride(e[this.iconOverrideOption])}setIconOverride(e){let t,r;if(typeof e=="object"&&e){t=Object.assign({},this.iconClasses);for(r in e)t[r]=this.applyIconOverridePrefix(e[r]);this.iconClasses=t}else e===!1&&(this.iconClasses={})}applyIconOverridePrefix(e){let t=this.iconOverridePrefix;return t&&e.indexOf(t)!==0&&(e=t+e),e}getClass(e){return this.classes[e]||""}getIconClass(e,t){let r;return t&&this.rtlIconClasses?r=this.rtlIconClasses[e]||this.iconClasses[e]:r=this.iconClasses[e],r?`${this.baseIconClass} ${r}`:""}getCustomButtonIconClass(e){let t;return this.iconOverrideCustomButtonOption&&(t=e[this.iconOverrideCustomButtonOption],t)?`${this.baseIconClass} ${this.applyIconOverridePrefix(t)}`:""}};xr.prototype.classes={};xr.prototype.iconClasses={};xr.prototype.baseIconClass="";xr.prototype.iconOverridePrefix="";function ga(i){i();let e=U.debounceRendering,t=[];function r(s){t.push(s)}for(U.debounceRendering=r,as(y(cf,{}),document.createElement("div"));t.length;)t.shift()();U.debounceRendering=e}var cf=class extends qe{render(){return y("div",{})}componentDidMount(){this.setState({})}};function cb(i){let e=Cl(i),t=e.Provider;return e.Provider=function(){let r=!this.getChildContext,s=t.apply(this,arguments);if(r){let n=[];this.shouldComponentUpdate=a=>{this.props.value!==a.value&&n.forEach(o=>{o.context=a.value,o.forceUpdate()})},this.sub=a=>{n.push(a);let o=a.componentWillUnmount;a.componentWillUnmount=()=>{n.splice(n.indexOf(a),1),o&&o.call(a)}}}return s},e}var Bl=class{constructor(e,t,r,s){this.execFunc=e,this.emitter=t,this.scrollTime=r,this.scrollTimeReset=s,this.handleScrollRequest=n=>{this.queuedRequest=Object.assign({},this.queuedRequest||{},n),this.drain()},t.on("_scrollRequest",this.handleScrollRequest),this.fireInitialScroll()}detach(){this.emitter.off("_scrollRequest",this.handleScrollRequest)}update(e){e&&this.scrollTimeReset?this.fireInitialScroll():this.drain()}fireInitialScroll(){this.handleScrollRequest({time:this.scrollTime})}drain(){this.queuedRequest&&this.execFunc(this.queuedRequest)&&(this.queuedRequest=null)}},_t=cb({});function db(i,e,t,r,s,n,a,o,l,c,d,u,f,h){return{dateEnv:s,nowManager:n,options:t,pluginHooks:o,emitter:d,dispatch:l,getCurrentData:c,calendarApi:u,viewSpec:i,viewApi:e,dateProfileGenerator:r,theme:a,isRtl:t.direction==="rtl",addResizeHandler(m){d.on("_resize",m)},removeResizeHandler(m){d.off("_resize",m)},createScrollResponder(m){return new Bl(m,d,j(t.scrollTime),t.scrollTimeReset)},registerInteractiveComponent:f,unregisterInteractiveComponent:h}}var ar=class extends qe{shouldComponentUpdate(e,t){return this.debug&&console.log(of(e,this.props),of(t,this.state)),!Nl(this.props,e,this.propEquality)||!Nl(this.state,t,this.stateEquality)}safeSetState(e){Nl(this.state,Object.assign(Object.assign({},this.state),e),this.stateEquality)||this.setState(e)}};ar.addPropsEquality=dD;ar.addStateEquality=uD;ar.contextType=_t;ar.prototype.propEquality={};ar.prototype.stateEquality={};var G=class extends ar{};G.contextType=_t;function dD(i){let e=Object.create(this.prototype.propEquality);Object.assign(e,i),this.prototype.propEquality=e}function uD(i){let e=Object.create(this.prototype.stateEquality);Object.assign(e,i),this.prototype.stateEquality=e}function xt(i,e){typeof i=="function"?i(e):i&&(i.current=e)}var ya=class extends G{constructor(){super(...arguments),this.id=Pr(),this.queuedDomNodes=[],this.currentDomNodes=[],this.handleEl=e=>{let{options:t}=this.context,{generatorName:r}=this.props;(!t.customRenderingReplaces||!df(r,t))&&this.updateElRef(e)},this.updateElRef=e=>{this.props.elRef&&xt(this.props.elRef,e)}}render(){let{props:e,context:t}=this,{options:r}=t,{customGenerator:s,defaultGenerator:n,renderProps:a}=e,o=If(e,[],this.handleEl),l=!1,c,d=[],u;if(s!=null){let f=typeof s=="function"?s(a,y):s;if(f===!0)l=!0;else{let h=f&&typeof f=="object";h&&"html"in f?o.dangerouslySetInnerHTML={__html:f.html}:h&&"domNodes"in f?d=Array.prototype.slice.call(f.domNodes):(h?Wu(f):typeof f!="function")?c=f:u=f}}else l=!df(e.generatorName,r);return l&&n&&(c=n(a)),this.queuedDomNodes=d,this.currentGeneratorMeta=u,y(e.elTag,o,c)}componentDidMount(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentDidUpdate(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentWillUnmount(){this.triggerCustomRendering(!1)}triggerCustomRendering(e){var t;let{props:r,context:s}=this,{handleCustomRendering:n,customRenderingMetaMap:a}=s.options;if(n){let o=(t=this.currentGeneratorMeta)!==null&&t!==void 0?t:a==null?void 0:a[r.generatorName];o&&n(Object.assign(Object.assign({id:this.id,isActive:e,containerEl:this.base,reportNewContainerEl:this.updateElRef,generatorMeta:o},r),{elClasses:(r.elClasses||[]).filter(fD)}))}}applyQueueudDomNodes(){let{queuedDomNodes:e,currentDomNodes:t}=this,r=this.base;if(!lr(e,t)){t.forEach(xa);for(let s of e)r.appendChild(s);this.currentDomNodes=e}}};ya.addPropsEquality({elClasses:lr,elStyle:et,elAttrs:nD,renderProps:et});function df(i,e){var t;return Boolean(e.handleCustomRendering&&i&&((t=e.customRenderingMetaMap)===null||t===void 0?void 0:t[i]))}function If(i,e,t){let r=Object.assign(Object.assign({},i.elAttrs),{ref:t});return(i.elClasses||e)&&(r.className=(i.elClasses||[]).concat(e||[]).concat(r.className||[]).filter(Boolean).join(" ")),i.elStyle&&(r.style=i.elStyle),r}function fD(i){return Boolean(i)}var Pf=cb(0),Ve=class extends qe{constructor(){super(...arguments),this.InnerContent=hD.bind(void 0,this),this.handleEl=e=>{this.el=e,this.props.elRef&&(xt(this.props.elRef,e),e&&this.didMountMisfire&&this.componentDidMount())}}render(){let{props:e}=this,t=pD(e.classNameGenerator,e.renderProps);if(e.children){let r=If(e,t,this.handleEl),s=e.children(this.InnerContent,e.renderProps,r);return e.elTag?y(e.elTag,r,s):s}else return y(ya,Object.assign(Object.assign({},e),{elRef:this.handleEl,elTag:e.elTag||"div",elClasses:(e.elClasses||[]).concat(t),renderId:this.context}))}componentDidMount(){var e,t;this.el?(t=(e=this.props).didMount)===null||t===void 0||t.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el})):this.didMountMisfire=!0}componentWillUnmount(){var e,t;(t=(e=this.props).willUnmount)===null||t===void 0||t.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el}))}};Ve.contextType=Pf;function hD(i,e){let t=i.props;return y(ya,Object.assign({renderProps:t.renderProps,generatorName:t.generatorName,customGenerator:t.customGenerator,defaultGenerator:t.defaultGenerator,renderId:i.context},e))}function pD(i,e){let t=typeof i=="function"?i(e):i||[];return typeof t=="string"?[t]:t}var zt=class extends G{render(){let{props:e,context:t}=this,{options:r}=t,s={view:t.viewApi};return y(Ve,Object.assign({},e,{elTag:e.elTag||"div",elClasses:[...Rf(e.viewSpec),...e.elClasses||[]],renderProps:s,classNameGenerator:r.viewClassNames,generatorName:void 0,didMount:r.viewDidMount,willUnmount:r.viewWillUnmount}),()=>e.children)}};function Rf(i){return[`fc-${i.type}-view`,"fc-view"]}function mD(i,e){let t=null,r=null;return i.start&&(t=e.createMarker(i.start)),i.end&&(r=e.createMarker(i.end)),!t&&!r||t&&r&&r<t?null:{start:t,end:r}}function Uv(i,e){let t=[],{start:r}=e,s,n;for(i.sort(gD),s=0;s<i.length;s+=1)n=i[s],n.start>r&&t.push({start:r,end:n.start}),n.end>r&&(r=n.end);return r<e.end&&t.push({start:r,end:e.end}),t}function gD(i,e){return i.start.valueOf()-e.start.valueOf()}function ht(i,e){let{start:t,end:r}=i,s=null;return e.start!==null&&(t===null?t=e.start:t=new Date(Math.max(t.valueOf(),e.start.valueOf()))),e.end!=null&&(r===null?r=e.end:r=new Date(Math.min(r.valueOf(),e.end.valueOf()))),(t===null||r===null||t<r)&&(s={start:t,end:r}),s}function ub(i,e){return(i.start===null?null:i.start.valueOf())===(e.start===null?null:e.start.valueOf())&&(i.end===null?null:i.end.valueOf())===(e.end===null?null:e.end.valueOf())}function ec(i,e){return(i.end===null||e.start===null||i.end>e.start)&&(i.start===null||e.end===null||i.start<e.end)}function $i(i,e){return(i.start===null||e.start!==null&&e.start>=i.start)&&(i.end===null||e.end!==null&&e.end<=i.end)}function Dt(i,e){return(i.start===null||e>=i.start)&&(i.end===null||e<i.end)}function yD(i,e){return e.start!=null&&i<e.start?e.start:e.end!=null&&i>=e.end?new Date(e.end.valueOf()-1):i}function fb(i){let e=Math.floor(Rr(i.start,i.end))||1,t=ye(i.start),r=Fe(t,e);return{start:t,end:r}}function Nf(i,e=j(0)){let t=null,r=null;if(i.end){r=ye(i.end);let s=i.end.valueOf()-r.valueOf();s&&s>=ft(e)&&(r=Fe(r,1))}return i.start&&(t=ye(i.start),r&&r<=t&&(r=Fe(t,1))),{start:t,end:r}}function ds(i,e,t,r){return r==="year"?j(t.diffWholeYears(i,e),"year"):r==="month"?j(t.diffWholeMonths(i,e),"month"):sb(i,e)}var Us=class{constructor(e){this.props=e,this.initHiddenDays()}buildPrev(e,t,r){let{dateEnv:s}=this.props,n=s.subtract(s.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(n,-1,r)}buildNext(e,t,r){let{dateEnv:s}=this.props,n=s.add(s.startOf(t,e.currentRangeUnit),e.dateIncrement);return this.build(n,1,r)}build(e,t,r=!0){let{props:s}=this,n,a,o,l,c,d;return n=this.buildValidRange(),n=this.trimHiddenDays(n),r&&(e=yD(e,n)),a=this.buildCurrentRangeInfo(e,t),o=/^(year|month|week|day)$/.test(a.unit),l=this.buildRenderRange(this.trimHiddenDays(a.range),a.unit,o),l=this.trimHiddenDays(l),c=l,s.showNonCurrentDates||(c=ht(c,a.range)),c=this.adjustActiveRange(c),c=ht(c,n),d=ec(a.range,n),Dt(l,e)||(e=l.start),{currentDate:e,validRange:n,currentRange:a.range,currentRangeUnit:a.unit,isRangeAllDay:o,activeRange:c,renderRange:l,slotMinTime:s.slotMinTime,slotMaxTime:s.slotMaxTime,isValid:d,dateIncrement:this.buildDateIncrement(a.duration)}}buildValidRange(){let e=this.props.validRangeInput,t=typeof e=="function"?e.call(this.props.calendarApi,this.props.dateEnv.toDate(this.props.nowManager.getDateMarker())):e;return this.refineRange(t)||{start:null,end:null}}buildCurrentRangeInfo(e,t){let{props:r}=this,s=null,n=null,a=null,o;return r.duration?(s=r.duration,n=r.durationUnit,a=this.buildRangeFromDuration(e,t,s,n)):(o=this.props.dayCount)?(n="day",a=this.buildRangeFromDayCount(e,t,o)):(a=this.buildCustomVisibleRange(e))?n=r.dateEnv.greatestWholeUnit(a.start,a.end).unit:(s=this.getFallbackDuration(),n=pa(s).unit,a=this.buildRangeFromDuration(e,t,s,n)),{duration:s,unit:n,range:a}}getFallbackDuration(){return j({day:1})}adjustActiveRange(e){let{dateEnv:t,usesMinMaxTime:r,slotMinTime:s,slotMaxTime:n}=this.props,{start:a,end:o}=e;return r&&(Ni(s)<0&&(a=ye(a),a=t.add(a,s)),Ni(n)>1&&(o=ye(o),o=Fe(o,-1),o=t.add(o,n))),{start:a,end:o}}buildRangeFromDuration(e,t,r,s){let{dateEnv:n,dateAlignment:a}=this.props,o,l,c;if(!a){let{dateIncrement:u}=this.props;u&&ft(u)<ft(r)?a=pa(u).unit:a=s}Ni(r)<=1&&this.isHiddenDay(o)&&(o=this.skipHiddenDays(o,t),o=ye(o));function d(){o=n.startOf(e,a),l=n.add(o,r),c={start:o,end:l}}return d(),this.trimHiddenDays(c)||(e=this.skipHiddenDays(e,t),d()),c}buildRangeFromDayCount(e,t,r){let{dateEnv:s,dateAlignment:n}=this.props,a=0,o=e,l;n&&(o=s.startOf(o,n)),o=ye(o),o=this.skipHiddenDays(o,t),l=o;do l=Fe(l,1),this.isHiddenDay(l)||(a+=1);while(a<r);return{start:o,end:l}}buildCustomVisibleRange(e){let{props:t}=this,r=t.visibleRangeInput,s=typeof r=="function"?r.call(t.calendarApi,t.dateEnv.toDate(e)):r,n=this.refineRange(s);return n&&(n.start==null||n.end==null)?null:n}buildRenderRange(e,t,r){return e}buildDateIncrement(e){let{dateIncrement:t}=this.props,r;return t||((r=this.props.dateAlignment)?j(1,r):e||j({days:1}))}refineRange(e){if(e){let t=mD(e,this.props.dateEnv);return t&&(t=Nf(t)),t}return null}initHiddenDays(){let e=this.props.hiddenDays||[],t=[],r=0,s;for(this.props.weekends===!1&&e.push(0,6),s=0;s<7;s+=1)(t[s]=e.indexOf(s)!==-1)||(r+=1);if(!r)throw new Error("invalid hiddenDays");this.isHiddenDayHash=t}trimHiddenDays(e){let{start:t,end:r}=e;return t&&(t=this.skipHiddenDays(t)),r&&(r=this.skipHiddenDays(r,-1,!0)),t==null||r==null||t<r?{start:t,end:r}:null}isHiddenDay(e){return e instanceof Date&&(e=e.getUTCDay()),this.isHiddenDayHash[e]}skipHiddenDays(e,t=1,r=!1){for(;this.isHiddenDayHash[(e.getUTCDay()+(r?t:0)+7)%7];)e=Fe(e,t);return e}};function Vi(i,e,t,r){return{instanceId:Pr(),defId:i,range:e,forcedStartTzo:t==null?null:t,forcedEndTzo:r==null?null:r}}function vD(i,e,t,r){for(let s=0;s<r.length;s+=1){let n=r[s].parse(i,t);if(n){let{allDay:a}=i;return a==null&&(a=e,a==null&&(a=n.allDayGuess,a==null&&(a=!1))),{allDay:a,duration:n.duration,typeData:n.typeData,typeId:s}}}return null}function $s(i,e,t){let{dateEnv:r,pluginHooks:s,options:n}=t,{defs:a,instances:o}=i;o=_r(o,l=>!a[l.defId].recurringDef);for(let l in a){let c=a[l];if(c.recurringDef){let{duration:d}=c.recurringDef;d||(d=c.allDay?n.defaultAllDayEventDuration:n.defaultTimedEventDuration);let u=bD(c,d,e,r,s.recurringTypes);for(let f of u){let h=Vi(l,{start:f,end:r.add(f,d)});o[h.instanceId]=h}}}return{defs:a,instances:o}}function bD(i,e,t,r,s){let a=s[i.recurringDef.typeId].expand(i.recurringDef.typeData,{start:r.subtract(t.start,e),end:t.end},r);return i.allDay&&(a=a.map(ye)),a}var Ol={id:String,groupId:String,title:String,url:String,interactive:Boolean},hb={start:T,end:T,date:T,allDay:Boolean},wD=Object.assign(Object.assign(Object.assign({},Ol),hb),{extendedProps:T});function pb(i,e,t,r,s=Of(t),n,a){let{refined:o,extra:l}=Na(i,t,s),c=ED(e,t),d=vD(o,c,t.dateEnv,t.pluginHooks.recurringTypes);if(d){let f=Li(o,l,e?e.sourceId:"",d.allDay,Boolean(d.duration),t,n);return f.recurringDef={typeId:d.typeId,typeData:d.typeData,duration:d.duration},{def:f,instance:null}}let u=TD(o,c,t,r);if(u){let f=Li(o,l,e?e.sourceId:"",u.allDay,u.hasEnd,t,n),h=Vi(f.defId,u.range,u.forcedStartTzo,u.forcedEndTzo);return a&&f.publicId&&a[f.publicId]&&(h.instanceId=a[f.publicId]),{def:f,instance:h}}return null}function Na(i,e,t=Of(e)){return Ra(i,t)}function Of(i){return Object.assign(Object.assign(Object.assign({},Wl),wD),i.pluginHooks.eventRefiners)}function Li(i,e,t,r,s,n,a){let o={title:i.title||"",groupId:i.groupId||"",publicId:i.id||"",url:i.url||"",recurringDef:null,defId:(a&&i.id?a[i.id]:"")||Pr(),sourceId:t,allDay:r,hasEnd:s,interactive:i.interactive,ui:zi(i,n),extendedProps:Object.assign(Object.assign({},i.extendedProps||{}),e)};for(let l of n.pluginHooks.eventDefMemberAdders)Object.assign(o,l(i));return Object.freeze(o.ui.classNames),Object.freeze(o.extendedProps),o}function TD(i,e,t,r){let{allDay:s}=i,n,a=null,o=!1,l,c=null,d=i.start!=null?i.start:i.date;if(n=t.dateEnv.createMarkerMeta(d),n)a=n.marker;else if(!r)return null;return i.end!=null&&(l=t.dateEnv.createMarkerMeta(i.end)),s==null&&(e!=null?s=e:s=(!n||n.isTimeUnspecified)&&(!l||l.isTimeUnspecified)),s&&a&&(a=ye(a)),l&&(c=l.marker,s&&(c=ye(c)),a&&c<=a&&(c=null)),c?o=!0:r||(o=t.options.forceEventDuration||!1,c=t.dateEnv.add(a,s?t.options.defaultAllDayEventDuration:t.options.defaultTimedEventDuration)),{allDay:s,hasEnd:o,range:{start:a,end:c},forcedStartTzo:n?n.forcedTzo:null,forcedEndTzo:l?l.forcedTzo:null}}function ED(i,e){let t=null;return i&&(t=i.defaultAllDay),t==null&&(t=e.options.defaultAllDay),t}function va(i,e,t,r,s,n){let a=He(),o=Of(t);for(let l of i){let c=pb(l,e,t,r,o,s,n);c&&Vs(c,a)}return a}function Vs(i,e=He()){return e.defs[i.def.defId]=i.def,i.instance&&(e.instances[i.instance.instanceId]=i.instance),e}function Oa(i,e){let t=i.instances[e];if(t){let r=i.defs[t.defId],s=rc(i,n=>kD(r,n));return s.defs[r.defId]=r,s.instances[t.instanceId]=t,s}return He()}function kD(i,e){return Boolean(i.groupId&&i.groupId===e.groupId)}function He(){return{defs:{},instances:{}}}function tc(i,e){return{defs:Object.assign(Object.assign({},i.defs),e.defs),instances:Object.assign(Object.assign({},i.instances),e.instances)}}function rc(i,e){let t=_r(i.defs,e),r=_r(i.instances,s=>t[s.defId]);return{defs:t,instances:r}}function DD(i,e){let{defs:t,instances:r}=i,s={},n={};for(let a in t)e.defs[a]||(s[a]=t[a]);for(let a in r)!e.instances[a]&&s[r[a].defId]&&(n[a]=r[a]);return{defs:s,instances:n}}function SD(i,e){return Array.isArray(i)?va(i,null,e,!0):typeof i=="object"&&i?va([i],null,e,!0):i!=null?String(i):null}function uf(i){return Array.isArray(i)?i:typeof i=="string"?i.split(/\s+/):[]}var Wl={display:String,editable:Boolean,startEditable:Boolean,durationEditable:Boolean,constraint:T,overlap:T,allow:T,className:uf,classNames:uf,color:String,backgroundColor:String,borderColor:String,textColor:String},CD={display:null,startEditable:null,durationEditable:null,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]};function zi(i,e){let t=SD(i.constraint,e);return{display:i.display||null,startEditable:i.startEditable!=null?i.startEditable:i.editable,durationEditable:i.durationEditable!=null?i.durationEditable:i.editable,constraints:t!=null?[t]:[],overlap:i.overlap!=null?i.overlap:null,allows:i.allow!=null?[i.allow]:[],backgroundColor:i.backgroundColor||i.color||"",borderColor:i.borderColor||i.color||"",textColor:i.textColor||"",classNames:(i.className||[]).concat(i.classNames||[])}}function Lf(i){return i.reduce(_D,CD)}function _D(i,e){return{display:e.display!=null?e.display:i.display,startEditable:e.startEditable!=null?e.startEditable:i.startEditable,durationEditable:e.durationEditable!=null?e.durationEditable:i.durationEditable,constraints:i.constraints.concat(e.constraints),overlap:typeof e.overlap=="boolean"?e.overlap:i.overlap,allows:i.allows.concat(e.allows),backgroundColor:e.backgroundColor||i.backgroundColor,borderColor:e.borderColor||i.borderColor,textColor:e.textColor||i.textColor,classNames:i.classNames.concat(e.classNames)}}var xD={id:String,defaultAllDay:Boolean,url:String,format:String,events:T,eventDataTransform:T,success:T,failure:T};function Ff(i,e,t=Hf(e)){let r;if(typeof i=="string"?r={url:i}:typeof i=="function"||Array.isArray(i)?r={events:i}:typeof i=="object"&&i&&(r=i),r){let{refined:s,extra:n}=Ra(r,t),a=MD(s,e);if(a)return{_raw:i,isFetching:!1,latestFetchId:"",fetchRange:null,defaultAllDay:s.defaultAllDay,eventDataTransform:s.eventDataTransform,success:s.success,failure:s.failure,publicId:s.id||"",sourceId:Pr(),sourceDefId:a.sourceDefId,meta:a.meta,ui:zi(s,e),extendedProps:n}}return null}function Hf(i){return Object.assign(Object.assign(Object.assign({},Wl),xD),i.pluginHooks.eventSourceRefiners)}function MD(i,e){let t=e.pluginHooks.eventSourceDefs;for(let r=t.length-1;r>=0;r-=1){let n=t[r].parseMeta(i);if(n)return{sourceDefId:r,meta:n}}return null}function mb(i,e,t,r,s){switch(e.type){case"RECEIVE_EVENTS":return AD(i,t[e.sourceId],e.fetchId,e.fetchRange,e.rawEvents,s);case"RESET_RAW_EVENTS":return ID(i,t[e.sourceId],e.rawEvents,r.activeRange,s);case"ADD_EVENTS":return PD(i,e.eventStore,r?r.activeRange:null,s);case"RESET_EVENTS":return e.eventStore;case"MERGE_EVENTS":return tc(i,e.eventStore);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return r?$s(i,r.activeRange,s):i;case"REMOVE_EVENTS":return DD(i,e.eventStore);case"REMOVE_EVENT_SOURCE":return yb(i,e.sourceId);case"REMOVE_ALL_EVENT_SOURCES":return rc(i,n=>!n.sourceId);case"REMOVE_ALL_EVENTS":return He();default:return i}}function AD(i,e,t,r,s,n){if(e&&t===e.latestFetchId){let a=va(gb(s,e,n),e,n);return r&&(a=$s(a,r,n)),tc(yb(i,e.sourceId),a)}return i}function ID(i,e,t,r,s){let{defIdMap:n,instanceIdMap:a}=ND(i),o=va(gb(t,e,s),e,s,!1,n,a);return $s(o,r,s)}function gb(i,e,t){let r=t.options.eventDataTransform,s=e?e.eventDataTransform:null;return s&&(i=$v(i,s)),r&&(i=$v(i,r)),i}function $v(i,e){let t;if(!e)t=i;else{t=[];for(let r of i){let s=e(r);s?t.push(s):s==null&&t.push(r)}}return t}function PD(i,e,t,r){return t&&(e=$s(e,t,r)),tc(i,e)}function Bf(i,e,t){let{defs:r}=i,s=St(i.instances,n=>r[n.defId].allDay?n:Object.assign(Object.assign({},n),{range:{start:t.createMarker(e.toDate(n.range.start,n.forcedStartTzo)),end:t.createMarker(e.toDate(n.range.end,n.forcedEndTzo))},forcedStartTzo:t.canComputeOffset?null:n.forcedStartTzo,forcedEndTzo:t.canComputeOffset?null:n.forcedEndTzo}));return{defs:r,instances:s}}function yb(i,e){return rc(i,t=>t.sourceId!==e)}function RD(i,e){return{defs:i.defs,instances:_r(i.instances,t=>!e[t.instanceId])}}function ND(i){let{defs:e,instances:t}=i,r={},s={};for(let n in e){let a=e[n],{publicId:o}=a;o&&(r[o]=n)}for(let n in t){let a=t[n],o=e[a.defId],{publicId:l}=o;l&&(s[l]=n)}return{defIdMap:r,instanceIdMap:s}}var Mr=class{constructor(){this.handlers={},this.thisContext=null}setThisContext(e){this.thisContext=e}setOptions(e){this.options=e}on(e,t){OD(this.handlers,e,t)}off(e,t){LD(this.handlers,e,t)}trigger(e,...t){let r=this.handlers[e]||[],s=this.options&&this.options[e],n=[].concat(s||[],r);for(let a of n)a.apply(this.thisContext,t)}hasHandlers(e){return Boolean(this.handlers[e]&&this.handlers[e].length||this.options&&this.options[e])}};function OD(i,e,t){(i[e]||(i[e]=[])).push(t)}function LD(i,e,t){t?i[e]&&(i[e]=i[e].filter(r=>r!==t)):delete i[e]}var FD={startTime:"09:00",endTime:"17:00",daysOfWeek:[1,2,3,4,5],display:"inverse-background",classNames:"fc-non-business",groupId:"_businessHours"};function Wf(i,e){return va(HD(i),null,e)}function HD(i){let e;return i===!0?e=[{}]:Array.isArray(i)?e=i.filter(t=>t.daysOfWeek):typeof i=="object"&&i?e=[i]:e=[],e=e.map(t=>Object.assign(Object.assign({},FD),t)),e}function sc(i,e,t){t.emitter.trigger("select",Object.assign(Object.assign({},Uf(i,t)),{jsEvent:e?e.origEvent:null,view:t.viewApi||t.calendarApi.view}))}function BD(i,e){e.emitter.trigger("unselect",{jsEvent:i?i.origEvent:null,view:e.viewApi||e.calendarApi.view})}function Uf(i,e){let t={};for(let r of e.pluginHooks.dateSpanTransforms)Object.assign(t,r(i,e));return Object.assign(t,ZD(i,e.dateEnv)),t}function ba(i,e,t){let{dateEnv:r,options:s}=t,n=e;return i?(n=ye(n),n=r.add(n,s.defaultAllDayEventDuration)):n=r.add(n,s.defaultTimedEventDuration),n}function La(i,e,t,r){let s=$l(i.defs,e),n=He();for(let a in i.defs){let o=i.defs[a];n.defs[a]=WD(o,s[a],t,r)}for(let a in i.instances){let o=i.instances[a],l=n.defs[o.defId];n.instances[a]=UD(o,l,s[o.defId],t,r)}return n}function WD(i,e,t,r){let s=t.standardProps||{};s.hasEnd==null&&e.durationEditable&&(t.startDelta||t.endDelta)&&(s.hasEnd=!0);let n=Object.assign(Object.assign(Object.assign({},i),s),{ui:Object.assign(Object.assign({},i.ui),s.ui)});t.extendedProps&&(n.extendedProps=Object.assign(Object.assign({},n.extendedProps),t.extendedProps));for(let a of r.pluginHooks.eventDefMutationAppliers)a(n,t,r);return!n.hasEnd&&r.options.forceEventDuration&&(n.hasEnd=!0),n}function UD(i,e,t,r,s){let{dateEnv:n}=s,a=r.standardProps&&r.standardProps.allDay===!0,o=r.standardProps&&r.standardProps.hasEnd===!1,l=Object.assign({},i);return a&&(l.range=fb(l.range)),r.datesDelta&&t.startEditable&&(l.range={start:n.add(l.range.start,r.datesDelta),end:n.add(l.range.end,r.datesDelta)}),r.startDelta&&t.durationEditable&&(l.range={start:n.add(l.range.start,r.startDelta),end:l.range.end}),r.endDelta&&t.durationEditable&&(l.range={start:l.range.start,end:n.add(l.range.end,r.endDelta)}),o&&(l.range={start:l.range.start,end:ba(e.allDay,l.range.start,s)}),e.allDay&&(l.range={start:ye(l.range.start),end:ye(l.range.end)}),l.range.end<l.range.start&&(l.range.end=ba(e.allDay,l.range.start,s)),l}var os=class{constructor(e,t){this.context=e,this.internalEventSource=t}remove(){this.context.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:this.internalEventSource.sourceId})}refetch(){this.context.dispatch({type:"FETCH_EVENT_SOURCES",sourceIds:[this.internalEventSource.sourceId],isRefetch:!0})}get id(){return this.internalEventSource.publicId}get url(){return this.internalEventSource.meta.url}get format(){return this.internalEventSource.meta.format}},ve=class{constructor(e,t,r){this._context=e,this._def=t,this._instance=r||null}setProp(e,t){if(e in hb)console.warn("Could not set date-related prop 'name'. Use one of the date-related methods instead.");else if(e==="id")t=Ol[e](t),this.mutate({standardProps:{publicId:t}});else if(e in Ol)t=Ol[e](t),this.mutate({standardProps:{[e]:t}});else if(e in Wl){let r=Wl[e](t);e==="color"?r={backgroundColor:t,borderColor:t}:e==="editable"?r={startEditable:t,durationEditable:t}:r={[e]:t},this.mutate({standardProps:{ui:r}})}else console.warn(`Could not set prop '${e}'. Use setExtendedProp instead.`)}setExtendedProp(e,t){this.mutate({extendedProps:{[e]:t}})}setStart(e,t={}){let{dateEnv:r}=this._context,s=r.createMarker(e);if(s&&this._instance){let n=this._instance.range,a=ds(n.start,s,r,t.granularity);t.maintainDuration?this.mutate({datesDelta:a}):this.mutate({startDelta:a})}}setEnd(e,t={}){let{dateEnv:r}=this._context,s;if(!(e!=null&&(s=r.createMarker(e),!s))&&this._instance)if(s){let n=ds(this._instance.range.end,s,r,t.granularity);this.mutate({endDelta:n})}else this.mutate({standardProps:{hasEnd:!1}})}setDates(e,t,r={}){let{dateEnv:s}=this._context,n={allDay:r.allDay},a=s.createMarker(e),o;if(a&&!(t!=null&&(o=s.createMarker(t),!o))&&this._instance){let l=this._instance.range;r.allDay===!0&&(l=fb(l));let c=ds(l.start,a,s,r.granularity);if(o){let d=ds(l.end,o,s,r.granularity);Nk(c,d)?this.mutate({datesDelta:c,standardProps:n}):this.mutate({startDelta:c,endDelta:d,standardProps:n})}else n.hasEnd=!1,this.mutate({datesDelta:c,standardProps:n})}}moveStart(e){let t=j(e);t&&this.mutate({startDelta:t})}moveEnd(e){let t=j(e);t&&this.mutate({endDelta:t})}moveDates(e){let t=j(e);t&&this.mutate({datesDelta:t})}setAllDay(e,t={}){let r={allDay:e},{maintainDuration:s}=t;s==null&&(s=this._context.options.allDayMaintainDuration),this._def.allDay!==e&&(r.hasEnd=s),this.mutate({standardProps:r})}formatRange(e){let{dateEnv:t}=this._context,r=this._instance,s=pe(e);return this._def.hasEnd?t.formatRange(r.range.start,r.range.end,s,{forcedStartTzo:r.forcedStartTzo,forcedEndTzo:r.forcedEndTzo}):t.format(r.range.start,s,{forcedTzo:r.forcedStartTzo})}mutate(e){let t=this._instance;if(t){let r=this._def,s=this._context,{eventStore:n}=s.getCurrentData(),a=Oa(n,t.instanceId);a=La(a,{"":{display:"",startEditable:!0,durationEditable:!0,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]}},e,s);let l=new ve(s,r,t);this._def=a.defs[r.defId],this._instance=a.instances[t.instanceId],s.dispatch({type:"MERGE_EVENTS",eventStore:a}),s.emitter.trigger("eventChange",{oldEvent:l,event:this,relatedEvents:dr(a,s,t),revert(){s.dispatch({type:"RESET_EVENTS",eventStore:n})}})}}remove(){let e=this._context,t=vb(this);e.dispatch({type:"REMOVE_EVENTS",eventStore:t}),e.emitter.trigger("eventRemove",{event:this,relatedEvents:[],revert(){e.dispatch({type:"MERGE_EVENTS",eventStore:t})}})}get source(){let{sourceId:e}=this._def;return e?new os(this._context,this._context.getCurrentData().eventSources[e]):null}get start(){return this._instance?this._context.dateEnv.toDate(this._instance.range.start):null}get end(){return this._instance&&this._def.hasEnd?this._context.dateEnv.toDate(this._instance.range.end):null}get startStr(){let e=this._instance;return e?this._context.dateEnv.formatIso(e.range.start,{omitTime:this._def.allDay,forcedTzo:e.forcedStartTzo}):""}get endStr(){let e=this._instance;return e&&this._def.hasEnd?this._context.dateEnv.formatIso(e.range.end,{omitTime:this._def.allDay,forcedTzo:e.forcedEndTzo}):""}get id(){return this._def.publicId}get groupId(){return this._def.groupId}get allDay(){return this._def.allDay}get title(){return this._def.title}get url(){return this._def.url}get display(){return this._def.ui.display||"auto"}get startEditable(){return this._def.ui.startEditable}get durationEditable(){return this._def.ui.durationEditable}get constraint(){return this._def.ui.constraints[0]||null}get overlap(){return this._def.ui.overlap}get allow(){return this._def.ui.allows[0]||null}get backgroundColor(){return this._def.ui.backgroundColor}get borderColor(){return this._def.ui.borderColor}get textColor(){return this._def.ui.textColor}get classNames(){return this._def.ui.classNames}get extendedProps(){return this._def.extendedProps}toPlainObject(e={}){let t=this._def,{ui:r}=t,{startStr:s,endStr:n}=this,a={allDay:t.allDay};return t.title&&(a.title=t.title),s&&(a.start=s),n&&(a.end=n),t.publicId&&(a.id=t.publicId),t.groupId&&(a.groupId=t.groupId),t.url&&(a.url=t.url),r.display&&r.display!=="auto"&&(a.display=r.display),e.collapseColor&&r.backgroundColor&&r.backgroundColor===r.borderColor?a.color=r.backgroundColor:(r.backgroundColor&&(a.backgroundColor=r.backgroundColor),r.borderColor&&(a.borderColor=r.borderColor)),r.textColor&&(a.textColor=r.textColor),r.classNames.length&&(a.classNames=r.classNames),Object.keys(t.extendedProps).length&&(e.collapseExtendedProps?Object.assign(a,t.extendedProps):a.extendedProps=t.extendedProps),a}toJSON(){return this.toPlainObject()}};function vb(i){let e=i._def,t=i._instance;return{defs:{[e.defId]:e},instances:t?{[t.instanceId]:t}:{}}}function dr(i,e,t){let{defs:r,instances:s}=i,n=[],a=t?t.instanceId:"";for(let o in s){let l=s[o],c=r[l.defId];l.instanceId!==a&&n.push(new ve(e,c,l))}return n}function Ul(i,e,t,r){let s={},n={},a={},o=[],l=[],c=$l(i.defs,e);for(let d in i.defs){let u=i.defs[d];c[u.defId].display==="inverse-background"&&(u.groupId?(s[u.groupId]=[],a[u.groupId]||(a[u.groupId]=u)):n[d]=[])}for(let d in i.instances){let u=i.instances[d],f=i.defs[u.defId],h=c[f.defId],m=u.range,p=!f.allDay&&r?Nf(m,r):m,g=ht(p,t);g&&(h.display==="inverse-background"?f.groupId?s[f.groupId].push(g):n[u.defId].push(g):h.display!=="none"&&(h.display==="background"?o:l).push({def:f,ui:h,instance:u,range:g,isStart:p.start&&p.start.valueOf()===g.start.valueOf(),isEnd:p.end&&p.end.valueOf()===g.end.valueOf()}))}for(let d in s){let u=s[d],f=Uv(u,t);for(let h of f){let m=a[d],p=c[m.defId];o.push({def:m,ui:p,instance:null,range:h,isStart:!1,isEnd:!1})}}for(let d in n){let u=n[d],f=Uv(u,t);for(let h of f)o.push({def:i.defs[d],ui:c[d],instance:null,range:h,isStart:!1,isEnd:!1})}return{bg:o,fg:l}}function $f(i){return i.ui.display==="background"||i.ui.display==="inverse-background"}function Vv(i,e){i.fcSeg=e}function Nr(i){return i.fcSeg||i.parentNode.fcSeg||null}function $l(i,e){return St(i,t=>bb(t,e))}function bb(i,e){let t=[];return e[""]&&t.push(e[""]),e[i.defId]&&t.push(e[i.defId]),t.push(i.ui),Lf(t)}function Fa(i,e){let t=i.map($D);return t.sort((r,s)=>eb(r,s,e)),t.map(r=>r._seg)}function $D(i){let{eventRange:e}=i,t=e.def,r=e.instance?e.instance.range:e.range,s=r.start?r.start.valueOf():0,n=r.end?r.end.valueOf():0;return Object.assign(Object.assign(Object.assign({},t.extendedProps),t),{id:t.publicId,start:s,end:n,duration:n-s,allDay:Number(t.allDay),_seg:i})}function VD(i,e){let{pluginHooks:t}=e,r=t.isDraggableTransformers,{def:s,ui:n}=i.eventRange,a=n.startEditable;for(let o of r)a=o(a,s,n,e);return a}function zD(i,e){return i.isStart&&i.eventRange.ui.durationEditable&&e.options.eventResizableFromStart}function jD(i,e){return i.isEnd&&i.eventRange.ui.durationEditable}function ic(i,e,t,r,s,n,a){let{dateEnv:o,options:l}=t,{displayEventTime:c,displayEventEnd:d}=l,u=i.eventRange.def,f=i.eventRange.instance;c==null&&(c=r!==!1),d==null&&(d=s!==!1);let h=f.range.start,m=f.range.end,p=n||i.start||i.eventRange.range.start,g=a||i.end||i.eventRange.range.end,v=ye(h).valueOf()===ye(p).valueOf(),w=ye(nr(m,-1)).valueOf()===ye(nr(g,-1)).valueOf();return c&&!u.allDay&&(v||w)?(p=v?h:p,g=w?m:g,d&&u.hasEnd?o.formatRange(p,g,e,{forcedStartTzo:n?null:f.forcedStartTzo,forcedEndTzo:a?null:f.forcedEndTzo}):o.format(p,e,{forcedTzo:n?null:f.forcedStartTzo})):""}function Yt(i,e,t){let r=i.eventRange.range;return{isPast:r.end<=(t||e.start),isFuture:r.start>=(t||e.end),isToday:e&&Dt(e,r.start)}}function qD(i){let e=["fc-event"];return i.isMirror&&e.push("fc-event-mirror"),i.isDraggable&&e.push("fc-event-draggable"),(i.isStartResizable||i.isEndResizable)&&e.push("fc-event-resizable"),i.isDragging&&e.push("fc-event-dragging"),i.isResizing&&e.push("fc-event-resizing"),i.isSelected&&e.push("fc-event-selected"),i.isStart&&e.push("fc-event-start"),i.isEnd&&e.push("fc-event-end"),i.isPast&&e.push("fc-event-past"),i.isToday&&e.push("fc-event-today"),i.isFuture&&e.push("fc-event-future"),e}function Ha(i){return i.instance?i.instance.instanceId:`${i.def.defId}:${i.range.start.toISOString()}`}function nc(i,e){let{def:t,instance:r}=i.eventRange,{url:s}=t;if(s)return{href:s};let{emitter:n,options:a}=e,{eventInteractive:o}=a;return o==null&&(o=t.interactive,o==null&&(o=Boolean(n.hasHandlers("eventClick")))),o?Xv(l=>{n.trigger("eventClick",{el:l.target,event:new ve(e,t,r),jsEvent:l,view:e.viewApi})}):{}}var YD={start:T,end:T,allDay:Boolean};function QD(i,e,t){let r=GD(i,e),{range:s}=r;if(!s.start)return null;if(!s.end){if(t==null)return null;s.end=e.add(s.start,t)}return r}function GD(i,e){let{refined:t,extra:r}=Ra(i,YD),s=t.start?e.createMarkerMeta(t.start):null,n=t.end?e.createMarkerMeta(t.end):null,{allDay:a}=t;return a==null&&(a=s&&s.isTimeUnspecified&&(!n||n.isTimeUnspecified)),Object.assign({range:{start:s?s.marker:null,end:n?n.marker:null},allDay:a},r)}function Vf(i,e){return ub(i.range,e.range)&&i.allDay===e.allDay&&KD(i,e)}function KD(i,e){for(let t in e)if(t!=="range"&&t!=="allDay"&&i[t]!==e[t])return!1;for(let t in i)if(!(t in e))return!1;return!0}function ZD(i,e){return Object.assign(Object.assign({},wb(i.range,e,i.allDay)),{allDay:i.allDay})}function zf(i,e,t){return Object.assign(Object.assign({},wb(i,e,t)),{timeZone:e.timeZone})}function wb(i,e,t){return{start:e.toDate(i.start),end:e.toDate(i.end),startStr:e.formatIso(i.start,{omitTime:t}),endStr:e.formatIso(i.end,{omitTime:t})}}function XD(i,e,t){let r=Na({editable:!1},t),s=Li(r.refined,r.extra,"",i.allDay,!0,t);return{def:s,ui:bb(s,e),instance:Vi(s.defId,i.range),range:i.range,isStart:!0,isEnd:!0}}function jf(i,e,t){let r=!1,s=function(o){r||(r=!0,e(o))},n=function(o){r||(r=!0,t(o))},a=i(s,n);a&&typeof a.then=="function"&&a.then(s,n)}var Vl=class extends Error{constructor(e,t){super(e),this.response=t}};function qf(i,e,t){i=i.toUpperCase();let r={method:i};return i==="GET"?e+=(e.indexOf("?")===-1?"?":"&")+new URLSearchParams(t):(r.body=new URLSearchParams(t),r.headers={"Content-Type":"application/x-www-form-urlencoded"}),fetch(e,r).then(s=>{if(s.ok)return s.json().then(n=>[n,s],()=>{throw new Vl("Failure parsing JSON",s)});throw new Vl("Request failed",s)})}var Gu;function Yf(){return Gu==null&&(Gu=JD()),Gu}function JD(){if(typeof document=="undefined")return!0;let i=document.createElement("div");i.style.position="absolute",i.style.top="0px",i.style.left="0px",i.innerHTML="<table><tr><td><div></div></td></tr></table>",i.querySelector("table").style.height="100px",i.querySelector("div").style.height="100%",document.body.appendChild(i);let t=i.querySelector("div").offsetHeight>0;return document.body.removeChild(i),t}var wa=class extends G{constructor(){super(...arguments),this.state={forPrint:!1},this.handleBeforePrint=()=>{ga(()=>{this.setState({forPrint:!0})})},this.handleAfterPrint=()=>{ga(()=>{this.setState({forPrint:!1})})}}render(){let{props:e}=this,{options:t}=e,{forPrint:r}=this.state,s=r||t.height==="auto"||t.contentHeight==="auto",n=!s&&t.height!=null?t.height:"",a=["fc",r?"fc-media-print":"fc-media-screen",`fc-direction-${t.direction}`,e.theme.getClass("root")];return Yf()||a.push("fc-liquid-hack"),e.children(a,n,s,r)}componentDidMount(){let{emitter:e}=this.props;e.on("_beforeprint",this.handleBeforePrint),e.on("_afterprint",this.handleAfterPrint)}componentWillUnmount(){let{emitter:e}=this.props;e.off("_beforeprint",this.handleBeforePrint),e.off("_afterprint",this.handleAfterPrint)}},jt=class{constructor(e){this.component=e.component,this.isHitComboAllowed=e.isHitComboAllowed||null}destroy(){}};function Tb(i,e){return{component:i,el:e.el,useEventCenter:e.useEventCenter!=null?e.useEventCenter:!0,isHitComboAllowed:e.isHitComboAllowed||null}}function Ba(i){return{[i.component.uid]:i}}var ei={},Ct=class extends qe{constructor(e,t){super(e,t),this.handleRefresh=()=>{let r=this.computeTiming();r.state.nowDate.valueOf()!==this.state.nowDate.valueOf()&&this.setState(r.state),this.clearTimeout(),this.setTimeout(r.waitMs)},this.handleVisibilityChange=()=>{document.hidden||this.handleRefresh()},this.state=this.computeTiming().state}render(){let{props:e,state:t}=this;return e.children(t.nowDate,t.todayRange)}componentDidMount(){this.setTimeout(),this.context.nowManager.addResetListener(this.handleRefresh),document.addEventListener("visibilitychange",this.handleVisibilityChange)}componentDidUpdate(e){e.unit!==this.props.unit&&(this.clearTimeout(),this.setTimeout())}componentWillUnmount(){this.clearTimeout(),this.context.nowManager.removeResetListener(this.handleRefresh),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}computeTiming(){let{props:e,context:t}=this,r=t.nowManager.getDateMarker(),s=t.dateEnv.startOf(r,e.unit),a=t.dateEnv.add(s,j(1,e.unit)).valueOf()-r.valueOf();return a=Math.min(1e3*60*60*24,a),{state:{nowDate:s,todayRange:eS(s)},waitMs:a}}setTimeout(e=this.computeTiming().waitMs){this.timeoutId=setTimeout(()=>{let t=this.computeTiming();this.setState(t.state,()=>{this.setTimeout(t.waitMs)})},e)}clearTimeout(){this.timeoutId&&clearTimeout(this.timeoutId)}};Ct.contextType=_t;function eS(i){let e=ye(i),t=Fe(e,1);return{start:e,end:t}}var Ta=class{getCurrentData(){return this.currentDataManager.getCurrentData()}dispatch(e){this.currentDataManager.dispatch(e)}get view(){return this.getCurrentData().viewApi}batchRendering(e){e()}updateSize(){this.trigger("_resize",!0)}setOption(e,t){this.dispatch({type:"SET_OPTION",optionName:e,rawOptionValue:t})}getOption(e){return this.currentDataManager.currentCalendarOptionsInput[e]}getAvailableLocaleCodes(){return Object.keys(this.getCurrentData().availableRawLocales)}on(e,t){let{currentDataManager:r}=this;r.currentCalendarOptionsRefiners[e]?r.emitter.on(e,t):console.warn(`Unknown listener name '${e}'`)}off(e,t){this.currentDataManager.emitter.off(e,t)}trigger(e,...t){this.currentDataManager.emitter.trigger(e,...t)}changeView(e,t){this.batchRendering(()=>{if(this.unselect(),t)if(t.start&&t.end)this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e}),this.dispatch({type:"SET_OPTION",optionName:"visibleRange",rawOptionValue:t});else{let{dateEnv:r}=this.getCurrentData();this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e,dateMarker:r.createMarker(t)})}else this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e})})}zoomTo(e,t){let r=this.getCurrentData(),s;t=t||"day",s=r.viewSpecs[t]||this.getUnitViewSpec(t),this.unselect(),s?this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:s.type,dateMarker:e}):this.dispatch({type:"CHANGE_DATE",dateMarker:e})}getUnitViewSpec(e){let{viewSpecs:t,toolbarConfig:r}=this.getCurrentData(),s=[].concat(r.header?r.header.viewsWithButtons:[],r.footer?r.footer.viewsWithButtons:[]),n,a;for(let o in t)s.push(o);for(n=0;n<s.length;n+=1)if(a=t[s[n]],a&&a.singleUnit===e)return a;return null}prev(){this.unselect(),this.dispatch({type:"PREV"})}next(){this.unselect(),this.dispatch({type:"NEXT"})}prevYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,-1)})}nextYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,1)})}today(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.nowManager.getDateMarker()})}gotoDate(e){let t=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.createMarker(e)})}incrementDate(e){let t=this.getCurrentData(),r=j(e);r&&(this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:t.dateEnv.add(t.currentDate,r)}))}getDate(){let e=this.getCurrentData();return e.dateEnv.toDate(e.currentDate)}formatDate(e,t){let{dateEnv:r}=this.getCurrentData();return r.format(r.createMarker(e),pe(t))}formatRange(e,t,r){let{dateEnv:s}=this.getCurrentData();return s.formatRange(s.createMarker(e),s.createMarker(t),pe(r),r)}formatIso(e,t){let{dateEnv:r}=this.getCurrentData();return r.formatIso(r.createMarker(e),{omitTime:t})}select(e,t){let r;t==null?e.start!=null?r=e:r={start:e,end:null}:r={start:e,end:t};let s=this.getCurrentData(),n=QD(r,s.dateEnv,j({days:1}));n&&(this.dispatch({type:"SELECT_DATES",selection:n}),sc(n,null,s))}unselect(e){let t=this.getCurrentData();t.dateSelection&&(this.dispatch({type:"UNSELECT_DATES"}),BD(e,t))}addEvent(e,t){if(e instanceof ve){let a=e._def,o=e._instance;return this.getCurrentData().eventStore.defs[a.defId]||(this.dispatch({type:"ADD_EVENTS",eventStore:Vs({def:a,instance:o})}),this.triggerEventAdd(e)),e}let r=this.getCurrentData(),s;if(t instanceof os)s=t.internalEventSource;else if(typeof t=="boolean")t&&([s]=Jl(r.eventSources));else if(t!=null){let a=this.getEventSourceById(t);if(!a)return console.warn(`Could not find an event source with ID "${t}"`),null;s=a.internalEventSource}let n=pb(e,s,r,!1);if(n){let a=new ve(r,n.def,n.def.recurringDef?null:n.instance);return this.dispatch({type:"ADD_EVENTS",eventStore:Vs(n)}),this.triggerEventAdd(a),a}return null}triggerEventAdd(e){let{emitter:t}=this.getCurrentData();t.trigger("eventAdd",{event:e,relatedEvents:[],revert:()=>{this.dispatch({type:"REMOVE_EVENTS",eventStore:vb(e)})}})}getEventById(e){let t=this.getCurrentData(),{defs:r,instances:s}=t.eventStore;e=String(e);for(let n in r){let a=r[n];if(a.publicId===e){if(a.recurringDef)return new ve(t,a,null);for(let o in s){let l=s[o];if(l.defId===a.defId)return new ve(t,a,l)}}}return null}getEvents(){let e=this.getCurrentData();return dr(e.eventStore,e)}removeAllEvents(){this.dispatch({type:"REMOVE_ALL_EVENTS"})}getEventSources(){let e=this.getCurrentData(),t=e.eventSources,r=[];for(let s in t)r.push(new os(e,t[s]));return r}getEventSourceById(e){let t=this.getCurrentData(),r=t.eventSources;e=String(e);for(let s in r)if(r[s].publicId===e)return new os(t,r[s]);return null}addEventSource(e){let t=this.getCurrentData();if(e instanceof os)return t.eventSources[e.internalEventSource.sourceId]||this.dispatch({type:"ADD_EVENT_SOURCES",sources:[e.internalEventSource]}),e;let r=Ff(e,t);return r?(this.dispatch({type:"ADD_EVENT_SOURCES",sources:[r]}),new os(t,r)):null}removeAllEventSources(){this.dispatch({type:"REMOVE_ALL_EVENT_SOURCES"})}refetchEvents(){this.dispatch({type:"FETCH_EVENT_SOURCES",isRefetch:!0})}scrollToTime(e){let t=j(e);t&&this.trigger("_scrollRequest",{time:t})}};function Qf(i,e){return i.left>=e.left&&i.left<e.right&&i.top>=e.top&&i.top<e.bottom}function ac(i,e){let t={left:Math.max(i.left,e.left),right:Math.min(i.right,e.right),top:Math.max(i.top,e.top),bottom:Math.min(i.bottom,e.bottom)};return t.left<t.right&&t.top<t.bottom?t:!1}function Gf(i,e){return{left:Math.min(Math.max(i.left,e.left),e.right),top:Math.min(Math.max(i.top,e.top),e.bottom)}}function Kf(i){return{left:(i.left+i.right)/2,top:(i.top+i.bottom)/2}}function Zf(i,e){return{left:i.left-e.left,top:i.top-e.top}}var Ku=He(),Ea=class{constructor(){this.getKeysForEventDefs=W(this._getKeysForEventDefs),this.splitDateSelection=W(this._splitDateSpan),this.splitEventStore=W(this._splitEventStore),this.splitIndividualUi=W(this._splitIndividualUi),this.splitEventDrag=W(this._splitInteraction),this.splitEventResize=W(this._splitInteraction),this.eventUiBuilders={}}splitProps(e){let t=this.getKeyInfo(e),r=this.getKeysForEventDefs(e.eventStore),s=this.splitDateSelection(e.dateSelection),n=this.splitIndividualUi(e.eventUiBases,r),a=this.splitEventStore(e.eventStore,r),o=this.splitEventDrag(e.eventDrag),l=this.splitEventResize(e.eventResize),c={};this.eventUiBuilders=St(t,(d,u)=>this.eventUiBuilders[u]||W(tS));for(let d in t){let u=t[d],f=a[d]||Ku,h=this.eventUiBuilders[d];c[d]={businessHours:u.businessHours||e.businessHours,dateSelection:s[d]||null,eventStore:f,eventUiBases:h(e.eventUiBases[""],u.ui,n[d]),eventSelection:f.instances[e.eventSelection]?e.eventSelection:"",eventDrag:o[d]||null,eventResize:l[d]||null}}return c}_splitDateSpan(e){let t={};if(e){let r=this.getKeysForDateSpan(e);for(let s of r)t[s]=e}return t}_getKeysForEventDefs(e){return St(e.defs,t=>this.getKeysForEventDef(t))}_splitEventStore(e,t){let{defs:r,instances:s}=e,n={};for(let a in r)for(let o of t[a])n[o]||(n[o]=He()),n[o].defs[a]=r[a];for(let a in s){let o=s[a];for(let l of t[o.defId])n[l]&&(n[l].instances[a]=o)}return n}_splitIndividualUi(e,t){let r={};for(let s in e)if(s)for(let n of t[s])r[n]||(r[n]={}),r[n][s]=e[s];return r}_splitInteraction(e){let t={};if(e){let r=this._splitEventStore(e.affectedEvents,this._getKeysForEventDefs(e.affectedEvents)),s=this._getKeysForEventDefs(e.mutatedEvents),n=this._splitEventStore(e.mutatedEvents,s),a=o=>{t[o]||(t[o]={affectedEvents:r[o]||Ku,mutatedEvents:n[o]||Ku,isEvent:e.isEvent})};for(let o in r)a(o);for(let o in n)a(o)}return t}};function tS(i,e,t){let r=[];i&&r.push(i),e&&r.push(e);let s={"":Lf(r)};return t&&Object.assign(s,t),s}function Xf(i,e,t,r){return{dow:i.getUTCDay(),isDisabled:Boolean(r&&(!r.activeRange||!Dt(r.activeRange,i))),isOther:Boolean(r&&!Dt(r.currentRange,i)),isToday:Boolean(e&&Dt(e,i)),isPast:Boolean(t?i<t:e?i<e.start:!1),isFuture:Boolean(t?i>t:e?i>=e.end:!1)}}function oc(i,e){let t=["fc-day",`fc-day-${Fk[i.dow]}`];return i.isDisabled?t.push("fc-day-disabled"):(i.isToday&&(t.push("fc-day-today"),t.push(e.getClass("today"))),i.isPast&&t.push("fc-day-past"),i.isFuture&&t.push("fc-day-future"),i.isOther&&t.push("fc-day-other")),t}var rS=pe({year:"numeric",month:"long",day:"numeric"}),sS=pe({week:"long"});function ti(i,e,t="day",r=!0){let{dateEnv:s,options:n,calendarApi:a}=i,o=s.format(e,t==="week"?sS:rS);if(n.navLinks){let l=s.toDate(e),c=d=>{let u=t==="day"?n.navLinkDayClick:t==="week"?n.navLinkWeekClick:null;typeof u=="function"?u.call(a,s.toDate(e),d):(typeof u=="string"&&(t=u),a.zoomTo(e,t))};return Object.assign({title:Bi(n.navLinkHint,[o,l],o),"data-navlink":""},r?Zv(c):{onClick:c})}return{"aria-label":o}}var Zu=null;function Eb(){return Zu===null&&(Zu=iS()),Zu}function iS(){let i=document.createElement("div");Js(i,{position:"absolute",top:-1e3,left:0,border:0,padding:0,overflow:"scroll",direction:"rtl"}),i.innerHTML="<div></div>",document.body.appendChild(i);let t=i.firstChild.getBoundingClientRect().left>i.getBoundingClientRect().left;return xa(i),t}var Xu;function kb(){return Xu||(Xu=nS()),Xu}function nS(){let i=document.createElement("div");i.style.overflow="scroll",i.style.position="absolute",i.style.top="-9999px",i.style.left="-9999px",document.body.appendChild(i);let e=Db(i);return document.body.removeChild(i),e}function Db(i){return{x:i.offsetHeight-i.clientHeight,y:i.offsetWidth-i.clientWidth}}function Sb(i,e=!1){let t=window.getComputedStyle(i),r=parseInt(t.borderLeftWidth,10)||0,s=parseInt(t.borderRightWidth,10)||0,n=parseInt(t.borderTopWidth,10)||0,a=parseInt(t.borderBottomWidth,10)||0,o=Db(i),l=o.y-r-s,c=o.x-n-a,d={borderLeft:r,borderRight:s,borderTop:n,borderBottom:a,scrollbarBottom:c,scrollbarLeft:0,scrollbarRight:0};return Eb()&&t.direction==="rtl"?d.scrollbarLeft=l:d.scrollbarRight=l,e&&(d.paddingLeft=parseInt(t.paddingLeft,10)||0,d.paddingRight=parseInt(t.paddingRight,10)||0,d.paddingTop=parseInt(t.paddingTop,10)||0,d.paddingBottom=parseInt(t.paddingBottom,10)||0),d}function Jf(i,e=!1,t){let r=t?i.getBoundingClientRect():Wa(i),s=Sb(i,e),n={left:r.left+s.borderLeft+s.scrollbarLeft,right:r.right-s.borderRight-s.scrollbarRight,top:r.top+s.borderTop,bottom:r.bottom-s.borderBottom-s.scrollbarBottom};return e&&(n.left+=s.paddingLeft,n.right-=s.paddingRight,n.top+=s.paddingTop,n.bottom-=s.paddingBottom),n}function Wa(i){let e=i.getBoundingClientRect();return{left:e.left+window.scrollX,top:e.top+window.scrollY,right:e.right+window.scrollX,bottom:e.bottom+window.scrollY}}function aS(i){let e=lc(i),t=i.getBoundingClientRect();for(let r of e){let s=ac(t,r.getBoundingClientRect());if(s)t=s;else return null}return t}function lc(i){let e=[];for(;i instanceof HTMLElement;){let t=window.getComputedStyle(i);if(t.position==="fixed")break;/(auto|scroll)/.test(t.overflow+t.overflowY+t.overflowX)&&e.push(i),i=i.parentNode}return e}var qt=class{constructor(e,t,r,s){this.els=t;let n=this.originClientRect=e.getBoundingClientRect();r&&this.buildElHorizontals(n.left),s&&this.buildElVerticals(n.top)}buildElHorizontals(e){let t=[],r=[];for(let s of this.els){let n=s.getBoundingClientRect();t.push(n.left-e),r.push(n.right-e)}this.lefts=t,this.rights=r}buildElVerticals(e){let t=[],r=[];for(let s of this.els){let n=s.getBoundingClientRect();t.push(n.top-e),r.push(n.bottom-e)}this.tops=t,this.bottoms=r}leftToIndex(e){let{lefts:t,rights:r}=this,s=t.length,n;for(n=0;n<s;n+=1)if(e>=t[n]&&e<r[n])return n}topToIndex(e){let{tops:t,bottoms:r}=this,s=t.length,n;for(n=0;n<s;n+=1)if(e>=t[n]&&e<r[n])return n}getWidth(e){return this.rights[e]-this.lefts[e]}getHeight(e){return this.bottoms[e]-this.tops[e]}similarTo(e){return Il(this.tops||[],e.tops||[])&&Il(this.bottoms||[],e.bottoms||[])&&Il(this.lefts||[],e.lefts||[])&&Il(this.rights||[],e.rights||[])}};function Il(i,e){let t=i.length;if(t!==e.length)return!1;for(let r=0;r<t;r++)if(Math.round(i[r])!==Math.round(e[r]))return!1;return!0}var zs=class{getMaxScrollTop(){return this.getScrollHeight()-this.getClientHeight()}getMaxScrollLeft(){return this.getScrollWidth()-this.getClientWidth()}canScrollVertically(){return this.getMaxScrollTop()>0}canScrollHorizontally(){return this.getMaxScrollLeft()>0}canScrollUp(){return this.getScrollTop()>0}canScrollDown(){return this.getScrollTop()<this.getMaxScrollTop()}canScrollLeft(){return this.getScrollLeft()>0}canScrollRight(){return this.getScrollLeft()<this.getMaxScrollLeft()}},ka=class extends zs{constructor(e){super(),this.el=e}getScrollTop(){return this.el.scrollTop}getScrollLeft(){return this.el.scrollLeft}setScrollTop(e){this.el.scrollTop=e}setScrollLeft(e){this.el.scrollLeft=e}getScrollWidth(){return this.el.scrollWidth}getScrollHeight(){return this.el.scrollHeight}getClientHeight(){return this.el.clientHeight}getClientWidth(){return this.el.clientWidth}},Da=class extends zs{getScrollTop(){return window.scrollY}getScrollLeft(){return window.scrollX}setScrollTop(e){window.scroll(window.scrollX,e)}setScrollLeft(e){window.scroll(e,window.scrollY)}getScrollWidth(){return document.documentElement.scrollWidth}getScrollHeight(){return document.documentElement.scrollHeight}getClientHeight(){return document.documentElement.clientHeight}getClientWidth(){return document.documentElement.clientWidth}},ze=class extends G{constructor(){super(...arguments),this.uid=Pr()}prepareHits(){}queryHit(e,t,r,s){return null}isValidSegDownEl(e){return!this.props.eventDrag&&!this.props.eventResize&&!Le(e,".fc-event-mirror")}isValidDateDownEl(e){return!Le(e,".fc-event:not(.fc-bg-event)")&&!Le(e,".fc-more-link")&&!Le(e,"a[data-navlink]")&&!Le(e,".fc-popover")}};var js=class{constructor(e=t=>t.thickness||1){this.getEntryThickness=e,this.strictOrder=!1,this.allowReslicing=!1,this.maxCoord=-1,this.maxStackCnt=-1,this.levelCoords=[],this.entriesByLevel=[],this.stackCnts={}}addSegs(e){let t=[];for(let r of e)this.insertEntry(r,t);return t}insertEntry(e,t){let r=this.findInsertion(e);this.isInsertionValid(r,e)?this.insertEntryAt(e,r):this.handleInvalidInsertion(r,e,t)}isInsertionValid(e,t){return(this.maxCoord===-1||e.levelCoord+this.getEntryThickness(t)<=this.maxCoord)&&(this.maxStackCnt===-1||e.stackCnt<this.maxStackCnt)}handleInvalidInsertion(e,t,r){if(this.allowReslicing&&e.touchingEntry){let s=Object.assign(Object.assign({},t),{span:Ua(t.span,e.touchingEntry.span)});r.push(s),this.splitEntry(t,e.touchingEntry,r)}else r.push(t)}splitEntry(e,t,r){let s=e.span,n=t.span;s.start<n.start&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:s.start,end:n.start}},r),s.end>n.end&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:n.end,end:s.end}},r)}insertEntryAt(e,t){let{entriesByLevel:r,levelCoords:s}=this;t.lateral===-1?(Ju(s,t.level,t.levelCoord),Ju(r,t.level,[e])):Ju(r[t.level],t.lateral,e),this.stackCnts[or(e)]=t.stackCnt}findInsertion(e){let{levelCoords:t,entriesByLevel:r,strictOrder:s,stackCnts:n}=this,a=t.length,o=0,l=-1,c=-1,d=null,u=0;for(let m=0;m<a;m+=1){let p=t[m];if(!s&&p>=o+this.getEntryThickness(e))break;let g=r[m],v,w=Ca(g,e.span.start,Sa),_=w[0]+w[1];for(;(v=g[_])&&v.span.start<e.span.end;){let E=p+this.getEntryThickness(v);E>o&&(o=E,d=v,l=m,c=_),E===o&&(u=Math.max(u,n[or(v)]+1)),_+=1}}let f=0;if(d)for(f=l+1;f<a&&t[f]<o;)f+=1;let h=-1;return f<a&&t[f]===o&&(h=Ca(r[f],e.span.end,Sa)[0]),{touchingLevel:l,touchingLateral:c,touchingEntry:d,stackCnt:u,levelCoord:o,level:f,lateral:h}}toRects(){let{entriesByLevel:e,levelCoords:t}=this,r=e.length,s=[];for(let n=0;n<r;n+=1){let a=e[n],o=t[n];for(let l of a)s.push(Object.assign(Object.assign({},l),{thickness:this.getEntryThickness(l),levelCoord:o}))}return s}};function Sa(i){return i.span.end}function or(i){return i.index+":"+i.span.start}function eh(i){let e=[];for(let t of i){let r=[],s={span:t.span,entries:[t]};for(let n of e)Ua(n.span,s.span)?s={entries:n.entries.concat(s.entries),span:oS(n.span,s.span)}:r.push(n);r.push(s),e=r}return e}function oS(i,e){return{start:Math.min(i.start,e.start),end:Math.max(i.end,e.end)}}function Ua(i,e){let t=Math.max(i.start,e.start),r=Math.min(i.end,e.end);return t<r?{start:t,end:r}:null}function Ju(i,e,t){i.splice(e,0,t)}function Ca(i,e,t){let r=0,s=i.length;if(!s||e<t(i[r]))return[0,0];if(e>t(i[s-1]))return[s,0];for(;r<s;){let n=Math.floor(r+(s-r)/2),a=t(i[n]);if(e<a)s=n;else if(e>a)r=n+1;else return[n,1]}return[r,0]}var _a=class{constructor(e,t){this.emitter=new Mr}destroy(){}setMirrorIsVisible(e){}setMirrorNeedsRevert(e){}setAutoScrollEnabled(e){}},ji={},lS={startTime:j,duration:j,create:Boolean,sourceId:String};function $a(i){let{refined:e,extra:t}=Ra(i,lS);return{startTime:e.startTime||null,duration:e.duration||null,create:e.create!=null?e.create:!0,sourceId:e.sourceId,leftoverProps:t}}function Cb(i,e){return!i||e>10?pe({weekday:"short"}):e>1?pe({weekday:"short",month:"numeric",day:"numeric",omitCommas:!0}):pe({weekday:"long"})}var _b="fc-col-header-cell";function xb(i){return i.text}var zl=class extends G{render(){let{dateEnv:e,options:t,theme:r,viewApi:s}=this.context,{props:n}=this,{date:a,dateProfile:o}=n,l=Xf(a,n.todayRange,null,o),c=[_b].concat(oc(l,r)),d=e.format(a,n.dayHeaderFormat),u=!l.isDisabled&&n.colCnt>1?ti(this.context,a):{},f=e.toDate(a);e.namedTimeZoneImpl&&(f=nr(f,36e5));let h=Object.assign(Object.assign(Object.assign({date:f,view:s},n.extraRenderProps),{text:d}),l);return y(Ve,{elTag:"th",elClasses:c,elAttrs:Object.assign({role:"columnheader",colSpan:n.colSpan,"data-date":l.isDisabled?void 0:Pa(a)},n.extraDataAttrs),renderProps:h,generatorName:"dayHeaderContent",customGenerator:t.dayHeaderContent,defaultGenerator:xb,classNameGenerator:t.dayHeaderClassNames,didMount:t.dayHeaderDidMount,willUnmount:t.dayHeaderWillUnmount},m=>y("div",{className:"fc-scrollgrid-sync-inner"},!l.isDisabled&&y(m,{elTag:"a",elAttrs:u,elClasses:["fc-col-header-cell-cushion",n.isSticky&&"fc-sticky"]})))}},cS=pe({weekday:"long"}),jl=class extends G{render(){let{props:e}=this,{dateEnv:t,theme:r,viewApi:s,options:n}=this.context,a=Fe(new Date(2592e5),e.dow),o={dow:e.dow,isDisabled:!1,isFuture:!1,isPast:!1,isToday:!1,isOther:!1},l=t.format(a,e.dayHeaderFormat),c=Object.assign(Object.assign(Object.assign(Object.assign({date:a},o),{view:s}),e.extraRenderProps),{text:l});return y(Ve,{elTag:"th",elClasses:[_b,...oc(o,r),...e.extraClassNames||[]],elAttrs:Object.assign({role:"columnheader",colSpan:e.colSpan},e.extraDataAttrs),renderProps:c,generatorName:"dayHeaderContent",customGenerator:n.dayHeaderContent,defaultGenerator:xb,classNameGenerator:n.dayHeaderClassNames,didMount:n.dayHeaderDidMount,willUnmount:n.dayHeaderWillUnmount},d=>y("div",{className:"fc-scrollgrid-sync-inner"},y(d,{elTag:"a",elClasses:["fc-col-header-cell-cushion",e.isSticky&&"fc-sticky"],elAttrs:{"aria-label":t.format(a,cS)}})))}},Ar=class extends G{constructor(){super(...arguments),this.createDayHeaderFormatter=W(dS)}render(){let{context:e}=this,{dates:t,dateProfile:r,datesRepDistinctDays:s,renderIntro:n}=this.props,a=this.createDayHeaderFormatter(e.options.dayHeaderFormat,s,t.length);return y(Ct,{unit:"day"},(o,l)=>y("tr",{role:"row"},n&&n("day"),t.map(c=>s?y(zl,{key:c.toISOString(),date:c,dateProfile:r,todayRange:l,colCnt:t.length,dayHeaderFormat:a}):y(jl,{key:c.getUTCDay(),dow:c.getUTCDay(),dayHeaderFormat:a}))))}};function dS(i,e,t){return i||Cb(e,t)}var qs=class{constructor(e,t){let r=e.start,{end:s}=e,n=[],a=[],o=-1;for(;r<s;)t.isHiddenDay(r)?n.push(o+.5):(o+=1,n.push(o),a.push(r)),r=Fe(r,1);this.dates=a,this.indices=n,this.cnt=a.length}sliceRange(e){let t=this.getDateDayIndex(e.start),r=this.getDateDayIndex(Fe(e.end,-1)),s=Math.max(0,t),n=Math.min(this.cnt-1,r);return s=Math.ceil(s),n=Math.floor(n),s<=n?{firstIndex:s,lastIndex:n,isStart:t===s,isEnd:r===n}:null}getDateDayIndex(e){let{indices:t}=this,r=Math.floor(Rr(this.dates[0],e));return r<0?t[0]-1:r>=t.length?t[t.length-1]+1:t[r]}},Ys=class{constructor(e,t){let{dates:r}=e,s,n,a;if(t){for(n=r[0].getUTCDay(),s=1;s<r.length&&r[s].getUTCDay()!==n;s+=1);a=Math.ceil(r.length/s)}else a=1,s=r.length;this.rowCnt=a,this.colCnt=s,this.daySeries=e,this.cells=this.buildCells(),this.headerDates=this.buildHeaderDates()}buildCells(){let e=[];for(let t=0;t<this.rowCnt;t+=1){let r=[];for(let s=0;s<this.colCnt;s+=1)r.push(this.buildCell(t,s));e.push(r)}return e}buildCell(e,t){let r=this.daySeries.dates[e*this.colCnt+t];return{key:r.toISOString(),date:r}}buildHeaderDates(){let e=[];for(let t=0;t<this.colCnt;t+=1)e.push(this.cells[0][t].date);return e}sliceRange(e){let{colCnt:t}=this,r=this.daySeries.sliceRange(e),s=[];if(r){let{firstIndex:n,lastIndex:a}=r,o=n;for(;o<=a;){let l=Math.floor(o/t),c=Math.min((l+1)*t,a+1);s.push({row:l,firstCol:o%t,lastCol:(c-1)%t,isStart:r.isStart&&o===n,isEnd:r.isEnd&&c-1===a}),o=c}}return s}},Qs=class{constructor(){this.sliceBusinessHours=W(this._sliceBusinessHours),this.sliceDateSelection=W(this._sliceDateSpan),this.sliceEventStore=W(this._sliceEventStore),this.sliceEventDrag=W(this._sliceInteraction),this.sliceEventResize=W(this._sliceInteraction),this.forceDayIfListItem=!1}sliceProps(e,t,r,s,...n){let{eventUiBases:a}=e,o=this.sliceEventStore(e.eventStore,a,t,r,...n);return{dateSelectionSegs:this.sliceDateSelection(e.dateSelection,t,r,a,s,...n),businessHourSegs:this.sliceBusinessHours(e.businessHours,t,r,s,...n),fgEventSegs:o.fg,bgEventSegs:o.bg,eventDrag:this.sliceEventDrag(e.eventDrag,a,t,r,...n),eventResize:this.sliceEventResize(e.eventResize,a,t,r,...n),eventSelection:e.eventSelection}}sliceNowDate(e,t,r,s,...n){return this._sliceDateSpan({range:{start:e,end:nr(e,1)},allDay:!1},t,r,{},s,...n)}_sliceBusinessHours(e,t,r,s,...n){return e?this._sliceEventStore($s(e,Pl(t,Boolean(r)),s),{},t,r,...n).bg:[]}_sliceEventStore(e,t,r,s,...n){if(e){let a=Ul(e,t,Pl(r,Boolean(s)),s);return{bg:this.sliceEventRanges(a.bg,n),fg:this.sliceEventRanges(a.fg,n)}}return{bg:[],fg:[]}}_sliceInteraction(e,t,r,s,...n){if(!e)return null;let a=Ul(e.mutatedEvents,t,Pl(r,Boolean(s)),s);return{segs:this.sliceEventRanges(a.fg,n),affectedInstances:e.affectedEvents.instances,isEvent:e.isEvent}}_sliceDateSpan(e,t,r,s,n,...a){if(!e)return[];let o=Pl(t,Boolean(r)),l=ht(e.range,o);if(l){e=Object.assign(Object.assign({},e),{range:l});let c=XD(e,s,n),d=this.sliceRange(e.range,...a);for(let u of d)u.eventRange=c;return d}return[]}sliceEventRanges(e,t){let r=[];for(let s of e)r.push(...this.sliceEventRange(s,t));return r}sliceEventRange(e,t){let r=e.range;this.forceDayIfListItem&&e.ui.display==="list-item"&&(r={start:r.start,end:Fe(r.start,1)});let s=this.sliceRange(r,...t);for(let n of s)n.eventRange=e,n.isStart=e.isStart&&n.isStart,n.isEnd=e.isEnd&&n.isEnd;return s}};function Pl(i,e){let t=i.activeRange;return e?t:{start:nr(t.start,i.slotMinTime.milliseconds),end:nr(t.end,i.slotMaxTime.milliseconds-864e5)}}function Va(i,e,t){let{instances:r}=i.mutatedEvents;for(let s in r)if(!$i(e.validRange,r[s].range))return!1;return Mb({eventDrag:i},t)}function th(i,e,t){return $i(e.validRange,i.range)?Mb({dateSelection:i},t):!1}function Mb(i,e){let t=e.getCurrentData(),r=Object.assign({businessHours:t.businessHours,dateSelection:"",eventStore:t.eventStore,eventUiBases:t.eventUiBases,eventSelection:"",eventDrag:null,eventResize:null},i);return(e.pluginHooks.isPropsValid||Ab)(r,e)}function Ab(i,e,t={},r){return!(i.eventDrag&&!uS(i,e,t,r)||i.dateSelection&&!fS(i,e,t,r))}function uS(i,e,t,r){let s=e.getCurrentData(),n=i.eventDrag,a=n.mutatedEvents,o=a.defs,l=a.instances,c=$l(o,n.isEvent?i.eventUiBases:{"":s.selectionConfig});r&&(c=St(c,r));let d=RD(i.eventStore,n.affectedEvents.instances),u=d.defs,f=d.instances,h=$l(u,i.eventUiBases);for(let m in l){let p=l[m],g=p.range,v=c[p.defId],w=o[p.defId];if(!Ib(v.constraints,g,d,i.businessHours,e))return!1;let{eventOverlap:_}=e.options,E=typeof _=="function"?_:null;for(let D in f){let A=f[D];if(ec(g,A.range)&&(h[A.defId].overlap===!1&&n.isEvent||v.overlap===!1||E&&!E(new ve(e,u[A.defId],A),new ve(e,w,p))))return!1}let S=s.eventStore;for(let D of v.allows){let A=Object.assign(Object.assign({},t),{range:p.range,allDay:w.allDay}),C=S.defs[w.defId],B=S.instances[m],$;if(C?$=new ve(e,C,B):$=new ve(e,w),!D(Uf(A,e),$))return!1}}return!0}function fS(i,e,t,r){let s=i.eventStore,n=s.defs,a=s.instances,o=i.dateSelection,l=o.range,{selectionConfig:c}=e.getCurrentData();if(r&&(c=r(c)),!Ib(c.constraints,l,s,i.businessHours,e))return!1;let{selectOverlap:d}=e.options,u=typeof d=="function"?d:null;for(let f in a){let h=a[f];if(ec(l,h.range)&&(c.overlap===!1||u&&!u(new ve(e,n[h.defId],h),null)))return!1}for(let f of c.allows){let h=Object.assign(Object.assign({},t),o);if(!f(Uf(h,e),null))return!1}return!0}function Ib(i,e,t,r,s){for(let n of i)if(!pS(hS(n,e,t,r,s),e))return!1;return!0}function hS(i,e,t,r,s){return i==="businessHours"?ef($s(r,e,s)):typeof i=="string"?ef(rc(t,n=>n.groupId===i)):typeof i=="object"&&i?ef($s(i,e,s)):[]}function ef(i){let{instances:e}=i,t=[];for(let r in e)t.push(e[r].range);return t}function pS(i,e){for(let t of i)if($i(t,e))return!0;return!1}var Rl=/^(visible|hidden)$/,ql=class extends G{constructor(){super(...arguments),this.handleEl=e=>{this.el=e,xt(this.props.elRef,e)}}render(){let{props:e}=this,{liquid:t,liquidIsAbsolute:r}=e,s=t&&r,n=["fc-scroller"];return t&&(r?n.push("fc-scroller-liquid-absolute"):n.push("fc-scroller-liquid")),y("div",{ref:this.handleEl,className:n.join(" "),style:{overflowX:e.overflowX,overflowY:e.overflowY,left:s&&-(e.overcomeLeft||0)||"",right:s&&-(e.overcomeRight||0)||"",bottom:s&&-(e.overcomeBottom||0)||"",marginLeft:!s&&-(e.overcomeLeft||0)||"",marginRight:!s&&-(e.overcomeRight||0)||"",marginBottom:!s&&-(e.overcomeBottom||0)||"",maxHeight:e.maxHeight||""}},e.children)}needsXScrolling(){if(Rl.test(this.props.overflowX))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().width-this.getYScrollbarWidth(),{children:r}=e;for(let s=0;s<r.length;s+=1)if(r[s].getBoundingClientRect().width>t)return!0;return!1}needsYScrolling(){if(Rl.test(this.props.overflowY))return!1;let{el:e}=this,t=this.el.getBoundingClientRect().height-this.getXScrollbarWidth(),{children:r}=e;for(let s=0;s<r.length;s+=1)if(r[s].getBoundingClientRect().height>t)return!0;return!1}getXScrollbarWidth(){return Rl.test(this.props.overflowX)?0:this.el.offsetHeight-this.el.clientHeight}getYScrollbarWidth(){return Rl.test(this.props.overflowY)?0:this.el.offsetWidth-this.el.clientWidth}},nt=class{constructor(e){this.masterCallback=e,this.currentMap={},this.depths={},this.callbackMap={},this.handleValue=(t,r)=>{let{depths:s,currentMap:n}=this,a=!1,o=!1;t!==null?(a=r in n,n[r]=t,s[r]=(s[r]||0)+1,o=!0):(s[r]-=1,s[r]||(delete n[r],delete this.callbackMap[r],a=!0)),this.masterCallback&&(a&&this.masterCallback(null,String(r)),o&&this.masterCallback(t,String(r)))}}createRef(e){let t=this.callbackMap[e];return t||(t=this.callbackMap[e]=r=>{this.handleValue(r,String(e))}),t}collect(e,t,r){return ab(this.currentMap,e,t,r)}getAll(){return Jl(this.currentMap)}};function Pb(i){let e=Gv(i,".fc-scrollgrid-shrink"),t=0;for(let r of e)t=Math.max(t,Ik(r));return Math.ceil(t)}function rh(i,e){return i.liquid&&e.liquid}function Rb(i,e){return e.maxHeight!=null||rh(i,e)}function Nb(i,e,t,r){let{expandRows:s}=t;return typeof e.content=="function"?e.content(t):y("table",{role:"presentation",className:[e.tableClassName,i.syncRowHeights?"fc-scrollgrid-sync-table":""].join(" "),style:{minWidth:t.tableMinWidth,width:t.clientWidth,height:s?t.clientHeight:""}},t.tableColGroupNode,y(r?"thead":"tbody",{role:"presentation"},typeof e.rowContent=="function"?e.rowContent(t):e.rowContent))}function Ob(i,e){return lr(i,e,et)}function Lb(i,e){let t=[];for(let r of i){let s=r.span||1;for(let n=0;n<s;n+=1)t.push(y("col",{style:{width:r.width==="shrink"?Fb(e):r.width||"",minWidth:r.minWidth||""}}))}return y("colgroup",{},...t)}function Fb(i){return i==null?4:i}function Hb(i){for(let e of i)if(e.width==="shrink")return!0;return!1}function Bb(i,e){let t=["fc-scrollgrid",e.theme.getClass("table")];return i&&t.push("fc-scrollgrid-liquid"),t}function Wb(i,e){let t=["fc-scrollgrid-section",`fc-scrollgrid-section-${i.type}`,i.className];return e&&i.liquid&&i.maxHeight==null&&t.push("fc-scrollgrid-section-liquid"),i.isSticky&&t.push("fc-scrollgrid-section-sticky"),t}function qi(i){return y("div",{className:"fc-scrollgrid-sticky-shim",style:{width:i.clientWidth,minWidth:i.tableMinWidth}})}function ri(i){let{stickyHeaderDates:e}=i;return(e==null||e==="auto")&&(e=i.height==="auto"||i.viewHeight==="auto"),e}function za(i){let{stickyFooterScrollbar:e}=i;return(e==null||e==="auto")&&(e=i.height==="auto"||i.viewHeight==="auto"),e}var us=class extends G{constructor(){super(...arguments),this.processCols=W(e=>e,Ob),this.renderMicroColGroup=W(Lb),this.scrollerRefs=new nt,this.scrollerElRefs=new nt(this._handleScrollerEl.bind(this)),this.state={shrinkWidth:null,forceYScrollbars:!1,scrollerClientWidths:{},scrollerClientHeights:{}},this.handleSizing=()=>{this.safeSetState(Object.assign({shrinkWidth:this.computeShrinkWidth()},this.computeScrollerDims()))}}render(){let{props:e,state:t,context:r}=this,s=e.sections||[],n=this.processCols(e.cols),a=this.renderMicroColGroup(n,t.shrinkWidth),o=Bb(e.liquid,r);e.collapsibleWidth&&o.push("fc-scrollgrid-collapsible");let l=s.length,c=0,d,u=[],f=[],h=[];for(;c<l&&(d=s[c]).type==="header";)u.push(this.renderSection(d,a,!0)),c+=1;for(;c<l&&(d=s[c]).type==="body";)f.push(this.renderSection(d,a,!1)),c+=1;for(;c<l&&(d=s[c]).type==="footer";)h.push(this.renderSection(d,a,!0)),c+=1;let m=!Yf(),p={role:"rowgroup"};return y("table",{role:"grid",className:o.join(" "),style:{height:e.height}},Boolean(!m&&u.length)&&y("thead",p,...u),Boolean(!m&&f.length)&&y("tbody",p,...f),Boolean(!m&&h.length)&&y("tfoot",p,...h),m&&y("tbody",p,...u,...f,...h))}renderSection(e,t,r){return"outerContent"in e?y(fe,{key:e.key},e.outerContent):y("tr",{key:e.key,role:"presentation",className:Wb(e,this.props.liquid).join(" ")},this.renderChunkTd(e,t,e.chunk,r))}renderChunkTd(e,t,r,s){if("outerContent"in r)return r.outerContent;let{props:n}=this,{forceYScrollbars:a,scrollerClientWidths:o,scrollerClientHeights:l}=this.state,c=Rb(n,e),d=rh(n,e),u=n.liquid?a?"scroll":c?"auto":"hidden":"visible",f=e.key,h=Nb(e,r,{tableColGroupNode:t,tableMinWidth:"",clientWidth:!n.collapsibleWidth&&o[f]!==void 0?o[f]:null,clientHeight:l[f]!==void 0?l[f]:null,expandRows:e.expandRows,syncRowHeights:!1,rowSyncHeights:[],reportRowHeightChange:()=>{}},s);return y(s?"th":"td",{ref:r.elRef,role:"presentation"},y("div",{className:`fc-scroller-harness${d?" fc-scroller-harness-liquid":""}`},y(ql,{ref:this.scrollerRefs.createRef(f),elRef:this.scrollerElRefs.createRef(f),overflowY:u,overflowX:n.liquid?"hidden":"visible",maxHeight:e.maxHeight,liquid:d,liquidIsAbsolute:!0},h)))}_handleScrollerEl(e,t){let r=mS(this.props.sections,t);r&&xt(r.chunk.scrollerElRef,e)}componentDidMount(){this.handleSizing(),this.context.addResizeHandler(this.handleSizing)}componentDidUpdate(){this.handleSizing()}componentWillUnmount(){this.context.removeResizeHandler(this.handleSizing)}computeShrinkWidth(){return Hb(this.props.cols)?Pb(this.scrollerElRefs.getAll()):0}computeScrollerDims(){let e=kb(),{scrollerRefs:t,scrollerElRefs:r}=this,s=!1,n={},a={};for(let o in t.currentMap){let l=t.currentMap[o];if(l&&l.needsYScrolling()){s=!0;break}}for(let o of this.props.sections){let l=o.key,c=r.currentMap[l];if(c){let d=c.parentNode;n[l]=Math.floor(d.getBoundingClientRect().width-(s?e.y:0)),a[l]=Math.floor(d.getBoundingClientRect().height)}}return{forceYScrollbars:s,scrollerClientWidths:n,scrollerClientHeights:a}}};us.addStateEquality({scrollerClientWidths:et,scrollerClientHeights:et});function mS(i,e){for(let t of i)if(t.key===e)return t;return null}var Gs=class extends G{constructor(){super(...arguments),this.handleEl=e=>{this.el=e,e&&Vv(e,this.props.seg)}}render(){let{props:e,context:t}=this,{options:r}=t,{seg:s}=e,{eventRange:n}=s,{ui:a}=n,o={event:new ve(t,n.def,n.instance),view:t.viewApi,timeText:e.timeText,textColor:a.textColor,backgroundColor:a.backgroundColor,borderColor:a.borderColor,isDraggable:!e.disableDragging&&VD(s,t),isStartResizable:!e.disableResizing&&zD(s,t),isEndResizable:!e.disableResizing&&jD(s),isMirror:Boolean(e.isDragging||e.isResizing||e.isDateSelecting),isStart:Boolean(s.isStart),isEnd:Boolean(s.isEnd),isPast:Boolean(e.isPast),isFuture:Boolean(e.isFuture),isToday:Boolean(e.isToday),isSelected:Boolean(e.isSelected),isDragging:Boolean(e.isDragging),isResizing:Boolean(e.isResizing)};return y(Ve,Object.assign({},e,{elRef:this.handleEl,elClasses:[...qD(o),...s.eventRange.ui.classNames,...e.elClasses||[]],renderProps:o,generatorName:"eventContent",customGenerator:r.eventContent,defaultGenerator:e.defaultGenerator,classNameGenerator:r.eventClassNames,didMount:r.eventDidMount,willUnmount:r.eventWillUnmount}))}componentDidUpdate(e){this.el&&this.props.seg!==e.seg&&Vv(this.el,this.props.seg)}},Ks=class extends G{render(){let{props:e,context:t}=this,{options:r}=t,{seg:s}=e,{ui:n}=s.eventRange,a=r.eventTimeFormat||e.defaultTimeFormat,o=ic(s,a,t,e.defaultDisplayEventTime,e.defaultDisplayEventEnd);return y(Gs,Object.assign({},e,{elTag:"a",elStyle:{borderColor:n.borderColor,backgroundColor:n.backgroundColor},elAttrs:nc(s,t),defaultGenerator:gS,timeText:o}),(l,c)=>y(fe,null,y(l,{elTag:"div",elClasses:["fc-event-main"],elStyle:{color:c.textColor}}),Boolean(c.isStartResizable)&&y("div",{className:"fc-event-resizer fc-event-resizer-start"}),Boolean(c.isEndResizable)&&y("div",{className:"fc-event-resizer fc-event-resizer-end"})))}};function gS(i){return y("div",{className:"fc-event-main-frame"},i.timeText&&y("div",{className:"fc-event-time"},i.timeText),y("div",{className:"fc-event-title-container"},y("div",{className:"fc-event-title fc-sticky"},i.event.title||y(fe,null,"\xA0"))))}var ja=i=>y(_t.Consumer,null,e=>{let{options:t}=e,r={isAxis:i.isAxis,date:e.dateEnv.toDate(i.date),view:e.viewApi};return y(Ve,Object.assign({},i,{elTag:i.elTag||"div",renderProps:r,generatorName:"nowIndicatorContent",customGenerator:t.nowIndicatorContent,classNameGenerator:t.nowIndicatorClassNames,didMount:t.nowIndicatorDidMount,willUnmount:t.nowIndicatorWillUnmount}))}),yS=pe({day:"numeric"}),fs=class extends G{constructor(){super(...arguments),this.refineRenderProps=Ui(vS)}render(){let{props:e,context:t}=this,{options:r}=t,s=this.refineRenderProps({date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,isMonthStart:e.isMonthStart||!1,showDayNumber:e.showDayNumber,extraRenderProps:e.extraRenderProps,viewApi:t.viewApi,dateEnv:t.dateEnv,monthStartFormat:r.monthStartFormat});return y(Ve,Object.assign({},e,{elClasses:[...oc(s,t.theme),...e.elClasses||[]],elAttrs:Object.assign(Object.assign({},e.elAttrs),s.isDisabled?{}:{"data-date":Pa(e.date)}),renderProps:s,generatorName:"dayCellContent",customGenerator:r.dayCellContent,defaultGenerator:e.defaultGenerator,classNameGenerator:s.isDisabled?void 0:r.dayCellClassNames,didMount:r.dayCellDidMount,willUnmount:r.dayCellWillUnmount}))}};function Yi(i){return Boolean(i.dayCellContent||df("dayCellContent",i))}function vS(i){let{date:e,dateEnv:t,dateProfile:r,isMonthStart:s}=i,n=Xf(e,i.todayRange,null,r),a=i.showDayNumber?t.format(e,s?i.monthStartFormat:yS):"";return Object.assign(Object.assign(Object.assign({date:t.toDate(e),view:i.viewApi},n),{isMonthStart:s,dayNumberText:a}),i.extraRenderProps)}var Zs=class extends G{render(){let{props:e}=this,{seg:t}=e;return y(Gs,{elTag:"div",elClasses:["fc-bg-event"],elStyle:{backgroundColor:t.eventRange.ui.backgroundColor},defaultGenerator:bS,seg:t,timeText:"",isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,isPast:e.isPast,isFuture:e.isFuture,isToday:e.isToday,disableDragging:!0,disableResizing:!0})}};function bS(i){let{title:e}=i.event;return e&&y("div",{className:"fc-event-title"},i.event.title)}function qa(i){return y("div",{className:`fc-${i}`})}var Ya=i=>y(_t.Consumer,null,e=>{let{dateEnv:t,options:r}=e,{date:s}=i,n=r.weekNumberFormat||i.defaultFormat,a=t.computeWeekNumber(s),o=t.format(s,n);return y(Ve,Object.assign({},i,{renderProps:{num:a,text:o,date:s},generatorName:"weekNumberContent",customGenerator:r.weekNumberContent,defaultGenerator:wS,classNameGenerator:r.weekNumberClassNames,didMount:r.weekNumberDidMount,willUnmount:r.weekNumberWillUnmount}))});function wS(i){return i.text}var tf=10,ff=class extends G{constructor(){super(...arguments),this.state={titleId:Ir()},this.handleRootEl=e=>{this.rootEl=e,this.props.elRef&&xt(this.props.elRef,e)},this.handleDocumentMouseDown=e=>{let t=Ql(e);this.rootEl.contains(t)||this.handleCloseClick()},this.handleDocumentKeyDown=e=>{e.key==="Escape"&&this.handleCloseClick()},this.handleCloseClick=()=>{let{onClose:e}=this.props;e&&e()}}render(){let{theme:e,options:t}=this.context,{props:r,state:s}=this,n=["fc-popover",e.getClass("popover")].concat(r.extraClassNames||[]);return Iv(y("div",Object.assign({},r.extraAttrs,{id:r.id,className:n.join(" "),"aria-labelledby":s.titleId,ref:this.handleRootEl}),y("div",{className:"fc-popover-header "+e.getClass("popoverHeader")},y("span",{className:"fc-popover-title",id:s.titleId},r.title),y("span",{className:"fc-popover-close "+e.getIconClass("close"),title:t.closeHint,onClick:this.handleCloseClick})),y("div",{className:"fc-popover-body "+e.getClass("popoverContent")},r.children)),r.parentEl)}componentDidMount(){document.addEventListener("mousedown",this.handleDocumentMouseDown),document.addEventListener("keydown",this.handleDocumentKeyDown),this.updateSize()}componentWillUnmount(){document.removeEventListener("mousedown",this.handleDocumentMouseDown),document.removeEventListener("keydown",this.handleDocumentKeyDown)}updateSize(){let{isRtl:e}=this.context,{alignmentEl:t,alignGridTop:r}=this.props,{rootEl:s}=this,n=aS(t);if(n){let a=s.getBoundingClientRect(),o=r?Le(t,".fc-scrollgrid").getBoundingClientRect().top:n.top,l=e?n.right-a.width:n.left;o=Math.max(o,tf),l=Math.min(l,document.documentElement.clientWidth-tf-a.width),l=Math.max(l,tf);let c=s.offsetParent.getBoundingClientRect();Js(s,{top:o-c.top,left:l-c.left})}}},hf=class extends ze{constructor(){super(...arguments),this.handleRootEl=e=>{this.rootEl=e,e?this.context.registerInteractiveComponent(this,{el:e,useEventCenter:!1}):this.context.unregisterInteractiveComponent(this)}}render(){let{options:e,dateEnv:t}=this.context,{props:r}=this,{startDate:s,todayRange:n,dateProfile:a}=r,o=t.format(s,e.dayPopoverFormat);return y(fs,{elRef:this.handleRootEl,date:s,dateProfile:a,todayRange:n},(l,c,d)=>y(ff,{elRef:d.ref,id:r.id,title:o,extraClassNames:["fc-more-popover"].concat(d.className||[]),extraAttrs:d,parentEl:r.parentEl,alignmentEl:r.alignmentEl,alignGridTop:r.alignGridTop,onClose:r.onClose},Yi(e)&&y(l,{elTag:"div",elClasses:["fc-more-popover-misc"]}),r.children))}queryHit(e,t,r,s){let{rootEl:n,props:a}=this;return e>=0&&e<r&&t>=0&&t<s?{dateProfile:a.dateProfile,dateSpan:Object.assign({allDay:!a.forceTimed,range:{start:a.startDate,end:a.endDate}},a.extraDateSpan),dayEl:n,rect:{left:0,top:0,right:r,bottom:s},layer:1}:null}},Xs=class extends G{constructor(){super(...arguments),this.state={isPopoverOpen:!1,popoverId:Ir()},this.handleLinkEl=e=>{this.linkEl=e,this.props.elRef&&xt(this.props.elRef,e)},this.handleClick=e=>{let{props:t,context:r}=this,{moreLinkClick:s}=r.options,n=zv(t).start;function a(o){let{def:l,instance:c,range:d}=o.eventRange;return{event:new ve(r,l,c),start:r.dateEnv.toDate(d.start),end:r.dateEnv.toDate(d.end),isStart:o.isStart,isEnd:o.isEnd}}typeof s=="function"&&(s=s({date:n,allDay:Boolean(t.allDayDate),allSegs:t.allSegs.map(a),hiddenSegs:t.hiddenSegs.map(a),jsEvent:e,view:r.viewApi})),!s||s==="popover"?this.setState({isPopoverOpen:!0}):typeof s=="string"&&r.calendarApi.zoomTo(n,s)},this.handlePopoverClose=()=>{this.setState({isPopoverOpen:!1})}}render(){let{props:e,state:t}=this;return y(_t.Consumer,null,r=>{let{viewApi:s,options:n,calendarApi:a}=r,{moreLinkText:o}=n,{moreCnt:l}=e,c=zv(e),d=typeof o=="function"?o.call(a,l):`+${l} ${o}`,u=Bi(n.moreLinkHint,[l],d),f={num:l,shortText:`+${l}`,text:d,view:s};return y(fe,null,Boolean(e.moreCnt)&&y(Ve,{elTag:e.elTag||"a",elRef:this.handleLinkEl,elClasses:[...e.elClasses||[],"fc-more-link"],elStyle:e.elStyle,elAttrs:Object.assign(Object.assign(Object.assign({},e.elAttrs),Zv(this.handleClick)),{title:u,"aria-expanded":t.isPopoverOpen,"aria-controls":t.isPopoverOpen?t.popoverId:""}),renderProps:f,generatorName:"moreLinkContent",customGenerator:n.moreLinkContent,defaultGenerator:e.defaultGenerator||TS,classNameGenerator:n.moreLinkClassNames,didMount:n.moreLinkDidMount,willUnmount:n.moreLinkWillUnmount},e.children),t.isPopoverOpen&&y(hf,{id:t.popoverId,startDate:c.start,endDate:c.end,dateProfile:e.dateProfile,todayRange:e.todayRange,extraDateSpan:e.extraDateSpan,parentEl:this.parentEl,alignmentEl:e.alignmentElRef?e.alignmentElRef.current:this.linkEl,alignGridTop:e.alignGridTop,forceTimed:e.forceTimed,onClose:this.handlePopoverClose},e.popoverContent()))})}componentDidMount(){this.updateParentEl()}componentDidUpdate(){this.updateParentEl()}updateParentEl(){this.linkEl&&(this.parentEl=Le(this.linkEl,".fc-view-harness"))}};function TS(i){return i.text}function zv(i){if(i.allDayDate)return{start:i.allDayDate,end:Fe(i.allDayDate,1)};let{hiddenSegs:e}=i;return{start:cc(e),end:kS(e)}}function cc(i){return i.reduce(ES).eventRange.range.start}function ES(i,e){return i.eventRange.range.start<e.eventRange.range.start?i:e}function kS(i){return i.reduce(DS).eventRange.range.end}function DS(i,e){return i.eventRange.range.end>e.eventRange.range.end?i:e}var SS=[],Yb={code:"en",week:{dow:0,doy:4},direction:"ltr",buttonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",year:"year",today:"today",month:"month",week:"week",day:"day",list:"list"},weekText:"W",weekTextLong:"Week",closeHint:"Close",timeHint:"Time",eventHint:"Event",allDayText:"all-day",moreLinkText:"more",noEventsText:"No events to display"},Qb=Object.assign(Object.assign({},Yb),{buttonHints:{prev:"Previous $0",next:"Next $0",today(i,e){return e==="day"?"Today":`This ${i}`}},viewHint:"$0 view",navLinkHint:"Go to $0",moreLinkHint(i){return`Show ${i} more event${i===1?"":"s"}`}});function CS(i){let e=i.length>0?i[0].code:"en",t=SS.concat(i),r={en:Qb};for(let s of t)r[s.code]=s;return{map:r,defaultCode:e}}function Gb(i,e){return typeof i=="object"&&!Array.isArray(i)?Kb(i.code,[i.code],i):_S(i,e)}function _S(i,e){let t=[].concat(i||[]),r=xS(t,e)||Qb;return Kb(i,t,r)}function xS(i,e){for(let t=0;t<i.length;t+=1){let r=i[t].toLocaleLowerCase().split("-");for(let s=r.length;s>0;s-=1){let n=r.slice(0,s).join("-");if(e[n])return e[n]}}return null}function Kb(i,e,t){let r=Xl([Yb,t],["buttonText"]);delete r.code;let{week:s}=r;return delete r.week,{codeArg:i,codes:e,week:s,simpleNumberFormat:new Intl.NumberFormat(i),options:r}}function at(i){return{id:Pr(),name:i.name,premiumReleaseDate:i.premiumReleaseDate?new Date(i.premiumReleaseDate):void 0,deps:i.deps||[],reducers:i.reducers||[],isLoadingFuncs:i.isLoadingFuncs||[],contextInit:[].concat(i.contextInit||[]),eventRefiners:i.eventRefiners||{},eventDefMemberAdders:i.eventDefMemberAdders||[],eventSourceRefiners:i.eventSourceRefiners||{},isDraggableTransformers:i.isDraggableTransformers||[],eventDragMutationMassagers:i.eventDragMutationMassagers||[],eventDefMutationAppliers:i.eventDefMutationAppliers||[],dateSelectionTransformers:i.dateSelectionTransformers||[],datePointTransforms:i.datePointTransforms||[],dateSpanTransforms:i.dateSpanTransforms||[],views:i.views||{},viewPropsTransformers:i.viewPropsTransformers||[],isPropsValid:i.isPropsValid||null,externalDefTransforms:i.externalDefTransforms||[],viewContainerAppends:i.viewContainerAppends||[],eventDropTransformers:i.eventDropTransformers||[],componentInteractions:i.componentInteractions||[],calendarInteractions:i.calendarInteractions||[],themeClasses:i.themeClasses||{},eventSourceDefs:i.eventSourceDefs||[],cmdFormatter:i.cmdFormatter,recurringTypes:i.recurringTypes||[],namedTimeZonedImpl:i.namedTimeZonedImpl,initialView:i.initialView||"",elementDraggingImpl:i.elementDraggingImpl,optionChangeHandlers:i.optionChangeHandlers||{},scrollGridImpl:i.scrollGridImpl||null,listenerRefiners:i.listenerRefiners||{},optionRefiners:i.optionRefiners||{},propSetHandlers:i.propSetHandlers||{}}}function MS(i,e){let t={},r={premiumReleaseDate:void 0,reducers:[],isLoadingFuncs:[],contextInit:[],eventRefiners:{},eventDefMemberAdders:[],eventSourceRefiners:{},isDraggableTransformers:[],eventDragMutationMassagers:[],eventDefMutationAppliers:[],dateSelectionTransformers:[],datePointTransforms:[],dateSpanTransforms:[],views:{},viewPropsTransformers:[],isPropsValid:null,externalDefTransforms:[],viewContainerAppends:[],eventDropTransformers:[],componentInteractions:[],calendarInteractions:[],themeClasses:{},eventSourceDefs:[],cmdFormatter:null,recurringTypes:[],namedTimeZonedImpl:null,initialView:"",elementDraggingImpl:null,optionChangeHandlers:{},scrollGridImpl:null,listenerRefiners:{},optionRefiners:{},propSetHandlers:{}};function s(n){for(let a of n){let o=a.name,l=t[o];l===void 0?(t[o]=a.id,s(a.deps),r=IS(r,a)):l!==a.id&&console.warn(`Duplicate plugin '${o}'`)}}return i&&s(i),s(e),r}function AS(){let i=[],e=[],t;return(r,s)=>((!t||!lr(r,i)||!lr(s,e))&&(t=MS(r,s)),i=r,e=s,t)}function IS(i,e){return{premiumReleaseDate:PS(i.premiumReleaseDate,e.premiumReleaseDate),reducers:i.reducers.concat(e.reducers),isLoadingFuncs:i.isLoadingFuncs.concat(e.isLoadingFuncs),contextInit:i.contextInit.concat(e.contextInit),eventRefiners:Object.assign(Object.assign({},i.eventRefiners),e.eventRefiners),eventDefMemberAdders:i.eventDefMemberAdders.concat(e.eventDefMemberAdders),eventSourceRefiners:Object.assign(Object.assign({},i.eventSourceRefiners),e.eventSourceRefiners),isDraggableTransformers:i.isDraggableTransformers.concat(e.isDraggableTransformers),eventDragMutationMassagers:i.eventDragMutationMassagers.concat(e.eventDragMutationMassagers),eventDefMutationAppliers:i.eventDefMutationAppliers.concat(e.eventDefMutationAppliers),dateSelectionTransformers:i.dateSelectionTransformers.concat(e.dateSelectionTransformers),datePointTransforms:i.datePointTransforms.concat(e.datePointTransforms),dateSpanTransforms:i.dateSpanTransforms.concat(e.dateSpanTransforms),views:Object.assign(Object.assign({},i.views),e.views),viewPropsTransformers:i.viewPropsTransformers.concat(e.viewPropsTransformers),isPropsValid:e.isPropsValid||i.isPropsValid,externalDefTransforms:i.externalDefTransforms.concat(e.externalDefTransforms),viewContainerAppends:i.viewContainerAppends.concat(e.viewContainerAppends),eventDropTransformers:i.eventDropTransformers.concat(e.eventDropTransformers),calendarInteractions:i.calendarInteractions.concat(e.calendarInteractions),componentInteractions:i.componentInteractions.concat(e.componentInteractions),themeClasses:Object.assign(Object.assign({},i.themeClasses),e.themeClasses),eventSourceDefs:i.eventSourceDefs.concat(e.eventSourceDefs),cmdFormatter:e.cmdFormatter||i.cmdFormatter,recurringTypes:i.recurringTypes.concat(e.recurringTypes),namedTimeZonedImpl:e.namedTimeZonedImpl||i.namedTimeZonedImpl,initialView:i.initialView||e.initialView,elementDraggingImpl:i.elementDraggingImpl||e.elementDraggingImpl,optionChangeHandlers:Object.assign(Object.assign({},i.optionChangeHandlers),e.optionChangeHandlers),scrollGridImpl:e.scrollGridImpl||i.scrollGridImpl,listenerRefiners:Object.assign(Object.assign({},i.listenerRefiners),e.listenerRefiners),optionRefiners:Object.assign(Object.assign({},i.optionRefiners),e.optionRefiners),propSetHandlers:Object.assign(Object.assign({},i.propSetHandlers),e.propSetHandlers)}}function PS(i,e){return i===void 0?e:e===void 0?i:new Date(Math.max(i.valueOf(),e.valueOf()))}var ur=class extends xr{};ur.prototype.classes={root:"fc-theme-standard",tableCellShaded:"fc-cell-shaded",buttonGroup:"fc-button-group",button:"fc-button fc-button-primary",buttonActive:"fc-button-active"};ur.prototype.baseIconClass="fc-icon";ur.prototype.iconClasses={close:"fc-icon-x",prev:"fc-icon-chevron-left",next:"fc-icon-chevron-right",prevYear:"fc-icon-chevrons-left",nextYear:"fc-icon-chevrons-right"};ur.prototype.rtlIconClasses={prev:"fc-icon-chevron-right",next:"fc-icon-chevron-left",prevYear:"fc-icon-chevrons-right",nextYear:"fc-icon-chevrons-left"};ur.prototype.iconOverrideOption="buttonIcons";ur.prototype.iconOverrideCustomButtonOption="icon";ur.prototype.iconOverridePrefix="fc-icon-";function RS(i,e){let t={},r;for(r in i)ih(r,t,i,e);for(r in e)ih(r,t,i,e);return t}function ih(i,e,t,r){if(e[i])return e[i];let s=NS(i,e,t,r);return s&&(e[i]=s),s}function NS(i,e,t,r){let s=t[i],n=r[i],a=d=>s&&s[d]!==null?s[d]:n&&n[d]!==null?n[d]:null,o=a("component"),l=a("superType"),c=null;if(l){if(l===i)throw new Error("Can't have a custom view type that references itself");c=ih(l,e,t,r)}return!o&&c&&(o=c.component),o?{type:i,component:o,defaults:Object.assign(Object.assign({},c?c.defaults:{}),s?s.rawOptions:{}),overrides:Object.assign(Object.assign({},c?c.overrides:{}),n?n.rawOptions:{})}:null}function Ub(i){return St(i,OS)}function OS(i){let e=typeof i=="function"?{component:i}:i,{component:t}=e;return e.content?t=$b(e):t&&!(t.prototype instanceof G)&&(t=$b(Object.assign(Object.assign({},e),{content:t}))),{superType:e.type,component:t,rawOptions:e}}function $b(i){return e=>y(_t.Consumer,null,t=>y(Ve,{elTag:"div",elClasses:Rf(t.viewSpec),renderProps:Object.assign(Object.assign({},e),{nextDayThreshold:t.options.nextDayThreshold}),generatorName:void 0,customGenerator:i.content,classNameGenerator:i.classNames,didMount:i.didMount,willUnmount:i.willUnmount}))}function LS(i,e,t,r){let s=Ub(i),n=Ub(e.views),a=RS(s,n);return St(a,o=>FS(o,n,e,t,r))}function FS(i,e,t,r,s){let n=i.overrides.duration||i.defaults.duration||r.duration||t.duration,a=null,o="",l="",c={};if(n&&(a=HS(n),a)){let f=pa(a);o=f.unit,f.value===1&&(l=o,c=e[o]?e[o].rawOptions:{})}let d=f=>{let h=f.buttonText||{},m=i.defaults.buttonTextKey;return m!=null&&h[m]!=null?h[m]:h[i.type]!=null?h[i.type]:h[l]!=null?h[l]:null},u=f=>{let h=f.buttonHints||{},m=i.defaults.buttonTextKey;return m!=null&&h[m]!=null?h[m]:h[i.type]!=null?h[i.type]:h[l]!=null?h[l]:null};return{type:i.type,component:i.component,duration:a,durationUnit:o,singleUnit:l,optionDefaults:i.defaults,optionOverrides:Object.assign(Object.assign({},c),i.overrides),buttonTextOverride:d(r)||d(t)||i.overrides.buttonText,buttonTextDefault:d(s)||i.defaults.buttonText||d(cr)||i.type,buttonTitleOverride:u(r)||u(t)||i.overrides.buttonHint,buttonTitleDefault:u(s)||i.defaults.buttonHint||u(cr)}}var Vb={};function HS(i){let e=JSON.stringify(i),t=Vb[e];return t===void 0&&(t=j(i),Vb[e]=t),t}function BS(i,e){switch(e.type){case"CHANGE_VIEW_TYPE":i=e.viewType}return i}function WS(i,e){switch(e.type){case"CHANGE_DATE":return e.dateMarker;default:return i}}function US(i,e,t){let r=i.initialDate;return r!=null?e.createMarker(r):t.getDateMarker()}function $S(i,e){switch(e.type){case"SET_OPTION":return Object.assign(Object.assign({},i),{[e.optionName]:e.rawOptionValue});default:return i}}function VS(i,e,t,r){let s;switch(e.type){case"CHANGE_VIEW_TYPE":return r.build(e.dateMarker||t);case"CHANGE_DATE":return r.build(e.dateMarker);case"PREV":if(s=r.buildPrev(i,t),s.isValid)return s;break;case"NEXT":if(s=r.buildNext(i,t),s.isValid)return s;break}return i}function zS(i,e,t){let r=e?e.activeRange:null;return Xb({},ZS(i,t),r,t)}function jS(i,e,t,r){let s=t?t.activeRange:null;switch(e.type){case"ADD_EVENT_SOURCES":return Xb(i,e.sources,s,r);case"REMOVE_EVENT_SOURCE":return YS(i,e.sourceId);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return t?Jb(i,s,r):i;case"FETCH_EVENT_SOURCES":return hh(i,e.sourceIds?Af(e.sourceIds):ew(i,r),s,e.isRefetch||!1,r);case"RECEIVE_EVENTS":case"RECEIVE_EVENT_ERROR":return KS(i,e.sourceId,e.fetchId,e.fetchRange);case"REMOVE_ALL_EVENT_SOURCES":return{};default:return i}}function qS(i,e,t){let r=e?e.activeRange:null;return hh(i,ew(i,t),r,!0,t)}function Zb(i){for(let e in i)if(i[e].isFetching)return!0;return!1}function Xb(i,e,t,r){let s={};for(let n of e)s[n.sourceId]=n;return t&&(s=Jb(s,t,r)),Object.assign(Object.assign({},i),s)}function YS(i,e){return _r(i,t=>t.sourceId!==e)}function Jb(i,e,t){return hh(i,_r(i,r=>QS(r,e,t)),e,!1,t)}function QS(i,e,t){return tw(i,t)?!t.options.lazyFetching||!i.fetchRange||i.isFetching||e.start<i.fetchRange.start||e.end>i.fetchRange.end:!i.latestFetchId}function hh(i,e,t,r,s){let n={};for(let a in i){let o=i[a];e[a]?n[a]=GS(o,t,r,s):n[a]=o}return n}function GS(i,e,t,r){let{options:s,calendarApi:n}=r,a=r.pluginHooks.eventSourceDefs[i.sourceDefId],o=Pr();return a.fetch({eventSource:i,range:e,isRefetch:t,context:r},l=>{let{rawEvents:c}=l;s.eventSourceSuccess&&(c=s.eventSourceSuccess.call(n,c,l.response)||c),i.success&&(c=i.success.call(n,c,l.response)||c),r.dispatch({type:"RECEIVE_EVENTS",sourceId:i.sourceId,fetchId:o,fetchRange:e,rawEvents:c})},l=>{let c=!1;s.eventSourceFailure&&(s.eventSourceFailure.call(n,l),c=!0),i.failure&&(i.failure(l),c=!0),c||console.warn(l.message,l),r.dispatch({type:"RECEIVE_EVENT_ERROR",sourceId:i.sourceId,fetchId:o,fetchRange:e,error:l})}),Object.assign(Object.assign({},i),{isFetching:!0,latestFetchId:o})}function KS(i,e,t,r){let s=i[e];return s&&t===s.latestFetchId?Object.assign(Object.assign({},i),{[e]:Object.assign(Object.assign({},s),{isFetching:!1,fetchRange:r})}):i}function ew(i,e){return _r(i,t=>tw(t,e))}function ZS(i,e){let t=Hf(e),r=[].concat(i.eventSources||[]),s=[];i.initialEvents&&r.unshift(i.initialEvents),i.events&&r.unshift(i.events);for(let n of r){let a=Ff(n,e,t);a&&s.push(a)}return s}function tw(i,e){return!e.pluginHooks.eventSourceDefs[i.sourceDefId].ignoreRange}function XS(i,e){switch(e.type){case"UNSELECT_DATES":return null;case"SELECT_DATES":return e.selection;default:return i}}function JS(i,e){switch(e.type){case"UNSELECT_EVENT":return"";case"SELECT_EVENT":return e.eventInstanceId;default:return i}}function eC(i,e){let t;switch(e.type){case"UNSET_EVENT_DRAG":return null;case"SET_EVENT_DRAG":return t=e.state,{affectedEvents:t.affectedEvents,mutatedEvents:t.mutatedEvents,isEvent:t.isEvent};default:return i}}function tC(i,e){let t;switch(e.type){case"UNSET_EVENT_RESIZE":return null;case"SET_EVENT_RESIZE":return t=e.state,{affectedEvents:t.affectedEvents,mutatedEvents:t.mutatedEvents,isEvent:t.isEvent};default:return i}}function rC(i,e,t,r,s){let n=i.headerToolbar?zb(i.headerToolbar,i,e,t,r,s):null,a=i.footerToolbar?zb(i.footerToolbar,i,e,t,r,s):null;return{header:n,footer:a}}function zb(i,e,t,r,s,n){let a={},o=[],l=!1;for(let c in i){let d=i[c],u=sC(d,e,t,r,s,n);a[c]=u.widgets,o.push(...u.viewsWithButtons),l=l||u.hasTitle}return{sectionWidgets:a,viewsWithButtons:o,hasTitle:l}}function sC(i,e,t,r,s,n){let a=e.direction==="rtl",o=e.customButtons||{},l=t.buttonText||{},c=e.buttonText||{},d=t.buttonHints||{},u=e.buttonHints||{},f=i?i.split(" "):[],h=[],m=!1;return{widgets:f.map(g=>g.split(",").map(v=>{if(v==="title")return m=!0,{buttonName:v};let w,_,E,S,D,A;if(w=o[v])E=C=>{w.click&&w.click.call(C.target,C,C.target)},(S=r.getCustomButtonIconClass(w))||(S=r.getIconClass(v,a))||(D=w.text),A=w.hint||w.text;else if(_=s[v]){h.push(v),E=()=>{n.changeView(v)},(D=_.buttonTextOverride)||(S=r.getIconClass(v,a))||(D=_.buttonTextDefault);let C=_.buttonTextOverride||_.buttonTextDefault;A=Bi(_.buttonTitleOverride||_.buttonTitleDefault||e.viewHint,[C,v],C)}else if(n[v])if(E=()=>{n[v]()},(D=l[v])||(S=r.getIconClass(v,a))||(D=c[v]),v==="prevYear"||v==="nextYear"){let C=v==="prevYear"?"prev":"next";A=Bi(d[C]||u[C],[c.year||"year","year"],c[v])}else A=C=>Bi(d[v]||u[v],[c[C]||C,C],c[v]);return{buttonName:v,buttonClick:E,buttonIcon:S,buttonText:D,buttonHint:A}})),viewsWithButtons:h,hasTitle:m}}var nh=class{constructor(e,t,r){this.type=e,this.getCurrentData=t,this.dateEnv=r}get calendar(){return this.getCurrentData().calendarApi}get title(){return this.getCurrentData().viewTitle}get activeStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start)}get activeEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end)}get currentStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start)}get currentEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end)}getOption(e){return this.getCurrentData().options[e]}},iC={ignoreRange:!0,parseMeta(i){return Array.isArray(i.events)?i.events:null},fetch(i,e){e({rawEvents:i.eventSource.meta})}},nC=at({name:"array-event-source",eventSourceDefs:[iC]}),aC={parseMeta(i){return typeof i.events=="function"?i.events:null},fetch(i,e,t){let{dateEnv:r}=i.context,s=i.eventSource.meta;jf(s.bind(null,zf(i.range,r)),n=>e({rawEvents:n}),t)}},oC=at({name:"func-event-source",eventSourceDefs:[aC]}),lC={method:String,extraParams:T,startParam:String,endParam:String,timeZoneParam:String},cC={parseMeta(i){return i.url&&(i.format==="json"||!i.format)?{url:i.url,format:"json",method:(i.method||"GET").toUpperCase(),extraParams:i.extraParams,startParam:i.startParam,endParam:i.endParam,timeZoneParam:i.timeZoneParam}:null},fetch(i,e,t){let{meta:r}=i.eventSource,s=uC(r,i.range,i.context);qf(r.method,r.url,s).then(([n,a])=>{e({rawEvents:n,response:a})},t)}},dC=at({name:"json-event-source",eventSourceRefiners:lC,eventSourceDefs:[cC]});function uC(i,e,t){let{dateEnv:r,options:s}=t,n,a,o,l,c={};return n=i.startParam,n==null&&(n=s.startParam),a=i.endParam,a==null&&(a=s.endParam),o=i.timeZoneParam,o==null&&(o=s.timeZoneParam),typeof i.extraParams=="function"?l=i.extraParams():l=i.extraParams||{},Object.assign(c,l),c[n]=r.formatIso(e.start),c[a]=r.formatIso(e.end),r.timeZone!=="local"&&(c[o]=r.timeZone),c}var fC={daysOfWeek:T,startTime:j,endTime:j,duration:j,startRecur:T,endRecur:T},hC={parse(i,e){if(i.daysOfWeek||i.startTime||i.endTime||i.startRecur||i.endRecur){let t={daysOfWeek:i.daysOfWeek||null,startTime:i.startTime||null,endTime:i.endTime||null,startRecur:i.startRecur?e.createMarker(i.startRecur):null,endRecur:i.endRecur?e.createMarker(i.endRecur):null,dateEnv:e},r;return i.duration&&(r=i.duration),!r&&i.startTime&&i.endTime&&(r=rb(i.endTime,i.startTime)),{allDayGuess:Boolean(!i.startTime&&!i.endTime),duration:r,typeData:t}}return null},expand(i,e,t){let r=ht(e,{start:i.startRecur,end:i.endRecur});return r?mC(i.daysOfWeek,i.startTime,i.dateEnv,t,r):[]}},pC=at({name:"simple-recurring-event",recurringTypes:[hC],eventRefiners:fC});function mC(i,e,t,r,s){let n=i?Af(i):null,a=ye(s.start),o=s.end,l=[];for(;a<o;){let c;(!n||n[a.getUTCDay()])&&(e?c=r.add(a,e):c=a,l.push(r.createMarker(t.toDate(c)))),a=Fe(a,1)}return l}var gC=at({name:"change-handler",optionChangeHandlers:{events(i,e){jb([i],e)},eventSources:jb}});function jb(i,e){let t=Jl(e.getCurrentData().eventSources);if(t.length===1&&i.length===1&&Array.isArray(t[0]._raw)&&Array.isArray(i[0])){e.dispatch({type:"RESET_RAW_EVENTS",sourceId:t[0].sourceId,rawEvents:i[0]});return}let r=[];for(let s of i){let n=!1;for(let a=0;a<t.length;a+=1)if(t[a]._raw===s){t.splice(a,1),n=!0;break}n||r.push(s)}for(let s of t)e.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:s.sourceId});for(let s of r)e.calendarApi.addEventSource(s)}function yC(i,e){e.emitter.trigger("datesSet",Object.assign(Object.assign({},zf(i.activeRange,e.dateEnv)),{view:e.viewApi}))}function vC(i,e){let{emitter:t}=e;t.hasHandlers("eventsSet")&&t.trigger("eventsSet",dr(i,e))}var bC=[nC,oC,dC,pC,gC,at({name:"misc",isLoadingFuncs:[i=>Zb(i.eventSources)],propSetHandlers:{dateProfile:yC,eventStore:vC}})],ah=class{constructor(e,t){this.runTaskOption=e,this.drainedOption=t,this.queue=[],this.delayedRunner=new Ws(this.drain.bind(this))}request(e,t){this.queue.push(e),this.delayedRunner.request(t)}pause(e){this.delayedRunner.pause(e)}resume(e,t){this.delayedRunner.resume(e,t)}drain(){let{queue:e}=this;for(;e.length;){let t=[],r;for(;r=e.shift();)this.runTask(r),t.push(r);this.drained(t)}}runTask(e){this.runTaskOption&&this.runTaskOption(e)}drained(e){this.drainedOption&&this.drainedOption(e)}};function wC(i,e,t){let r;return/^(year|month)$/.test(i.currentRangeUnit)?r=i.currentRange:r=i.activeRange,t.formatRange(r.start,r.end,pe(e.titleFormat||TC(i)),{isEndExclusive:i.isRangeAllDay,defaultSeparator:e.titleRangeSeparator})}function TC(i){let{currentRangeUnit:e}=i;if(e==="year")return{year:"numeric"};if(e==="month")return{year:"numeric",month:"long"};let t=Oi(i.currentRange.start,i.currentRange.end);return t!==null&&t>1?{year:"numeric",month:"short",day:"numeric"}:{year:"numeric",month:"long",day:"numeric"}}var dc=class{constructor(){this.resetListeners=new Set}handleInput(e,t){let r=this.dateEnv;if(e!==r&&(typeof t=="function"?this.nowFn=t:r||(this.nowAnchorDate=e.toDate(t?e.createMarker(t):e.createNowMarker()),this.nowAnchorQueried=Date.now()),this.dateEnv=e,r))for(let s of this.resetListeners.values())s()}getDateMarker(){return this.nowAnchorDate?this.dateEnv.timestampToMarker(this.nowAnchorDate.valueOf()+(Date.now()-this.nowAnchorQueried)):this.dateEnv.createMarker(this.nowFn())}addResetListener(e){this.resetListeners.add(e)}removeResetListener(e){this.resetListeners.delete(e)}},oh=class{constructor(e){this.computeCurrentViewData=W(this._computeCurrentViewData),this.organizeRawLocales=W(CS),this.buildLocale=W(Gb),this.buildPluginHooks=AS(),this.buildDateEnv=W(EC),this.buildTheme=W(kC),this.parseToolbars=W(rC),this.buildViewSpecs=W(LS),this.buildDateProfileGenerator=Ui(DC),this.buildViewApi=W(SC),this.buildViewUiProps=Ui(xC),this.buildEventUiBySource=W(CC,et),this.buildEventUiBases=W(_C),this.parseContextBusinessHours=Ui(MC),this.buildTitle=W(wC),this.nowManager=new dc,this.emitter=new Mr,this.actionRunner=new ah(this._handleAction.bind(this),this.updateData.bind(this)),this.currentCalendarOptionsInput={},this.currentCalendarOptionsRefined={},this.currentViewOptionsInput={},this.currentViewOptionsRefined={},this.currentCalendarOptionsRefiners={},this.optionsForRefining=[],this.optionsForHandling=[],this.getCurrentData=()=>this.data,this.dispatch=f=>{this.actionRunner.request(f)},this.props=e,this.actionRunner.pause(),this.nowManager=new dc;let t={},r=this.computeOptionsData(e.optionOverrides,t,e.calendarApi),s=r.calendarOptions.initialView||r.pluginHooks.initialView,n=this.computeCurrentViewData(s,r,e.optionOverrides,t);e.calendarApi.currentDataManager=this,this.emitter.setThisContext(e.calendarApi),this.emitter.setOptions(n.options);let a={nowManager:this.nowManager,dateEnv:r.dateEnv,options:r.calendarOptions,pluginHooks:r.pluginHooks,calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},o=US(r.calendarOptions,r.dateEnv,this.nowManager),l=n.dateProfileGenerator.build(o);Dt(l.activeRange,o)||(o=l.currentRange.start);for(let f of r.pluginHooks.contextInit)f(a);let c=zS(r.calendarOptions,l,a),d={dynamicOptionOverrides:t,currentViewType:s,currentDate:o,dateProfile:l,businessHours:this.parseContextBusinessHours(a),eventSources:c,eventUiBases:{},eventStore:He(),renderableEventStore:He(),dateSelection:null,eventSelection:"",eventDrag:null,eventResize:null,selectionConfig:this.buildViewUiProps(a).selectionConfig},u=Object.assign(Object.assign({},a),d);for(let f of r.pluginHooks.reducers)Object.assign(d,f(null,null,u));sh(d,a)&&this.emitter.trigger("loading",!0),this.state=d,this.updateData(),this.actionRunner.resume()}resetOptions(e,t){let{props:r}=this;t===void 0?r.optionOverrides=e:(r.optionOverrides=Object.assign(Object.assign({},r.optionOverrides||{}),e),this.optionsForRefining.push(...t)),(t===void 0||t.length)&&this.actionRunner.request({type:"NOTHING"})}_handleAction(e){let{props:t,state:r,emitter:s}=this,n=$S(r.dynamicOptionOverrides,e),a=this.computeOptionsData(t.optionOverrides,n,t.calendarApi),o=BS(r.currentViewType,e),l=this.computeCurrentViewData(o,a,t.optionOverrides,n);t.calendarApi.currentDataManager=this,s.setThisContext(t.calendarApi),s.setOptions(l.options);let c={nowManager:this.nowManager,dateEnv:a.dateEnv,options:a.calendarOptions,pluginHooks:a.pluginHooks,calendarApi:t.calendarApi,dispatch:this.dispatch,emitter:s,getCurrentData:this.getCurrentData},{currentDate:d,dateProfile:u}=r;this.data&&this.data.dateProfileGenerator!==l.dateProfileGenerator&&(u=l.dateProfileGenerator.build(d)),d=WS(d,e),u=VS(u,e,d,l.dateProfileGenerator),(e.type==="PREV"||e.type==="NEXT"||!Dt(u.currentRange,d))&&(d=u.currentRange.start);let f=jS(r.eventSources,e,u,c),h=mb(r.eventStore,e,f,u,c),p=Zb(f)&&!l.options.progressiveEventRendering&&r.renderableEventStore||h,{eventUiSingleBase:g,selectionConfig:v}=this.buildViewUiProps(c),w=this.buildEventUiBySource(f),_=this.buildEventUiBases(p.defs,g,w),E={dynamicOptionOverrides:n,currentViewType:o,currentDate:d,dateProfile:u,eventSources:f,eventStore:h,renderableEventStore:p,selectionConfig:v,eventUiBases:_,businessHours:this.parseContextBusinessHours(c),dateSelection:XS(r.dateSelection,e),eventSelection:JS(r.eventSelection,e),eventDrag:eC(r.eventDrag,e),eventResize:tC(r.eventResize,e)},S=Object.assign(Object.assign({},c),E);for(let C of a.pluginHooks.reducers)Object.assign(E,C(r,e,S));let D=sh(r,c),A=sh(E,c);!D&&A?s.trigger("loading",!0):D&&!A&&s.trigger("loading",!1),this.state=E,t.onAction&&t.onAction(e)}updateData(){let{props:e,state:t}=this,r=this.data,s=this.computeOptionsData(e.optionOverrides,t.dynamicOptionOverrides,e.calendarApi),n=this.computeCurrentViewData(t.currentViewType,s,e.optionOverrides,t.dynamicOptionOverrides),a=this.data=Object.assign(Object.assign(Object.assign({nowManager:this.nowManager,viewTitle:this.buildTitle(t.dateProfile,n.options,s.dateEnv),calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},s),n),t),o=s.pluginHooks.optionChangeHandlers,l=r&&r.calendarOptions,c=s.calendarOptions;if(l&&l!==c){l.timeZone!==c.timeZone&&(t.eventSources=a.eventSources=qS(a.eventSources,t.dateProfile,a),t.eventStore=a.eventStore=Bf(a.eventStore,r.dateEnv,a.dateEnv),t.renderableEventStore=a.renderableEventStore=Bf(a.renderableEventStore,r.dateEnv,a.dateEnv));for(let d in o)(this.optionsForHandling.indexOf(d)!==-1||l[d]!==c[d])&&o[d](c[d],a)}this.optionsForHandling=[],e.onData&&e.onData(a)}computeOptionsData(e,t,r){if(!this.optionsForRefining.length&&e===this.stableOptionOverrides&&t===this.stableDynamicOptionOverrides)return this.stableCalendarOptionsData;let{refinedOptions:s,pluginHooks:n,localeDefaults:a,availableLocaleData:o,extra:l}=this.processRawCalendarOptions(e,t);qb(l);let c=this.buildDateEnv(s.timeZone,s.locale,s.weekNumberCalculation,s.firstDay,s.weekText,n,o,s.defaultRangeSeparator),d=this.buildViewSpecs(n.views,this.stableOptionOverrides,this.stableDynamicOptionOverrides,a),u=this.buildTheme(s,n),f=this.parseToolbars(s,this.stableOptionOverrides,u,d,r);return this.stableCalendarOptionsData={calendarOptions:s,pluginHooks:n,dateEnv:c,viewSpecs:d,theme:u,toolbarConfig:f,localeDefaults:a,availableRawLocales:o.map}}processRawCalendarOptions(e,t){let{locales:r,locale:s}=Zl([cr,e,t]),n=this.organizeRawLocales(r),a=n.map,o=this.buildLocale(s||n.defaultCode,a).options,l=this.buildPluginHooks(e.plugins||[],bC),c=this.currentCalendarOptionsRefiners=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},_f),xf),Mf),l.listenerRefiners),l.optionRefiners),d={},u=Zl([cr,o,e,t]),f={},h=this.currentCalendarOptionsInput,m=this.currentCalendarOptionsRefined,p=!1;for(let g in u)this.optionsForRefining.indexOf(g)===-1&&(u[g]===h[g]||ps[g]&&g in h&&ps[g](h[g],u[g]))?f[g]=m[g]:c[g]?(f[g]=c[g](u[g]),p=!0):d[g]=h[g];return p&&(this.currentCalendarOptionsInput=u,this.currentCalendarOptionsRefined=f,this.stableOptionOverrides=e,this.stableDynamicOptionOverrides=t),this.optionsForHandling.push(...this.optionsForRefining),this.optionsForRefining=[],{rawOptions:this.currentCalendarOptionsInput,refinedOptions:this.currentCalendarOptionsRefined,pluginHooks:l,availableLocaleData:n,localeDefaults:o,extra:d}}_computeCurrentViewData(e,t,r,s){let n=t.viewSpecs[e];if(!n)throw new Error(`viewType "${e}" is not available. Please make sure you've loaded all neccessary plugins`);let{refinedOptions:a,extra:o}=this.processRawViewOptions(n,t.pluginHooks,t.localeDefaults,r,s);qb(o),this.nowManager.handleInput(t.dateEnv,a.now);let l=this.buildDateProfileGenerator({dateProfileGeneratorClass:n.optionDefaults.dateProfileGeneratorClass,nowManager:this.nowManager,duration:n.duration,durationUnit:n.durationUnit,usesMinMaxTime:n.optionDefaults.usesMinMaxTime,dateEnv:t.dateEnv,calendarApi:this.props.calendarApi,slotMinTime:a.slotMinTime,slotMaxTime:a.slotMaxTime,showNonCurrentDates:a.showNonCurrentDates,dayCount:a.dayCount,dateAlignment:a.dateAlignment,dateIncrement:a.dateIncrement,hiddenDays:a.hiddenDays,weekends:a.weekends,validRangeInput:a.validRange,visibleRangeInput:a.visibleRange,fixedWeekCount:a.fixedWeekCount}),c=this.buildViewApi(e,this.getCurrentData,t.dateEnv);return{viewSpec:n,options:a,dateProfileGenerator:l,viewApi:c}}processRawViewOptions(e,t,r,s,n){let a=Zl([cr,e.optionDefaults,r,s,e.optionOverrides,n]),o=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},_f),xf),Mf),nb),t.listenerRefiners),t.optionRefiners),l={},c=this.currentViewOptionsInput,d=this.currentViewOptionsRefined,u=!1,f={};for(let h in a)a[h]===c[h]||ps[h]&&ps[h](a[h],c[h])?l[h]=d[h]:(a[h]===this.currentCalendarOptionsInput[h]||ps[h]&&ps[h](a[h],this.currentCalendarOptionsInput[h])?h in this.currentCalendarOptionsRefined&&(l[h]=this.currentCalendarOptionsRefined[h]):o[h]?l[h]=o[h](a[h]):f[h]=a[h],u=!0);return u&&(this.currentViewOptionsInput=a,this.currentViewOptionsRefined=l),{rawOptions:this.currentViewOptionsInput,refinedOptions:this.currentViewOptionsRefined,extra:f}}};function EC(i,e,t,r,s,n,a,o){let l=Gb(e||a.defaultCode,a.map);return new ma({calendarSystem:"gregory",timeZone:i,namedTimeZoneImpl:n.namedTimeZonedImpl,locale:l,weekNumberCalculation:t,firstDay:r,weekText:s,cmdFormatter:n.cmdFormatter,defaultSeparator:o})}function kC(i,e){let t=e.themeClasses[i.themeSystem]||ur;return new t(i)}function DC(i){let e=i.dateProfileGeneratorClass||Us;return new e(i)}function SC(i,e,t){return new nh(i,e,t)}function CC(i){return St(i,e=>e.ui)}function _C(i,e,t){let r={"":e};for(let s in i){let n=i[s];n.sourceId&&t[n.sourceId]&&(r[s]=t[n.sourceId])}return r}function xC(i){let{options:e}=i;return{eventUiSingleBase:zi({display:e.eventDisplay,editable:e.editable,startEditable:e.eventStartEditable,durationEditable:e.eventDurationEditable,constraint:e.eventConstraint,overlap:typeof e.eventOverlap=="boolean"?e.eventOverlap:void 0,allow:e.eventAllow,backgroundColor:e.eventBackgroundColor,borderColor:e.eventBorderColor,textColor:e.eventTextColor,color:e.eventColor},i),selectionConfig:zi({constraint:e.selectConstraint,overlap:typeof e.selectOverlap=="boolean"?e.selectOverlap:void 0,allow:e.selectAllow},i)}}function sh(i,e){for(let t of e.pluginHooks.isLoadingFuncs)if(t(i))return!0;return!1}function MC(i){return Wf(i.options.businessHours,i)}function qb(i,e){for(let t in i)console.warn(`Unknown option '${t}'`+(e?` for view '${e}'`:""))}var lh=class extends G{render(){let e=this.props.widgetGroups.map(t=>this.renderWidgetGroup(t));return y("div",{className:"fc-toolbar-chunk"},...e)}renderWidgetGroup(e){let{props:t}=this,{theme:r}=this.context,s=[],n=!0;for(let a of e){let{buttonName:o,buttonClick:l,buttonText:c,buttonIcon:d,buttonHint:u}=a;if(o==="title")n=!1,s.push(y("h2",{className:"fc-toolbar-title",id:t.titleId},t.title));else{let f=o===t.activeButton,h=!t.isTodayEnabled&&o==="today"||!t.isPrevEnabled&&o==="prev"||!t.isNextEnabled&&o==="next",m=[`fc-${o}-button`,r.getClass("button")];f&&m.push(r.getClass("buttonActive")),s.push(y("button",{type:"button",title:typeof u=="function"?u(t.navUnit):u,disabled:h,"aria-pressed":f,className:m.join(" "),onClick:l},c||(d?y("span",{className:d,role:"img"}):"")))}}if(s.length>1){let a=n&&r.getClass("buttonGroup")||"";return y("div",{className:a},...s)}return s[0]}},uc=class extends G{render(){let{model:e,extraClassName:t}=this.props,r=!1,s,n,a=e.sectionWidgets,o=a.center;return a.left?(r=!0,s=a.left):s=a.start,a.right?(r=!0,n=a.right):n=a.end,y("div",{className:[t||"","fc-toolbar",r?"fc-toolbar-ltr":""].join(" ")},this.renderSection("start",s||[]),this.renderSection("center",o||[]),this.renderSection("end",n||[]))}renderSection(e,t){let{props:r}=this;return y(lh,{key:e,widgetGroups:t,title:r.title,navUnit:r.navUnit,activeButton:r.activeButton,isTodayEnabled:r.isTodayEnabled,isPrevEnabled:r.isPrevEnabled,isNextEnabled:r.isNextEnabled,titleId:r.titleId})}},ch=class extends G{constructor(){super(...arguments),this.state={availableWidth:null},this.handleEl=e=>{this.el=e,xt(this.props.elRef,e),this.updateAvailableWidth()},this.handleResize=()=>{this.updateAvailableWidth()}}render(){let{props:e,state:t}=this,{aspectRatio:r}=e,s=["fc-view-harness",r||e.liquid||e.height?"fc-view-harness-active":"fc-view-harness-passive"],n="",a="";return r?t.availableWidth!==null?n=t.availableWidth/r:a=`${1/r*100}%`:n=e.height||"",y("div",{"aria-labelledby":e.labeledById,ref:this.handleEl,className:s.join(" "),style:{height:n,paddingBottom:a}},e.children)}componentDidMount(){this.context.addResizeHandler(this.handleResize)}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}updateAvailableWidth(){this.el&&this.props.aspectRatio&&this.setState({availableWidth:this.el.offsetWidth})}},dh=class extends jt{constructor(e){super(e),this.handleSegClick=(t,r)=>{let{component:s}=this,{context:n}=s,a=Nr(r);if(a&&s.isValidSegDownEl(t.target)){let o=Le(t.target,".fc-event-forced-url"),l=o?o.querySelector("a[href]").href:"";n.emitter.trigger("eventClick",{el:r,event:new ve(s.context,a.eventRange.def,a.eventRange.instance),jsEvent:t,view:n.viewApi}),l&&!t.defaultPrevented&&(window.location.href=l)}},this.destroy=mf(e.el,"click",".fc-event",this.handleSegClick)}},uh=class extends jt{constructor(e){super(e),this.handleEventElRemove=t=>{t===this.currentSegEl&&this.handleSegLeave(null,this.currentSegEl)},this.handleSegEnter=(t,r)=>{Nr(r)&&(this.currentSegEl=r,this.triggerEvent("eventMouseEnter",t,r))},this.handleSegLeave=(t,r)=>{this.currentSegEl&&(this.currentSegEl=null,this.triggerEvent("eventMouseLeave",t,r))},this.removeHoverListeners=Kv(e.el,".fc-event",this.handleSegEnter,this.handleSegLeave)}destroy(){this.removeHoverListeners()}triggerEvent(e,t,r){let{component:s}=this,{context:n}=s,a=Nr(r);(!t||s.isValidSegDownEl(t.target))&&n.emitter.trigger(e,{el:r,event:new ve(n,a.eventRange.def,a.eventRange.instance),jsEvent:t,view:n.viewApi})}},fh=class extends ar{constructor(){super(...arguments),this.buildViewContext=W(db),this.buildViewPropTransformers=W(IC),this.buildToolbarProps=W(AC),this.headerRef=Se(),this.footerRef=Se(),this.interactionsStore={},this.state={viewLabelId:Ir()},this.registerInteractiveComponent=(e,t)=>{let r=Tb(e,t),a=[dh,uh].concat(this.props.pluginHooks.componentInteractions).map(o=>new o(r));this.interactionsStore[e.uid]=a,ei[e.uid]=r},this.unregisterInteractiveComponent=e=>{let t=this.interactionsStore[e.uid];if(t){for(let r of t)r.destroy();delete this.interactionsStore[e.uid]}delete ei[e.uid]},this.resizeRunner=new Ws(()=>{this.props.emitter.trigger("_resize",!0),this.props.emitter.trigger("windowResize",{view:this.props.viewApi})}),this.handleWindowResize=e=>{let{options:t}=this.props;t.handleWindowResize&&e.target===window&&this.resizeRunner.request(t.windowResizeDelay)}}render(){let{props:e}=this,{toolbarConfig:t,options:r}=e,s=!1,n="",a;e.isHeightAuto||e.forPrint?n="":r.height!=null?s=!0:r.contentHeight!=null?n=r.contentHeight:a=Math.max(r.aspectRatio,.5);let o=this.buildViewContext(e.viewSpec,e.viewApi,e.options,e.dateProfileGenerator,e.dateEnv,e.nowManager,e.theme,e.pluginHooks,e.dispatch,e.getCurrentData,e.emitter,e.calendarApi,this.registerInteractiveComponent,this.unregisterInteractiveComponent),l=t.header&&t.header.hasTitle?this.state.viewLabelId:void 0;return y(_t.Provider,{value:o},y(Ct,{unit:"day"},c=>{let d=this.buildToolbarProps(e.viewSpec,e.dateProfile,e.dateProfileGenerator,e.currentDate,c,e.viewTitle);return y(fe,null,t.header&&y(uc,Object.assign({ref:this.headerRef,extraClassName:"fc-header-toolbar",model:t.header,titleId:l},d)),y(ch,{liquid:s,height:n,aspectRatio:a,labeledById:l},this.renderView(e),this.buildAppendContent()),t.footer&&y(uc,Object.assign({ref:this.footerRef,extraClassName:"fc-footer-toolbar",model:t.footer,titleId:""},d)))}))}componentDidMount(){let{props:e}=this;this.calendarInteractions=e.pluginHooks.calendarInteractions.map(r=>new r(e)),window.addEventListener("resize",this.handleWindowResize);let{propSetHandlers:t}=e.pluginHooks;for(let r in t)t[r](e[r],e)}componentDidUpdate(e){let{props:t}=this,{propSetHandlers:r}=t.pluginHooks;for(let s in r)t[s]!==e[s]&&r[s](t[s],t)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),this.resizeRunner.clear();for(let e of this.calendarInteractions)e.destroy();this.props.emitter.trigger("_unmount")}buildAppendContent(){let{props:e}=this,t=e.pluginHooks.viewContainerAppends.map(r=>r(e));return y(fe,{},...t)}renderView(e){let{pluginHooks:t}=e,{viewSpec:r}=e,s={dateProfile:e.dateProfile,businessHours:e.businessHours,eventStore:e.renderableEventStore,eventUiBases:e.eventUiBases,dateSelection:e.dateSelection,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,isHeightAuto:e.isHeightAuto,forPrint:e.forPrint},n=this.buildViewPropTransformers(t.viewPropsTransformers);for(let o of n)Object.assign(s,o.transform(s,e));let a=r.component;return y(a,Object.assign({},s))}};function AC(i,e,t,r,s,n){let a=t.build(s,void 0,!1),o=t.buildPrev(e,r,!1),l=t.buildNext(e,r,!1);return{title:n,activeButton:i.type,navUnit:i.singleUnit,isTodayEnabled:a.isValid&&!Dt(e.currentRange,s),isPrevEnabled:o.isValid,isNextEnabled:l.isValid}}function IC(i){return i.map(e=>new e)}var fc=class extends Ta{constructor(e,t={}){super(),this.isRendering=!1,this.isRendered=!1,this.currentClassNames=[],this.customContentRenderId=0,this.handleAction=r=>{switch(r.type){case"SET_EVENT_DRAG":case"SET_EVENT_RESIZE":this.renderRunner.tryDrain()}},this.handleData=r=>{this.currentData=r,this.renderRunner.request(r.calendarOptions.rerenderDelay)},this.handleRenderRequest=()=>{if(this.isRendering){this.isRendered=!0;let{currentData:r}=this;ga(()=>{as(y(wa,{options:r.calendarOptions,theme:r.theme,emitter:r.emitter},(s,n,a,o)=>(this.setClassNames(s),this.setHeight(n),y(Pf.Provider,{value:this.customContentRenderId},y(fh,Object.assign({isHeightAuto:a,forPrint:o},r))))),this.el)})}else this.isRendered&&(this.isRendered=!1,as(null,this.el),this.setClassNames([]),this.setHeight(""))},qv(e),this.el=e,this.renderRunner=new Ws(this.handleRenderRequest),new oh({optionOverrides:t,calendarApi:this,onAction:this.handleAction,onData:this.handleData})}render(){let e=this.isRendering;e?this.customContentRenderId+=1:this.isRendering=!0,this.renderRunner.request(),e&&this.updateSize()}destroy(){this.isRendering&&(this.isRendering=!1,this.renderRunner.request())}updateSize(){ga(()=>{super.updateSize()})}batchRendering(e){this.renderRunner.pause("batchRendering"),e(),this.renderRunner.resume("batchRendering")}pauseRendering(){this.renderRunner.pause("pauseRendering")}resumeRendering(){this.renderRunner.resume("pauseRendering",!0)}resetOptions(e,t){this.currentDataManager.resetOptions(e,t)}setClassNames(e){if(!lr(e,this.currentClassNames)){let{classList:t}=this.el;for(let r of this.currentClassNames)t.remove(r);for(let r of e)t.add(r);this.currentClassNames=e}}setHeight(e){pf(this.el,"height",e)}};var ph=class extends ze{constructor(){super(...arguments),this.headerElRef=Se()}renderSimpleLayout(e,t){let{props:r,context:s}=this,n=[],a=ri(s.options);return e&&n.push({type:"header",key:"header",isSticky:a,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),n.push({type:"body",key:"body",liquid:!0,chunk:{content:t}}),y(zt,{elClasses:["fc-daygrid"],viewSpec:s.viewSpec},y(us,{liquid:!r.isHeightAuto&&!r.forPrint,collapsibleWidth:r.forPrint,cols:[],sections:n}))}renderHScrollLayout(e,t,r,s){let n=this.context.pluginHooks.scrollGridImpl;if(!n)throw new Error("No ScrollGrid implementation");let{props:a,context:o}=this,l=!a.forPrint&&ri(o.options),c=!a.forPrint&&za(o.options),d=[];return e&&d.push({type:"header",key:"header",isSticky:l,chunks:[{key:"main",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),d.push({type:"body",key:"body",liquid:!0,chunks:[{key:"main",content:t}]}),c&&d.push({type:"footer",key:"footer",isSticky:!0,chunks:[{key:"main",content:qi}]}),y(zt,{elClasses:["fc-daygrid"],viewSpec:o.viewSpec},y(n,{liquid:!a.isHeightAuto&&!a.forPrint,forPrint:a.forPrint,collapsibleWidth:a.forPrint,colGroups:[{cols:[{span:r,minWidth:s}]}],sections:d}))}};function hc(i,e){let t=[];for(let r=0;r<e;r+=1)t[r]=[];for(let r of i)t[r.row].push(r);return t}function pc(i,e){let t=[];for(let r=0;r<e;r+=1)t[r]=[];for(let r of i)t[r.firstCol].push(r);return t}function rw(i,e){let t=[];if(i){for(let r=0;r<e;r+=1)t[r]={affectedInstances:i.affectedInstances,isEvent:i.isEvent,segs:[]};for(let r of i.segs)t[r.row].segs.push(r)}else for(let r=0;r<e;r+=1)t[r]=null;return t}var sw=pe({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"narrow"});function iw(i){let{display:e}=i.eventRange.ui;return e==="list-item"||e==="auto"&&!i.eventRange.def.allDay&&i.firstCol===i.lastCol&&i.isStart&&i.isEnd}var mc=class extends G{render(){let{props:e}=this;return y(Ks,Object.assign({},e,{elClasses:["fc-daygrid-event","fc-daygrid-block-event","fc-h-event"],defaultTimeFormat:sw,defaultDisplayEventEnd:e.defaultDisplayEventEnd,disableResizing:!e.seg.eventRange.def.allDay}))}},gc=class extends G{render(){let{props:e,context:t}=this,{options:r}=t,{seg:s}=e,n=r.eventTimeFormat||sw,a=ic(s,n,t,!0,e.defaultDisplayEventEnd);return y(Gs,Object.assign({},e,{elTag:"a",elClasses:["fc-daygrid-event","fc-daygrid-dot-event"],elAttrs:nc(e.seg,t),defaultGenerator:PC,timeText:a,isResizing:!1,isDateSelecting:!1}))}};function PC(i){return y(fe,null,y("div",{className:"fc-daygrid-event-dot",style:{borderColor:i.borderColor||i.backgroundColor}}),i.timeText&&y("div",{className:"fc-event-time"},i.timeText),y("div",{className:"fc-event-title"},i.event.title||y(fe,null,"\xA0")))}var mh=class extends G{constructor(){super(...arguments),this.compileSegs=W(RC)}render(){let{props:e}=this,{allSegs:t,invisibleSegs:r}=this.compileSegs(e.singlePlacements);return y(Xs,{elClasses:["fc-daygrid-more-link"],dateProfile:e.dateProfile,todayRange:e.todayRange,allDayDate:e.allDayDate,moreCnt:e.moreCnt,allSegs:t,hiddenSegs:r,alignmentElRef:e.alignmentElRef,alignGridTop:e.alignGridTop,extraDateSpan:e.extraDateSpan,popoverContent:()=>{let s=(e.eventDrag?e.eventDrag.affectedInstances:null)||(e.eventResize?e.eventResize.affectedInstances:null)||{};return y(fe,null,t.map(n=>{let a=n.eventRange.instance.instanceId;return y("div",{className:"fc-daygrid-event-harness",key:a,style:{visibility:s[a]?"hidden":""}},iw(n)?y(gc,Object.assign({seg:n,isDragging:!1,isSelected:a===e.eventSelection,defaultDisplayEventEnd:!1},Yt(n,e.todayRange))):y(mc,Object.assign({seg:n,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:a===e.eventSelection,defaultDisplayEventEnd:!1},Yt(n,e.todayRange))))}))}})}};function RC(i){let e=[],t=[];for(let r of i)e.push(r.seg),r.isVisible||t.push(r.seg);return{allSegs:e,invisibleSegs:t}}var NC=pe({week:"narrow"}),gh=class extends ze{constructor(){super(...arguments),this.rootElRef=Se(),this.state={dayNumberId:Ir()},this.handleRootEl=e=>{xt(this.rootElRef,e),xt(this.props.elRef,e)}}render(){let{context:e,props:t,state:r,rootElRef:s}=this,{options:n,dateEnv:a}=e,{date:o,dateProfile:l}=t,c=t.showDayNumber&&LC(o,l.currentRange,a);return y(fs,{elTag:"td",elRef:this.handleRootEl,elClasses:["fc-daygrid-day",...t.extraClassNames||[]],elAttrs:Object.assign(Object.assign(Object.assign({},t.extraDataAttrs),t.showDayNumber?{"aria-labelledby":r.dayNumberId}:{}),{role:"gridcell"}),defaultGenerator:OC,date:o,dateProfile:l,todayRange:t.todayRange,showDayNumber:t.showDayNumber,isMonthStart:c,extraRenderProps:t.extraRenderProps},(d,u)=>y("div",{ref:t.innerElRef,className:"fc-daygrid-day-frame fc-scrollgrid-sync-inner",style:{minHeight:t.minHeight}},t.showWeekNumber&&y(Ya,{elTag:"a",elClasses:["fc-daygrid-week-number"],elAttrs:ti(e,o,"week"),date:o,defaultFormat:NC}),!u.isDisabled&&(t.showDayNumber||Yi(n)||t.forceDayTop)?y("div",{className:"fc-daygrid-day-top"},y(d,{elTag:"a",elClasses:["fc-daygrid-day-number",c&&"fc-daygrid-month-start"],elAttrs:Object.assign(Object.assign({},ti(e,o)),{id:r.dayNumberId})})):t.showDayNumber?y("div",{className:"fc-daygrid-day-top",style:{visibility:"hidden"}},y("a",{className:"fc-daygrid-day-number"},"\xA0")):void 0,y("div",{className:"fc-daygrid-day-events",ref:t.fgContentElRef},t.fgContent,y("div",{className:"fc-daygrid-day-bottom",style:{marginTop:t.moreMarginTop}},y(mh,{allDayDate:o,singlePlacements:t.singlePlacements,moreCnt:t.moreCnt,alignmentElRef:s,alignGridTop:!t.showDayNumber,extraDateSpan:t.extraDateSpan,dateProfile:t.dateProfile,eventSelection:t.eventSelection,eventDrag:t.eventDrag,eventResize:t.eventResize,todayRange:t.todayRange}))),y("div",{className:"fc-daygrid-day-bg"},t.bgContent)))}};function OC(i){return i.dayNumberText||y(fe,null,"\xA0")}function LC(i,e,t){let{start:r,end:s}=e,n=nr(s,-1),a=t.getYear(r),o=t.getMonth(r),l=t.getYear(n),c=t.getMonth(n);return!(a===l&&o===c)&&Boolean(i.valueOf()===r.valueOf()||t.getDay(i)===1&&i.valueOf()<s.valueOf())}function nw(i){return i.eventRange.instance.instanceId+":"+i.firstCol}function aw(i){return nw(i)+":"+i.lastCol}function FC(i,e,t,r,s,n,a){let o=new yh(v=>{let w=i[v.index].eventRange.instance.instanceId+":"+v.span.start+":"+(v.span.end-1);return s[w]||1});o.allowReslicing=!0,o.strictOrder=r,e===!0||t===!0?(o.maxCoord=n,o.hiddenConsumes=!0):typeof e=="number"?o.maxStackCnt=e:typeof t=="number"&&(o.maxStackCnt=t,o.hiddenConsumes=!0);let l=[],c=[];for(let v=0;v<i.length;v+=1){let w=i[v],_=aw(w);s[_]!=null?l.push({index:v,span:{start:w.firstCol,end:w.lastCol+1}}):c.push(w)}let d=o.addSegs(l),u=o.toRects(),{singleColPlacements:f,multiColPlacements:h,leftoverMargins:m}=HC(u,i,a),p=[],g=[];for(let v of c){h[v.firstCol].push({seg:v,isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let w=v.firstCol;w<=v.lastCol;w+=1)f[w].push({seg:Qi(v,w,w+1,a),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let v=0;v<a.length;v+=1)p.push(0);for(let v of d){let w=i[v.index],_=v.span;h[_.start].push({seg:Qi(w,_.start,_.end,a),isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let E=_.start;E<_.end;E+=1)p[E]+=1,f[E].push({seg:Qi(w,E,E+1,a),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let v=0;v<a.length;v+=1)g.push(m[v]);return{singleColPlacements:f,multiColPlacements:h,moreCnts:p,moreMarginTops:g}}function HC(i,e,t){let r=BC(i,t.length),s=[],n=[],a=[];for(let o=0;o<t.length;o+=1){let l=r[o],c=[],d=0,u=0;for(let h of l){let m=e[h.index];c.push({seg:Qi(m,o,o+1,t),isVisible:!0,isAbsolute:!1,absoluteTop:h.levelCoord,marginTop:h.levelCoord-d}),d=h.levelCoord+h.thickness}let f=[];d=0,u=0;for(let h of l){let m=e[h.index],p=h.span.end-h.span.start>1,g=h.span.start===o;u+=h.levelCoord-d,d=h.levelCoord+h.thickness,p?(u+=h.thickness,g&&f.push({seg:Qi(m,h.span.start,h.span.end,t),isVisible:!0,isAbsolute:!0,absoluteTop:h.levelCoord,marginTop:0})):g&&(f.push({seg:Qi(m,h.span.start,h.span.end,t),isVisible:!0,isAbsolute:!1,absoluteTop:h.levelCoord,marginTop:u}),u=0)}s.push(c),n.push(f),a.push(u)}return{singleColPlacements:s,multiColPlacements:n,leftoverMargins:a}}function BC(i,e){let t=[];for(let r=0;r<e;r+=1)t.push([]);for(let r of i)for(let s=r.span.start;s<r.span.end;s+=1)t[s].push(r);return t}function Qi(i,e,t,r){if(i.firstCol===e&&i.lastCol===t-1)return i;let s=i.eventRange,n=s.range,a=ht(n,{start:r[e].date,end:Fe(r[t-1].date,1)});return Object.assign(Object.assign({},i),{firstCol:e,lastCol:t-1,eventRange:{def:s.def,ui:Object.assign(Object.assign({},s.ui),{durationEditable:!1}),instance:s.instance,range:a},isStart:i.isStart&&a.start.valueOf()===n.start.valueOf(),isEnd:i.isEnd&&a.end.valueOf()===n.end.valueOf()})}var yh=class extends js{constructor(){super(...arguments),this.hiddenConsumes=!1,this.forceHidden={}}addSegs(e){let t=super.addSegs(e),{entriesByLevel:r}=this,s=n=>!this.forceHidden[or(n)];for(let n=0;n<r.length;n+=1)r[n]=r[n].filter(s);return t}handleInvalidInsertion(e,t,r){let{entriesByLevel:s,forceHidden:n}=this,{touchingEntry:a,touchingLevel:o,touchingLateral:l}=e;if(this.hiddenConsumes&&a){let c=or(a);if(!n[c])if(this.allowReslicing){let d=Object.assign(Object.assign({},a),{span:Ua(a.span,t.span)}),u=or(d);n[u]=!0,s[o][l]=d,r.push(d),this.splitEntry(a,t,r)}else n[c]=!0,r.push(a)}super.handleInvalidInsertion(e,t,r)}},yc=class extends ze{constructor(){super(...arguments),this.cellElRefs=new nt,this.frameElRefs=new nt,this.fgElRefs=new nt,this.segHarnessRefs=new nt,this.rootElRef=Se(),this.state={framePositions:null,maxContentHeight:null,segHeights:{}},this.handleResize=e=>{e&&this.updateSizing(!0)}}render(){let{props:e,state:t,context:r}=this,{options:s}=r,n=e.cells.length,a=pc(e.businessHourSegs,n),o=pc(e.bgEventSegs,n),l=pc(this.getHighlightSegs(),n),c=pc(this.getMirrorSegs(),n),{singleColPlacements:d,multiColPlacements:u,moreCnts:f,moreMarginTops:h}=FC(Fa(e.fgEventSegs,s.eventOrder),e.dayMaxEvents,e.dayMaxEventRows,s.eventOrderStrict,t.segHeights,t.maxContentHeight,e.cells),m=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{};return y("tr",{ref:this.rootElRef,role:"row"},e.renderIntro&&e.renderIntro(),e.cells.map((p,g)=>{let v=this.renderFgSegs(g,e.forPrint?d[g]:u[g],e.todayRange,m),w=this.renderFgSegs(g,WC(c[g],u),e.todayRange,{},Boolean(e.eventDrag),Boolean(e.eventResize),!1);return y(gh,{key:p.key,elRef:this.cellElRefs.createRef(p.key),innerElRef:this.frameElRefs.createRef(p.key),dateProfile:e.dateProfile,date:p.date,showDayNumber:e.showDayNumbers,showWeekNumber:e.showWeekNumbers&&g===0,forceDayTop:e.showWeekNumbers,todayRange:e.todayRange,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,extraRenderProps:p.extraRenderProps,extraDataAttrs:p.extraDataAttrs,extraClassNames:p.extraClassNames,extraDateSpan:p.extraDateSpan,moreCnt:f[g],moreMarginTop:h[g],singlePlacements:d[g],fgContentElRef:this.fgElRefs.createRef(p.key),fgContent:y(fe,null,y(fe,null,v),y(fe,null,w)),bgContent:y(fe,null,this.renderFillSegs(l[g],"highlight"),this.renderFillSegs(a[g],"non-business"),this.renderFillSegs(o[g],"bg-event")),minHeight:e.cellMinHeight})}))}componentDidMount(){this.updateSizing(!0),this.context.addResizeHandler(this.handleResize)}componentDidUpdate(e,t){let r=this.props;this.updateSizing(!et(e,r))}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}getHighlightSegs(){let{props:e}=this;return e.eventDrag&&e.eventDrag.segs.length?e.eventDrag.segs:e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:e.dateSelectionSegs}getMirrorSegs(){let{props:e}=this;return e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:[]}renderFgSegs(e,t,r,s,n,a,o){let{context:l}=this,{eventSelection:c}=this.props,{framePositions:d}=this.state,u=this.props.cells.length===1,f=n||a||o,h=[];if(d)for(let m of t){let{seg:p}=m,{instanceId:g}=p.eventRange.instance,v=m.isVisible&&!s[g],w=m.isAbsolute,_="",E="";w&&(l.isRtl?(E=0,_=d.lefts[p.lastCol]-d.lefts[p.firstCol]):(_=0,E=d.rights[p.firstCol]-d.rights[p.lastCol])),h.push(y("div",{className:"fc-daygrid-event-harness"+(w?" fc-daygrid-event-harness-abs":""),key:nw(p),ref:f?null:this.segHarnessRefs.createRef(aw(p)),style:{visibility:v?"":"hidden",marginTop:w?"":m.marginTop,top:w?m.absoluteTop:"",left:_,right:E}},iw(p)?y(gc,Object.assign({seg:p,isDragging:n,isSelected:g===c,defaultDisplayEventEnd:u},Yt(p,r))):y(mc,Object.assign({seg:p,isDragging:n,isResizing:a,isDateSelecting:o,isSelected:g===c,defaultDisplayEventEnd:u},Yt(p,r)))))}return h}renderFillSegs(e,t){let{isRtl:r}=this.context,{todayRange:s}=this.props,{framePositions:n}=this.state,a=[];if(n)for(let o of e){let l=r?{right:0,left:n.lefts[o.lastCol]-n.lefts[o.firstCol]}:{left:0,right:n.rights[o.firstCol]-n.rights[o.lastCol]};a.push(y("div",{key:Ha(o.eventRange),className:"fc-daygrid-bg-harness",style:l},t==="bg-event"?y(Zs,Object.assign({seg:o},Yt(o,s))):qa(t)))}return y(fe,{},...a)}updateSizing(e){let{props:t,state:r,frameElRefs:s}=this;if(!t.forPrint&&t.clientWidth!==null){if(e){let l=t.cells.map(c=>s.currentMap[c.key]);if(l.length){let c=this.rootElRef.current,d=new qt(c,l,!0,!1);(!r.framePositions||!r.framePositions.similarTo(d))&&this.setState({framePositions:new qt(c,l,!0,!1)})}}let n=this.state.segHeights,a=this.querySegHeights(),o=t.dayMaxEvents===!0||t.dayMaxEventRows===!0;this.safeSetState({segHeights:Object.assign(Object.assign({},n),a),maxContentHeight:o?this.computeMaxContentHeight():null})}}querySegHeights(){let e=this.segHarnessRefs.currentMap,t={};for(let r in e){let s=Math.round(e[r].getBoundingClientRect().height);t[r]=Math.max(t[r]||0,s)}return t}computeMaxContentHeight(){let e=this.props.cells[0].key,t=this.cellElRefs.currentMap[e],r=this.fgElRefs.currentMap[e];return t.getBoundingClientRect().bottom-r.getBoundingClientRect().top}getCellEls(){let e=this.cellElRefs.currentMap;return this.props.cells.map(t=>e[t.key])}};yc.addStateEquality({segHeights:et});function WC(i,e){if(!i.length)return[];let t=UC(e);return i.map(r=>({seg:r,isVisible:!0,isAbsolute:!0,absoluteTop:t[r.eventRange.instance.instanceId],marginTop:0}))}function UC(i){let e={};for(let t of i)for(let r of t)e[r.seg.eventRange.instance.instanceId]=r.absoluteTop;return e}var Qa=class extends ze{constructor(){super(...arguments),this.splitBusinessHourSegs=W(hc),this.splitBgEventSegs=W(hc),this.splitFgEventSegs=W(hc),this.splitDateSelectionSegs=W(hc),this.splitEventDrag=W(rw),this.splitEventResize=W(rw),this.rowRefs=new nt}render(){let{props:e,context:t}=this,r=e.cells.length,s=this.splitBusinessHourSegs(e.businessHourSegs,r),n=this.splitBgEventSegs(e.bgEventSegs,r),a=this.splitFgEventSegs(e.fgEventSegs,r),o=this.splitDateSelectionSegs(e.dateSelectionSegs,r),l=this.splitEventDrag(e.eventDrag,r),c=this.splitEventResize(e.eventResize,r),d=r>=7&&e.clientWidth?e.clientWidth/t.options.aspectRatio/6:null;return y(Ct,{unit:"day"},(u,f)=>y(fe,null,e.cells.map((h,m)=>y(yc,{ref:this.rowRefs.createRef(m),key:h.length?h[0].date.toISOString():m,showDayNumbers:r>1,showWeekNumbers:e.showWeekNumbers,todayRange:f,dateProfile:e.dateProfile,cells:h,renderIntro:e.renderRowIntro,businessHourSegs:s[m],eventSelection:e.eventSelection,bgEventSegs:n[m].filter($C),fgEventSegs:a[m],dateSelectionSegs:o[m],eventDrag:l[m],eventResize:c[m],dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,clientWidth:e.clientWidth,clientHeight:e.clientHeight,cellMinHeight:d,forPrint:e.forPrint}))))}componentDidMount(){this.registerInteractiveComponent()}componentDidUpdate(){this.registerInteractiveComponent()}registerInteractiveComponent(){if(!this.rootEl){let e=this.rowRefs.currentMap[0].getCellEls()[0],t=e?e.closest(".fc-daygrid-body"):null;t&&(this.rootEl=t,this.context.registerInteractiveComponent(this,{el:t,isHitComboAllowed:this.props.isHitComboAllowed}))}}componentWillUnmount(){this.rootEl&&(this.context.unregisterInteractiveComponent(this),this.rootEl=null)}prepareHits(){this.rowPositions=new qt(this.rootEl,this.rowRefs.collect().map(e=>e.getCellEls()[0]),!1,!0),this.colPositions=new qt(this.rootEl,this.rowRefs.currentMap[0].getCellEls(),!0,!1)}queryHit(e,t){let{colPositions:r,rowPositions:s}=this,n=r.leftToIndex(e),a=s.topToIndex(t);if(a!=null&&n!=null){let o=this.props.cells[a][n];return{dateProfile:this.props.dateProfile,dateSpan:Object.assign({range:this.getCellRange(a,n),allDay:!0},o.extraDateSpan),dayEl:this.getCellEl(a,n),rect:{left:r.lefts[n],right:r.rights[n],top:s.tops[a],bottom:s.bottoms[a]},layer:0}}return null}getCellEl(e,t){return this.rowRefs.currentMap[e].getCellEls()[t]}getCellRange(e,t){let r=this.props.cells[e][t].date,s=Fe(r,1);return{start:r,end:s}}};function $C(i){return i.eventRange.def.allDay}var vh=class extends ze{constructor(){super(...arguments),this.elRef=Se(),this.needsScrollReset=!1}render(){let{props:e}=this,{dayMaxEventRows:t,dayMaxEvents:r,expandRows:s}=e,n=r===!0||t===!0;n&&!s&&(n=!1,t=null,r=null);let a=["fc-daygrid-body",n?"fc-daygrid-body-balanced":"fc-daygrid-body-unbalanced",s?"":"fc-daygrid-body-natural"];return y("div",{ref:this.elRef,className:a.join(" "),style:{width:e.clientWidth,minWidth:e.tableMinWidth}},y("table",{role:"presentation",className:"fc-scrollgrid-sync-table",style:{width:e.clientWidth,minWidth:e.tableMinWidth,height:s?e.clientHeight:""}},e.colGroupNode,y("tbody",{role:"presentation"},y(Qa,{dateProfile:e.dateProfile,cells:e.cells,renderRowIntro:e.renderRowIntro,showWeekNumbers:e.showWeekNumbers,clientWidth:e.clientWidth,clientHeight:e.clientHeight,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,dayMaxEvents:r,dayMaxEventRows:t,forPrint:e.forPrint,isHitComboAllowed:e.isHitComboAllowed}))))}componentDidMount(){this.requestScrollReset()}componentDidUpdate(e){e.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&this.props.clientWidth){let e=VC(this.elRef.current,this.props.dateProfile);if(e){let t=e.closest(".fc-daygrid-body"),r=t.closest(".fc-scroller"),s=e.getBoundingClientRect().top-t.getBoundingClientRect().top;r.scrollTop=s?s+1:0}this.needsScrollReset=!1}}};function VC(i,e){let t;return e.currentRangeUnit.match(/year|month/)&&(t=i.querySelector(`[data-date="${Wi(e.currentDate)}-01"]`)),t||(t=i.querySelector(`[data-date="${Pa(e.currentDate)}"]`)),t}var Ga=class extends Qs{constructor(){super(...arguments),this.forceDayIfListItem=!0}sliceRange(e,t){return t.sliceRange(e)}},Ka=class extends ze{constructor(){super(...arguments),this.slicer=new Ga,this.tableRef=Se()}render(){let{props:e,context:t}=this;return y(vh,Object.assign({ref:this.tableRef},this.slicer.sliceProps(e,e.dateProfile,e.nextDayThreshold,t,e.dayTableModel),{dateProfile:e.dateProfile,cells:e.dayTableModel.cells,colGroupNode:e.colGroupNode,tableMinWidth:e.tableMinWidth,renderRowIntro:e.renderRowIntro,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.showWeekNumbers,expandRows:e.expandRows,headerAlignElRef:e.headerAlignElRef,clientWidth:e.clientWidth,clientHeight:e.clientHeight,forPrint:e.forPrint}))}},vc=class extends ph{constructor(){super(...arguments),this.buildDayTableModel=W(bh),this.headerRef=Se(),this.tableRef=Se()}render(){let{options:e,dateProfileGenerator:t}=this.context,{props:r}=this,s=this.buildDayTableModel(r.dateProfile,t),n=e.dayHeaders&&y(Ar,{ref:this.headerRef,dateProfile:r.dateProfile,dates:s.headerDates,datesRepDistinctDays:s.rowCnt===1}),a=o=>y(Ka,{ref:this.tableRef,dateProfile:r.dateProfile,dayTableModel:s,businessHours:r.businessHours,dateSelection:r.dateSelection,eventStore:r.eventStore,eventUiBases:r.eventUiBases,eventSelection:r.eventSelection,eventDrag:r.eventDrag,eventResize:r.eventResize,nextDayThreshold:e.nextDayThreshold,colGroupNode:o.tableColGroupNode,tableMinWidth:o.tableMinWidth,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.weekNumbers,expandRows:!r.isHeightAuto,headerAlignElRef:this.headerElRef,clientWidth:o.clientWidth,clientHeight:o.clientHeight,forPrint:r.forPrint});return e.dayMinWidth?this.renderHScrollLayout(n,a,s.colCnt,e.dayMinWidth):this.renderSimpleLayout(n,a)}};function bh(i,e){let t=new qs(i.renderRange,e);return new Ys(t,/year|month|week/.test(i.currentRangeUnit))}var Gi=class extends Us{buildRenderRange(e,t,r){let s=super.buildRenderRange(e,t,r),{props:n}=this;return wh({currentRange:s,snapToWeek:/^(year|month)$/.test(t),fixedWeekCount:n.fixedWeekCount,dateEnv:n.dateEnv})}};function wh(i){let{dateEnv:e,currentRange:t}=i,{start:r,end:s}=t,n;if(i.snapToWeek&&(r=e.startOfWeek(r),n=e.startOfWeek(s),n.valueOf()!==s.valueOf()&&(s=Gl(n,1))),i.fixedWeekCount){let a=e.startOfWeek(e.startOfMonth(Fe(t.end,-1))),o=Math.ceil(kf(a,s));s=Gl(s,6-o)}return{start:r,end:s}}var zC=':root{--fc-daygrid-event-dot-width:8px}.fc-daygrid-day-events:after,.fc-daygrid-day-events:before,.fc-daygrid-day-frame:after,.fc-daygrid-day-frame:before,.fc-daygrid-event-harness:after,.fc-daygrid-event-harness:before{clear:both;content:"";display:table}.fc .fc-daygrid-body{position:relative;z-index:1}.fc .fc-daygrid-day.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-daygrid-day-frame{min-height:100%;position:relative}.fc .fc-daygrid-day-top{display:flex;flex-direction:row-reverse}.fc .fc-day-other .fc-daygrid-day-top{opacity:.3}.fc .fc-daygrid-day-number{padding:4px;position:relative;z-index:4}.fc .fc-daygrid-month-start{font-size:1.1em;font-weight:700}.fc .fc-daygrid-day-events{margin-top:1px}.fc .fc-daygrid-body-balanced .fc-daygrid-day-events{left:0;position:absolute;right:0}.fc .fc-daygrid-body-unbalanced .fc-daygrid-day-events{min-height:2em;position:relative}.fc .fc-daygrid-body-natural .fc-daygrid-day-events{margin-bottom:1em}.fc .fc-daygrid-event-harness{position:relative}.fc .fc-daygrid-event-harness-abs{left:0;position:absolute;right:0;top:0}.fc .fc-daygrid-bg-harness{bottom:0;position:absolute;top:0}.fc .fc-daygrid-day-bg .fc-non-business{z-index:1}.fc .fc-daygrid-day-bg .fc-bg-event{z-index:2}.fc .fc-daygrid-day-bg .fc-highlight{z-index:3}.fc .fc-daygrid-event{margin-top:1px;z-index:6}.fc .fc-daygrid-event.fc-event-mirror{z-index:7}.fc .fc-daygrid-day-bottom{font-size:.85em;margin:0 2px}.fc .fc-daygrid-day-bottom:after,.fc .fc-daygrid-day-bottom:before{clear:both;content:"";display:table}.fc .fc-daygrid-more-link{border-radius:3px;cursor:pointer;line-height:1;margin-top:1px;max-width:100%;overflow:hidden;padding:2px;position:relative;white-space:nowrap;z-index:4}.fc .fc-daygrid-more-link:hover{background-color:rgba(0,0,0,.1)}.fc .fc-daygrid-week-number{background-color:var(--fc-neutral-bg-color);color:var(--fc-neutral-text-color);min-width:1.5em;padding:2px;position:absolute;text-align:center;top:0;z-index:5}.fc .fc-more-popover .fc-popover-body{min-width:220px;padding:10px}.fc-direction-ltr .fc-daygrid-event.fc-event-start,.fc-direction-rtl .fc-daygrid-event.fc-event-end{margin-left:2px}.fc-direction-ltr .fc-daygrid-event.fc-event-end,.fc-direction-rtl .fc-daygrid-event.fc-event-start{margin-right:2px}.fc-direction-ltr .fc-daygrid-more-link{float:left}.fc-direction-ltr .fc-daygrid-week-number{border-radius:0 0 3px 0;left:0}.fc-direction-rtl .fc-daygrid-more-link{float:right}.fc-direction-rtl .fc-daygrid-week-number{border-radius:0 0 0 3px;right:0}.fc-liquid-hack .fc-daygrid-day-frame{position:static}.fc-daygrid-event{border-radius:3px;font-size:var(--fc-small-font-size);position:relative;white-space:nowrap}.fc-daygrid-block-event .fc-event-time{font-weight:700}.fc-daygrid-block-event .fc-event-time,.fc-daygrid-block-event .fc-event-title{padding:1px}.fc-daygrid-dot-event{align-items:center;display:flex;padding:2px 0}.fc-daygrid-dot-event .fc-event-title{flex-grow:1;flex-shrink:1;font-weight:700;min-width:0;overflow:hidden}.fc-daygrid-dot-event.fc-event-mirror,.fc-daygrid-dot-event:hover{background:rgba(0,0,0,.1)}.fc-daygrid-dot-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-daygrid-event-dot{border:calc(var(--fc-daygrid-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-daygrid-event-dot-width)/2);box-sizing:content-box;height:0;margin:0 4px;width:0}.fc-direction-ltr .fc-daygrid-event .fc-event-time{margin-right:3px}.fc-direction-rtl .fc-daygrid-event .fc-event-time{margin-left:3px}';hs(zC);var ow=at({name:"@fullcalendar/daygrid",initialView:"dayGridMonth",views:{dayGrid:{component:vc,dateProfileGeneratorClass:Gi},dayGridDay:{type:"dayGrid",duration:{days:1}},dayGridWeek:{type:"dayGrid",duration:{weeks:1}},dayGridMonth:{type:"dayGrid",duration:{months:1},fixedWeekCount:!0},dayGridYear:{type:"dayGrid",duration:{years:1}}}});var Eh=class extends Ea{getKeyInfo(){return{allDay:{},timed:{}}}getKeysForDateSpan(e){return e.allDay?["allDay"]:["timed"]}getKeysForEventDef(e){return e.allDay?$f(e)?["timed","allDay"]:["allDay"]:["timed"]}},jC=pe({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"short"});function fw(i){let e=["fc-timegrid-slot","fc-timegrid-slot-label",i.isLabeled?"fc-scrollgrid-shrink":"fc-timegrid-slot-minor"];return y(_t.Consumer,null,t=>{if(!i.isLabeled)return y("td",{className:e.join(" "),"data-time":i.isoTimeStr});let{dateEnv:r,options:s,viewApi:n}=t,a=s.slotLabelFormat==null?jC:Array.isArray(s.slotLabelFormat)?pe(s.slotLabelFormat[0]):pe(s.slotLabelFormat),o={level:0,time:i.time,date:r.toDate(i.date),view:n,text:r.format(i.date,a)};return y(Ve,{elTag:"td",elClasses:e,elAttrs:{"data-time":i.isoTimeStr},renderProps:o,generatorName:"slotLabelContent",customGenerator:s.slotLabelContent,defaultGenerator:qC,classNameGenerator:s.slotLabelClassNames,didMount:s.slotLabelDidMount,willUnmount:s.slotLabelWillUnmount},l=>y("div",{className:"fc-timegrid-slot-label-frame fc-scrollgrid-shrink-frame"},y(l,{elTag:"div",elClasses:["fc-timegrid-slot-label-cushion","fc-scrollgrid-shrink-cushion"]})))})}function qC(i){return i.text}var kh=class extends G{render(){return this.props.slatMetas.map(e=>y("tr",{key:e.key},y(fw,Object.assign({},e))))}},YC=pe({week:"short"}),QC=5,Dh=class extends ze{constructor(){super(...arguments),this.allDaySplitter=new Eh,this.headerElRef=Se(),this.rootElRef=Se(),this.scrollerElRef=Se(),this.state={slatCoords:null},this.handleScrollTopRequest=e=>{let t=this.scrollerElRef.current;t&&(t.scrollTop=e)},this.renderHeadAxis=(e,t="")=>{let{options:r}=this.context,{dateProfile:s}=this.props,n=s.renderRange,o=Rr(n.start,n.end)===1?ti(this.context,n.start,"week"):{};return r.weekNumbers&&e==="day"?y(Ya,{elTag:"th",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},date:n.start,defaultFormat:YC},l=>y("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame","fc-timegrid-axis-frame-liquid"].join(" "),style:{height:t}},y(l,{elTag:"a",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"],elAttrs:o}))):y("th",{"aria-hidden":!0,className:"fc-timegrid-axis"},y("div",{className:"fc-timegrid-axis-frame",style:{height:t}}))},this.renderTableRowAxis=e=>{let{options:t,viewApi:r}=this.context,s={text:t.allDayText,view:r};return y(Ve,{elTag:"td",elClasses:["fc-timegrid-axis","fc-scrollgrid-shrink"],elAttrs:{"aria-hidden":!0},renderProps:s,generatorName:"allDayContent",customGenerator:t.allDayContent,defaultGenerator:GC,classNameGenerator:t.allDayClassNames,didMount:t.allDayDidMount,willUnmount:t.allDayWillUnmount},n=>y("div",{className:["fc-timegrid-axis-frame","fc-scrollgrid-shrink-frame",e==null?" fc-timegrid-axis-frame-liquid":""].join(" "),style:{height:e}},y(n,{elTag:"span",elClasses:["fc-timegrid-axis-cushion","fc-scrollgrid-shrink-cushion","fc-scrollgrid-sync-inner"]})))},this.handleSlatCoords=e=>{this.setState({slatCoords:e})}}renderSimpleLayout(e,t,r){let{context:s,props:n}=this,a=[],o=ri(s.options);return e&&a.push({type:"header",key:"header",isSticky:o,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),t&&(a.push({type:"body",key:"all-day",chunk:{content:t}}),a.push({type:"body",key:"all-day-divider",outerContent:y("tr",{role:"presentation",className:"fc-scrollgrid-section"},y("td",{className:"fc-timegrid-divider "+s.theme.getClass("tableCellShaded")}))})),a.push({type:"body",key:"body",liquid:!0,expandRows:Boolean(s.options.expandRows),chunk:{scrollerElRef:this.scrollerElRef,content:r}}),y(zt,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:s.viewSpec},y(us,{liquid:!n.isHeightAuto&&!n.forPrint,collapsibleWidth:n.forPrint,cols:[{width:"shrink"}],sections:a}))}renderHScrollLayout(e,t,r,s,n,a,o){let l=this.context.pluginHooks.scrollGridImpl;if(!l)throw new Error("No ScrollGrid implementation");let{context:c,props:d}=this,u=!d.forPrint&&ri(c.options),f=!d.forPrint&&za(c.options),h=[];e&&h.push({type:"header",key:"header",isSticky:u,syncRowHeights:!0,chunks:[{key:"axis",rowContent:p=>y("tr",{role:"presentation"},this.renderHeadAxis("day",p.rowSyncHeights[0]))},{key:"cols",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),t&&(h.push({type:"body",key:"all-day",syncRowHeights:!0,chunks:[{key:"axis",rowContent:p=>y("tr",{role:"presentation"},this.renderTableRowAxis(p.rowSyncHeights[0]))},{key:"cols",content:t}]}),h.push({key:"all-day-divider",type:"body",outerContent:y("tr",{role:"presentation",className:"fc-scrollgrid-section"},y("td",{colSpan:2,className:"fc-timegrid-divider "+c.theme.getClass("tableCellShaded")}))}));let m=c.options.nowIndicator;return h.push({type:"body",key:"body",liquid:!0,expandRows:Boolean(c.options.expandRows),chunks:[{key:"axis",content:p=>y("div",{className:"fc-timegrid-axis-chunk"},y("table",{"aria-hidden":!0,style:{height:p.expandRows?p.clientHeight:""}},p.tableColGroupNode,y("tbody",null,y(kh,{slatMetas:a}))),y("div",{className:"fc-timegrid-now-indicator-container"},y(Ct,{unit:m?"minute":"day"},g=>{let v=m&&o&&o.safeComputeTop(g);return typeof v=="number"?y(ja,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:v},isAxis:!0,date:g}):null})))},{key:"cols",scrollerElRef:this.scrollerElRef,content:r}]}),f&&h.push({key:"footer",type:"footer",isSticky:!0,chunks:[{key:"axis",content:qi},{key:"cols",content:qi}]}),y(zt,{elRef:this.rootElRef,elClasses:["fc-timegrid"],viewSpec:c.viewSpec},y(l,{liquid:!d.isHeightAuto&&!d.forPrint,forPrint:d.forPrint,collapsibleWidth:!1,colGroups:[{width:"shrink",cols:[{width:"shrink"}]},{cols:[{span:s,minWidth:n}]}],sections:h}))}getAllDayMaxEventProps(){let{dayMaxEvents:e,dayMaxEventRows:t}=this.context.options;return(e===!0||t===!0)&&(e=void 0,t=QC),{dayMaxEvents:e,dayMaxEventRows:t}}};function GC(i){return i.text}var Sh=class{constructor(e,t,r){this.positions=e,this.dateProfile=t,this.slotDuration=r}safeComputeTop(e){let{dateProfile:t}=this;if(Dt(t.currentRange,e)){let r=ye(e),s=e.valueOf()-r.valueOf();if(s>=ft(t.slotMinTime)&&s<ft(t.slotMaxTime))return this.computeTimeTop(j(s))}return null}computeDateTop(e,t){return t||(t=ye(e)),this.computeTimeTop(j(e.valueOf()-t.valueOf()))}computeTimeTop(e){let{positions:t,dateProfile:r}=this,s=t.els.length,n=(e.milliseconds-ft(r.slotMinTime))/ft(this.slotDuration),a,o;return n=Math.max(0,n),n=Math.min(s,n),a=Math.floor(n),a=Math.min(a,s-1),o=n-a,t.tops[a]+t.getHeight(a)*o}},Ch=class extends G{render(){let{props:e,context:t}=this,{options:r}=t,{slatElRefs:s}=e;return y("tbody",null,e.slatMetas.map((n,a)=>{let o={time:n.time,date:t.dateEnv.toDate(n.date),view:t.viewApi};return y("tr",{key:n.key,ref:s.createRef(n.key)},e.axis&&y(fw,Object.assign({},n)),y(Ve,{elTag:"td",elClasses:["fc-timegrid-slot","fc-timegrid-slot-lane",!n.isLabeled&&"fc-timegrid-slot-minor"],elAttrs:{"data-time":n.isoTimeStr},renderProps:o,generatorName:"slotLaneContent",customGenerator:r.slotLaneContent,classNameGenerator:r.slotLaneClassNames,didMount:r.slotLaneDidMount,willUnmount:r.slotLaneWillUnmount}))}))}},_h=class extends G{constructor(){super(...arguments),this.rootElRef=Se(),this.slatElRefs=new nt}render(){let{props:e,context:t}=this;return y("div",{ref:this.rootElRef,className:"fc-timegrid-slots"},y("table",{"aria-hidden":!0,className:t.theme.getClass("table"),style:{minWidth:e.tableMinWidth,width:e.clientWidth,height:e.minHeight}},e.tableColGroupNode,y(Ch,{slatElRefs:this.slatElRefs,axis:e.axis,slatMetas:e.slatMetas})))}componentDidMount(){this.updateSizing()}componentDidUpdate(){this.updateSizing()}componentWillUnmount(){this.props.onCoords&&this.props.onCoords(null)}updateSizing(){let{context:e,props:t}=this;t.onCoords&&t.clientWidth!==null&&this.rootElRef.current.offsetHeight&&t.onCoords(new Sh(new qt(this.rootElRef.current,KC(this.slatElRefs.currentMap,t.slatMetas),!1,!0),this.props.dateProfile,e.options.slotDuration))}};function KC(i,e){return e.map(t=>i[t.key])}function Za(i,e){let t=[],r;for(r=0;r<e;r+=1)t.push([]);if(i)for(r=0;r<i.length;r+=1)t[i[r].col].push(i[r]);return t}function lw(i,e){let t=[];if(i){for(let r=0;r<e;r+=1)t[r]={affectedInstances:i.affectedInstances,isEvent:i.isEvent,segs:[]};for(let r of i.segs)t[r.col].segs.push(r)}else for(let r=0;r<e;r+=1)t[r]=null;return t}var xh=class extends G{render(){let{props:e}=this;return y(Xs,{elClasses:["fc-timegrid-more-link"],elStyle:{top:e.top,bottom:e.bottom},allDayDate:null,moreCnt:e.hiddenSegs.length,allSegs:e.hiddenSegs,hiddenSegs:e.hiddenSegs,extraDateSpan:e.extraDateSpan,dateProfile:e.dateProfile,todayRange:e.todayRange,popoverContent:()=>hw(e.hiddenSegs,e),defaultGenerator:ZC,forceTimed:!0},t=>y(t,{elTag:"div",elClasses:["fc-timegrid-more-link-inner","fc-sticky"]}))}};function ZC(i){return i.shortText}function XC(i,e,t){let r=new js;e!=null&&(r.strictOrder=e),t!=null&&(r.maxStackCnt=t);let s=r.addSegs(i),n=eh(s),a=JC(r);return a=s_(a,1),{segRects:i_(a),hiddenGroups:n}}function JC(i){let{entriesByLevel:e}=i,t=Nh((r,s)=>r+":"+s,(r,s)=>{let n=r_(i,r,s),a=cw(n,t),o=e[r][s];return[Object.assign(Object.assign({},o),{nextLevelNodes:a[0]}),o.thickness+a[1]]});return cw(e.length?{level:0,lateralStart:0,lateralEnd:e[0].length}:null,t)[0]}function cw(i,e){if(!i)return[[],0];let{level:t,lateralStart:r,lateralEnd:s}=i,n=r,a=[];for(;n<s;)a.push(e(t,n)),n+=1;return a.sort(e_),[a.map(t_),a[0][1]]}function e_(i,e){return e[1]-i[1]}function t_(i){return i[0]}function r_(i,e,t){let{levelCoords:r,entriesByLevel:s}=i,n=s[e][t],a=r[e]+n.thickness,o=r.length,l=e;for(;l<o&&r[l]<a;l+=1);for(;l<o;l+=1){let c=s[l],d,u=Ca(c,n.span.start,Sa),f=u[0]+u[1],h=f;for(;(d=c[h])&&d.span.start<n.span.end;)h+=1;if(f<h)return{level:l,lateralStart:f,lateralEnd:h}}return null}function s_(i,e){let t=Nh((r,s,n)=>or(r),(r,s,n)=>{let{nextLevelNodes:a,thickness:o}=r,l=o+n,c=o/l,d,u=[];if(!a.length)d=e;else for(let h of a)if(d===void 0){let m=t(h,s,l);d=m[0],u.push(m[1])}else{let m=t(h,d,0);u.push(m[1])}let f=(d-s)*c;return[d-f,Object.assign(Object.assign({},r),{thickness:f,nextLevelNodes:u})]});return i.map(r=>t(r,0,0)[1])}function i_(i){let e=[],t=Nh((s,n,a)=>or(s),(s,n,a)=>{let o=Object.assign(Object.assign({},s),{levelCoord:n,stackDepth:a,stackForward:0});return e.push(o),o.stackForward=r(s.nextLevelNodes,n+s.thickness,a+1)+1});function r(s,n,a){let o=0;for(let l of s)o=Math.max(t(l,n,a),o);return o}return r(i,0,0),e}function Nh(i,e){let t={};return(...r)=>{let s=i(...r);return s in t?t[s]:t[s]=e(...r)}}function dw(i,e,t=null,r=0){let s=[];if(t)for(let n=0;n<i.length;n+=1){let a=i[n],o=t.computeDateTop(a.start,e),l=Math.max(o+(r||0),t.computeDateTop(a.end,e));s.push({start:Math.round(o),end:Math.round(l)})}return s}function n_(i,e,t,r){let s=[],n=[];for(let c=0;c<i.length;c+=1){let d=e[c];d?s.push({index:c,thickness:1,span:d}):n.push(i[c])}let{segRects:a,hiddenGroups:o}=XC(s,t,r),l=[];for(let c of a)l.push({seg:i[c.index],rect:c});for(let c of n)l.push({seg:c,rect:null});return{segPlacements:l,hiddenGroups:o}}var a_=pe({hour:"numeric",minute:"2-digit",meridiem:!1}),bc=class extends G{render(){return y(Ks,Object.assign({},this.props,{elClasses:["fc-timegrid-event","fc-v-event",this.props.isShort&&"fc-timegrid-event-short"],defaultTimeFormat:a_}))}},Mh=class extends G{constructor(){super(...arguments),this.sortEventSegs=W(Fa)}render(){let{props:e,context:t}=this,{options:r}=t,s=r.selectMirror,n=e.eventDrag&&e.eventDrag.segs||e.eventResize&&e.eventResize.segs||s&&e.dateSelectionSegs||[],a=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{},o=this.sortEventSegs(e.fgEventSegs,r.eventOrder);return y(fs,{elTag:"td",elRef:e.elRef,elClasses:["fc-timegrid-col",...e.extraClassNames||[]],elAttrs:Object.assign({role:"gridcell"},e.extraDataAttrs),date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,extraRenderProps:e.extraRenderProps},l=>y("div",{className:"fc-timegrid-col-frame"},y("div",{className:"fc-timegrid-col-bg"},this.renderFillSegs(e.businessHourSegs,"non-business"),this.renderFillSegs(e.bgEventSegs,"bg-event"),this.renderFillSegs(e.dateSelectionSegs,"highlight")),y("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(o,a,!1,!1,!1)),y("div",{className:"fc-timegrid-col-events"},this.renderFgSegs(n,{},Boolean(e.eventDrag),Boolean(e.eventResize),Boolean(s),"mirror")),y("div",{className:"fc-timegrid-now-indicator-container"},this.renderNowIndicator(e.nowIndicatorSegs)),Yi(r)&&y(l,{elTag:"div",elClasses:["fc-timegrid-col-misc"]})))}renderFgSegs(e,t,r,s,n,a){let{props:o}=this;return o.forPrint?hw(e,o):this.renderPositionedFgSegs(e,t,r,s,n,a)}renderPositionedFgSegs(e,t,r,s,n,a){let{eventMaxStack:o,eventShortHeight:l,eventOrderStrict:c,eventMinHeight:d}=this.context.options,{date:u,slatCoords:f,eventSelection:h,todayRange:m,nowDate:p}=this.props,g=r||s||n,v=dw(e,u,f,d),{segPlacements:w,hiddenGroups:_}=n_(e,v,c,o);return y(fe,null,this.renderHiddenGroups(_,e),w.map(E=>{let{seg:S,rect:D}=E,A=S.eventRange.instance.instanceId,C=g||Boolean(!t[A]&&D),B=Th(D&&D.span),$=!g&&D?this.computeSegHStyle(D):{left:0,right:0},K=Boolean(D)&&D.stackForward>0,Be=Boolean(D)&&D.span.end-D.span.start<l;return y("div",{className:"fc-timegrid-event-harness"+(K?" fc-timegrid-event-harness-inset":""),key:a||A,style:Object.assign(Object.assign({visibility:C?"":"hidden"},B),$)},y(bc,Object.assign({seg:S,isDragging:r,isResizing:s,isDateSelecting:n,isSelected:A===h,isShort:Be},Yt(S,m,p))))}))}renderHiddenGroups(e,t){let{extraDateSpan:r,dateProfile:s,todayRange:n,nowDate:a,eventSelection:o,eventDrag:l,eventResize:c}=this.props;return y(fe,null,e.map(d=>{let u=Th(d.span),f=o_(d.entries,t);return y(xh,{key:Kl(cc(f)),hiddenSegs:f,top:u.top,bottom:u.bottom,extraDateSpan:r,dateProfile:s,todayRange:n,nowDate:a,eventSelection:o,eventDrag:l,eventResize:c})}))}renderFillSegs(e,t){let{props:r,context:s}=this,a=dw(e,r.date,r.slatCoords,s.options.eventMinHeight).map((o,l)=>{let c=e[l];return y("div",{key:Ha(c.eventRange),className:"fc-timegrid-bg-harness",style:Th(o)},t==="bg-event"?y(Zs,Object.assign({seg:c},Yt(c,r.todayRange,r.nowDate))):qa(t))});return y(fe,null,a)}renderNowIndicator(e){let{slatCoords:t,date:r}=this.props;return t?e.map((s,n)=>y(ja,{key:n,elClasses:["fc-timegrid-now-indicator-line"],elStyle:{top:t.computeDateTop(s.start,r)},isAxis:!1,date:r})):null}computeSegHStyle(e){let{isRtl:t,options:r}=this.context,s=r.slotEventOverlap,n=e.levelCoord,a=e.levelCoord+e.thickness,o,l;s&&(a=Math.min(1,n+(a-n)*2)),t?(o=1-a,l=n):(o=n,l=1-a);let c={zIndex:e.stackDepth+1,left:o*100+"%",right:l*100+"%"};return s&&!e.stackForward&&(c[t?"marginLeft":"marginRight"]=10*2),c}};function hw(i,{todayRange:e,nowDate:t,eventSelection:r,eventDrag:s,eventResize:n}){let a=(s?s.affectedInstances:null)||(n?n.affectedInstances:null)||{};return y(fe,null,i.map(o=>{let l=o.eventRange.instance.instanceId;return y("div",{key:l,style:{visibility:a[l]?"hidden":""}},y(bc,Object.assign({seg:o,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:l===r,isShort:!1},Yt(o,e,t))))}))}function Th(i){return i?{top:i.start,bottom:-i.end}:{top:"",bottom:""}}function o_(i,e){return i.map(t=>e[t.index])}var Ah=class extends G{constructor(){super(...arguments),this.splitFgEventSegs=W(Za),this.splitBgEventSegs=W(Za),this.splitBusinessHourSegs=W(Za),this.splitNowIndicatorSegs=W(Za),this.splitDateSelectionSegs=W(Za),this.splitEventDrag=W(lw),this.splitEventResize=W(lw),this.rootElRef=Se(),this.cellElRefs=new nt}render(){let{props:e,context:t}=this,r=t.options.nowIndicator&&e.slatCoords&&e.slatCoords.safeComputeTop(e.nowDate),s=e.cells.length,n=this.splitFgEventSegs(e.fgEventSegs,s),a=this.splitBgEventSegs(e.bgEventSegs,s),o=this.splitBusinessHourSegs(e.businessHourSegs,s),l=this.splitNowIndicatorSegs(e.nowIndicatorSegs,s),c=this.splitDateSelectionSegs(e.dateSelectionSegs,s),d=this.splitEventDrag(e.eventDrag,s),u=this.splitEventResize(e.eventResize,s);return y("div",{className:"fc-timegrid-cols",ref:this.rootElRef},y("table",{role:"presentation",style:{minWidth:e.tableMinWidth,width:e.clientWidth}},e.tableColGroupNode,y("tbody",{role:"presentation"},y("tr",{role:"row"},e.axis&&y("td",{"aria-hidden":!0,className:"fc-timegrid-col fc-timegrid-axis"},y("div",{className:"fc-timegrid-col-frame"},y("div",{className:"fc-timegrid-now-indicator-container"},typeof r=="number"&&y(ja,{elClasses:["fc-timegrid-now-indicator-arrow"],elStyle:{top:r},isAxis:!0,date:e.nowDate})))),e.cells.map((f,h)=>y(Mh,{key:f.key,elRef:this.cellElRefs.createRef(f.key),dateProfile:e.dateProfile,date:f.date,nowDate:e.nowDate,todayRange:e.todayRange,extraRenderProps:f.extraRenderProps,extraDataAttrs:f.extraDataAttrs,extraClassNames:f.extraClassNames,extraDateSpan:f.extraDateSpan,fgEventSegs:n[h],bgEventSegs:a[h],businessHourSegs:o[h],nowIndicatorSegs:l[h],dateSelectionSegs:c[h],eventDrag:d[h],eventResize:u[h],slatCoords:e.slatCoords,eventSelection:e.eventSelection,forPrint:e.forPrint}))))))}componentDidMount(){this.updateCoords()}componentDidUpdate(){this.updateCoords()}updateCoords(){let{props:e}=this;e.onColCoords&&e.clientWidth!==null&&e.onColCoords(new qt(this.rootElRef.current,l_(this.cellElRefs.currentMap,e.cells),!0,!1))}};function l_(i,e){return e.map(t=>i[t.key])}var Ih=class extends ze{constructor(){super(...arguments),this.processSlotOptions=W(c_),this.state={slatCoords:null},this.handleRootEl=e=>{e?this.context.registerInteractiveComponent(this,{el:e,isHitComboAllowed:this.props.isHitComboAllowed}):this.context.unregisterInteractiveComponent(this)},this.handleScrollRequest=e=>{let{onScrollTopRequest:t}=this.props,{slatCoords:r}=this.state;if(t&&r){if(e.time){let s=r.computeTimeTop(e.time);s=Math.ceil(s),s&&(s+=1),t(s)}return!0}return!1},this.handleColCoords=e=>{this.colCoords=e},this.handleSlatCoords=e=>{this.setState({slatCoords:e}),this.props.onSlatCoords&&this.props.onSlatCoords(e)}}render(){let{props:e,state:t}=this;return y("div",{className:"fc-timegrid-body",ref:this.handleRootEl,style:{width:e.clientWidth,minWidth:e.tableMinWidth}},y(_h,{axis:e.axis,dateProfile:e.dateProfile,slatMetas:e.slatMetas,clientWidth:e.clientWidth,minHeight:e.expandRows?e.clientHeight:"",tableMinWidth:e.tableMinWidth,tableColGroupNode:e.axis?e.tableColGroupNode:null,onCoords:this.handleSlatCoords}),y(Ah,{cells:e.cells,axis:e.axis,dateProfile:e.dateProfile,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,todayRange:e.todayRange,nowDate:e.nowDate,nowIndicatorSegs:e.nowIndicatorSegs,clientWidth:e.clientWidth,tableMinWidth:e.tableMinWidth,tableColGroupNode:e.tableColGroupNode,slatCoords:t.slatCoords,onColCoords:this.handleColCoords,forPrint:e.forPrint}))}componentDidMount(){this.scrollResponder=this.context.createScrollResponder(this.handleScrollRequest)}componentDidUpdate(e){this.scrollResponder.update(e.dateProfile!==this.props.dateProfile)}componentWillUnmount(){this.scrollResponder.detach()}queryHit(e,t){let{dateEnv:r,options:s}=this.context,{colCoords:n}=this,{dateProfile:a}=this.props,{slatCoords:o}=this.state,{snapDuration:l,snapsPerSlot:c}=this.processSlotOptions(this.props.slotDuration,s.snapDuration),d=n.leftToIndex(e),u=o.positions.topToIndex(t);if(d!=null&&u!=null){let f=this.props.cells[d],h=o.positions.tops[u],m=o.positions.getHeight(u),p=(t-h)/m,g=Math.floor(p*c),v=u*c+g,w=this.props.cells[d].date,_=Aa(a.slotMinTime,Ef(l,v)),E=r.add(w,_),S=r.add(E,l);return{dateProfile:a,dateSpan:Object.assign({range:{start:E,end:S},allDay:!1},f.extraDateSpan),dayEl:n.els[d],rect:{left:n.lefts[d],right:n.rights[d],top:h,bottom:h+m},layer:0}}return null}};function c_(i,e){let t=e||i,r=Ia(i,t);return r===null&&(t=i,r=1),{snapDuration:t,snapsPerSlot:r}}var Ph=class extends Qs{sliceRange(e,t){let r=[];for(let s=0;s<t.length;s+=1){let n=ht(e,t[s]);n&&r.push({start:n.start,end:n.end,isStart:n.start.valueOf()===e.start.valueOf(),isEnd:n.end.valueOf()===e.end.valueOf(),col:s})}return r}},Rh=class extends ze{constructor(){super(...arguments),this.buildDayRanges=W(d_),this.slicer=new Ph,this.timeColsRef=Se()}render(){let{props:e,context:t}=this,{dateProfile:r,dayTableModel:s}=e,{nowIndicator:n,nextDayThreshold:a}=t.options,o=this.buildDayRanges(s,r,t.dateEnv);return y(Ct,{unit:n?"minute":"day"},(l,c)=>y(Ih,Object.assign({ref:this.timeColsRef},this.slicer.sliceProps(e,r,null,t,o),{forPrint:e.forPrint,axis:e.axis,dateProfile:r,slatMetas:e.slatMetas,slotDuration:e.slotDuration,cells:s.cells[0],tableColGroupNode:e.tableColGroupNode,tableMinWidth:e.tableMinWidth,clientWidth:e.clientWidth,clientHeight:e.clientHeight,expandRows:e.expandRows,nowDate:l,nowIndicatorSegs:n&&this.slicer.sliceNowDate(l,r,a,t,o),todayRange:c,onScrollTopRequest:e.onScrollTopRequest,onSlatCoords:e.onSlatCoords})))}};function d_(i,e,t){let r=[];for(let s of i.headerDates)r.push({start:t.add(s,e.slotMinTime),end:t.add(s,e.slotMaxTime)});return r}var uw=[{hours:1},{minutes:30},{minutes:15},{seconds:30},{seconds:15}];function u_(i,e,t,r,s){let n=new Date(0),a=i,o=j(0),l=t||f_(r),c=[];for(;ft(a)<ft(e);){let d=s.add(n,a),u=Ia(o,l)!==null;c.push({date:d,time:a,key:d.toISOString(),isoTimeStr:Sf(d),isLabeled:u}),a=Aa(a,r),o=Aa(o,r)}return c}function f_(i){let e,t,r;for(e=uw.length-1;e>=0;e-=1)if(t=j(uw[e]),r=Ia(t,i),r!==null&&r>1)return t;return i}var wc=class extends Dh{constructor(){super(...arguments),this.buildTimeColsModel=W(h_),this.buildSlatMetas=W(u_)}render(){let{options:e,dateEnv:t,dateProfileGenerator:r}=this.context,{props:s}=this,{dateProfile:n}=s,a=this.buildTimeColsModel(n,r),o=this.allDaySplitter.splitProps(s),l=this.buildSlatMetas(n.slotMinTime,n.slotMaxTime,e.slotLabelInterval,e.slotDuration,t),{dayMinWidth:c}=e,d=!c,u=c,f=e.dayHeaders&&y(Ar,{dates:a.headerDates,dateProfile:n,datesRepDistinctDays:!0,renderIntro:d?this.renderHeadAxis:null}),h=e.allDaySlot!==!1&&(p=>y(Ka,Object.assign({},o.allDay,{dateProfile:n,dayTableModel:a,nextDayThreshold:e.nextDayThreshold,tableMinWidth:p.tableMinWidth,colGroupNode:p.tableColGroupNode,renderRowIntro:d?this.renderTableRowAxis:null,showWeekNumbers:!1,expandRows:!1,headerAlignElRef:this.headerElRef,clientWidth:p.clientWidth,clientHeight:p.clientHeight,forPrint:s.forPrint},this.getAllDayMaxEventProps()))),m=p=>y(Rh,Object.assign({},o.timed,{dayTableModel:a,dateProfile:n,axis:d,slotDuration:e.slotDuration,slatMetas:l,forPrint:s.forPrint,tableColGroupNode:p.tableColGroupNode,tableMinWidth:p.tableMinWidth,clientWidth:p.clientWidth,clientHeight:p.clientHeight,onSlatCoords:this.handleSlatCoords,expandRows:p.expandRows,onScrollTopRequest:this.handleScrollTopRequest}));return u?this.renderHScrollLayout(f,h,m,a.colCnt,c,l,this.state.slatCoords):this.renderSimpleLayout(f,h,m)}};function h_(i,e){let t=new qs(i.renderRange,e);return new Ys(t,!1)}var p_='.fc-v-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-v-event .fc-event-main{color:var(--fc-event-text-color);height:100%}.fc-v-event .fc-event-main-frame{display:flex;flex-direction:column;height:100%}.fc-v-event .fc-event-time{flex-grow:0;flex-shrink:0;max-height:100%;overflow:hidden}.fc-v-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-height:0}.fc-v-event .fc-event-title{bottom:0;max-height:100%;overflow:hidden;top:0}.fc-v-event:not(.fc-event-start){border-top-left-radius:0;border-top-right-radius:0;border-top-width:0}.fc-v-event:not(.fc-event-end){border-bottom-left-radius:0;border-bottom-right-radius:0;border-bottom-width:0}.fc-v-event.fc-event-selected:before{left:-10px;right:-10px}.fc-v-event .fc-event-resizer-start{cursor:n-resize}.fc-v-event .fc-event-resizer-end{cursor:s-resize}.fc-v-event:not(.fc-event-selected) .fc-event-resizer{height:var(--fc-event-resizer-thickness);left:0;right:0}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-start{top:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event:not(.fc-event-selected) .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-thickness)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer{left:50%;margin-left:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-start{top:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc-v-event.fc-event-selected .fc-event-resizer-end{bottom:calc(var(--fc-event-resizer-dot-total-width)/-2)}.fc .fc-timegrid .fc-daygrid-body{z-index:2}.fc .fc-timegrid-divider{padding:0 0 2px}.fc .fc-timegrid-body{min-height:100%;position:relative;z-index:1}.fc .fc-timegrid-axis-chunk{position:relative}.fc .fc-timegrid-axis-chunk>table,.fc .fc-timegrid-slots{position:relative;z-index:1}.fc .fc-timegrid-slot{border-bottom:0;height:1.5em}.fc .fc-timegrid-slot:empty:before{content:"\\00a0"}.fc .fc-timegrid-slot-minor{border-top-style:dotted}.fc .fc-timegrid-slot-label-cushion{display:inline-block;white-space:nowrap}.fc .fc-timegrid-slot-label{vertical-align:middle}.fc .fc-timegrid-axis-cushion,.fc .fc-timegrid-slot-label-cushion{padding:0 4px}.fc .fc-timegrid-axis-frame-liquid{height:100%}.fc .fc-timegrid-axis-frame{align-items:center;display:flex;justify-content:flex-end;overflow:hidden}.fc .fc-timegrid-axis-cushion{flex-shrink:0;max-width:60px}.fc-direction-ltr .fc-timegrid-slot-label-frame{text-align:right}.fc-direction-rtl .fc-timegrid-slot-label-frame{text-align:left}.fc-liquid-hack .fc-timegrid-axis-frame-liquid{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-timegrid-col-frame{min-height:100%;position:relative}.fc-media-screen.fc-liquid-hack .fc-timegrid-col-frame{bottom:0;height:auto;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols{bottom:0;left:0;position:absolute;right:0;top:0}.fc-media-screen .fc-timegrid-cols>table{height:100%}.fc-media-screen .fc-timegrid-col-bg,.fc-media-screen .fc-timegrid-col-events,.fc-media-screen .fc-timegrid-now-indicator-container{left:0;position:absolute;right:0;top:0}.fc .fc-timegrid-col-bg{z-index:2}.fc .fc-timegrid-col-bg .fc-non-business{z-index:1}.fc .fc-timegrid-col-bg .fc-bg-event{z-index:2}.fc .fc-timegrid-col-bg .fc-highlight{z-index:3}.fc .fc-timegrid-bg-harness{left:0;position:absolute;right:0}.fc .fc-timegrid-col-events{z-index:3}.fc .fc-timegrid-now-indicator-container{bottom:0;overflow:hidden}.fc-direction-ltr .fc-timegrid-col-events{margin:0 2.5% 0 2px}.fc-direction-rtl .fc-timegrid-col-events{margin:0 2px 0 2.5%}.fc-timegrid-event-harness{position:absolute}.fc-timegrid-event-harness>.fc-timegrid-event{bottom:0;left:0;position:absolute;right:0;top:0}.fc-timegrid-event-harness-inset .fc-timegrid-event,.fc-timegrid-event.fc-event-mirror,.fc-timegrid-more-link{box-shadow:0 0 0 1px var(--fc-page-bg-color)}.fc-timegrid-event,.fc-timegrid-more-link{border-radius:3px;font-size:var(--fc-small-font-size)}.fc-timegrid-event{margin-bottom:1px}.fc-timegrid-event .fc-event-main{padding:1px 1px 0}.fc-timegrid-event .fc-event-time{font-size:var(--fc-small-font-size);margin-bottom:1px;white-space:nowrap}.fc-timegrid-event-short .fc-event-main-frame{flex-direction:row;overflow:hidden}.fc-timegrid-event-short .fc-event-time:after{content:"\\00a0-\\00a0"}.fc-timegrid-event-short .fc-event-title{font-size:var(--fc-small-font-size)}.fc-timegrid-more-link{background:var(--fc-more-link-bg-color);color:var(--fc-more-link-text-color);cursor:pointer;margin-bottom:1px;position:absolute;z-index:9999}.fc-timegrid-more-link-inner{padding:3px 2px;top:0}.fc-direction-ltr .fc-timegrid-more-link{right:0}.fc-direction-rtl .fc-timegrid-more-link{left:0}.fc .fc-timegrid-now-indicator-arrow,.fc .fc-timegrid-now-indicator-line{pointer-events:none}.fc .fc-timegrid-now-indicator-line{border-color:var(--fc-now-indicator-color);border-style:solid;border-width:1px 0 0;left:0;position:absolute;right:0;z-index:4}.fc .fc-timegrid-now-indicator-arrow{border-color:var(--fc-now-indicator-color);border-style:solid;margin-top:-5px;position:absolute;z-index:4}.fc-direction-ltr .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 0 5px 6px;left:0}.fc-direction-rtl .fc-timegrid-now-indicator-arrow{border-bottom-color:transparent;border-top-color:transparent;border-width:5px 6px 5px 0;right:0}';hs(p_);var m_={allDaySlot:Boolean},pw=at({name:"@fullcalendar/timegrid",initialView:"timeGridWeek",optionRefiners:m_,views:{timeGrid:{component:wc,usesMinMaxTime:!0,allDaySlot:!0,slotDuration:"00:30:00",slotEventOverlap:!0},timeGridDay:{type:"timeGrid",duration:{days:1}},timeGridWeek:{type:"timeGrid",duration:{weeks:1}}}});var Oh=class extends ze{constructor(){super(...arguments),this.buildDayTableModel=W(bh),this.slicer=new Ga,this.state={labelId:Ir()}}render(){let{props:e,state:t,context:r}=this,{dateProfile:s,forPrint:n}=e,{options:a}=r,o=this.buildDayTableModel(s,r.dateProfileGenerator),l=this.slicer.sliceProps(e,s,a.nextDayThreshold,r,o),c=e.tableWidth!=null?e.tableWidth/a.aspectRatio:null,d=o.cells.length,u=c!=null?c/d:null;return y("div",{ref:e.elRef,"data-date":e.isoDateStr,className:"fc-multimonth-month",style:{width:e.width},role:"grid","aria-labelledby":t.labelId},y("div",{className:"fc-multimonth-header",style:{marginBottom:u},role:"presentation"},y("div",{className:"fc-multimonth-title",id:t.labelId},r.dateEnv.format(e.dateProfile.currentRange.start,e.titleFormat)),y("table",{className:["fc-multimonth-header-table",r.theme.getClass("table")].join(" "),role:"presentation"},y("thead",{role:"rowgroup"},y(Ar,{dateProfile:e.dateProfile,dates:o.headerDates,datesRepDistinctDays:!1})))),y("div",{className:["fc-multimonth-daygrid","fc-daygrid","fc-daygrid-body",!n&&"fc-daygrid-body-balanced",n&&"fc-daygrid-body-unbalanced",n&&"fc-daygrid-body-natural"].join(" "),style:{marginTop:-u}},y("table",{className:["fc-multimonth-daygrid-table",r.theme.getClass("table")].join(" "),style:{height:n?"":c},role:"presentation"},y("tbody",{role:"rowgroup"},y(Qa,Object.assign({},l,{dateProfile:s,cells:o.cells,eventSelection:e.eventSelection,dayMaxEvents:!n,dayMaxEventRows:!n,showWeekNumbers:a.weekNumbers,clientWidth:e.clientWidth,clientHeight:e.clientHeight,forPrint:n}))))))}},Lh=class extends ze{constructor(){super(...arguments),this.splitDateProfileByMonth=W(y_),this.buildMonthFormat=W(w_),this.scrollElRef=Se(),this.firstMonthElRef=Se(),this.needsScrollReset=!1,this.handleSizing=e=>{e&&this.updateSize()}}render(){let{context:e,props:t,state:r}=this,{options:s}=e,{clientWidth:n,clientHeight:a}=r,o=r.monthHPadding||0,l=Math.min(n!=null?Math.floor(n/(s.multiMonthMinWidth+o)):1,s.multiMonthMaxColumns)||1,c=100/l+"%",d=n==null?null:n/l-o,u=n!=null&&l===1,f=this.splitDateProfileByMonth(e.dateProfileGenerator,t.dateProfile,e.dateEnv,u?!1:s.fixedWeekCount,s.showNonCurrentDates),h=this.buildMonthFormat(s.multiMonthTitleFormat,f),m=["fc-multimonth",u?"fc-multimonth-singlecol":"fc-multimonth-multicol",d!=null&&d<400?"fc-multimonth-compact":"",t.isHeightAuto?"":"fc-scroller"];return y(zt,{elRef:this.scrollElRef,elClasses:m,viewSpec:e.viewSpec},f.map((p,g)=>{let v=Wi(p.currentRange.start);return y(Oh,Object.assign({},t,{key:v,isoDateStr:v,elRef:g===0?this.firstMonthElRef:void 0,titleFormat:h,dateProfile:p,width:c,tableWidth:d,clientWidth:n,clientHeight:a}))}))}componentDidMount(){this.updateSize(),this.context.addResizeHandler(this.handleSizing),this.requestScrollReset()}componentDidUpdate(e){et(e,this.props)||this.handleSizing(!1),e.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}componentWillUnmount(){this.context.removeResizeHandler(this.handleSizing)}updateSize(){let e=this.scrollElRef.current,t=this.firstMonthElRef.current;e&&this.setState({clientWidth:e.clientWidth,clientHeight:e.clientHeight}),t&&e&&this.state.monthHPadding==null&&this.setState({monthHPadding:e.clientWidth-t.firstChild.offsetWidth})}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&this.state.monthHPadding!=null){let{currentDate:e}=this.props.dateProfile,t=this.scrollElRef.current,r=t.querySelector(`[data-date="${Wi(e)}"]`);t.scrollTop=r.getBoundingClientRect().top-this.firstMonthElRef.current.getBoundingClientRect().top,this.needsScrollReset=!1}}shouldComponentUpdate(){return!0}},g_=j(1,"month");function y_(i,e,t,r,s){let{start:n,end:a}=e.currentRange,o=n,l=[];for(;o.valueOf()<a.valueOf();){let c=t.add(o,g_),d={start:i.skipHiddenDays(o),end:i.skipHiddenDays(c,-1,!0)},u=wh({currentRange:d,snapToWeek:!0,fixedWeekCount:r,dateEnv:t});u={start:i.skipHiddenDays(u.start),end:i.skipHiddenDays(u.end,-1,!0)};let f=e.activeRange?ht(e.activeRange,s?u:d):null;l.push({currentDate:e.currentDate,isValid:e.isValid,validRange:e.validRange,renderRange:u,activeRange:f,currentRange:d,currentRangeUnit:"month",isRangeAllDay:!0,dateIncrement:e.dateIncrement,slotMinTime:e.slotMaxTime,slotMaxTime:e.slotMinTime}),o=c}return l}var v_=pe({year:"numeric",month:"long"}),b_=pe({month:"long"});function w_(i,e){return i||(e[0].currentRange.start.getUTCFullYear()!==e[e.length-1].currentRange.start.getUTCFullYear()?v_:b_)}var T_={multiMonthTitleFormat:pe,multiMonthMaxColumns:Number,multiMonthMinWidth:Number},E_=".fc .fc-multimonth{border:1px solid var(--fc-border-color);display:flex;flex-wrap:wrap;overflow-x:hidden;overflow-y:auto}.fc .fc-multimonth-title{font-size:1.2em;font-weight:700;padding:1em 0;text-align:center}.fc .fc-multimonth-daygrid{background:var(--fc-page-bg-color)}.fc .fc-multimonth-daygrid-table,.fc .fc-multimonth-header-table{table-layout:fixed;width:100%}.fc .fc-multimonth-daygrid-table{border-top-style:hidden!important}.fc .fc-multimonth-singlecol .fc-multimonth{position:relative}.fc .fc-multimonth-singlecol .fc-multimonth-header{background:var(--fc-page-bg-color);position:relative;top:0;z-index:2}.fc .fc-multimonth-singlecol .fc-multimonth-daygrid{position:relative;z-index:1}.fc .fc-multimonth-singlecol .fc-multimonth-daygrid-table,.fc .fc-multimonth-singlecol .fc-multimonth-header-table{border-left-style:hidden;border-right-style:hidden}.fc .fc-multimonth-singlecol .fc-multimonth-month:last-child .fc-multimonth-daygrid-table{border-bottom-style:hidden}.fc .fc-multimonth-multicol{line-height:1}.fc .fc-multimonth-multicol .fc-multimonth-month{padding:0 1.2em 1.2em}.fc .fc-multimonth-multicol .fc-daygrid-more-link{border:1px solid var(--fc-event-border-color);display:block;float:none;padding:1px}.fc .fc-multimonth-compact{line-height:1}.fc .fc-multimonth-compact .fc-multimonth-daygrid-table,.fc .fc-multimonth-compact .fc-multimonth-header-table{font-size:.9em}.fc-media-screen .fc-multimonth-singlecol .fc-multimonth-header{position:sticky}.fc-media-print .fc-multimonth{overflow:visible}";hs(E_);var mw=at({name:"@fullcalendar/multimonth",initialView:"multiMonthYear",optionRefiners:T_,views:{multiMonth:{component:Lh,dateProfileGeneratorClass:Gi,multiMonthMinWidth:350,multiMonthMaxColumns:3},multiMonthYear:{type:"multiMonth",duration:{years:1},fixedWeekCount:!0,showNonCurrentDates:!1}}});ji.touchMouseIgnoreWait=500;var Fh=0,Tc=0,Hh=!1,Ec=class{constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=t=>{if(!this.shouldIgnoreMouse()&&k_(t)&&this.tryStart(t)){let r=this.createEventFromMouse(t,!0);this.emitter.trigger("pointerdown",r),this.initScrollWatch(r),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=t=>{let r=this.createEventFromMouse(t);this.recordCoords(r),this.emitter.trigger("pointermove",r)},this.handleMouseUp=t=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(t)),this.cleanup()},this.handleTouchStart=t=>{if(this.tryStart(t)){this.isTouchDragging=!0;let r=this.createEventFromTouch(t,!0);this.emitter.trigger("pointerdown",r),this.initScrollWatch(r);let s=t.target;this.shouldIgnoreMove||s.addEventListener("touchmove",this.handleTouchMove),s.addEventListener("touchend",this.handleTouchEnd),s.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=t=>{let r=this.createEventFromTouch(t);this.recordCoords(r),this.emitter.trigger("pointermove",r)},this.handleTouchEnd=t=>{if(this.isDragging){let r=t.target;r.removeEventListener("touchmove",this.handleTouchMove),r.removeEventListener("touchend",this.handleTouchEnd),r.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(t)),this.cleanup(),this.isTouchDragging=!1,D_()}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=t=>{if(!this.shouldIgnoreMove){let r=window.scrollX-this.prevScrollX+this.prevPageX,s=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:t,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:r,pageY:s,deltaX:r-this.origPageX,deltaY:s-this.origPageY})}},this.containerEl=e,this.emitter=new Mr,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),S_()}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),C_()}tryStart(e){let t=this.querySubjectEl(e),r=e.target;return t&&(!this.handleSelector||Le(r,this.handleSelector))?(this.subjectEl=t,this.isDragging=!0,this.wasTouchScroll=!1,!0):!1}cleanup(){Hh=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?Le(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return Fh||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(Hh=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,t){let r=0,s=0;return t?(this.origPageX=e.pageX,this.origPageY=e.pageY):(r=e.pageX-this.origPageX,s=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:r,deltaY:s}}createEventFromTouch(e,t){let r=e.touches,s,n,a=0,o=0;return r&&r.length?(s=r[0].pageX,n=r[0].pageY):(s=e.pageX,n=e.pageY),t?(this.origPageX=s,this.origPageY=n):(a=s-this.origPageX,o=n-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:s,pageY:n,deltaX:a,deltaY:o}}};function k_(i){return i.button===0&&!i.ctrlKey}function D_(){Fh+=1,setTimeout(()=>{Fh-=1},ji.touchMouseIgnoreWait)}function S_(){Tc+=1,Tc===1&&window.addEventListener("touchmove",yw,{passive:!1})}function C_(){Tc-=1,Tc||window.removeEventListener("touchmove",yw,{passive:!1})}function yw(i){Hh&&i.preventDefault()}var Bh=class{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,t,r){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=t-window.scrollX,this.origScreenY=r-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,t){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=t-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,t){let r=()=>{this.cleanup(),t()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(r,this.revertDuration):setTimeout(r,0)}doRevertAnimation(e,t){let r=this.mirrorEl,s=this.sourceEl.getBoundingClientRect();r.style.transition="top "+t+"ms,left "+t+"ms",Js(r,{left:s.left,top:s.top}),gf(r,()=>{r.style.transition="",e()})}cleanup(){this.mirrorEl&&(xa(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&Js(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,t=this.mirrorEl;return t||(t=this.mirrorEl=this.sourceEl.cloneNode(!0),t.style.userSelect="none",t.style.webkitUserSelect="none",t.style.pointerEvents="none",t.classList.add("fc-event-dragging"),Js(t,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(t)),t}},kc=class extends zs{constructor(e,t){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=t,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}},Dc=class extends kc{constructor(e,t){super(new ka(e),t)}getEventTarget(){return this.scrollController.el}computeClientRect(){return Jf(this.scrollController.el)}},Wh=class extends kc{constructor(e){super(new Da,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}},gw=typeof performance=="function"?performance.now:Date.now,Uh=class{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let t=gw();this.handleSide(e,(t-this.msSinceRequest)/1e3),this.requestAnimation(t)}else this.isAnimating=!1}}}start(e,t,r){this.isEnabled&&(this.scrollCaches=this.buildCaches(r),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,t))}handleMove(e,t){if(this.isEnabled){let r=e-window.scrollX,s=t-window.scrollY,n=this.pointerScreenY===null?0:s-this.pointerScreenY,a=this.pointerScreenX===null?0:r-this.pointerScreenX;n<0?this.everMovedUp=!0:n>0&&(this.everMovedDown=!0),a<0?this.everMovedLeft=!0:a>0&&(this.everMovedRight=!0),this.pointerScreenX=r,this.pointerScreenY=s,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(gw()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,t){let{scrollCache:r}=e,{edgeThreshold:s}=this,n=s-e.distance,a=n*n/(s*s)*this.maxVelocity*t,o=1;switch(e.name){case"left":o=-1;case"right":r.setScrollLeft(r.getScrollLeft()+a*o);break;case"top":o=-1;case"bottom":r.setScrollTop(r.getScrollTop()+a*o);break}}computeBestEdge(e,t){let{edgeThreshold:r}=this,s=null,n=this.scrollCaches||[];for(let a of n){let o=a.clientRect,l=e-o.left,c=o.right-e,d=t-o.top,u=o.bottom-t;l>=0&&c>=0&&d>=0&&u>=0&&(d<=r&&this.everMovedUp&&a.canScrollUp()&&(!s||s.distance>d)&&(s={scrollCache:a,name:"top",distance:d}),u<=r&&this.everMovedDown&&a.canScrollDown()&&(!s||s.distance>u)&&(s={scrollCache:a,name:"bottom",distance:u}),l<=r&&this.everMovedLeft&&a.canScrollLeft()&&(!s||s.distance>l)&&(s={scrollCache:a,name:"left",distance:l}),c<=r&&this.everMovedRight&&a.canScrollRight()&&(!s||s.distance>c)&&(s={scrollCache:a,name:"right",distance:c}))}return s}buildCaches(e){return this.queryScrollEls(e).map(t=>t===window?new Wh(!1):new Dc(t,!1))}queryScrollEls(e){let t=[];for(let r of this.scrollQuery)typeof r=="object"?t.push(r):t.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(r)));return t}},ms=class extends _a{constructor(e,t){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=s=>{this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,yf(document.body),bf(document.body),s.isTouch||s.origEvent.preventDefault(),this.emitter.trigger("pointerdown",s),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(s.subjectEl,s.pageX,s.pageY),this.startDelay(s),this.minDistance||this.handleDistanceSurpassed(s)))},this.onPointerMove=s=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",s),!this.isDistanceSurpassed){let n=this.minDistance,a,{deltaX:o,deltaY:l}=s;a=o*o+l*l,a>=n*n&&this.handleDistanceSurpassed(s)}this.isDragging&&(s.origEvent.type!=="scroll"&&(this.mirror.handleMove(s.pageX,s.pageY),this.autoScroller.handleMove(s.pageX,s.pageY)),this.emitter.trigger("dragmove",s))}},this.onPointerUp=s=>{this.isInteracting&&(this.isInteracting=!1,vf(document.body),wf(document.body),this.emitter.trigger("pointerup",s),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(s)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let r=this.pointer=new Ec(e);r.emitter.on("pointerdown",this.onPointerDown),r.emitter.on("pointermove",this.onPointerMove),r.emitter.on("pointerup",this.onPointerUp),t&&(r.selector=t),this.mirror=new Bh,this.autoScroller=new Uh}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){typeof this.delay=="number"?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(!this.pointer.wasTouchScroll||this.touchScrollAllowed)&&(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),this.touchScrollAllowed===!1&&this.pointer.cancelTouchScroll())}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}},$h=class{constructor(e){this.el=e,this.origRect=Wa(e),this.scrollCaches=lc(e).map(t=>new Dc(t,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let t of this.scrollCaches)e+=t.origScrollLeft-t.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let t of this.scrollCaches)e+=t.origScrollTop-t.getScrollTop();return e}isWithinClipping(e,t){let r={left:e,top:t};for(let s of this.scrollCaches)if(!__(s.getEventTarget())&&!Qf(r,s.clientRect))return!1;return!0}};function __(i){let e=i.tagName;return e==="HTML"||e==="BODY"}var si=class{constructor(e,t){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=r=>{let{dragging:s}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(r),this.initialHit||!this.requireInitial?(s.setIgnoreMove(!1),this.emitter.trigger("pointerdown",r)):s.setIgnoreMove(!0)},this.handleDragStart=r=>{this.emitter.trigger("dragstart",r),this.handleMove(r,!0)},this.handleDragMove=r=>{this.emitter.trigger("dragmove",r),this.handleMove(r)},this.handlePointerUp=r=>{this.releaseHits(),this.emitter.trigger("pointerup",r)},this.handleDragEnd=r=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,r),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",r)},this.droppableStore=t,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new Mr}processFirstCoord(e){let t={left:e.pageX,top:e.pageY},r=t,s=e.subjectEl,n;s instanceof HTMLElement&&(n=Wa(s),r=Gf(r,n));let a=this.initialHit=this.queryHitForOffset(r.left,r.top);if(a){if(this.useSubjectCenter&&n){let o=ac(n,a.rect);o&&(r=Kf(o))}this.coordAdjust=Zf(r,t)}else this.coordAdjust={left:0,top:0}}handleMove(e,t){let r=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);(t||!Cc(this.movingHit,r))&&(this.movingHit=r,this.emitter.trigger("hitupdate",r,!1,e))}prepareHits(){this.offsetTrackers=St(this.droppableStore,e=>(e.component.prepareHits(),new $h(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let t in e)e[t].destroy();this.offsetTrackers={}}queryHitForOffset(e,t){let{droppableStore:r,offsetTrackers:s}=this,n=null;for(let a in r){let o=r[a].component,l=s[a];if(l&&l.isWithinClipping(e,t)){let c=l.computeLeft(),d=l.computeTop(),u=e-c,f=t-d,{origRect:h}=l,m=h.right-h.left,p=h.bottom-h.top;if(u>=0&&u<m&&f>=0&&f<p){let g=o.queryHit(u,f,m,p);g&&$i(g.dateProfile.activeRange,g.dateSpan.range)&&(this.disablePointCheck||l.el.contains(l.el.getRootNode().elementFromPoint(u+c-window.scrollX,f+d-window.scrollY)))&&(!n||g.layer>n.layer)&&(g.componentId=a,g.context=o.context,g.rect.left+=c,g.rect.right+=c,g.rect.top+=d,g.rect.bottom+=d,n=g)}}}return n}};function Cc(i,e){return!i&&!e?!0:Boolean(i)!==Boolean(e)?!1:Vf(i.dateSpan,e.dateSpan)}function Qh(i,e){let t={};for(let r of e.pluginHooks.datePointTransforms)Object.assign(t,r(i,e));return Object.assign(t,x_(i,e.dateEnv)),t}function x_(i,e){return{date:e.toDate(i.range.start),dateStr:e.formatIso(i.range.start,{omitTime:i.allDay}),allDay:i.allDay}}var Vh=class extends jt{constructor(e){super(e),this.handlePointerDown=r=>{let{dragging:s}=this,n=r.origEvent.target;s.setIgnoreMove(!this.component.isValidDateDownEl(n))},this.handleDragEnd=r=>{let{component:s}=this,{pointer:n}=this.dragging;if(!n.wasTouchScroll){let{initialHit:a,finalHit:o}=this.hitDragging;if(a&&o&&Cc(a,o)){let{context:l}=s,c=Object.assign(Object.assign({},Qh(a.dateSpan,l)),{dayEl:a.dayEl,jsEvent:r.origEvent,view:l.viewApi||l.calendarApi.view});l.emitter.trigger("dateClick",c)}}},this.dragging=new ms(e.el),this.dragging.autoScroller.isEnabled=!1;let t=this.hitDragging=new si(this.dragging,Ba(e));t.emitter.on("pointerdown",this.handlePointerDown),t.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}},zh=class extends jt{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=a=>{let{component:o,dragging:l}=this,{options:c}=o.context,d=c.selectable&&o.isValidDateDownEl(a.origEvent.target);l.setIgnoreMove(!d),l.delay=a.isTouch?M_(o):null},this.handleDragStart=a=>{this.component.context.calendarApi.unselect(a)},this.handleHitUpdate=(a,o)=>{let{context:l}=this.component,c=null,d=!1;if(a){let u=this.hitDragging.initialHit;a.componentId===u.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(u,a)||(c=A_(u,a,l.pluginHooks.dateSelectionTransformers)),(!c||!th(c,a.dateProfile,l))&&(d=!0,c=null)}c?l.dispatch({type:"SELECT_DATES",selection:c}):o||l.dispatch({type:"UNSELECT_DATES"}),d?Fi():Hi(),o||(this.dragSelection=c)},this.handlePointerUp=a=>{this.dragSelection&&(sc(this.dragSelection,a,this.component.context),this.dragSelection=null)};let{component:t}=e,{options:r}=t.context,s=this.dragging=new ms(e.el);s.touchScrollAllowed=!1,s.minDistance=r.selectMinDistance||0,s.autoScroller.isEnabled=r.dragScroll;let n=this.hitDragging=new si(this.dragging,Ba(e));n.emitter.on("pointerdown",this.handlePointerDown),n.emitter.on("dragstart",this.handleDragStart),n.emitter.on("hitupdate",this.handleHitUpdate),n.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}};function M_(i){let{options:e}=i.context,t=e.selectLongPressDelay;return t==null&&(t=e.longPressDelay),t}function A_(i,e,t){let r=i.dateSpan,s=e.dateSpan,n=[r.range.start,r.range.end,s.range.start,s.range.end];n.sort(Tf);let a={};for(let o of t){let l=o(i,e);if(l===!1)return null;l&&Object.assign(a,l)}return a.range={start:n[0],end:n[3]},a.allDay=r.allDay,a}var ii=class extends jt{constructor(e){super(e),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=a=>{let o=a.origEvent.target,{component:l,dragging:c}=this,{mirror:d}=c,{options:u}=l.context,f=l.context;this.subjectEl=a.subjectEl;let h=this.subjectSeg=Nr(a.subjectEl),p=(this.eventRange=h.eventRange).instance.instanceId;this.relevantEvents=Oa(f.getCurrentData().eventStore,p),c.minDistance=a.isTouch?0:u.eventDragMinDistance,c.delay=a.isTouch&&p!==l.props.eventSelection?P_(l):null,u.fixedMirrorParent?d.parentNode=u.fixedMirrorParent:d.parentNode=Le(o,".fc"),d.revertDuration=u.dragRevertDuration;let g=l.isValidSegDownEl(o)&&!Le(o,".fc-event-resizer");c.setIgnoreMove(!g),this.isDragging=g&&a.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=a=>{let o=this.component.context,l=this.eventRange,c=l.instance.instanceId;a.isTouch?c!==this.component.props.eventSelection&&o.dispatch({type:"SELECT_EVENT",eventInstanceId:c}):o.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(o.calendarApi.unselect(a),o.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new ve(o,l.def,l.instance),jsEvent:a.origEvent,view:o.viewApi}))},this.handleHitUpdate=(a,o)=>{if(!this.isDragging)return;let l=this.relevantEvents,c=this.hitDragging.initialHit,d=this.component.context,u=null,f=null,h=null,m=!1,p={affectedEvents:l,mutatedEvents:He(),isEvent:!0};if(a){u=a.context;let g=u.options;d===u||g.editable&&g.droppable?(f=I_(c,a,this.eventRange.instance.range.start,u.getCurrentData().pluginHooks.eventDragMutationMassagers),f&&(h=La(l,u.getCurrentData().eventUiBases,f,u),p.mutatedEvents=h,Va(p,a.dateProfile,u)||(m=!0,f=null,h=null,p.mutatedEvents=He()))):u=null}this.displayDrag(u,p),m?Fi():Hi(),o||(d===u&&Cc(c,a)&&(f=null),this.dragging.setMirrorNeedsRevert(!f),this.dragging.setMirrorIsVisible(!a||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=u,this.validMutation=f,this.mutatedRelevantEvents=h)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=a=>{if(this.isDragging){let o=this.component.context,l=o.viewApi,{receivingContext:c,validMutation:d}=this,u=this.eventRange.def,f=this.eventRange.instance,h=new ve(o,u,f),m=this.relevantEvents,p=this.mutatedRelevantEvents,{finalHit:g}=this.hitDragging;if(this.clearDrag(),o.emitter.trigger("eventDragStop",{el:this.subjectEl,event:h,jsEvent:a.origEvent,view:l}),d){if(c===o){let v=new ve(o,p.defs[u.defId],f?p.instances[f.instanceId]:null);o.dispatch({type:"MERGE_EVENTS",eventStore:p});let w={oldEvent:h,event:v,relatedEvents:dr(p,o,f),revert(){o.dispatch({type:"MERGE_EVENTS",eventStore:m})}},_={};for(let E of o.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(_,E(d,o));o.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},w),_),{el:a.subjectEl,delta:d.datesDelta,jsEvent:a.origEvent,view:l})),o.emitter.trigger("eventChange",w)}else if(c){let v={event:h,relatedEvents:dr(m,o,f),revert(){o.dispatch({type:"MERGE_EVENTS",eventStore:m})}};o.emitter.trigger("eventLeave",Object.assign(Object.assign({},v),{draggedEl:a.subjectEl,view:l})),o.dispatch({type:"REMOVE_EVENTS",eventStore:m}),o.emitter.trigger("eventRemove",v);let w=p.defs[u.defId],_=p.instances[f.instanceId],E=new ve(c,w,_);c.dispatch({type:"MERGE_EVENTS",eventStore:p});let S={event:E,relatedEvents:dr(p,c,_),revert(){c.dispatch({type:"REMOVE_EVENTS",eventStore:p})}};c.emitter.trigger("eventAdd",S),a.isTouch&&c.dispatch({type:"SELECT_EVENT",eventInstanceId:f.instanceId}),c.emitter.trigger("drop",Object.assign(Object.assign({},Qh(g.dateSpan,c)),{draggedEl:a.subjectEl,jsEvent:a.origEvent,view:g.context.viewApi})),c.emitter.trigger("eventReceive",Object.assign(Object.assign({},S),{draggedEl:a.subjectEl,view:g.context.viewApi}))}}else o.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:t}=this,{options:r}=t.context,s=this.dragging=new ms(e.el);s.pointer.selector=ii.SELECTOR,s.touchScrollAllowed=!1,s.autoScroller.isEnabled=r.dragScroll;let n=this.hitDragging=new si(this.dragging,ei);n.useSubjectCenter=e.useEventCenter,n.emitter.on("pointerdown",this.handlePointerDown),n.emitter.on("dragstart",this.handleDragStart),n.emitter.on("hitupdate",this.handleHitUpdate),n.emitter.on("pointerup",this.handlePointerUp),n.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(e,t){let r=this.component.context,s=this.receivingContext;s&&s!==e&&(s===r?s.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:t.affectedEvents,mutatedEvents:He(),isEvent:!0}}):s.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})}clearDrag(){let e=this.component.context,{receivingContext:t}=this;t&&t.dispatch({type:"UNSET_EVENT_DRAG"}),e!==t&&e.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}};ii.SELECTOR=".fc-event-draggable, .fc-event-resizable";function I_(i,e,t,r){let s=i.dateSpan,n=e.dateSpan,a=s.range.start,o=n.range.start,l={};s.allDay!==n.allDay&&(l.allDay=n.allDay,l.hasEnd=e.context.options.allDayMaintainDuration,n.allDay?a=ye(t):a=t);let c=ds(a,o,i.context.dateEnv,i.componentId===e.componentId?i.largeUnit:null);c.milliseconds&&(l.allDay=!1);let d={datesDelta:c,standardProps:l};for(let u of r)u(d,i,e);return d}function P_(i){let{options:e}=i.context,t=e.eventLongPressDelay;return t==null&&(t=e.longPressDelay),t}var jh=class extends jt{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=n=>{let{component:a}=this,o=this.querySegEl(n),l=Nr(o),c=this.eventRange=l.eventRange;this.dragging.minDistance=a.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(n.origEvent.target)||n.isTouch&&this.component.props.eventSelection!==c.instance.instanceId)},this.handleDragStart=n=>{let{context:a}=this.component,o=this.eventRange;this.relevantEvents=Oa(a.getCurrentData().eventStore,this.eventRange.instance.instanceId);let l=this.querySegEl(n);this.draggingSegEl=l,this.draggingSeg=Nr(l),a.calendarApi.unselect(),a.emitter.trigger("eventResizeStart",{el:l,event:new ve(a,o.def,o.instance),jsEvent:n.origEvent,view:a.viewApi})},this.handleHitUpdate=(n,a,o)=>{let{context:l}=this.component,c=this.relevantEvents,d=this.hitDragging.initialHit,u=this.eventRange.instance,f=null,h=null,m=!1,p={affectedEvents:c,mutatedEvents:He(),isEvent:!0};n&&(n.componentId===d.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(d,n)||(f=R_(d,n,o.subjectEl.classList.contains("fc-event-resizer-start"),u.range))),f&&(h=La(c,l.getCurrentData().eventUiBases,f,l),p.mutatedEvents=h,Va(p,n.dateProfile,l)||(m=!0,f=null,h=null,p.mutatedEvents=null)),h?l.dispatch({type:"SET_EVENT_RESIZE",state:p}):l.dispatch({type:"UNSET_EVENT_RESIZE"}),m?Fi():Hi(),a||(f&&Cc(d,n)&&(f=null),this.validMutation=f,this.mutatedRelevantEvents=h)},this.handleDragEnd=n=>{let{context:a}=this.component,o=this.eventRange.def,l=this.eventRange.instance,c=new ve(a,o,l),d=this.relevantEvents,u=this.mutatedRelevantEvents;if(a.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:c,jsEvent:n.origEvent,view:a.viewApi}),this.validMutation){let f=new ve(a,u.defs[o.defId],l?u.instances[l.instanceId]:null);a.dispatch({type:"MERGE_EVENTS",eventStore:u});let h={oldEvent:c,event:f,relatedEvents:dr(u,a,l),revert(){a.dispatch({type:"MERGE_EVENTS",eventStore:d})}};a.emitter.trigger("eventResize",Object.assign(Object.assign({},h),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||j(0),endDelta:this.validMutation.endDelta||j(0),jsEvent:n.origEvent,view:a.viewApi})),a.emitter.trigger("eventChange",h)}else a.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:t}=e,r=this.dragging=new ms(e.el);r.pointer.selector=".fc-event-resizer",r.touchScrollAllowed=!1,r.autoScroller.isEnabled=t.context.options.dragScroll;let s=this.hitDragging=new si(this.dragging,Ba(e));s.emitter.on("pointerdown",this.handlePointerDown),s.emitter.on("dragstart",this.handleDragStart),s.emitter.on("hitupdate",this.handleHitUpdate),s.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return Le(e.subjectEl,".fc-event")}};function R_(i,e,t,r){let s=i.context.dateEnv,n=i.dateSpan.range.start,a=e.dateSpan.range.start,o=ds(n,a,s,i.largeUnit);if(t){if(s.add(r.start,o)<r.end)return{startDelta:o}}else if(s.add(r.end,o)>r.start)return{endDelta:o};return null}var qh=class{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=r=>{r.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=r=>{let s=this.context.options.unselectCancel,n=Ql(r.origEvent);this.matchesCancel=!!Le(n,s),this.matchesEvent=!!Le(n,ii.SELECTOR)},this.onDocumentPointerUp=r=>{let{context:s}=this,{documentPointer:n}=this,a=s.getCurrentData();if(!n.wasTouchScroll){if(a.dateSelection&&!this.isRecentPointerDateSelect){let o=s.options.unselectAuto;o&&(!o||!this.matchesCancel)&&s.calendarApi.unselect(r)}a.eventSelection&&!this.matchesEvent&&s.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let t=this.documentPointer=new Ec(document);t.shouldIgnoreMove=!0,t.shouldWatchScroll=!1,t.emitter.on("pointerdown",this.onDocumentPointerDown),t.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}},N_={fixedMirrorParent:T},O_={dateClick:T,eventDragStart:T,eventDragStop:T,eventDrop:T,eventResizeStart:T,eventResizeStop:T,eventResize:T,drop:T,eventReceive:T,eventLeave:T},Yh=class{constructor(e,t){this.receivingContext=null,this.droppableEvent=null,this.suppliedDragMeta=null,this.dragMeta=null,this.handleDragStart=s=>{this.dragMeta=this.buildDragMeta(s.subjectEl)},this.handleHitUpdate=(s,n,a)=>{let{dragging:o}=this.hitDragging,l=null,c=null,d=!1,u={affectedEvents:He(),mutatedEvents:He(),isEvent:this.dragMeta.create};s&&(l=s.context,this.canDropElOnCalendar(a.subjectEl,l)&&(c=L_(s.dateSpan,this.dragMeta,l),u.mutatedEvents=Vs(c),d=!Va(u,s.dateProfile,l),d&&(u.mutatedEvents=He(),c=null))),this.displayDrag(l,u),o.setMirrorIsVisible(n||!c||!document.querySelector(".fc-event-mirror")),d?Fi():Hi(),n||(o.setMirrorNeedsRevert(!c),this.receivingContext=l,this.droppableEvent=c)},this.handleDragEnd=s=>{let{receivingContext:n,droppableEvent:a}=this;if(this.clearDrag(),n&&a){let o=this.hitDragging.finalHit,l=o.context.viewApi,c=this.dragMeta;if(n.emitter.trigger("drop",Object.assign(Object.assign({},Qh(o.dateSpan,n)),{draggedEl:s.subjectEl,jsEvent:s.origEvent,view:l})),c.create){let d=Vs(a);n.dispatch({type:"MERGE_EVENTS",eventStore:d}),s.isTouch&&n.dispatch({type:"SELECT_EVENT",eventInstanceId:a.instance.instanceId}),n.emitter.trigger("eventReceive",{event:new ve(n,a.def,a.instance),relatedEvents:[],revert(){n.dispatch({type:"REMOVE_EVENTS",eventStore:d})},draggedEl:s.subjectEl,view:l})}}this.receivingContext=null,this.droppableEvent=null};let r=this.hitDragging=new si(e,ei);r.requireInitial=!1,r.emitter.on("dragstart",this.handleDragStart),r.emitter.on("hitupdate",this.handleHitUpdate),r.emitter.on("dragend",this.handleDragEnd),this.suppliedDragMeta=t}buildDragMeta(e){return typeof this.suppliedDragMeta=="object"?$a(this.suppliedDragMeta):typeof this.suppliedDragMeta=="function"?$a(this.suppliedDragMeta(e)):F_(e)}displayDrag(e,t){let r=this.receivingContext;r&&r!==e&&r.dispatch({type:"UNSET_EVENT_DRAG"}),e&&e.dispatch({type:"SET_EVENT_DRAG",state:t})}clearDrag(){this.receivingContext&&this.receivingContext.dispatch({type:"UNSET_EVENT_DRAG"})}canDropElOnCalendar(e,t){let r=t.options.dropAccept;return typeof r=="function"?r.call(t.calendarApi,e):typeof r=="string"&&r?Boolean(Yl(e,r)):!0}};function L_(i,e,t){let r=Object.assign({},e.leftoverProps);for(let d of t.pluginHooks.externalDefTransforms)Object.assign(r,d(i,e));let{refined:s,extra:n}=Na(r,t),a=Li(s,n,e.sourceId,i.allDay,t.options.forceEventDuration||Boolean(e.duration),t),o=i.range.start;i.allDay&&e.startTime&&(o=t.dateEnv.add(o,e.startTime));let l=e.duration?t.dateEnv.add(o,e.duration):ba(i.allDay,o,t),c=Vi(a.defId,{start:o,end:l});return{def:a,instance:c}}function F_(i){let e=H_(i,"event"),t=e?JSON.parse(e):{create:!1};return $a(t)}ji.dataAttrPrefix="";function H_(i,e){let t=ji.dataAttrPrefix,r=(t?t+"-":"")+e;return i.getAttribute("data-"+r)||""}var Sc=class{constructor(e,t={}){this.handlePointerDown=s=>{let{dragging:n}=this,{minDistance:a,longPressDelay:o}=this.settings;n.minDistance=a!=null?a:s.isTouch?0:cr.eventDragMinDistance,n.delay=s.isTouch?o!=null?o:cr.longPressDelay:0},this.handleDragStart=s=>{s.isTouch&&this.dragging.delay&&s.subjectEl.classList.contains("fc-event")&&this.dragging.mirror.getMirrorEl().classList.add("fc-event-selected")},this.settings=t;let r=this.dragging=new ms(e);r.touchScrollAllowed=!1,t.itemSelector!=null&&(r.pointer.selector=t.itemSelector),t.appendTo!=null&&(r.mirror.parentNode=t.appendTo),r.emitter.on("pointerdown",this.handlePointerDown),r.emitter.on("dragstart",this.handleDragStart),new Yh(r,t.eventData)}destroy(){this.dragging.destroy()}};var vw=at({name:"@fullcalendar/interaction",componentInteractions:[Vh,zh,ii,jh],calendarInteractions:[qh],elementDraggingImpl:ms,optionRefiners:N_,listenerRefiners:O_});var Ye=require("obsidian");Me();var bw=require("obsidian");_e();var Ki=class extends bw.Modal{constructor(t,r){super(t);this.title="";this.dueDate="";this.scheduledDate="";this.priority="normal";this.status="open";this.contexts="";this.tags="";this.timeEstimate=0;this.recurrence="none";this.daysOfWeek=[];this.dayOfMonth="";this.monthOfYear="";this.existingContexts=[];this.existingTags=[];this.plugin=r}async getExistingContexts(){return await this.plugin.cacheManager.getAllContexts()}async getExistingTags(){return(await this.plugin.cacheManager.getAllTags()).filter(r=>r!==this.plugin.settings.taskTag)}convertAbbreviationsToFullNames(t){let r={mon:"Monday",tue:"Tuesday",wed:"Wednesday",thu:"Thursday",fri:"Friday",sat:"Saturday",sun:"Sunday"};return t.map(s=>r[s]).filter(Boolean)}convertFullNamesToAbbreviations(t){let r={Monday:"mon",Tuesday:"tue",Wednesday:"wed",Thursday:"thu",Friday:"fri",Saturday:"sat",Sunday:"sun"};return t.map(s=>r[s]).filter(Boolean)}createFormGroup(t,r,s){let n=t.createDiv({cls:"modal-form__group"}),a=`form-label-${Math.random().toString(36).substr(2,9)}`,o=n.createEl("label",{text:r,cls:"modal-form__label",attr:{id:a}}),l=n.createDiv({cls:"modal-form__input-container"});return l.setAttribute("aria-labelledby",a),s(l),n}async createAutocompleteInput(t,r,s,n){let a=`autocomplete-${r}-${Math.random().toString(36).substr(2,9)}`,o=`listbox-${r}-${Math.random().toString(36).substr(2,9)}`,l=t.createEl("input",{type:"text",cls:"modal-form__input",attr:{id:a,"aria-label":`Enter ${r} (comma-separated)`,"aria-autocomplete":"list","aria-expanded":"false","aria-haspopup":"listbox",role:"combobox"}});l.value=this[r]||"",l.addEventListener("input",c=>{let d=c.target.value;this[r]=d,n(d)}),l.addEventListener("focus",async()=>{let c=await s();(!c||c.length===0)&&(r==="contexts"?(c=await this.getExistingContexts(),this.existingContexts=c):r==="tags"&&(c=await this.getExistingTags(),this.existingTags=c)),this.showSuggestions(t,c,l,n,o)}),l.addEventListener("blur",()=>{setTimeout(()=>this.hideSuggestions(t),200)}),l.addEventListener("keydown",c=>{let d=t.querySelector(".modal-form__suggestions");if(!d)return;let u=d.querySelectorAll(".modal-form__suggestion"),f=Array.from(u).findIndex(h=>h.hasClass("modal-form__suggestion--selected"));if(c.key==="ArrowDown")c.preventDefault(),f=(f+1)%u.length,this.updateSelectedSuggestion(u,f);else if(c.key==="ArrowUp")c.preventDefault(),f=f<=0?u.length-1:f-1,this.updateSelectedSuggestion(u,f);else if(c.key==="Enter"&&f>=0){c.preventDefault();let h=u[f].textContent;h&&this.applySuggestion(l,h,n)}else c.key==="Escape"&&this.hideSuggestions(t)})}showSuggestions(t,r,s,n,a){if(this.hideSuggestions(t),r.length===0){s.setAttribute("aria-expanded","false");return}let o=t.createDiv({cls:"modal-form__suggestions",attr:{role:"listbox",id:a||`suggestions-${Math.random().toString(36).substr(2,9)}`,"aria-label":"Suggestions"}});s.setAttribute("aria-expanded","true"),s.setAttribute("aria-controls",o.id);let l=s.value,c=l.lastIndexOf(","),d=c>=0?l.substring(c+1).trim().toLowerCase():l.toLowerCase();r.filter(f=>{let h=f.toLowerCase();return d===""||h.includes(d)}).slice(0,10).forEach((f,h)=>{let m=o.createDiv({cls:"modal-form__suggestion",text:f,attr:{role:"option",id:`suggestion-${h}`,"aria-selected":h===0?"true":"false",tabindex:"-1"}});h===0&&(m.addClass("modal-form__suggestion--selected"),s.setAttribute("aria-activedescendant",`suggestion-${h}`)),m.addEventListener("click",()=>{this.applySuggestion(s,f,n)})})}applySuggestion(t,r,s){let n=t.value,a=n.lastIndexOf(","),o;a>=0?o=n.substring(0,a+1)+" "+r:o=r,t.value=o,s(o),this.hideSuggestions(t.parentElement),t.focus()}updateSelectedSuggestion(t,r){t.forEach((s,n)=>{var a;if(n===r){s.addClass("modal-form__suggestion--selected"),s.setAttribute("aria-selected","true");let o=(a=s.closest(".modal-form__input-container"))==null?void 0:a.querySelector("input");o&&o.setAttribute("aria-activedescendant",s.id)}else s.removeClass("modal-form__suggestion--selected"),s.setAttribute("aria-selected","false")})}hideSuggestions(t){let r=t.querySelector(".modal-form__suggestions");if(r){r.remove();let s=t.querySelector("input");s&&(s.setAttribute("aria-expanded","false"),s.removeAttribute("aria-activedescendant"),s.removeAttribute("aria-controls"))}}createTitleInputWithCounter(t,r){let s=`title-input-${Math.random().toString(36).substr(2,9)}`,n=t.createEl("input",{type:"text",cls:"modal-form__input modal-form__input--title",attr:{maxlength:r.toString(),id:s,"aria-label":"Task title","aria-describedby":`${s}-counter`}});n.value=this.title;let a=t.createDiv({cls:"modal-form__char-counter",attr:{id:`${s}-counter`,"aria-live":"polite","aria-label":"Character count"}});this.updateCharCounter(a,this.title.length,r),n.addEventListener("input",o=>{let l=o.target.value;this.title=l,this.updateCharCounter(a,l.length,r)})}updateCharCounter(t,r,s){t.textContent=`${r}/${s}`,r>s*.9?t.addClass("modal-form__char-counter--warning"):t.removeClass("modal-form__char-counter--warning")}createPriorityDropdown(t){let r=`priority-select-${Math.random().toString(36).substr(2,9)}`,s=t.createEl("select",{cls:"modal-form__select",attr:{id:r,"aria-label":"Task priority"}});this.plugin.priorityManager.getPrioritiesByWeight().forEach(n=>{let a=s.createEl("option",{value:n.value,text:n.label});n.value===this.priority&&(a.selected=!0)}),s.addEventListener("change",n=>{this.priority=n.target.value})}createStatusDropdown(t){let r=`status-select-${Math.random().toString(36).substr(2,9)}`,s=t.createEl("select",{cls:"modal-form__select",attr:{id:r,"aria-label":"Task status"}});this.plugin.statusManager.getAllStatuses().forEach(n=>{let a=s.createEl("option",{value:n.value,text:n.label});n.value===this.status&&(a.selected=!0)}),s.addEventListener("change",n=>{this.status=n.target.value})}createDueDateInput(t){let r=t.createDiv({cls:"modal-form__datetime-container"}),s=r.createEl("input",{type:"date",cls:"modal-form__input modal-form__input--date",attr:{"aria-label":"Due date",placeholder:"YYYY-MM-DD"}}),n=ge(this.dueDate);n&&sa(n)&&(s.value=n),this.dueTimeInput=r.createEl("input",{type:"time",cls:"modal-form__input modal-form__input--time",attr:{"aria-label":"Due time (optional)",placeholder:"HH:MM"}});let a=Sr(this.dueDate);a&&(this.dueTimeInput.value=a),s.addEventListener("change",o=>{var c;let l=o.target.value;this.updateDueDateValue(l,((c=this.dueTimeInput)==null?void 0:c.value)||"")}),this.dueTimeInput.addEventListener("change",o=>{let l=o.target.value;this.updateDueDateValue(s.value,l)})}updateDueDateValue(t,r){if(!t){this.dueDate="";return}r&&r.trim()?this.dueDate=is(t,r):this.dueDate=t}createScheduledDateInput(t){let r=t.createDiv({cls:"modal-form__datetime-container"}),s=r.createEl("input",{type:"date",cls:"modal-form__input modal-form__input--date",attr:{"aria-label":"Scheduled date",placeholder:"YYYY-MM-DD"}}),n=ge(this.scheduledDate);n&&sa(n)&&(s.value=n),this.scheduledTimeInput=r.createEl("input",{type:"time",cls:"modal-form__input modal-form__input--time",attr:{"aria-label":"Scheduled time (optional)",placeholder:"HH:MM"}});let a=Sr(this.scheduledDate);a&&(this.scheduledTimeInput.value=a),s.addEventListener("change",o=>{var c;let l=o.target.value;this.updateScheduledDateValue(l,((c=this.scheduledTimeInput)==null?void 0:c.value)||"")}),this.scheduledTimeInput.addEventListener("change",o=>{let l=o.target.value;this.updateScheduledDateValue(s.value,l)}),this.createHelpText(t,"When you plan to work on this task. For recurring tasks, this sets the time template - the date part is ignored and instances will appear based on the recurrence pattern.")}updateScheduledDateValue(t,r){if(!t){this.scheduledDate="";return}r&&r.trim()?this.scheduledDate=is(t,r):this.scheduledDate=t}createTimeEstimateInput(t){let r=t.createDiv({cls:"modal-form__time-estimate"}),s=`time-estimate-input-${Math.random().toString(36).substr(2,9)}`,n=r.createEl("input",{type:"number",cls:"modal-form__input modal-form__input--number",attr:{min:"0",step:"5",id:s,"aria-label":"Time estimate in minutes","aria-describedby":`${s}-label`}}),a=this.timeEstimate||0;n.value=a.toString();let o=r.createSpan({cls:"modal-form__time-label",attr:{id:`${s}-label`}});this.updateTimeLabel(o,this.timeEstimate),n.addEventListener("input",l=>{let c=parseInt(l.target.value)||0;this.timeEstimate=c,this.updateTimeLabel(o,c)})}updateTimeLabel(t,r){if(r===0)t.textContent="No estimate";else if(r<60)t.textContent=`${r} minute${r===1?"":"s"}`;else{let s=Math.floor(r/60),n=r%60,a=`${s} hour${s===1?"":"s"}`;n>0&&(a+=` ${n} minute${n===1?"":"s"}`),t.textContent=a}}createHelpText(t,r){let s=t.createDiv({cls:"modal-form__help-text",text:r})}createRecurrenceDropdown(t){let r=`recurrence-select-${Math.random().toString(36).substr(2,9)}`,s=t.createEl("select",{cls:"modal-form__select",attr:{id:r,"aria-label":"Task recurrence pattern"}});[{value:"none",text:"No recurrence"},{value:"daily",text:"Daily"},{value:"weekly",text:"Weekly"},{value:"monthly",text:"Monthly"},{value:"yearly",text:"Yearly"}].forEach(a=>{let o=s.createEl("option",{value:a.value,text:a.text});a.value===this.recurrence&&(o.selected=!0)}),s.addEventListener("change",a=>{this.recurrence=a.target.value,this.updateRecurrenceOptions(t.parentElement)}),this.createHelpText(t,"Create recurring instances of this task. Set a scheduled date to define the time template. Use the due date to limit when recurrence stops.")}updateRecurrenceOptions(t){let r=t.querySelector(".modal-form__recurrence-options");if(r&&r.remove(),this.recurrence==="none")return;let s=t.createDiv({cls:"modal-form__recurrence-options"});switch(this.recurrence){case"weekly":this.createDaysOfWeekSelector(s);break;case"monthly":this.createDayOfMonthSelector(s);break;case"yearly":this.createYearlySelector(s);break}}createDaysOfWeekSelector(t){let r=t.createEl("label",{text:"Days of week:",cls:"modal-form__recurrence-label"}),s=t.createDiv({cls:"modal-form__days-grid"});["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"].forEach(a=>{let o=s.createDiv({cls:"modal-form__day-checkbox"}),l=`day-${a.toLowerCase()}-${Math.random().toString(36).substr(2,9)}`,c=o.createEl("input",{type:"checkbox",cls:"modal-form__day-input",attr:{id:l,"aria-label":`Include ${a} in weekly recurrence`}});c.checked=this.daysOfWeek.includes(a),o.createEl("label",{text:a,cls:"modal-form__day-label",attr:{for:l}}),c.addEventListener("change",d=>{d.target.checked?this.daysOfWeek.includes(a)||this.daysOfWeek.push(a):this.daysOfWeek=this.daysOfWeek.filter(u=>u!==a)})})}createDayOfMonthSelector(t){let r=t.createEl("label",{text:"Day of month:",cls:"modal-form__recurrence-label"}),s=t.createEl("input",{type:"number",cls:"modal-form__input",attr:{min:"1",max:"31"}});s.value=this.dayOfMonth,s.addEventListener("change",n=>{this.dayOfMonth=n.target.value})}createYearlySelector(t){let r=t.createEl("label",{text:"Month:",cls:"modal-form__recurrence-label"}),s=t.createEl("select",{cls:"modal-form__select"});["January","February","March","April","May","June","July","August","September","October","November","December"].forEach((l,c)=>{let d=s.createEl("option",{value:(c+1).toString(),text:l});(c+1).toString()===this.monthOfYear&&(d.selected=!0)}),s.addEventListener("change",l=>{this.monthOfYear=l.target.value});let a=t.createEl("label",{text:"Day:",cls:"modal-form__recurrence-label"}),o=t.createEl("input",{type:"number",cls:"modal-form__input",attr:{min:"1",max:"31"}});o.value=this.dayOfMonth,o.addEventListener("change",l=>{this.dayOfMonth=l.target.value})}};_e();Me();var Gh=require("obsidian");function _c(i,e){if(!i||!e)throw new Error("Invalid context or settings provided");if(!i.title||typeof i.title!="string")throw new Error("Context must have a valid title");if(i.title.trim().length===0)throw new Error("Title cannot be empty");if(i.title.length>200)throw new Error("Title too long for filename generation");let t=i.date||new Date;if(!(t instanceof Date)||isNaN(t.getTime()))throw new Error("Invalid date provided in context");try{switch(e.taskFilenameFormat){case"title":return Zi(i.title);case"zettel":return Xa(t);case"timestamp":return B_(t);case"custom":return W_(i,e.customFilenameTemplate,t);default:return Xa(t)}}catch(r){return console.error("Error generating filename:",r),Xa(t)}}function Xa(i){let e=k(i,"yyMMdd"),t=new Date(i);t.setHours(0,0,0,0);let s=Math.floor((i.getTime()-t.getTime())/1e3).toString(36);return`${e}${s}`}function B_(i){return k(i,"yyyy-MM-dd-HHmmss")}function W_(i,e,t){if(!i||!e||!t)throw new Error("Invalid inputs for custom filename generation");if(typeof e!="string"||e.trim().length===0)throw new Error("Template must be a non-empty string");if(!(t instanceof Date)||isNaN(t.getTime()))throw new Error("Invalid date for filename generation");try{let r=Zi(i.title),s=i.priority&&["low","normal","medium","high"].includes(i.priority)?i.priority:"normal",n=i.status&&["open","in-progress","done","scheduled"].includes(i.status)?i.status:"open",a={title:r,date:k(t,"yyyy-MM-dd"),time:k(t,"HHmmss"),priority:s,status:n,timestamp:k(t,"yyyy-MM-dd-HHmmss"),dateTime:k(t,"yyyy-MM-dd-HHmm"),year:k(t,"yyyy"),month:k(t,"MM"),day:k(t,"dd"),hour:k(t,"HH"),minute:k(t,"mm"),second:k(t,"ss")},o=e;if(e.length>500)throw new Error("Template too long");return Object.entries(a).forEach(([l,c])=>{try{let d=new RegExp(`\\{${l}\\}`,"g");o=o.replace(d,c)}catch(d){console.warn(`Error replacing template variable ${l}:`,d)}}),o=o.replace(/\{[^}]+\}/g,""),o.trim()||(o=r||Xa(t)),Zi(o)}catch(r){return console.error("Error generating custom filename:",r),Zi(i.title)||Xa(t)}}function Zi(i){if(!i||typeof i!="string")return"untitled";try{let e=i.trim().replace(/\s+/g," ").replace(/[<>:"/\\|?*\x00-\x1f\x7f]/g,"").replace(/[\u0000-\u001f\u007f-\u009f]/g,"").replace(/^\.+|\.+$/g,"").substring(0,100).trim();return(!e||e.length===0)&&(e="untitled"),["CON","PRN","AUX","NUL","COM1","COM2","COM3","COM4","COM5","COM6","COM7","COM8","COM9","LPT1","LPT2","LPT3","LPT4","LPT5","LPT6","LPT7","LPT8","LPT9"].includes(e.toUpperCase())&&(e=`task-${e}`),e}catch(e){return console.error("Error sanitizing filename:",e),"untitled"}}async function ww(i,e,t){if(!i||typeof i!="string")throw new Error("Base filename must be a non-empty string");if(typeof e!="string")throw new Error("Folder path must be a string");if(!t)throw new Error("Vault must be provided");let r=Zi(i);if(!r)throw new Error("Base filename cannot be sanitized to a valid name");let s=e.replace(/\.\./g,"").trim();try{let n=(0,Gh.normalizePath)(`${s}/${r}.md`);if(n.length>260)throw new Error("Generated path too long");if(!t.getAbstractFileByPath(n))return r;for(let l=2;l<=999;l++){let c=`${r}-${l}`,d=(0,Gh.normalizePath)(`${s}/${c}.md`);if(d.length>260)break;if(!t.getAbstractFileByPath(d))return c}let a=Date.now().toString(36),o=`${r.substring(0,50)}-${a}`;return Zi(o)}catch(n){return console.error("Error generating unique filename:",n),`task-${Date.now().toString(36)}`}}rr();var ni=class extends Ki{constructor(t,r,s,n){super(t,r);this.details="";this.filenamePreview=null;this.dueDateInput=null;this.prePopulatedValues=s||{},this.conversionOptions=n||{}}async initializeFormData(){if(this.conversionOptions.parsedData)this.populateFromParsedData(this.conversionOptions.parsedData);else{this.priority=this.plugin.settings.defaultTaskPriority,this.status=this.plugin.settings.defaultTaskStatus;let t=this.plugin.settings.taskCreationDefaults;this.dueDate=Fu(t.defaultDueDate),this.plugin.selectedDate?this.scheduledDate=k(this.plugin.selectedDate,"yyyy-MM-dd"):this.scheduledDate=Fu(t.defaultScheduledDate),this.contexts=t.defaultContexts||"",this.tags=t.defaultTags||"",t.defaultTimeEstimate&&t.defaultTimeEstimate>0&&(this.timeEstimate=t.defaultTimeEstimate),this.recurrence=t.defaultRecurrence||"none"}this.prePopulatedValues&&this.populateFromPrePopulatedValues(this.prePopulatedValues)}populateFromPrePopulatedValues(t){t.title!==void 0&&(this.title=t.title),t.status!==void 0&&(this.status=t.status),t.priority!==void 0&&(this.priority=t.priority),t.due!==void 0&&(this.dueDate=t.due),t.scheduled!==void 0&&(this.scheduledDate=t.scheduled),t.contexts!==void 0&&t.contexts.length>0&&(this.contexts=t.contexts.join(", "))}populateFromParsedData(t){this.title=t.title||"",this.priority=t.priority||this.plugin.settings.defaultTaskPriority,this.status=t.status||this.plugin.settings.defaultTaskStatus,this.dueDate=t.dueDate||"",this.scheduledDate="",this.details="",this.dueDateInput&&(this.dueDateInput.value=ge(this.dueDate)),t.scheduledDate&&(this.details=`Scheduled: ${t.scheduledDate}
${this.details}`.trim()),t.startDate&&(this.details=`Start: ${t.startDate}
${this.details}`.trim()),t.createdDate&&(this.details=`Originally created: ${t.createdDate}
${this.details}`.trim()),t.doneDate&&(this.details=`Completed on: ${t.doneDate}
${this.details}`.trim()),t.recurrence&&t.recurrence!=="none"&&(["none","daily","weekly","monthly","yearly"].includes(t.recurrence)?this.recurrence=t.recurrence:this.details=`Recurrence: ${t.recurrence}
${this.details}`.trim(),t.recurrenceData&&(t.recurrenceData.days_of_week&&(this.daysOfWeek=t.recurrenceData.days_of_week),t.recurrenceData.day_of_month&&(this.dayOfMonth=t.recurrenceData.day_of_month.toString()),t.recurrenceData.month_of_year&&(this.monthOfYear=t.recurrenceData.month_of_year.toString())))}async cacheAutocompleteData(){try{this.existingContexts=await this.getExistingContexts(),this.existingTags=await this.getExistingTags()}catch(t){console.error("Error caching autocomplete data:",t)}}async onOpen(){let{contentEl:t}=this;t.addClass("tasknotes-plugin","task-creation-modal"),new Ye.Setting(t).setName("Create new task").setHeading(),await this.initializeFormData(),this.cacheAutocompleteData(),this.createFormGroup(t,"Title",r=>{let s=r.createDiv({cls:"modal-form__input-container"}),n=s.createEl("input",{type:"text",cls:"modal-form__input modal-form__input--title",attr:{placeholder:"Enter task title...",maxlength:"200"}}),a=s.createDiv({cls:"modal-form__char-counter",text:"0/200"});this.title&&(n.value=this.title,this.updateCharCounter(a,this.title.length,200),this.updateFilenamePreview()),n.addEventListener("input",o=>{let l=o.target.value;this.title=l,this.updateCharCounter(a,l.length,200),this.updateFilenamePreview()}),setTimeout(()=>n.focus(),50)}),this.createFormGroup(t,"Filename preview",r=>{this.filenamePreview=r.createDiv({cls:"task-creation-modal__preview",text:"Enter a title to see filename preview..."})}),this.createFormGroup(t,"Details",r=>{let s=r.createEl("textarea",{cls:"modal-form__input modal-form__input--textarea",attr:{placeholder:"Optional details or description...",rows:"3"}});this.details?s.value=this.details:this.applyBodyTemplate().then(n=>{n&&(this.details=n,s.value=n)}),s.addEventListener("input",n=>{this.details=n.target.value})}),this.createFormGroup(t,"Due date",r=>{this.createDueDateInputWithRef(r)}),this.createFormGroup(t,"Scheduled date",r=>{this.createScheduledDateInput(r)}),this.createFormGroup(t,"Priority",r=>{this.createPriorityDropdown(r);let s=r.querySelector("select");s&&s.addEventListener("change",()=>{this.updateFilenamePreview()})}),this.createFormGroup(t,"Status",r=>{this.createStatusDropdown(r);let s=r.querySelector("select");s&&s.addEventListener("change",()=>{this.updateFilenamePreview()})}),this.createFormGroup(t,"Contexts",r=>{this.createAutocompleteInput(r,"contexts",()=>this.existingContexts,s=>{this.contexts=s})}),this.createFormGroup(t,"Tags",r=>{this.createAutocompleteInput(r,"tags",()=>this.existingTags,s=>{this.tags=s})}),this.createFormGroup(t,"Time estimate",r=>{this.createTimeEstimateInput(r)}),this.createFormGroup(t,"Recurrence",r=>{this.createRecurrenceDropdown(r)}),this.createActionButtons(t),t.addEventListener("keydown",r=>{r.key==="Escape"?this.close():r.key==="Enter"&&(r.ctrlKey||r.metaKey)&&(r.preventDefault(),this.createTask())})}createActionButtons(t){let r=t.createDiv({cls:"modal-form__buttons"});r.createEl("button",{text:"Create task",cls:"modal-form__button modal-form__button--primary"}).addEventListener("click",()=>{this.createTask()}),r.createEl("button",{text:"Cancel",cls:"modal-form__button modal-form__button--secondary"}).addEventListener("click",()=>{this.close()})}async handleSubmit(){await this.createTask()}async applyBodyTemplate(){var r;let t=this.plugin.settings.taskCreationDefaults;if(!t.useBodyTemplate||!((r=t.bodyTemplate)!=null&&r.trim()))return null;try{let s=(0,Ye.normalizePath)(t.bodyTemplate.trim());s.endsWith(".md")||(s+=".md");let n=this.app.vault.getAbstractFileByPath(s);if(n instanceof Ye.TFile){let a=await this.app.vault.read(n),o={title:this.title||"",priority:this.priority||"",status:this.status||"",contexts:this.contexts?this.contexts.split(",").map(l=>l.trim()):[],tags:this.tags?this.tags.split(",").map(l=>l.trim()):[],timeEstimate:this.timeEstimate||0,dueDate:this.dueDate||"",scheduledDate:this.scheduledDate||""};return jy(a,o)}else return new Ye.Notice(`Task body template not found: ${s}`),null}catch(s){return console.error("Error reading task body template:",s),new Ye.Notice(`Error reading task body template: ${t.bodyTemplate}`),null}}updateFilenamePreview(){if(this.filenamePreview){if(!this.title||!this.title.trim()){this.filenamePreview.textContent="Enter a title to see filename preview...",this.filenamePreview.className="task-creation-modal__preview";return}try{let t={title:this.title,priority:this.priority,status:this.status,date:new Date},r=_c(t,this.plugin.settings);this.filenamePreview.textContent=`${r}.md`,this.filenamePreview.className="task-creation-modal__preview task-creation-modal__preview--valid"}catch(t){this.filenamePreview.textContent="Error generating filename preview",this.filenamePreview.className="task-creation-modal__preview task-creation-modal__preview--error"}}}async createTask(){if(await this.validateAndPrepareTask())try{let t=await this.performTaskCreation();this.conversionOptions.editor&&this.conversionOptions.lineNumber!==void 0&&await this.replaceOriginalTaskLine(t),new Ye.Notice(`Task created: ${this.title}`),this.close()}catch(t){console.error("Failed to create task:",t),new Ye.Notice("Failed to create task. Please try again.")}}async replaceOriginalTaskLine(t){if(!this.conversionOptions.editor||this.conversionOptions.lineNumber===void 0)return;let r=this.conversionOptions.editor,s=this.conversionOptions.lineNumber,n=`- [[${t.path}|${this.title}]]`,a={line:s,ch:0},o={line:s,ch:r.getLine(s).length};r.replaceRange(n,a,o)}async validateAndPrepareTask(){if(!this.title||!this.title.trim())return new Ye.Notice("Title is required"),!1;if(this.title.length>200)return new Ye.Notice("Title is too long (max 200 characters)"),!1;if(this.recurrence==="weekly"&&this.daysOfWeek.length===0)return new Ye.Notice("Please select at least one day for weekly recurrence"),!1;if(this.recurrence==="monthly"&&(!this.dayOfMonth||parseInt(this.dayOfMonth)<1||parseInt(this.dayOfMonth)>31))return new Ye.Notice("Please enter a valid day of month (1-31)"),!1;if(this.recurrence==="yearly"){if(!this.monthOfYear||!this.dayOfMonth)return new Ye.Notice("Please select month and day for yearly recurrence"),!1;if(parseInt(this.dayOfMonth)<1||parseInt(this.dayOfMonth)>31)return new Ye.Notice("Please enter a valid day of month (1-31)"),!1}return!0}async performTaskCreation(){let t=this.contexts?this.contexts.split(",").map(o=>o.trim()).filter(o=>o):[],r=this.tags?this.tags.split(",").map(o=>o.trim()).filter(o=>o):[];r.unshift(this.plugin.settings.taskTag);let s={title:this.title,status:this.status,priority:this.priority,due:this.dueDate||void 0,scheduled:this.scheduledDate||void 0,contexts:t.length>0?t:void 0,tags:r,timeEstimate:this.timeEstimate>0?this.timeEstimate:void 0,details:this.details&&this.details.trim()?this.details.trim():void 0,dateCreated:we(),dateModified:we()};this.recurrence!=="none"&&(s.recurrence={frequency:this.recurrence},this.recurrence==="weekly"&&this.daysOfWeek.length>0&&(s.recurrence.days_of_week=this.convertFullNamesToAbbreviations(this.daysOfWeek)),this.recurrence==="monthly"&&this.dayOfMonth&&(s.recurrence.day_of_month=parseInt(this.dayOfMonth)),this.recurrence==="yearly"&&(this.monthOfYear&&(s.recurrence.month_of_year=parseInt(this.monthOfYear)),this.dayOfMonth&&(s.recurrence.day_of_month=parseInt(this.dayOfMonth))));let{file:n}=await this.plugin.taskService.createTask(s),a=this.app.workspace.getLeavesOfType(Wr);if(a.length>0){let o=a[0].view;o&&typeof o.refresh=="function"&&o.refresh()}return n}createDueDateInputWithRef(t){this.createDueDateInput(t),this.dueDateInput=t.querySelector('input[type="date"]')}};var ot=require("obsidian");_e();var Xi=class extends Ki{constructor(t,r,s){super(t,r);this.task=s}async initializeFormData(){var r,s,n;let t=await this.plugin.cacheManager.getTaskInfo(this.task.path,!0);t&&(this.task=t),this.title=this.task.title,this.dueDate=this.task.due||"",this.scheduledDate=this.task.scheduled||"",this.priority=this.task.priority,this.status=this.task.status,this.contexts=this.task.contexts?this.task.contexts.join(", "):"",this.tags=this.task.tags?this.task.tags.filter(a=>a!==this.plugin.settings.taskTag).join(", "):"",this.timeEstimate=this.task.timeEstimate!==void 0?this.task.timeEstimate:0,this.recurrence=((r=this.task.recurrence)==null?void 0:r.frequency)||"none",this.task.recurrence&&(this.daysOfWeek=this.convertAbbreviationsToFullNames(this.task.recurrence.days_of_week||[]),this.dayOfMonth=((s=this.task.recurrence.day_of_month)==null?void 0:s.toString())||"",this.monthOfYear=((n=this.task.recurrence.month_of_year)==null?void 0:n.toString())||"")}async onOpen(){let{contentEl:t}=this;t.addClass("tasknotes-plugin","task-edit-modal"),new ot.Setting(t).setName("Edit task").setHeading(),await this.initializeFormData(),this.existingContexts=await this.getExistingContexts(),this.existingTags=await this.getExistingTags(),this.createFormGroup(t,"Title",r=>{this.createTitleInputWithCounter(r,200);let s=r.querySelector("input");s&&setTimeout(()=>s.focus(),50)}),this.createFormGroup(t,"Due date",r=>{this.createDueDateInput(r)}),this.createFormGroup(t,"Scheduled date",r=>{this.createScheduledDateInput(r)}),this.createFormGroup(t,"Priority",r=>{this.createPriorityDropdown(r)}),this.createFormGroup(t,"Status",r=>{this.createStatusDropdown(r)}),this.createFormGroup(t,"Contexts",r=>{this.createAutocompleteInput(r,"contexts",()=>this.existingContexts,s=>{this.contexts=s})}),this.createFormGroup(t,"Tags",r=>{this.createAutocompleteInput(r,"tags",()=>this.existingTags,s=>{this.tags=s})}),this.createFormGroup(t,"Time estimate",r=>{this.createTimeEstimateInput(r)}),this.createFormGroup(t,"Recurrence",r=>{this.createRecurrenceDropdown(r)}),this.createMetadataFooter(t),this.createActionButtons(t),t.addEventListener("keydown",r=>{r.key==="Escape"?this.close():r.key==="Enter"&&(r.ctrlKey||r.metaKey)&&(r.preventDefault(),this.saveTask())})}createActionButtons(t){let r=t.createDiv({cls:"modal-form__buttons"});r.createEl("button",{text:"Open note",cls:"modal-form__button modal-form__button--tertiary"}).addEventListener("click",()=>{this.openNote()}),r.createEl("button",{text:"Save",cls:"modal-form__button modal-form__button--primary"}).addEventListener("click",()=>{this.saveTask()}),r.createEl("button",{text:"Cancel",cls:"modal-form__button modal-form__button--secondary"}).addEventListener("click",()=>{this.close()})}async handleSubmit(){await this.saveTask()}createMetadataFooter(t){let s=t.createDiv({cls:"task-edit-modal__metadata"}).createDiv({cls:"task-edit-modal__metadata-container"});this.task.dateCreated&&s.createDiv({cls:"task-edit-modal__metadata-item",text:`Created: ${Iu(this.task.dateCreated,"MMM d, yyyy 'at' h:mm a")}`}),this.task.dateModified&&s.createDiv({cls:"task-edit-modal__metadata-item",text:`Modified: ${Iu(this.task.dateModified,"MMM d, yyyy 'at' h:mm a")}`})}openNote(){let t=this.app.vault.getAbstractFileByPath(this.task.path);t instanceof ot.TFile&&(this.app.workspace.getLeaf(!1).openFile(t),this.close())}async saveTask(){if(!this.title||!this.title.trim()){new ot.Notice("Title is required");return}if(this.title.length>200){new ot.Notice("Title is too long (max 200 characters)");return}if(this.recurrence==="weekly"&&this.daysOfWeek.length===0){new ot.Notice("Please select at least one day for weekly recurrence");return}if(this.recurrence==="monthly"&&(!this.dayOfMonth||parseInt(this.dayOfMonth)<1||parseInt(this.dayOfMonth)>31)){new ot.Notice("Please enter a valid day of month (1-31)");return}if(this.recurrence==="yearly"){if(!this.monthOfYear||!this.dayOfMonth){new ot.Notice("Please select month and day for yearly recurrence");return}if(parseInt(this.dayOfMonth)<1||parseInt(this.dayOfMonth)>31){new ot.Notice("Please enter a valid day of month (1-31)");return}}try{let t=this.contexts?this.contexts.split(",").map(v=>v.trim()).filter(v=>v):[],r=this.tags?this.tags.split(",").map(v=>v.trim()).filter(v=>v):[];r.includes(this.plugin.settings.taskTag)||r.unshift(this.plugin.settings.taskTag);let s={};this.title!==this.task.title&&(s.title=this.title),this.priority!==this.task.priority&&(s.priority=this.priority),this.status!==this.task.status&&(s.status=this.status);let n=this.dueDate||"",a=this.task.due||"";n!==a&&(s.due=this.dueDate||void 0);let o=this.scheduledDate||"",l=this.task.scheduled||"";o!==l&&(s.scheduled=this.scheduledDate||void 0);let c=this.task.timeEstimate!==void 0?this.task.timeEstimate:0;this.timeEstimate!==c&&(s.timeEstimate=this.timeEstimate>0?this.timeEstimate:void 0);let d=this.task.contexts||[],u=(v,w)=>v.length===w.length&&v.every((_,E)=>_===w[E]);u(t,d)||(s.contexts=t.length>0?t:void 0);let f=this.task.tags||[];u(r,f)||(s.tags=r);let h=this.recurrence!=="none"?{frequency:this.recurrence,days_of_week:this.recurrence==="weekly"?this.convertFullNamesToAbbreviations(this.daysOfWeek):void 0,day_of_month:(this.recurrence==="monthly"||this.recurrence==="yearly")&&this.dayOfMonth?parseInt(this.dayOfMonth):void 0,month_of_year:this.recurrence==="yearly"&&this.monthOfYear?parseInt(this.monthOfYear):void 0}:void 0,m=this.task.recurrence;if(JSON.stringify(h)!==JSON.stringify(m)&&(s.recurrence=h),Object.keys(s).length===0){new ot.Notice("No changes detected"),this.close();return}let g=await this.plugin.cacheManager.getTaskInfo(this.task.path,!0)||this.task;await this.plugin.taskService.updateTask(g,s),new ot.Notice("Task updated successfully"),this.close()}catch(t){console.error("Failed to save task:",t),new ot.Notice("Failed to save task. Please try again.")}}};var Ji=require("obsidian");Me();_e();var xc=class extends Ji.FuzzySuggestModal{constructor(t,r,s,n){super(t);this.plugin=r,this.onScheduleTask=s,this.defaultScheduleOptions=n,this.setPlaceholder("Type to search for an unscheduled task..."),this.setInstructions([{command:"\u2191\u2193",purpose:"to navigate"},{command:"\u21B5",purpose:"to schedule task"},{command:"esc",purpose:"to dismiss"}]),this.titleEl.setText("Schedule Task"),this.titleEl.setAttribute("id","unscheduled-tasks-selector-title"),this.containerEl.setAttribute("aria-labelledby","unscheduled-tasks-selector-title"),this.containerEl.setAttribute("role","dialog"),this.containerEl.setAttribute("aria-modal","true"),this.containerEl.addClass("unscheduled-tasks-selector-modal"),this.loadUnscheduledTasks()}async loadUnscheduledTasks(){try{let t=this.plugin.cacheManager.getAllTaskPaths(),r=Array.from(t).map(n=>this.plugin.cacheManager.getTaskInfo(n)),s=(await Promise.all(r)).filter(n=>n!==null);this.tasks=s.filter(n=>!n.archived&&!this.plugin.statusManager.isCompletedStatus(n.status)&&!n.scheduled)}catch(t){console.error("Error loading unscheduled tasks:",t),this.tasks=[]}}getItems(){return this.tasks.sort((t,r)=>{var o,l;if(t.due&&!r.due)return-1;if(!t.due&&r.due)return 1;if(t.due&&r.due){let c=t.due.localeCompare(r.due);if(c!==0)return c}let s={high:0,normal:1,low:2},n=(o=s[t.priority])!=null?o:1,a=(l=s[r.priority])!=null?l:1;return n!==a?n-a:t.title.localeCompare(r.title)})}getItemText(t){return t.title}renderSuggestion(t,r){let s=t.item;r.empty(),r.addClass("unscheduled-tasks-selector__suggestion");let n=r.createDiv({cls:"unscheduled-tasks-selector__content"}),a=n.createDiv({cls:"unscheduled-tasks-selector__title"});a.innerHTML=this.highlight(t,s.title);let o=n.createDiv({cls:"unscheduled-tasks-selector__meta"});if(s.priority){let c=o.createSpan({text:s.priority.toUpperCase(),cls:`unscheduled-tasks-selector__priority priority-${s.priority.toLowerCase()}`})}if(s.due){let c=o.createSpan({cls:"unscheduled-tasks-selector__due"}),d=Je(s.due)?k(le(s.due),"MMM d, h:mm a"):k(le(s.due),"MMM d");if(Ii(ge(s.due))){c.addClass("overdue");let u=c.createSpan();(0,Ji.setIcon)(u,"alert-triangle"),c.createSpan({text:` Overdue: ${d}`})}else if(rs(ge(s.due))){c.addClass("due-today");let u=c.createSpan();(0,Ji.setIcon)(u,"calendar"),c.createSpan({text:` Due today: ${d}`})}else c.setText(`Due: ${d}`)}if(s.timeEstimate){let c=o.createSpan({text:`~${s.timeEstimate}min`,cls:"unscheduled-tasks-selector__time-estimate"})}let l=n.createDiv({cls:"unscheduled-tasks-selector__schedule-icon"});(0,Ji.setIcon)(l,"calendar-plus")}highlight(t,r){let s=t.match.matches;if(!s||s.length===0)return r;let n="",a=0;for(let o of s)n+=r.slice(a,o[0]),n+=`<mark>${r.slice(o[0],o[1]+1)}</mark>`,a=o[1]+1;return n+=r.slice(a),n}onChooseItem(t,r){this.onScheduleTask(t,this.defaultScheduleOptions)}onNoSuggestion(){this.resultContainerEl.createDiv({cls:"unscheduled-tasks-selector__no-results"}).setText("No unscheduled tasks found. All tasks are either scheduled, completed, or archived.")}};var fr=class{constructor(){this.events={}}on(e,t){return this.events[e]||(this.events[e]=[]),this.events[e].push(t),()=>{this.events[e]=this.events[e].filter(r=>r!==t)}}emit(e,...t){this.events[e]&&this.events[e].forEach(r=>{r(...t)})}removeAllListeners(e){e?delete this.events[e]:this.events={}}};var hr=class extends fr{constructor(t,r,s,n={}){super();this.cacheRefreshListeners=[];this.container=t,this.currentQuery={...r},this.filterOptions=s,this.config={showSearch:!0,showGroupBy:!0,showSortBy:!0,showAdvancedFilters:!0,showDateRangePicker:!1,allowedSortKeys:["due","priority","title"],allowedGroupKeys:["none","status","priority","context","due"],...n},this.render(),this.updateUI()}async initialize(){return Promise.resolve()}setupCacheRefresh(t,r){let s=t.subscribe("cache-initialized",async()=>{try{let a=await r.getFilterOptions();this.updateFilterOptions(a)}catch(a){console.error("FilterBar: Error refreshing filter options after cache initialization:",a)}}),n=r.on("data-changed",async()=>{try{let a=await r.getFilterOptions();this.updateFilterOptions(a)}catch(a){console.error("FilterBar: Error refreshing filter options after data change:",a)}});this.cacheRefreshListeners||(this.cacheRefreshListeners=[]),this.cacheRefreshListeners.push(s,n)}updateQuery(t){this.currentQuery={...t},this.updateUI()}updateFilterOptions(t){this.filterOptions=t,this.rebuildAdvancedFilters()}getCurrentQuery(){return{...this.currentQuery}}render(){this.container.empty(),this.container.addClass("filter-bar");let t=this.container.createDiv("filter-bar__main");this.config.showSearch&&this.renderSearchInput(t);let r=t.createDiv("filter-bar__controls");this.config.showSortBy&&this.renderSortControls(r),this.config.showGroupBy&&this.renderGroupControls(r),this.config.showAdvancedFilters&&this.renderAdvancedFiltersButton(r),this.config.showAdvancedFilters&&this.renderAdvancedFiltersPanel()}renderSearchInput(t){let r=t.createDiv("filter-bar__search");this.searchInput=r.createEl("input",{type:"text",placeholder:"Search tasks...",cls:"filter-bar__search-input"}),this.searchInput.addEventListener("input",()=>{this.updateQueryField("searchQuery",this.searchInput.value||void 0)})}renderSortControls(t){let r=t.createDiv("filter-bar__sort");r.createSpan({text:"Sort:",cls:"filter-bar__label"}),this.sortSelect=r.createEl("select",{cls:"filter-bar__select"}),(this.config.allowedSortKeys||["due","priority","title"]).forEach(a=>{let o=this.sortSelect.createEl("option",{value:a,text:this.getSortKeyLabel(a)})}),this.sortSelect.addEventListener("change",()=>{this.updateQueryField("sortKey",this.sortSelect.value)}),r.createEl("button",{cls:"filter-bar__sort-direction",attr:{"aria-label":"Toggle sort direction"}}).addEventListener("click",()=>{let a=this.currentQuery.sortDirection==="asc"?"desc":"asc";this.updateQueryField("sortDirection",a)})}renderGroupControls(t){let r=t.createDiv("filter-bar__group");r.createSpan({text:"Group:",cls:"filter-bar__label"}),this.groupSelect=r.createEl("select",{cls:"filter-bar__select"}),(this.config.allowedGroupKeys||["none","status","priority","context","due"]).forEach(n=>{this.groupSelect.createEl("option",{value:n,text:this.getGroupKeyLabel(n)})}),this.groupSelect.addEventListener("change",()=>{this.updateQueryField("groupKey",this.groupSelect.value)})}renderDateRangeFilter(){let t=this.advancedFiltersPanel.createDiv("filter-bar__advanced-item");t.createSpan({text:"Date range:",cls:"filter-bar__label"});let r=t.createDiv("filter-bar__date-inputs"),s=r.createDiv("filter-bar__date-input-container");s.createSpan({text:"From:",cls:"filter-bar__date-label"}),this.dateRangeStartInput=s.createEl("input",{type:"date",cls:"filter-bar__date-input"});let n=r.createDiv("filter-bar__date-input-container");n.createSpan({text:"To:",cls:"filter-bar__date-label"}),this.dateRangeEndInput=n.createEl("input",{type:"date",cls:"filter-bar__date-input"});let a=r.createEl("button",{cls:"filter-bar__date-clear",text:"Clear",attr:{"aria-label":"Clear date range"}});this.dateRangeStartInput.addEventListener("change",()=>{this.updateDateRange()}),this.dateRangeEndInput.addEventListener("change",()=>{this.updateDateRange()}),a.addEventListener("click",()=>{this.clearDateRange()})}updateDateRange(){var s,n;let t=(s=this.dateRangeStartInput)==null?void 0:s.value,r=(n=this.dateRangeEndInput)==null?void 0:n.value;t&&r?this.updateQueryField("dateRange",{start:t,end:r}):!t&&!r&&this.updateQueryField("dateRange",void 0)}clearDateRange(){this.dateRangeStartInput&&(this.dateRangeStartInput.value=""),this.dateRangeEndInput&&(this.dateRangeEndInput.value=""),this.updateQueryField("dateRange",void 0)}renderAdvancedFiltersButton(t){this.advancedFiltersButton=t.createEl("button",{cls:"filter-bar__advanced-toggle",text:"Filters"}),this.activeFiltersIndicator=this.advancedFiltersButton.createSpan({cls:"filter-bar__active-indicator filter-bar__active-indicator--hidden"}),this.advancedFiltersButton.addEventListener("click",()=>{this.toggleAdvancedFilters()})}renderAdvancedFiltersPanel(){this.advancedFiltersPanel=this.container.createDiv("filter-bar__advanced"),this.advancedFiltersPanel.addClass("filter-bar__advanced--hidden"),this.renderStatusFilter(),this.renderPriorityFilter(),this.renderContextFilter(),this.config.showDateRangePicker&&this.renderDateRangeFilter(),this.renderArchivedToggle()}renderStatusFilter(){let t=this.advancedFiltersPanel.createDiv("filter-bar__advanced-item");t.createSpan({text:"Status:",cls:"filter-bar__label"});let r=t.createDiv("filter-bar__checkbox-group");this.filterOptions.statuses.forEach(s=>{let a=r.createDiv("filter-bar__checkbox-wrapper").createEl("label",{cls:"filter-bar__checkbox-label"}),o=a.createEl("input",{type:"checkbox",value:s,cls:"filter-bar__checkbox"});a.createSpan({text:s}),o.addEventListener("change",()=>{this.updateStatusFilter()})})}updateStatusFilter(){var n;let t=(n=this.advancedFiltersPanel)==null?void 0:n.querySelector(".filter-bar__advanced-item:nth-child(1)"),r=t==null?void 0:t.querySelectorAll('input[type="checkbox"]:checked'),s=Array.from(r||[]).map(a=>a.value);this.updateQueryField("statuses",s.length>0?s:void 0)}renderPriorityFilter(){let t=this.advancedFiltersPanel.createDiv("filter-bar__advanced-item");t.createSpan({text:"Priority:",cls:"filter-bar__label"});let r=t.createDiv("filter-bar__checkbox-group");this.filterOptions.priorities.forEach(s=>{let a=r.createDiv("filter-bar__checkbox-wrapper").createEl("label",{cls:"filter-bar__checkbox-label"}),o=a.createEl("input",{type:"checkbox",value:s,cls:"filter-bar__checkbox"});a.createSpan({text:s}),o.addEventListener("change",()=>{this.updatePriorityFilter()})})}updatePriorityFilter(){var n;let t=(n=this.advancedFiltersPanel)==null?void 0:n.querySelector(".filter-bar__advanced-item:nth-child(2)"),r=t==null?void 0:t.querySelectorAll('input[type="checkbox"]:checked'),s=Array.from(r||[]).map(a=>a.value);this.updateQueryField("priorities",s.length>0?s:void 0)}renderContextFilter(){let t=this.advancedFiltersPanel.createDiv("filter-bar__advanced-item");t.createSpan({text:"Context:",cls:"filter-bar__label"});let r=t.createDiv("filter-bar__checkbox-group");this.filterOptions.contexts.forEach(s=>{let a=r.createDiv("filter-bar__checkbox-wrapper").createEl("label",{cls:"filter-bar__checkbox-label"}),o=a.createEl("input",{type:"checkbox",value:s,cls:"filter-bar__checkbox"});a.createSpan({text:s}),o.addEventListener("change",()=>{this.updateContextFilter()})})}updateContextFilter(){var n;let t=(n=this.advancedFiltersPanel)==null?void 0:n.querySelector(".filter-bar__advanced-item:nth-child(3)"),r=t==null?void 0:t.querySelectorAll('input[type="checkbox"]:checked'),s=Array.from(r||[]).map(a=>a.value);this.updateQueryField("contexts",s.length>0?s:void 0)}renderArchivedToggle(){let r=this.advancedFiltersPanel.createDiv("filter-bar__advanced-item").createEl("label",{cls:"filter-bar__checkbox-label"});this.archivedToggle=r.createEl("input",{type:"checkbox",cls:"filter-bar__checkbox"}),r.createSpan({text:"Show archived"}),this.archivedToggle.addEventListener("change",()=>{this.updateQueryField("showArchived",this.archivedToggle.checked)})}updateQueryField(t,r){this.currentQuery[t]=r,t==="sortDirection"&&this.updateSortDirectionButton(),this.updateActiveFiltersIndicator(),this.emit("queryChange",{...this.currentQuery})}updateUI(){var l,c,d;this.searchInput&&(this.searchInput.value=this.currentQuery.searchQuery||""),this.sortSelect&&(this.sortSelect.value=this.currentQuery.sortKey),this.groupSelect&&(this.groupSelect.value=this.currentQuery.groupKey),this.dateRangeStartInput&&this.dateRangeEndInput&&(this.currentQuery.dateRange?(this.dateRangeStartInput.value=this.currentQuery.dateRange.start,this.dateRangeEndInput.value=this.currentQuery.dateRange.end):(this.dateRangeStartInput.value="",this.dateRangeEndInput.value=""));let t=(l=this.advancedFiltersPanel)==null?void 0:l.querySelector(".filter-bar__advanced-item:nth-child(1)"),r=t==null?void 0:t.querySelectorAll('input[type="checkbox"]');r==null||r.forEach(u=>{this.currentQuery.statuses?u.checked=this.currentQuery.statuses.includes(u.value):u.checked=!1});let s=(c=this.advancedFiltersPanel)==null?void 0:c.querySelector(".filter-bar__advanced-item:nth-child(2)"),n=s==null?void 0:s.querySelectorAll('input[type="checkbox"]');n==null||n.forEach(u=>{u.checked=(this.currentQuery.priorities||[]).includes(u.value)});let a=(d=this.advancedFiltersPanel)==null?void 0:d.querySelector(".filter-bar__advanced-item:nth-child(3)"),o=a==null?void 0:a.querySelectorAll('input[type="checkbox"]');o==null||o.forEach(u=>{u.checked=(this.currentQuery.contexts||[]).includes(u.value)}),this.archivedToggle&&(this.archivedToggle.checked=this.currentQuery.showArchived),this.updateSortDirectionButton(),this.updateActiveFiltersIndicator()}updateSortDirectionButton(){let t=this.container.querySelector(".filter-bar__sort-direction");t&&(t.textContent=this.currentQuery.sortDirection==="asc"?"\u2191":"\u2193",t.title=`Sort ${this.currentQuery.sortDirection==="asc"?"Ascending":"Descending"}`)}updateActiveFiltersIndicator(){if(!this.activeFiltersIndicator)return;let t=0;this.currentQuery.searchQuery&&t++,this.currentQuery.statuses&&this.currentQuery.statuses.length>0&&t++,this.currentQuery.priorities&&this.currentQuery.priorities.length>0&&t++,this.currentQuery.contexts&&this.currentQuery.contexts.length>0&&t++,this.currentQuery.showArchived&&t++,this.currentQuery.dateRange&&t++,t>0?(this.activeFiltersIndicator.textContent=`(${t})`,this.activeFiltersIndicator.classList.remove("filter-bar__active-indicator--hidden")):this.activeFiltersIndicator.classList.add("filter-bar__active-indicator--hidden")}toggleAdvancedFilters(){if(!this.advancedFiltersPanel)return;let t=!this.advancedFiltersPanel.classList.contains("filter-bar__advanced--hidden");this.advancedFiltersPanel.classList.toggle("filter-bar__advanced--hidden",t),this.advancedFiltersButton&&this.advancedFiltersButton.classList.toggle("filter-bar__advanced-toggle--active",!t)}rebuildAdvancedFilters(){this.advancedFiltersPanel&&(this.rebuildStatusCheckboxes(),this.rebuildPriorityCheckboxes(),this.rebuildContextCheckboxes())}rebuildSelectOptions(t,r,s){if(!t)return;let n=s||[];t.empty(),r.forEach(a=>{let o=t.createEl("option",{value:a,text:a});o.selected=n.includes(a)})}rebuildStatusCheckboxes(){var s;let t=(s=this.advancedFiltersPanel)==null?void 0:s.querySelector(".filter-bar__advanced-item:nth-child(1) .filter-bar__checkbox-group");if(!t)return;let r=this.currentQuery.statuses||[];t.empty(),this.filterOptions.statuses.forEach(n=>{let o=t.createDiv("filter-bar__checkbox-wrapper").createEl("label",{cls:"filter-bar__checkbox-label"}),l=o.createEl("input",{type:"checkbox",value:n,cls:"filter-bar__checkbox"});l.checked=r.includes(n),o.createSpan({text:n}),l.addEventListener("change",()=>{this.updateStatusFilter()})})}rebuildPriorityCheckboxes(){var s;let t=(s=this.advancedFiltersPanel)==null?void 0:s.querySelector(".filter-bar__advanced-item:nth-child(2) .filter-bar__checkbox-group");if(!t)return;let r=this.currentQuery.priorities||[];t.empty(),this.filterOptions.priorities.forEach(n=>{let o=t.createDiv("filter-bar__checkbox-wrapper").createEl("label",{cls:"filter-bar__checkbox-label"}),l=o.createEl("input",{type:"checkbox",value:n,cls:"filter-bar__checkbox"});l.checked=r.includes(n),o.createSpan({text:n}),l.addEventListener("change",()=>{this.updatePriorityFilter()})})}rebuildContextCheckboxes(){var s;let t=(s=this.advancedFiltersPanel)==null?void 0:s.querySelector(".filter-bar__advanced-item:nth-child(3) .filter-bar__checkbox-group");if(!t)return;let r=this.currentQuery.contexts||[];t.empty(),this.filterOptions.contexts.forEach(n=>{let o=t.createDiv("filter-bar__checkbox-wrapper").createEl("label",{cls:"filter-bar__checkbox-label"}),l=o.createEl("input",{type:"checkbox",value:n,cls:"filter-bar__checkbox"});l.checked=r.includes(n),o.createSpan({text:n}),l.addEventListener("change",()=>{this.updateContextFilter()})})}getSortKeyLabel(t){return{due:"Due date",scheduled:"Scheduled date",priority:"Priority",title:"Title"}[t]||t}getGroupKeyLabel(t){return{none:"None",status:"Status",priority:"Priority",context:"Context",due:"Due date",scheduled:"Scheduled date"}[t]||t}destroy(){this.cacheRefreshListeners&&(this.cacheRefreshListeners.forEach(t=>t()),this.cacheRefreshListeners=[]),this.container.empty(),this.removeAllListeners()}};en();_e();rr();var Mc=class extends ys.ItemView{constructor(t,r){super(t);this.calendar=null;this.listeners=[];this.filterBar=null;this.showScheduled=!0;this.showDue=!0;this.showTimeEntries=!1;this.showRecurring=!0;this.plugin=r,this.currentQuery={searchQuery:void 0,statuses:void 0,contexts:void 0,priorities:void 0,dateRange:void 0,showArchived:!1,sortKey:"due",sortDirection:"asc",groupKey:"none"}}getViewType(){return _s}getDisplayText(){return"Advanced Calendar"}getIcon(){return"calendar-range"}async onOpen(){await this.plugin.onReady();let t=this.plugin.viewStateManager.getFilterState(_s);t?this.currentQuery=t:this.plugin.filterService&&(this.currentQuery=this.plugin.filterService.createDefaultQuery());let r=this.contentEl;r.empty(),r.addClass("tasknotes-plugin"),r.addClass("advanced-calendar-view"),await this.renderView(),this.registerEvents(),await this.initializeCalendar()}async renderView(){let{contentEl:t}=this;t.empty();let r=t.createDiv({cls:"advanced-calendar-view__container"});await this.createHeader(r);let s=r.createDiv({cls:"advanced-calendar-view__calendar-container",attr:{id:"advanced-calendar"}})}async createHeader(t){let s=t.createDiv({cls:"advanced-calendar-view__header"}).createDiv({cls:"advanced-calendar-view__main-row"}),n=s.createDiv({cls:"filter-bar-container"}),a=await this.plugin.filterService.getFilterOptions();this.filterBar=new hr(n,this.currentQuery,a,{showSearch:!0,showGroupBy:!1,showSortBy:!1,showAdvancedFilters:!0,showDateRangePicker:!1,allowedSortKeys:[],allowedGroupKeys:[]}),await this.filterBar.initialize(),this.filterBar.setupCacheRefresh(this.plugin.cacheManager,this.plugin.filterService),this.filterBar.on("queryChange",async m=>{this.currentQuery=m,await this.plugin.viewStateManager.setFilterState(_s,m),this.refreshEvents()});let o=s.createDiv({cls:"advanced-calendar-view__controls"}),l=o.createDiv({cls:"advanced-calendar-view__toggles"}),c=this.createToggle(l,"Scheduled tasks",this.showScheduled,m=>{this.showScheduled=m,this.refreshEvents()}),d=this.createToggle(l,"Due dates",this.showDue,m=>{this.showDue=m,this.refreshEvents()}),u=this.createToggle(l,"Time entries",this.showTimeEntries,m=>{this.showTimeEntries=m,this.refreshEvents()}),f=this.createToggle(l,"Recurring tasks",this.showRecurring,m=>{this.showRecurring=m,this.refreshEvents()});o.createEl("button",{text:"Schedule tasks",cls:"advanced-calendar-view__schedule-tasks-btn"}).addEventListener("click",()=>{this.openScheduleTasksModal()})}createToggle(t,r,s,n){let a=t.createDiv({cls:"advanced-calendar-view__toggle"}),o=a.createEl("input",{type:"checkbox",cls:"advanced-calendar-view__toggle-input"});o.checked=s;let l=a.createEl("label",{text:r,cls:"advanced-calendar-view__toggle-label"});return o.addEventListener("change",()=>{n(o.checked)}),a}openScheduleTasksModal(){new xc(this.app,this.plugin,(r,s)=>{r&&this.scheduleTask(r,s)}).open()}async scheduleTask(t,r){try{let s;r!=null&&r.date?r.allDay?s=k(r.date,"yyyy-MM-dd"):r.time?s=k(r.date,"yyyy-MM-dd")+"T"+r.time:s=k(r.date,"yyyy-MM-dd")+"T09:00":s=k(new Date,"yyyy-MM-dd")+"T09:00",await this.plugin.taskService.updateProperty(t,"scheduled",s)}catch(s){console.error("Error scheduling task:",s)}}async initializeCalendar(){let t=document.getElementById("advanced-calendar");if(!t){console.error("Calendar element not found");return}this.calendar=new fc(t,{plugins:[ow,pw,mw,vw],initialView:"dayGridMonth",headerToolbar:{left:"prev,next today",center:"title",right:"multiMonthYear,dayGridMonth,timeGridWeek,timeGridDay"},height:"100%",editable:!0,droppable:!0,selectable:!0,selectMirror:!0,nowIndicator:!0,slotMinTime:"00:00:00",slotMaxTime:"24:00:00",scrollTime:"08:00:00",slotDuration:"00:30:00",slotLabelInterval:"01:00:00",select:this.handleDateSelect.bind(this),eventClick:this.handleEventClick.bind(this),eventDrop:this.handleEventDrop.bind(this),eventResize:this.handleEventResize.bind(this),drop:this.handleExternalDrop.bind(this),eventReceive:this.handleEventReceive.bind(this),eventDidMount:this.handleEventDidMount.bind(this),events:this.getCalendarEvents.bind(this)}),this.calendar.render()}async getCalendarEvents(){var r;let t=[];try{let s=await this.plugin.filterService.getGroupedTasks(this.currentQuery),n=[];for(let c of s.values())n.push(...c);let a=(r=this.calendar)==null?void 0:r.view,o=(a==null?void 0:a.activeStart)||Re(new Date),l=(a==null?void 0:a.activeEnd)||Ts(new Date);for(let c of n){if(this.showRecurring&&c.recurrence&&c.scheduled){let d=this.generateRecurringInstances(c,o,l);t.push(...d)}else if(this.showScheduled&&c.scheduled&&!c.recurrence){let d=this.createScheduledEvent(c);d&&t.push(d)}if(this.showDue&&c.due&&!c.scheduled){let d=this.createDueEvent(c);d&&t.push(d)}if(this.showTimeEntries&&c.timeEntries){let d=this.createTimeEntryEvents(c);t.push(...d)}}}catch(s){console.error("Error getting calendar events:",s)}return t}createScheduledEvent(t){if(!t.scheduled)return null;let r=Je(t.scheduled),s=t.scheduled,n;if(r&&t.timeEstimate){let c=le(s),d=new Date(c.getTime()+t.timeEstimate*60*1e3);n=k(d,"yyyy-MM-dd'T'HH:mm")}let a=this.plugin.priorityManager.getPriorityConfig(t.priority),o=(a==null?void 0:a.color)||"#6B73FF",l=this.plugin.statusManager.isCompletedStatus(t.status);return{id:`scheduled-${t.path}`,title:t.title,start:s,end:n,allDay:!r,backgroundColor:"transparent",borderColor:o,textColor:o,extendedProps:{taskInfo:t,eventType:"scheduled",isCompleted:l}}}createDueEvent(t){if(!t.due)return null;let r=Je(t.due),s=t.due,n;if(r){let d=le(s),u=new Date(d.getTime()+30*60*1e3);n=k(u,"yyyy-MM-dd'T'HH:mm")}let a=this.plugin.priorityManager.getPriorityConfig(t.priority),o=(a==null?void 0:a.color)||"#FF5722",l=this.hexToRgba(o,.15),c=this.plugin.statusManager.isCompletedStatus(t.status);return{id:`due-${t.path}`,title:`DUE: ${t.title}`,start:s,end:n,allDay:!r,backgroundColor:l,borderColor:o,textColor:o,extendedProps:{taskInfo:t,eventType:"due",isCompleted:c}}}hexToRgba(t,r){t=t.replace("#","");let s=parseInt(t.substr(0,2),16),n=parseInt(t.substr(2,2),16),a=parseInt(t.substr(4,2),16);return`rgba(${s}, ${n}, ${a}, ${r})`}createTimeEntryEvents(t){if(!t.timeEntries)return[];let r=this.plugin.statusManager.isCompletedStatus(t.status);return t.timeEntries.filter(s=>s.endTime).map((s,n)=>({id:`timeentry-${t.path}-${n}`,title:t.title,start:s.startTime,end:s.endTime,allDay:!1,backgroundColor:"#9E9E9E",borderColor:"#757575",textColor:"#FFFFFF",extendedProps:{taskInfo:t,eventType:"timeEntry",isCompleted:r}}))}generateRecurringInstances(t,r,s){if(!t.recurrence||!t.scheduled)return[];let n=[],a=this.getRecurringTime(t),o=new Date(r);for(;o<=s;){if(Os(t,o)){if(t.due&&o>le(t.due))break;let l=k(o,"yyyy-MM-dd"),c=`${l}T${a}`,d=this.createRecurringEvent(t,c,l,a);d&&n.push(d)}o.setDate(o.getDate()+1)}return n}getRecurringTime(t){return t.scheduled&&Sr(t.scheduled)||"09:00"}createRecurringEvent(t,r,s,n){var h;let a=Je(r),o;if(a&&t.timeEstimate){let m=le(r),p=new Date(m.getTime()+t.timeEstimate*60*1e3);o=k(p,"yyyy-MM-dd'T'HH:mm")}let l=this.plugin.priorityManager.getPriorityConfig(t.priority),c=(l==null?void 0:l.color)||"#6B73FF",d=((h=t.complete_instances)==null?void 0:h.includes(s))||!1,u=d?"rgba(0,0,0,0.3)":"transparent",f=d?"line-through":"none";return{id:`recurring-${t.path}-${s}`,title:t.title,start:r,end:o,allDay:!a,backgroundColor:u,borderColor:c,textColor:c,extendedProps:{taskInfo:t,eventType:"recurring",isCompleted:d,isRecurringInstance:!0,instanceDate:s,recurringTemplateTime:n}}}handleDateSelect(t){var c;let{start:r,end:s,allDay:n}=t,a=n?k(r,"yyyy-MM-dd"):k(r,"yyyy-MM-dd'T'HH:mm"),o=n?60:Math.round((s.getTime()-r.getTime())/(1e3*60));new ni(this.app,this.plugin,{scheduled:a,timeEstimate:o>0?o:60}).open(),(c=this.calendar)==null||c.unselect()}handleEventClick(t){let{taskInfo:r,eventType:s,isRecurringInstance:n}=t.event.extendedProps,a=t.jsEvent;s!=="timeEntry"&&(a.ctrlKey||a.metaKey?this.app.vault.getAbstractFileByPath(r.path)instanceof ys.TFile&&this.app.workspace.openLinkText(r.path,"",!0):a.button===0&&new Xi(this.app,this.plugin,r).open())}async handleEventDrop(t){let{taskInfo:r,eventType:s,isRecurringInstance:n,recurringTemplateTime:a}=t.event.extendedProps;if(s==="timeEntry"){t.revert();return}try{let o=t.event.start,l=t.event.allDay;if(n){let c=k(o,"HH:mm"),u=`${ge(r.scheduled)}T${c}`;new ys.Notice(`Updated recurring task time to ${c}. This affects all future instances.`),await this.plugin.taskService.updateProperty(r,"scheduled",u)}else{let c;l?c=k(o,"yyyy-MM-dd"):c=k(o,"yyyy-MM-dd'T'HH:mm");let d=s==="scheduled"?"scheduled":"due";await this.plugin.taskService.updateProperty(r,d,c)}}catch(o){console.error("Error updating task date:",o),t.revert()}}async handleEventResize(t){let{taskInfo:r,eventType:s}=t.event.extendedProps;if(s!=="scheduled"){t.revert();return}try{let n=t.event.start,a=t.event.end;if(n&&a){let o=Math.round((a.getTime()-n.getTime())/6e4);await this.plugin.taskService.updateProperty(r,"timeEstimate",o)}}catch(n){console.error("Error updating task duration:",n),t.revert()}}async handleExternalDrop(t){try{console.log("FullCalendar external drop triggered",t);let r;if(t.dataTransfer&&(r=t.dataTransfer.getData("text/plain")||t.dataTransfer.getData("application/x-task-path"),console.log("Task path from dataTransfer:",r)),!r&&t.draggedEl&&(r=t.draggedEl.dataset.taskPath,console.log("Task path from element dataset:",r)),!r){console.warn("No task path found in drop data",t);return}let s=await this.plugin.cacheManager.getTaskInfo(r);if(!s){console.warn("Task not found:",r);return}let n=t.date;if(!n){console.warn("No drop date provided");return}let a;t.allDay?a=k(n,"yyyy-MM-dd"):a=k(n,"yyyy-MM-dd'T'HH:mm"),await this.plugin.taskService.updateProperty(s,"scheduled",a),console.log(`Task "${s.title}" scheduled for ${a}`),new ys.Notice(`Task "${s.title}" scheduled for ${k(n,t.allDay?"MMM d, yyyy":"MMM d, yyyy h:mm a")}`),t.draggedEl&&t.draggedEl.remove(),this.refreshEvents()}catch(r){console.error("Error handling external drop:",r),new ys.Notice("Failed to schedule task"),t.draggedEl&&t.draggedEl.remove()}}handleEventReceive(t){console.log("FullCalendar eventReceive triggered, removing placeholder event:",t),t.event.remove()}handleEventDidMount(t){if(!t.event.extendedProps)return;let{taskInfo:r,eventType:s,isCompleted:n,isRecurringInstance:a,instanceDate:o}=t.event.extendedProps;if(!(!r||!r.path)){if(a&&(t.el.style.borderStyle="dashed",t.el.style.borderWidth="2px",t.el.setAttribute("data-recurring","true"),n&&(t.el.style.opacity="0.6")),n){let l=t.el.querySelector(".fc-event-title, .fc-event-title-container");l?l.style.textDecoration="line-through":t.el.style.textDecoration="line-through"}s!=="timeEntry"&&t.el.addEventListener("contextmenu",l=>{l.preventDefault(),l.stopPropagation();let c=a&&o?le(o):t.event.start||new Date;Ja(l,r.path,this.plugin,c)})}}registerEvents(){this.listeners.forEach(n=>n()),this.listeners=[];let t=this.plugin.emitter.on(tt,()=>{this.refreshEvents()});this.listeners.push(t);let r=this.plugin.emitter.on(Ae,()=>{this.refreshEvents()});this.listeners.push(r);let s=this.plugin.filterService.on("data-changed",()=>{this.refreshEvents()});this.listeners.push(s)}async refreshEvents(){this.calendar&&this.calendar.refetchEvents()}async onClose(){this.listeners.forEach(t=>t()),this.filterBar&&(this.filterBar.destroy(),this.filterBar=null),this.calendar&&(this.calendar.destroy(),this.calendar=null),this.contentEl.empty()}};var Ic=require("obsidian");en();var Ac=class extends Ic.ItemView{constructor(t,r){super(t);this.taskListContainer=null;this.loadingIndicator=null;this.isTasksLoading=!1;this.filterBar=null;this.taskElements=new Map;this.listeners=[];this.plugin=r,this.currentQuery={searchQuery:void 0,statuses:void 0,contexts:void 0,priorities:void 0,dateRange:void 0,showArchived:!1,sortKey:"due",sortDirection:"asc",groupKey:"none"},this.registerEvents()}getViewType(){return xs}getDisplayText(){return"Tasks"}getIcon(){return"check-square"}registerEvents(){this.listeners.forEach(n=>n()),this.listeners=[];let t=this.plugin.emitter.on(tt,()=>{this.refresh()});this.listeners.push(t);let r=this.plugin.emitter.on(Ae,async({path:n,originalTask:a,updatedTask:o})=>{if(!n||!o){console.error("EVENT_TASK_UPDATED received invalid data:",{path:n,originalTask:a,updatedTask:o});return}let l=this.taskElements.get(n);if(l)try{pr(l,o,this.plugin,{showDueDate:!0,showCheckbox:!1,showArchiveButton:!0,showTimeTracking:!0,showRecurringControls:!0,groupByDate:!1}),l.classList.add("task-updated"),setTimeout(()=>{l.classList.remove("task-updated")},1e3)}catch(c){console.error("Error updating task card:",c),this.refreshTasks()}else this.refreshTasks()});this.listeners.push(r);let s=this.plugin.filterService.on("data-changed",()=>{this.refreshTasks()});this.listeners.push(s)}async onOpen(){try{await this.plugin.onReady();let t=this.plugin.viewStateManager.getFilterState(xs);t?this.currentQuery=t:this.plugin.filterService&&(this.currentQuery=this.plugin.filterService.createDefaultQuery()),await this.refresh()}catch(t){console.error("TaskListView: Error during onOpen:",t),this.fallbackToPolling()}}async fallbackToPolling(){this.contentEl.empty(),this.contentEl.createDiv({cls:"task-list-view__loading"}).createSpan({text:"Initializing..."});let r=0,s=50,n=async()=>{r++,this.plugin.cacheManager&&this.plugin.cacheManager.isInitialized()?await this.refresh():r<s?setTimeout(n,100):(console.warn("TaskListView: Cache initialization timeout, attempting to load anyway"),await this.refresh())};n()}async onClose(){this.listeners.forEach(t=>t()),this.filterBar&&(this.filterBar.destroy(),this.filterBar=null),this.contentEl.empty()}async refresh(t=!1){return sr.measure("task-list-refresh",async()=>{t&&this.taskElements.clear(),this.contentEl.empty(),this.taskElements.clear(),await this.render()})}async render(){let t=this.contentEl.createDiv({cls:"tasknotes-plugin tasknotes-container task-list-view-container"});this.createHeader(t),await this.createTasksContent(t)}createHeader(t){let r=t.createDiv({cls:"detail-view-header task-list-header"});r.createEl("h2",{text:"All tasks",cls:"task-list-view__title"}),r.createDiv({cls:"detail-view-actions"}).createEl("button",{text:"New task",cls:"add-task-button tasknotes-button tasknotes-button-primary",attr:{"aria-label":"Create new task",title:"Create new task"}}).addEventListener("click",()=>{this.plugin.openTaskCreationModal()})}async createTasksContent(t){let r=t.createDiv({cls:"filter-bar-container"});await this.waitForCacheReady();let s=await this.plugin.filterService.getFilterOptions();this.filterBar=new hr(r,this.currentQuery,s,{showSearch:!0,showGroupBy:!0,showSortBy:!0,showAdvancedFilters:!0,showDateRangePicker:!0,allowedSortKeys:["due","scheduled","priority","title"],allowedGroupKeys:["none","status","priority","context","due","scheduled"]}),await this.filterBar.initialize(),this.filterBar.setupCacheRefresh(this.plugin.cacheManager,this.plugin.filterService),this.filterBar.on("queryChange",async a=>{this.currentQuery=a,await this.plugin.viewStateManager.setFilterState(xs,a),this.refreshTasks()});let n=t.createDiv({cls:"task-list"});this.loadingIndicator=n.createDiv({cls:"loading-indicator"}),this.loadingIndicator.createDiv({cls:"loading-spinner"}),this.loadingIndicator.createDiv({cls:"loading-text",text:"Loading tasks..."}),this.loadingIndicator.addClass("is-hidden"),this.taskListContainer=n,this.isTasksLoading=!0,this.updateLoadingState(),await this.refreshTasks(),this.isTasksLoading=!1,this.updateLoadingState()}async refreshTasks(){var t;if(this.taskListContainer)try{this.isTasksLoading=!0,this.updateLoadingState();let r=await this.plugin.filterService.getGroupedTasks(this.currentQuery);this.renderTaskItems(this.taskListContainer,r)}catch(r){let s=r instanceof Error?r.message:String(r);console.error("TaskListView: Error refreshing tasks:",{error:s,stack:r instanceof Error?r.stack:void 0,query:this.currentQuery,cacheInitialized:((t=this.plugin.cacheManager)==null?void 0:t.isInitialized())||!1}),this.taskListContainer.empty();let n=this.taskListContainer.createDiv({cls:"error-container"});n.createEl("p",{text:"Error loading tasks. Please try refreshing.",cls:"error-message"}),n.createEl("button",{text:"Retry",cls:"mod-cta"}).addEventListener("click",()=>{this.refreshTasks()})}finally{this.isTasksLoading=!1,this.updateLoadingState()}}renderTaskItems(t,r){if(Array.from(r.values()).reduce((n,a)=>n+a.length,0)===0){t.empty(),this.taskElements.clear(),t.createEl("p",{text:"No tasks found for the selected filters."});return}if(this.currentQuery.groupKey==="none"&&r.has("all")){let n=r.get("all")||[];this.renderTaskListWithReconciler(t,n)}else this.renderGroupedTasksWithReconciler(t,r)}renderTaskListWithReconciler(t,r){this.plugin.domReconciler.updateList(t,r,s=>s.path,s=>this.createTaskCardForReconciler(s),(s,n)=>this.updateTaskCardForReconciler(s,n)),this.taskElements.clear(),Array.from(t.children).forEach(s=>{let n=s.dataset.key;n&&this.taskElements.set(n,s)})}renderGroupedTasksWithReconciler(t,r){let s=t.scrollTop,n=new Map;Array.from(t.children).forEach(a=>{let o=a.dataset.group;o&&n.set(o,a)}),t.empty(),this.taskElements.clear(),r.forEach((a,o)=>{if(a.length===0)return;let l=t.createDiv({cls:"task-section task-group"});l.setAttribute("data-group",o),this.currentQuery.groupKey==="none"&&o==="all"||l.createEl("h3",{text:this.formatGroupName(o),cls:"task-group-header task-list-view__group-header"});let c=l.createDiv({cls:"tasks-container task-cards"});this.plugin.domReconciler.updateList(c,a,d=>d.path,d=>this.createTaskCardForReconciler(d),(d,u)=>this.updateTaskCardForReconciler(d,u)),Array.from(c.children).forEach(d=>{let u=d.dataset.key;u&&this.taskElements.set(u,d)})}),t.scrollTop=s}createTaskCardForReconciler(t){let r=gs(t,this.plugin,{showDueDate:!0,showCheckbox:!1,showArchiveButton:!0,showTimeTracking:!0,showRecurringControls:!0,groupByDate:!1});return r.dataset.key=t.path,this.addDragHandlers(r,t),r}updateTaskCardForReconciler(t,r){pr(t,r,this.plugin,{showDueDate:!0,showCheckbox:!1,showArchiveButton:!0,showTimeTracking:!0,showRecurringControls:!0,groupByDate:!1})}addDragHandlers(t,r){this.plugin.dragDropManager.makeTaskCardDraggable(t,r.path)}createSVGIcon(t,r,s,n){let a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("viewBox",t),a.setAttribute("width",r.toString()),a.setAttribute("height",s.toString());let o=document.createElementNS("http://www.w3.org/2000/svg","path");return o.setAttribute("fill","currentColor"),o.setAttribute("d",n),a.appendChild(o),a}formatGroupName(t){let r=this.plugin.priorityManager.getPriorityConfig(t);if(r)return`${r.label} priority`;let s=this.plugin.statusManager.getStatusConfig(t);if(s)return s.label;switch(t){case"all":return"All tasks";default:return t}}updateLoadingState(){this.loadingIndicator&&(this.isTasksLoading?this.loadingIndicator.removeClass("is-hidden"):this.loadingIndicator.addClass("is-hidden"))}openTask(t){let r=this.app.vault.getAbstractFileByPath(t);r instanceof Ic.TFile&&this.app.workspace.getLeaf(!1).openFile(r)}async waitForCacheReady(){if(!this.plugin.cacheManager.isInitialized())return new Promise(t=>{let r=this.plugin.cacheManager.subscribe("cache-initialized",()=>{r(),t()})})}};var tn=require("obsidian");Me();var kw=require("obsidian");_e();var Dw={showCreatedDate:!0,showTags:!0,showPath:!1,maxTags:3,showDailyNoteBadge:!0};function Pc(i,e,t={}){let r={...Dw,...t},s=document.createElement("div"),n=i.path.startsWith(e.settings.dailyNotesFolder),a=["note-card"];if(n&&a.push("note-card--daily-note"),a.push("note-card--compact","note-card--shadow-light"),s.className=a.join(" "),s.dataset.notePath=i.path,r.showDailyNoteBadge&&n){let c=s.createSpan({cls:"note-card__badge",text:"Daily",attr:{title:"Daily note"}})}let o=s.createDiv({cls:"note-card__content"}),l=o.createDiv({cls:"note-card__title",text:i.title});if(r.showTags&&i.tags&&i.tags.length>0){let c=o.createEl("div",{cls:"note-card__divider"}),u=i.tags.slice(0,r.maxTags).map(h=>`#${h}`).join(" ");i.tags.length>r.maxTags&&(u+=` +${i.tags.length-r.maxTags}`);let f=o.createEl("div",{cls:"note-card__tags-text",text:u})}if(r.showCreatedDate&&i.createdDate){let c=i.createdDate.indexOf("T")>0?Au(i.createdDate,"MMM d, yyyy h:mm a"):i.createdDate,d=o.createDiv({cls:"note-card__metadata",text:`Created: ${c}`,attr:{title:`Created: ${c}`}})}if(r.showPath){let c=o.createDiv({cls:"note-card__metadata",text:i.path,attr:{title:`Path: ${i.path}`}})}return s.addEventListener("click",()=>{let c=e.app.vault.getAbstractFileByPath(i.path);c instanceof kw.TFile&&e.app.workspace.getLeaf(!1).openFile(c)}),s.addEventListener("mouseover",c=>{e.app.vault.getAbstractFileByPath(i.path)&&e.app.workspace.trigger("hover-link",{event:c,source:"tasknotes-note-card",hoverParent:s,targetEl:s,linktext:i.path,sourcePath:i.path})}),s}function Sw(i,e,t,r={}){let s={...Dw,...r},n=e.path.startsWith(t.settings.dailyNotesFolder),a=["note-card"];n&&a.push("note-card--daily-note"),a.push("note-card--compact","note-card--shadow-light"),i.className=a.join(" ");let o=i.querySelector(".note-card__title");o&&(o.textContent=e.title);let l=i.querySelector(".note-card__metadata");if(l&&s.showCreatedDate&&e.createdDate){let u=e.createdDate.indexOf("T")>0?Au(e.createdDate,"MMM d, yyyy h:mm a"):e.createdDate;l.textContent=`Created: ${u}`}let c=i.querySelector(".note-card__metadata");c&&s.showPath&&(c.textContent=e.path);let d=i.querySelector(".note-card__tags-text");if(d&&s.showTags&&e.tags&&e.tags.length>0){let f=e.tags.slice(0,s.maxTags).map(h=>`#${h}`).join(" ");e.tags.length>s.maxTags&&(f+=` +${e.tags.length-s.maxTags}`),d.textContent=f}i.classList.add("note-card--updated"),setTimeout(()=>{i.classList.remove("note-card--updated")},1e3)}var Rc=class extends tn.ItemView{constructor(t,r){super(t);this.loadingIndicator=null;this.isNotesLoading=!1;this.listeners=[];this.plugin=r,this.registerEvents()}getViewType(){return Dn}getDisplayText(){return"Notes"}getIcon(){return"file-text"}registerEvents(){this.listeners.forEach(s=>s()),this.listeners=[];let t=this.plugin.emitter.on(Ur,()=>{this.refresh(!0)});this.listeners.push(t);let r=this.plugin.emitter.on(tt,()=>{this.refresh()});this.listeners.push(r)}async onOpen(){await this.plugin.onReady(),await this.refresh()}async onClose(){this.listeners.forEach(t=>t()),this.contentEl.empty()}async refresh(t=!1){let r=this.contentEl.querySelector(".notes-view"),s=0;if(r&&!t){let n=r.querySelector(".notes-view__list");n&&(s=n.scrollTop)}if(this.contentEl.empty(),await this.render(t),s>0){let n=this.contentEl.querySelector(".notes-view__list");n&&(n.scrollTop=s)}}async render(t=!1){let r=this.contentEl.createDiv({cls:"tasknotes-plugin notes-view"});this.createHeader(r),await this.createNotesContent(r,t)}createHeader(t){let r=t.createDiv({cls:"notes-view__header"}),s=k(this.plugin.selectedDate,"EEEE, MMMM d, yyyy"),n=r.createDiv();n.createEl("h2",{text:"Notes",cls:"notes-view__title"}),n.createEl("div",{text:s,cls:"notes-view__date"});let o=r.createDiv({cls:"notes-view__actions"}).createEl("button",{text:"Refresh",cls:"notes-view__refresh-button",attr:{"aria-label":"Refresh notes list",title:"Refresh notes list"}});o.addEventListener("click",async()=>{if(o.classList.contains("is-loading"))return;o.classList.add("is-loading"),o.disabled=!0;let l=o.textContent;o.textContent="Refreshing...";try{await this.refresh(!0)}finally{o.classList.remove("is-loading"),o.disabled=!1,o.textContent=l}})}async createNotesContent(t,r=!1){let s=t.createDiv({cls:"notes-view__list"});this.loadingIndicator=s.createDiv({cls:"notes-view__loading is-hidden"}),this.loadingIndicator.createSpan({text:"Loading notes..."}),this.isNotesLoading=!0,this.updateLoadingState();let n=await this.getNotesForView(r);if(this.isNotesLoading=!1,this.updateLoadingState(),n.length===0){let a=s.createDiv({cls:"notes-view__empty"}),o=a.createDiv({cls:"notes-view__empty-icon"});(0,tn.setIcon)(o,"file-text"),a.createEl("h3",{text:"No Notes Found",cls:"notes-view__empty-title"}),a.createEl("p",{text:"No notes found for the selected date. Try selecting a different date or create some notes.",cls:"notes-view__empty-description"})}else{let a=s.createDiv({cls:"notes-view__container"});this.renderNotesWithReconciler(a,n)}}renderNotesWithReconciler(t,r){this.plugin.domReconciler.updateList(t,r,s=>s.path,s=>this.createNoteCardForReconciler(s),(s,n)=>this.updateNoteCardForReconciler(s,n))}createNoteCardForReconciler(t){let r=Pc(t,this.plugin,{showCreatedDate:!0,showTags:!0,showPath:!1,maxTags:5,showDailyNoteBadge:!0});return r.dataset.key=t.path,r}updateNoteCardForReconciler(t,r){Sw(t,r,this.plugin,{showCreatedDate:!0,showTags:!0,showPath:!1,maxTags:5,showDailyNoteBadge:!0})}updateLoadingState(){var t,r;this.loadingIndicator&&(this.isNotesLoading?(t=this.loadingIndicator)==null||t.classList.remove("is-hidden"):(r=this.loadingIndicator)==null||r.classList.add("is-hidden"))}async getNotesForView(t=!1){try{return this.isNotesLoading=!0,this.updateLoadingState(),(await this.plugin.cacheManager.getNotesForDate(this.plugin.selectedDate,t)).sort((a,o)=>a.title.localeCompare(o.title))}finally{this.isNotesLoading=!1,this.updateLoadingState()}}openNote(t){let r=this.app.vault.getAbstractFileByPath(t);r instanceof tn.TFile&&this.app.workspace.getLeaf(!1).openFile(r)}};var Nc=require("obsidian");Me();en();rr();Me();_e();var Or=class extends fr{constructor(t,r,s){super();this.cacheManager=t,this.statusManager=r,this.priorityManager=s}async getGroupedTasks(t,r){let s=await this.getInitialTaskSet(t),n=await this.filterTasksByQuery(s,t),a=this.sortTasks(n,t.sortKey,t.sortDirection);return this.groupTasks(a,t.groupKey,r)}async getInitialTaskSet(t){if(t.statuses&&t.statuses.length===1){let r=this.cacheManager.getTaskPathsByStatus(t.statuses[0]);if(r.size>0)return r}else if(t.statuses&&t.statuses.length>1){let r=new Set;for(let s of t.statuses)this.cacheManager.getTaskPathsByStatus(s).forEach(a=>r.add(a));if(r.size>0)return r}if(t.priorities&&t.priorities.length===1){let r=this.cacheManager.getTaskPathsByPriority(t.priorities[0]);if(r.size>0)return r}if(t.dateRange){let r=await this.getTaskPathsInDateRange(t.dateRange.start,t.dateRange.end);if(t.includeOverdue){let s=this.getOverdueTaskPaths();return this.combineTaskPathSets([r,s])}return r}return this.cacheManager.getAllTaskPaths()}async getTaskPathsInDateRange(t,r){let s=new Set,n=new Date(t),a=new Date(r);for(let d=new Date(n);d<=a;d.setDate(d.getDate()+1)){let u=k(d,"yyyy-MM-dd");this.cacheManager.getTaskPathsByDate(u).forEach(h=>s.add(h))}let o=this.cacheManager.getAllTaskPaths(),l=50,c=Array.from(o);for(let d=0;d<c.length;d+=l){let u=c.slice(d,d+l),f=await Promise.all(u.map(h=>this.cacheManager.getCachedTaskInfo(h)));for(let h of f)if(h&&h.recurrence&&!h.due){for(let m=new Date(n);m<=a;m.setDate(m.getDate()+1))if(Os(h,m)){s.add(h.path);break}}}return s}getOverdueTaskPaths(){return this.cacheManager.getOverdueTaskPaths()}combineTaskPathSets(t){let r=new Set;return t.forEach(s=>{s.forEach(n=>r.add(n))}),r}async filterTasksByQuery(t,r){let s=[],a=Array.from(t);for(let o=0;o<a.length;o+=50){let l=a.slice(o,o+50),c=await Promise.all(l.map(d=>this.cacheManager.getCachedTaskInfo(d)));for(let d of c)d&&this.matchesQuery(d,r)&&s.push(d)}return s}isDateInRange(t,r,s){try{let n=ge(t),a=ge(r),o=ge(s),l=na(n),c=na(a),d=na(o);return l>=c&&l<=d}catch(n){return console.error("Error checking date range:",{dateString:t,startDateString:r,endDateString:s,error:n}),!1}}isSameDayAs(t,r){try{let s=new Date(t);s.setHours(0,0,0,0);let n=na(r);return s.getTime()===n.getTime()}catch(s){return console.error("Error comparing date object with date string:",{dateObj:t,dateString:r,error:s}),!1}}matchesQuery(t,r){var s;if(r.searchQuery){let n=r.searchQuery.toLowerCase(),a=t.title.toLowerCase().includes(n),o=((s=t.contexts)==null?void 0:s.some(l=>l.toLowerCase().includes(n)))||!1;if(!a&&!o)return!1}if(r.statuses&&r.statuses.length>0&&!r.statuses.includes(t.status)||r.priorities&&r.priorities.length>0&&!r.priorities.includes(t.priority)||r.contexts&&r.contexts.length>0&&(!t.contexts||!r.contexts.some(n=>t.contexts.includes(n)))||!r.showArchived&&t.archived)return!1;if(r.dateRange){if(t.recurrence&&!t.due){let n=new Date(r.dateRange.start),a=new Date(r.dateRange.end),o=!1;for(let l=new Date(n);l<=a;l.setDate(l.getDate()+1))if(Os(t,l)){o=!0;break}if(!o)return!1}else if(t.due||t.scheduled){let n=!1;if(t.due&&(r.includeOverdue&&kt(t.due)||this.isDateInRange(t.due,r.dateRange.start,r.dateRange.end))&&(n=!0),!n&&t.scheduled&&(r.includeOverdue&&kt(t.scheduled)||this.isDateInRange(t.scheduled,r.dateRange.start,r.dateRange.end))&&(n=!0),!n)return!1}}return!0}sortTasks(t,r,s){return t.sort((n,a)=>{let o=0;switch(r){case"due":o=this.compareDates(n.due,a.due);break;case"scheduled":o=this.compareDates(n.scheduled,a.scheduled);break;case"priority":o=this.comparePriorities(n.priority,a.priority);break;case"title":o=n.title.localeCompare(a.title);break}return s==="desc"?-o:o})}compareDates(t,r){if(!t&&!r)return 0;if(!t)return 1;if(!r)return-1;try{return Pu(t,r)?-1:Pu(r,t)?1:0}catch(s){return console.error("Error comparing dates time-aware:",{dateA:t,dateB:r,error:s}),t.localeCompare(r)}}comparePriorities(t,r){let s=this.priorityManager.getPriorityWeight(t);return this.priorityManager.getPriorityWeight(r)-s}groupTasks(t,r,s){if(r==="none")return new Map([["all",t]]);let n=new Map;for(let a of t){let o;switch(r){case"status":o=a.status||"unknown";break;case"priority":o=a.priority||"unknown";break;case"context":o=a.contexts&&a.contexts.length>0?a.contexts[0]:"none";break;case"due":o=this.getDueDateGroup(a,s);break;case"scheduled":o=this.getScheduledDateGroup(a,s);break;default:o="unknown"}n.has(o)||n.set(o,[]),n.get(o).push(a)}return this.sortGroups(n,r)}getDueDateGroup(t,r){let s=r||new Date;if(s.setHours(0,0,0,0),t.recurrence)if(Os(t,s)){let n=k(s,"yyyy-MM-dd");return this.getDateGroupFromDateString(n)}else return t.due?this.getDueDateGroupFromDate(t.due):"No due date";return t.due?this.getDueDateGroupFromDate(t.due):"No due date"}getDateGroupFromDateString(t){let r=Dr();if(kt(t))return"Overdue";let s=ge(t);if(ts(s,r))return"Today";try{let n=new Date;n.setDate(n.getDate()+1);let a=k(n,"yyyy-MM-dd");if(ts(s,a))return"Tomorrow";let o=new Date;o.setDate(o.getDate()+7);let l=k(o,"yyyy-MM-dd");return kr(s,l)||ts(s,l)?"This week":"Later"}catch(n){return console.error(`Error categorizing date ${t}:`,n),"Invalid Date"}}getDueDateGroupFromDate(t){return this.getDateGroupFromDateString(t)}getScheduledDateGroup(t,r){return t.scheduled?this.getScheduledDateGroupFromDate(t.scheduled):"No scheduled date"}getScheduledDateGroupFromDate(t){let r=Dr();if(kt(t))return"Past scheduled";let s=ge(t);if(ts(s,r))return"Today";try{let n=new Date;n.setDate(n.getDate()+1);let a=k(n,"yyyy-MM-dd");if(ts(s,a))return"Tomorrow";let o=new Date;o.setDate(o.getDate()+7);let l=k(o,"yyyy-MM-dd");return kr(s,l)||ts(s,l)?"This week":"Later"}catch(n){return console.error(`Error categorizing scheduled date ${t}:`,n),"Invalid Date"}}sortGroups(t,r){let s=new Map,n;switch(r){case"priority":n=Array.from(t.keys()).sort((l,c)=>{let d=this.priorityManager.getPriorityWeight(l);return this.priorityManager.getPriorityWeight(c)-d});break;case"status":n=Array.from(t.keys()).sort((l,c)=>{let d=this.statusManager.getStatusOrder(l),u=this.statusManager.getStatusOrder(c);return d-u});break;case"due":let a=["Overdue","Today","Tomorrow","This week","Later","No due date"];n=Array.from(t.keys()).sort((l,c)=>{let d=a.indexOf(l),u=a.indexOf(c);return d-u});break;case"scheduled":let o=["Past scheduled","Today","Tomorrow","This week","Later","No scheduled date"];n=Array.from(t.keys()).sort((l,c)=>{let d=o.indexOf(l),u=o.indexOf(c);return d-u});break;default:n=Array.from(t.keys()).sort()}for(let a of n)s.set(a,t.get(a));return s}async getFilterOptions(){return{statuses:this.cacheManager.getAllStatuses(),priorities:this.cacheManager.getAllPriorities(),contexts:await this.cacheManager.getAllContexts()}}createDefaultQuery(){return{searchQuery:void 0,statuses:void 0,contexts:void 0,priorities:void 0,dateRange:void 0,showArchived:!1,sortKey:"due",sortDirection:"asc",groupKey:"none"}}normalizeQuery(t){var s;let r=this.createDefaultQuery();return{searchQuery:t.searchQuery||r.searchQuery,statuses:t.statuses||r.statuses,contexts:t.contexts||r.contexts,priorities:t.priorities||r.priorities,dateRange:t.dateRange||r.dateRange,showArchived:(s=t.showArchived)!=null?s:r.showArchived,sortKey:t.sortKey||r.sortKey,sortDirection:t.sortDirection||r.sortDirection,groupKey:t.groupKey||r.groupKey}}initialize(){this.cacheManager.subscribe("file-updated",()=>{this.emit("data-changed")}),this.cacheManager.subscribe("file-added",()=>{this.emit("data-changed")}),this.cacheManager.subscribe("file-deleted",()=>{this.emit("data-changed")})}cleanup(){this.removeAllListeners()}static createDateRangeFromDates(t){if(t.length===0)throw new Error("No dates provided");let r=t[0],s=t[t.length-1];return{start:k(r,"yyyy-MM-dd"),end:k(s,"yyyy-MM-dd")}}static shouldIncludeOverdueForRange(t,r){if(!r)return!1;let s=new Date,n=k(s,"yyyy-MM-dd");return t.some(a=>k(a,"yyyy-MM-dd")===n)}async getTasksForDate(t,r,s=!1){let n=k(t,"yyyy-MM-dd"),a=rs(n);return(await this.filterTasksByQuery(await this.getInitialTaskSet(r),r)).filter(l=>l.recurrence?Os(l,t):!!(l.due&&ge(l.due)===n||l.scheduled&&ge(l.scheduled)===n||s&&a&&(l.due&&ge(l.due)!==n&&kt(l.due)||l.scheduled&&ge(l.scheduled)!==n&&kt(l.scheduled))))}async getAgendaData(t,r,s=!1){let n=Or.createDateRangeFromDates(t),a=Or.shouldIncludeOverdueForRange(t,s),o={...r,dateRange:n,includeOverdue:a},l=[];for(let c of t){let d=await this.getTasksForDate(c,o,s&&pi(c));l.push({date:new Date(c),tasks:d})}return l}async getFlatAgendaData(t,r,s=!1){let n=await this.getAgendaData(t,r,s),a=[];for(let o of n)for(let l of o.tasks)a.push({...l,agendaDate:o.date});return a}};var rn=class extends Nc.ItemView{constructor(t,r){super(t);this.daysToShow=7;this.groupByDate=!0;this.showOverdueOnToday=!1;this.showNotes=!0;this.filterBar=null;this.listeners=[];this.plugin=r,this.startDate=new Date(r.selectedDate),this.currentQuery={searchQuery:void 0,statuses:void 0,contexts:void 0,priorities:void 0,dateRange:this.getDateRange(),showArchived:!1,sortKey:"scheduled",sortDirection:"asc",groupKey:"none"},this.registerEvents()}registerEvents(){this.listeners.forEach(a=>a()),this.listeners=[];let t=this.plugin.emitter.on(tt,()=>{this.refresh()});this.listeners.push(t);let r=this.plugin.emitter.on(Ur,a=>{this.startDate=new Date(a),this.updatePeriodDisplay(),this.refresh()});this.listeners.push(r);let s=this.plugin.emitter.on(Ae,({path:a,originalTask:o,updatedTask:l})=>{this.refresh()});this.listeners.push(s);let n=this.plugin.filterService.on("data-changed",()=>{this.refresh()});this.listeners.push(n)}getViewType(){return Ms}getDisplayText(){return"Agenda"}getIcon(){return"calendar-clock"}async onOpen(){await this.plugin.onReady();let t=this.plugin.viewStateManager.getFilterState(Ms);t&&(this.currentQuery={...t,dateRange:this.getDateRange()});let r=this.contentEl;r.empty();let s=r.createDiv({cls:"tasknotes-plugin agenda-view"});this.showLoadingIndicator(),await this.renderView(s),this.hideLoadingIndicator(),this.registerKeyboardNavigation()}async onClose(){this.listeners.forEach(t=>t()),this.filterBar&&(this.filterBar.destroy(),this.filterBar=null),this.contentEl.empty()}async renderView(t){t.empty(),await this.createAgendaControls(t),await this.renderAgendaContent(t)}async createAgendaControls(t){let r=t.createDiv({cls:"agenda-view__controls"}),n=r.createDiv({cls:"agenda-view__header"}).createDiv({cls:"agenda-view__header-content"}),a=n.createEl("button",{cls:"agenda-view__nav-button agenda-view__nav-button--prev",text:"\u2039",attr:{"aria-label":"Previous period",title:"Previous period (Left arrow)"}}),o=n.createDiv({cls:"agenda-view__period-title",text:this.getCurrentPeriodText()}),l=n.createEl("button",{cls:"agenda-view__nav-button agenda-view__nav-button--next",text:"\u203A",attr:{"aria-label":"Next period",title:"Next period (Right arrow)"}});a.addEventListener("click",()=>{this.navigateToPreviousPeriod()}),l.addEventListener("click",()=>{this.navigateToNextPeriod()});let c=r.createDiv({cls:"agenda-view__filter-container"});await this.waitForCacheReady();let d=await this.plugin.filterService.getFilterOptions();this.filterBar=new hr(c,this.currentQuery,d,{showSearch:!0,showGroupBy:!1,showSortBy:!0,showAdvancedFilters:!0,allowedSortKeys:["due","scheduled","priority","title"],allowedGroupKeys:["none"]}),await this.filterBar.initialize(),this.filterBar.setupCacheRefresh(this.plugin.cacheManager,this.plugin.filterService),this.filterBar.on("queryChange",async S=>{this.currentQuery=S;let D={...S,dateRange:this.getDateRange()};await this.plugin.viewStateManager.setFilterState(Ms,D),this.refresh()});let u=r.createDiv({cls:"agenda-view__settings"}),f=u.createDiv({cls:"agenda-view__settings-left"}),h=f.createEl("select",{cls:"agenda-view__period-select"});[{value:"7",text:"7 days"},{value:"14",text:"14 days"},{value:"30",text:"30 days"},{value:"week",text:"This week"}].forEach(S=>{let D=h.createEl("option",{value:S.value,text:S.text});(S.value==="7"&&this.daysToShow===7||S.value==="week"&&this.daysToShow===-1)&&(D.selected=!0)}),h.addEventListener("change",()=>{let S=h.value;S==="week"?this.daysToShow=-1:this.daysToShow=parseInt(S),this.currentQuery.dateRange=this.getDateRange(),this.refresh()}),f.createEl("button",{text:"Today",cls:"agenda-view__today-button"}).addEventListener("click",()=>{this.startDate=new Date,this.refresh()});let g=u.createDiv({cls:"agenda-view__settings-right"}),v=g.createEl("label",{cls:"agenda-view__toggle"}),w=v.createEl("input",{type:"checkbox",cls:"agenda-view__toggle-checkbox"});w.checked=this.showOverdueOnToday,v.createSpan({text:"Overdue on today"}),w.addEventListener("change",()=>{this.showOverdueOnToday=w.checked,this.refresh()});let _=g.createEl("label",{cls:"agenda-view__toggle"}),E=_.createEl("input",{type:"checkbox",cls:"agenda-view__toggle-checkbox"});E.checked=this.showNotes,_.createSpan({text:"Show notes"}),E.addEventListener("change",()=>{this.showNotes=E.checked,this.refresh()})}getDateRange(){let t=this.getAgendaDates();return Or.createDateRangeFromDates(t)}async addNotesToAgendaData(t){if(!this.showNotes)return t.map(s=>({...s,notes:[]}));let r=t.map(async s=>{let n=await this.plugin.cacheManager.getNotesForDate(s.date);return{...s,notes:n}});return Promise.all(r)}async renderAgendaContent(t){let r=t.querySelector(".agenda-view__content");r||(r=t.createDiv({cls:"agenda-view__content"}));try{let s=this.getAgendaDates(),n=await this.plugin.filterService.getAgendaData(s,{searchQuery:this.currentQuery.searchQuery,statuses:this.currentQuery.statuses,contexts:this.currentQuery.contexts,priorities:this.currentQuery.priorities,showArchived:this.currentQuery.showArchived,sortKey:this.currentQuery.sortKey,sortDirection:this.currentQuery.sortDirection,groupKey:this.currentQuery.groupKey},this.showOverdueOnToday),a=await this.addNotesToAgendaData(n);this.groupByDate?this.renderGroupedAgendaWithReconciler(r,a):this.renderFlatAgendaWithReconciler(r,a)}catch(s){console.error("Error rendering agenda content:",s),r.empty(),r.createDiv({cls:"agenda-view__error"}).createSpan({text:"Error loading agenda. Please try refreshing."})}}renderGroupedAgendaWithReconciler(t,r){let s=[],n=!1;if(r.forEach(a=>{let o=k(a.date,"yyyy-MM-dd");if(a.tasks.length>0||a.notes.length>0){n=!0;let c=o;s.push({type:"day-header",item:a,date:a.date,dayKey:c}),a.tasks.forEach(d=>{s.push({type:"task",item:d,date:a.date,dayKey:c})}),a.notes.forEach(d=>{s.push({type:"note",item:d,date:a.date,dayKey:c})})}}),!n){t.empty();let a=t.createDiv({cls:"agenda-view__empty"});a.createEl("h3",{text:"No items scheduled",cls:"agenda-view__empty-title"}),a.createEl("p",{text:"No items scheduled for this period.",cls:"agenda-view__empty-description"});let o=a.createEl("p",{cls:"agenda-view__empty-tip"});o.createEl("span",{text:"Tip: "}),o.appendChild(document.createTextNode("Create tasks with due or scheduled dates, or add notes to see them here."));return}this.plugin.domReconciler.updateList(t,s,a=>`${a.type}-${a.dayKey}-${a.type==="day-header"?a.dayKey:a.item.path||a.item.id||"unknown"}`,a=>this.createAgendaItemElement(a),(a,o)=>this.updateAgendaItemElement(a,o))}renderFlatAgendaWithReconciler(t,r){let s=[];if(r.forEach(n=>{n.tasks.forEach(a=>{s.push({type:"task",item:a,date:n.date})}),n.notes.forEach(a=>{s.push({type:"note",item:a,date:n.date})})}),s.length===0){t.empty();let n=t.createDiv({cls:"agenda-view__empty"});n.createEl("h3",{text:"No items found",cls:"agenda-view__empty-title"}),n.createEl("p",{text:"No items found for the selected period.",cls:"agenda-view__empty-description"});return}s.sort((n,a)=>n.date.getTime()-a.date.getTime()),this.plugin.domReconciler.updateList(t,s,n=>`${n.type}-${n.item.path||n.item.id||"unknown"}`,n=>this.createFlatAgendaItemElement(n),(n,a)=>this.updateFlatAgendaItemElement(n,a))}createAgendaItemElement(t){if(t.type==="day-header"){let r=document.createElement("div");r.className="agenda-view__day-header";let s=r.createDiv({cls:"agenda-view__day-header-text"}),n=k(t.date,"EEEE"),a=k(t.date,"MMMM d");pi(t.date)?(s.createSpan({cls:"agenda-view__day-name agenda-view__day-name--today",text:"Today"}),s.createSpan({cls:"agenda-view__day-date",text:` \u2022 ${a}`})):(s.createSpan({cls:"agenda-view__day-name",text:n}),s.createSpan({cls:"agenda-view__day-date",text:` \u2022 ${a}`}));let o=t.item.tasks.length+t.item.notes.length;return r.createDiv({cls:"agenda-view__item-count",text:`${o}`}),r}else return t.type==="task"?this.createTaskItemElement(t.item,t.date):this.createNoteItemElement(t.item,t.date)}updateAgendaItemElement(t,r){if(r.type==="day-header"){let s=t.querySelector(".agenda-view__item-count");if(s){let n=r.item.tasks.length+r.item.notes.length;s.textContent=`${n}`}}else r.type==="task"&&pr(t,r.item,this.plugin,{showDueDate:!this.groupByDate,showCheckbox:!1,showTimeTracking:!0,showRecurringControls:!0,groupByDate:this.groupByDate,targetDate:r.date})}createFlatAgendaItemElement(t){return t.type==="task"?this.createTaskItemElement(t.item,t.date):this.createNoteItemElement(t.item,t.date)}updateFlatAgendaItemElement(t,r){r.type==="task"&&pr(t,r.item,this.plugin,{showDueDate:!this.groupByDate,showCheckbox:!1,showTimeTracking:!0,showRecurringControls:!0,groupByDate:this.groupByDate,targetDate:r.date})}createTaskItemElement(t,r){let s=gs(t,this.plugin,{showDueDate:!this.groupByDate,showCheckbox:!1,showTimeTracking:!0,showRecurringControls:!0,groupByDate:this.groupByDate,targetDate:r});return this.plugin.statusManager.isCompletedStatus(t.status)&&s.classList.add("done"),this.addDragHandlers(s,t),s}createNoteItemElement(t,r){let s=Pc(t,this.plugin,{showCreatedDate:!1,showTags:!0,showPath:!1,maxTags:3,showDailyNoteBadge:!1});if(!this.groupByDate&&r){let n=s.createSpan({cls:"agenda-view__note-date",text:k(r,"MMM d")})}return s}addDragHandlers(t,r){this.plugin.dragDropManager.makeTaskCardDraggable(t,r.path)}addHoverPreview(t,r){t.addEventListener("mouseover",s=>{this.app.vault.getAbstractFileByPath(r)&&this.app.workspace.trigger("hover-link",{event:s,source:"tasknotes-agenda",hoverParent:this,targetEl:t,linktext:r,sourcePath:r})})}openFile(t){let r=this.app.vault.getAbstractFileByPath(t);r instanceof Nc.TFile&&this.app.workspace.getLeaf(!1).openFile(r)}getAgendaDates(){let t=[];if(this.daysToShow===-1){let r=ai(this.startDate,{weekStartsOn:0}),s=oi(this.startDate,{weekStartsOn:0}),n=r;for(;n<=s;)t.push(new Date(n)),n=yt(n,1)}else for(let r=0;r<this.daysToShow;r++)t.push(yt(this.startDate,r));return t}navigateToPreviousPeriod(){this.daysToShow===-1?this.startDate=yt(this.startDate,-7):this.startDate=yt(this.startDate,-this.daysToShow),this.currentQuery.dateRange=this.getDateRange(),this.updatePeriodDisplay(),this.refresh()}navigateToNextPeriod(){this.daysToShow===-1?this.startDate=yt(this.startDate,7):this.startDate=yt(this.startDate,this.daysToShow),this.currentQuery.dateRange=this.getDateRange(),this.updatePeriodDisplay(),this.refresh()}updatePeriodDisplay(){let t=this.contentEl.querySelector(".agenda-view__period-title");t&&(t.textContent=this.getCurrentPeriodText())}getCurrentPeriodText(){let t=this.getAgendaDates();if(t.length===0)return"";let r=t[0],s=t[t.length-1];return gr(r,s)?k(r,"EEEE, MMMM d, yyyy"):`${k(r,"MMM d")} - ${k(s,"MMM d, yyyy")}`}showLoadingIndicator(){let t=this.contentEl.querySelector(".agenda-view");if(!t||t.querySelector(".agenda-view__loading"))return;let r=document.createElement("div");r.className="agenda-view__loading",r.textContent="Loading agenda...",t.prepend(r)}hideLoadingIndicator(){let t=this.contentEl.querySelector(".agenda-view__loading");t&&t.remove()}async refresh(){let t=this.contentEl.querySelector(".agenda-view");t&&await this.renderAgendaContent(t)}registerKeyboardNavigation(){this.registerDomEvent(document,"keydown",async t=>{if(this.isThisViewActive())switch(t.key){case"ArrowLeft":t.preventDefault(),this.navigateToPreviousPeriod();break;case"ArrowRight":t.preventDefault(),this.navigateToNextPeriod();break}})}isThisViewActive(){return this.app.workspace.getActiveViewOfType(rn)===this}async waitForCacheReady(){if(!this.plugin.cacheManager.isInitialized())return new Promise(t=>{let r=this.plugin.cacheManager.subscribe("cache-initialized",()=>{r(),t()})})}};var eo=require("obsidian");var Cw=require("obsidian");_e();var Oc=class extends Cw.FuzzySuggestModal{constructor(t,r,s){super(t);this.tasks=r,this.onChooseTask=s,this.setPlaceholder("Type to search for a task..."),this.setInstructions([{command:"\u2191\u2193",purpose:"to navigate"},{command:"\u21B5",purpose:"to select"},{command:"esc",purpose:"to dismiss"}]),this.titleEl.setText("Select Task"),this.titleEl.setAttribute("id","task-selector-title"),this.containerEl.setAttribute("aria-labelledby","task-selector-title"),this.containerEl.setAttribute("role","dialog"),this.containerEl.setAttribute("aria-modal","true")}getItems(){return this.tasks.filter(t=>t.status!=="done"&&!t.archived).sort((t,r)=>{var o,l;if(t.due&&!r.due)return-1;if(!t.due&&r.due)return 1;if(t.due&&r.due){let c=t.due.localeCompare(r.due);if(c!==0)return c}let s={high:0,normal:1,low:2},n=(o=s[t.priority])!=null?o:1,a=(l=s[r.priority])!=null?l:1;return n!==a?n-a:t.title.localeCompare(r.title)})}getItemText(t){let r=t.title;return t.due&&(r+=` ${t.due}`),t.priority!=="normal"&&(r+=` ${t.priority}`),t.contexts&&t.contexts.length>0&&(r+=` ${t.contexts.join(" ")}`),r}renderSuggestion(t,r){let s=t.item,n=r.createDiv({cls:"task-selector-modal__suggestion"}),a=n.createDiv({cls:"task-selector-modal__title"}),o=s.priority!=="normal"?`task-selector-modal__task-title--${s.priority}-priority`:"";a.createSpan({cls:`task-selector-modal__task-title ${o}`,text:s.title});let l=n.createDiv({cls:"task-selector-modal__meta"});if(s.due){let c=Ii(s.due),d=rs(s.due),u=s.due,f="task-selector-modal__due-date";c?(u=`Overdue (${s.due})`,f+=" task-selector-modal__due-date--overdue"):d&&(u="Due today",f+=" task-selector-modal__due-date--today"),l.createSpan({cls:f,text:u})}if(s.contexts&&s.contexts.length>0){let c=l.createSpan({cls:"task-selector-modal__contexts"});s.contexts.forEach((d,u)=>{u>0&&c.createSpan({text:", "}),c.createSpan({cls:"task-selector-modal__context-tag",text:d})})}s.status!=="open"&&l.createSpan({cls:"task-selector-modal__status",text:s.status})}onChooseItem(t,r){this.onChooseTask(t)}onClose(){super.onClose()}};var Lc=class extends eo.ItemView{constructor(t,r){super(t);this.timerDisplay=null;this.statusDisplay=null;this.progressCircle=null;this.progressContainer=null;this.startButton=null;this.pauseButton=null;this.stopButton=null;this.taskDisplay=null;this.statsDisplay=null;this.taskSelectButton=null;this.currentSelectedTask=null;this.statElements={pomodoros:null,streak:null,minutes:null};this.listeners=[];this.plugin=r,this.registerEvents()}getViewType(){return Sn}getDisplayText(){return"Pomodoro"}getIcon(){return"clock"}registerEvents(){this.listeners.forEach(a=>a()),this.listeners=[];let t=this.plugin.emitter.on(Do,({session:a,task:o})=>{this.updateDisplay(a,o)});this.listeners.push(t);let r=this.plugin.emitter.on(So,({session:a,nextType:o})=>{this.onPomodoroComplete(a,o)});this.listeners.push(r);let s=this.plugin.emitter.on(Co,({session:a})=>{this.updateDisplay()});this.listeners.push(s);let n=this.plugin.emitter.on($r,({timeRemaining:a,session:o})=>{this.updateTimer(a),this.updateDisplay(o)});this.listeners.push(n)}async onOpen(){await this.plugin.onReady(),await this.render()}async onClose(){this.listeners.forEach(t=>t()),this.timerDisplay=null,this.statusDisplay=null,this.progressCircle=null,this.progressContainer=null,this.startButton=null,this.pauseButton=null,this.stopButton=null,this.taskDisplay=null,this.statsDisplay=null,this.taskSelectButton=null,this.currentSelectedTask=null,this.statElements={pomodoros:null,streak:null,minutes:null},this.contentEl.empty()}async render(){let t=this.contentEl.createDiv({cls:"tasknotes-plugin pomodoro-view"}),r=t.createDiv({cls:"pomodoro-view__timer-section"});this.progressContainer=r.createDiv({cls:"pomodoro-view__progress-container"});let s=document.createElementNS("http://www.w3.org/2000/svg","svg");s.setAttribute("class","pomodoro-view__progress-svg"),s.setAttribute("width","240"),s.setAttribute("height","240"),s.setAttribute("viewBox","0 0 240 240"),this.progressContainer.appendChild(s);let n=document.createElementNS("http://www.w3.org/2000/svg","circle");n.setAttributeNS(null,"cx","120"),n.setAttributeNS(null,"cy","120"),n.setAttributeNS(null,"r","110"),n.setAttributeNS(null,"fill","none"),n.setAttributeNS(null,"stroke","var(--tn-border-color)"),n.setAttributeNS(null,"stroke-width","4"),s.appendChild(n),this.progressCircle=document.createElementNS("http://www.w3.org/2000/svg","circle"),this.progressCircle.setAttributeNS(null,"cx","120"),this.progressCircle.setAttributeNS(null,"cy","120"),this.progressCircle.setAttributeNS(null,"r","110"),this.progressCircle.setAttributeNS(null,"fill","none"),this.progressCircle.setAttributeNS(null,"stroke","var(--tn-interactive-accent)"),this.progressCircle.setAttributeNS(null,"stroke-width","6"),this.progressCircle.setAttributeNS(null,"stroke-linecap","round");let a=110,o=2*Math.PI*a;this.progressCircle.setAttributeNS(null,"stroke-dasharray",o.toString()),this.progressCircle.setAttributeNS(null,"stroke-dashoffset",o.toString()),this.progressCircle.addClass("pomodoro-view__progress-circle"),s.appendChild(this.progressCircle);let l=this.progressContainer.createDiv({cls:"pomodoro-view__timer-overlay"});this.timerDisplay=l.createDiv({cls:"pomodoro-view__timer-display",text:"25:00"}),this.statusDisplay=r.createDiv({cls:"pomodoro-view__status",text:"Ready to start"}),this.taskDisplay=t.createDiv({cls:"pomodoro-view__task-display"});let c=t.createDiv({cls:"pomodoro-view__task-selector"});c.createEl("label",{cls:"pomodoro-view__task-selector-label",text:"Select task (optional):"});let d=c.createDiv({cls:"pomodoro-view__task-selector-container"});this.taskSelectButton=d.createEl("button",{cls:"pomodoro-view__task-select-button",text:"Choose task..."}),this.registerDomEvent(this.taskSelectButton,"click",async()=>{await this.openTaskSelector()});let u=d.createEl("button",{cls:"pomodoro-view__task-clear-button",text:"Clear"});this.registerDomEvent(u,"click",async()=>{await this.selectTask(null)}),this.restoreLastSelectedTask();let f=t.createDiv({cls:"pomodoro-view__control-section"}),h=f.createDiv({cls:"pomodoro-view__primary-controls"});this.startButton=h.createEl("button",{text:"Start",cls:"pomodoro-view__start-button"}),this.pauseButton=h.createEl("button",{text:"Pause",cls:"pomodoro-view__pause-button"}),this.pauseButton.addClass("pomodoro-view__pause-button--hidden"),this.stopButton=h.createEl("button",{text:"Stop",cls:"pomodoro-view__stop-button"}),this.stopButton.addClass("pomodoro-view__stop-button--hidden");let m=f.createDiv({cls:"pomodoro-view__quick-start-section"}),p=m.createDiv({cls:"pomodoro-view__section-label",text:"Quick start"}),g=m.createDiv({cls:"pomodoro-view__quick-actions"}),v=g.createEl("button",{text:"Work session",cls:"pomodoro-view__quick-button pomodoro-view__work-button"}),w=g.createEl("button",{text:"Short break",cls:"pomodoro-view__quick-button pomodoro-view__short-break-button"}),_=g.createEl("button",{text:"Long break",cls:"pomodoro-view__quick-button pomodoro-view__long-break-button"}),E=t.createDiv({cls:"pomodoro-view__stats-section"}),S=E.createDiv({cls:"pomodoro-view__stats-header"});S.createEl("h3",{text:"Today's progress",cls:"pomodoro-view__stats-title"});let D=S.createEl("button",{cls:"pomodoro-view__view-stats-button",text:"View all stats"});this.registerDomEvent(D,"click",async()=>{await this.plugin.activatePomodoroStatsView()}),this.statsDisplay=E.createDiv({cls:"pomodoro-view__stats"});let A=this.statsDisplay.createDiv({cls:"pomodoro-view__stat"});this.statElements.pomodoros=A.createSpan({cls:"pomodoro-view__stat-value",text:"0"}),A.createSpan({cls:"pomodoro-view__stat-label",text:"Pomodoros completed"});let C=this.statsDisplay.createDiv({cls:"pomodoro-view__stat"});this.statElements.streak=C.createSpan({cls:"pomodoro-view__stat-value",text:"0"}),C.createSpan({cls:"pomodoro-view__stat-label",text:"Current streak"});let B=this.statsDisplay.createDiv({cls:"pomodoro-view__stat"});this.statElements.minutes=B.createSpan({cls:"pomodoro-view__stat-value",text:"0"}),B.createSpan({cls:"pomodoro-view__stat-label",text:"Minutes focused"}),this.registerDomEvent(this.startButton,"click",async()=>{if(!this.startButton.hasClass("is-loading")){this.startButton.addClass("pomodoro-view__start-button--loading");try{let K=this.plugin.pomodoroService.getState();K.currentSession&&!K.isRunning?await this.plugin.pomodoroService.resumePomodoro():await this.plugin.pomodoroService.startPomodoro(this.currentSelectedTask||void 0)}finally{this.startButton.removeClass("pomodoro-view__start-button--loading")}}}),this.registerDomEvent(this.pauseButton,"click",()=>{this.plugin.pomodoroService.pausePomodoro()}),this.registerDomEvent(this.stopButton,"click",()=>{this.plugin.pomodoroService.stopPomodoro()}),this.registerDomEvent(v,"click",async()=>{await this.plugin.pomodoroService.startPomodoro(this.currentSelectedTask||void 0)}),this.registerDomEvent(w,"click",()=>{this.plugin.pomodoroService.startBreak(!1)}),this.registerDomEvent(_,"click",()=>{this.plugin.pomodoroService.startBreak(!0)}),this.updateDisplay(),this.updateStats().catch(K=>{console.error("Failed to update initial stats:",K)});let $=this.plugin.pomodoroService.getState();this.updateTimer($.timeRemaining)}async openTaskSelector(){try{let t=new Date,r=[];for(let a=0;a<7;a++){let o=new Date(t);o.setDate(t.getDate()+a);try{let l=await this.plugin.cacheManager.getTaskInfoForDate(o);r.push(...l)}catch(l){}}let s=r.filter((a,o,l)=>l.findIndex(c=>c.path===a.path)===o);if(s.length===0){new eo.Notice("No tasks found. Create some tasks first.");return}new Oc(this.app,s,a=>{this.selectTask(a)}).open()}catch(t){console.error("Error opening task selector:",t),new eo.Notice("Failed to load tasks")}}async selectTask(t){if(this.currentSelectedTask=t,this.taskSelectButton)if(t){let s=t.title.length>30?t.title.substring(0,27)+"...":t.title;this.taskSelectButton.textContent=s,this.taskSelectButton.title=t.title,this.taskSelectButton.removeClass("pomodoro-view__task-select-button--no-task")}else this.taskSelectButton.textContent="Choose task...",this.taskSelectButton.title="",this.taskSelectButton.addClass("pomodoro-view__task-select-button--no-task");await this.plugin.pomodoroService.saveLastSelectedTask(t==null?void 0:t.path);let r=this.plugin.pomodoroService.getState();r.currentSession&&r.currentSession.type==="work"&&await this.plugin.pomodoroService.assignTaskToCurrentSession(t||void 0)}async restoreLastSelectedTask(){try{let t=await this.plugin.pomodoroService.getLastSelectedTaskPath();if(t){let r=await this.plugin.cacheManager.getTaskByPath(t);r&&!this.plugin.statusManager.isCompletedStatus(r.status)&&!r.archived&&await this.selectTask(r)}}catch(t){console.error("Error restoring last selected task:",t)}}async updateTaskButtonFromPath(t){try{let r=await this.plugin.cacheManager.getTaskInfo(t);if(r){if(this.currentSelectedTask=r,this.taskSelectButton){let s=r.title.length>30?r.title.substring(0,27)+"...":r.title;this.taskSelectButton.textContent=s,this.taskSelectButton.title=r.title,this.taskSelectButton.removeClass("pomodoro-no-task"),this.taskSelectButton.removeClass("pomodoro-view__task-select-button--no-task")}return}this.currentSelectedTask=null,this.taskSelectButton&&(this.taskSelectButton.textContent="Select Task",this.taskSelectButton.title="",this.taskSelectButton.addClass("pomodoro-view__task-select-button--no-task"))}catch(r){console.error("Error updating task button from path:",r)}}updateDisplay(t,r){var n,a,o,l;let s=this.plugin.pomodoroService.getState();if(this.updateTimer(s.timeRemaining),this.updateProgress(s),this.statusDisplay)if(s.isRunning&&s.currentSession){let c=s.currentSession.type==="work"?"Working":s.currentSession.type==="short-break"?"Short break":"Long break";this.statusDisplay.textContent=c,this.statusDisplay.className=`pomodoro-status pomodoro-view__status pomodoro-status-${s.currentSession.type} pomodoro-view__status--${s.currentSession.type}`}else s.currentSession&&!s.isRunning?(this.statusDisplay.textContent="Paused",this.statusDisplay.className="pomodoro-status pomodoro-view__status pomodoro-status-paused pomodoro-view__status--paused"):(this.statusDisplay.textContent="Ready to start",this.statusDisplay.className="pomodoro-status pomodoro-view__status");if(this.taskDisplay){let c=(n=s.currentSession)==null?void 0:n.taskPath,d=this.taskDisplay.dataset.currentTaskPath;if(c!==d){if(this.taskDisplay.empty(),this.taskDisplay.dataset.currentTaskPath=c||"",t!=null&&t.taskPath&&r){let u=this.taskDisplay.createDiv({cls:"pomodoro-view__current-task"});u.createSpan({cls:"pomodoro-view__task-label",text:"Working on:"}),u.createSpan({cls:"pomodoro-view__task-title",text:r.title})}else if((a=s.currentSession)!=null&&a.taskPath){let u=s.currentSession.taskPath,f=this.taskDisplay.createDiv({cls:"pomodoro-view__current-task"});f.createSpan({cls:"pomodoro-view__task-label",text:"Working on:"}),f.createSpan({cls:"pomodoro-view__task-title",text:((o=u.split("/").pop())==null?void 0:o.replace(".md",""))||""})}}}this.taskSelectButton&&(l=s.currentSession)!=null&&l.taskPath&&!this.currentSelectedTask&&this.updateTaskButtonFromPath(s.currentSession.taskPath),this.startButton&&this.pauseButton&&this.stopButton&&(s.isRunning?(this.startButton.addClass("pomodoro-view__start-button--hidden"),this.pauseButton.removeClass("pomodoro-view__pause-button--hidden"),this.stopButton.removeClass("pomodoro-view__stop-button--hidden")):s.currentSession?(this.startButton.removeClass("pomodoro-view__start-button--hidden"),this.startButton.textContent="Resume",this.pauseButton.addClass("pomodoro-view__pause-button--hidden"),this.stopButton.removeClass("pomodoro-view__stop-button--hidden")):(this.startButton.removeClass("pomodoro-view__start-button--hidden"),this.startButton.textContent="Start",this.pauseButton.addClass("pomodoro-view__pause-button--hidden"),this.stopButton.addClass("pomodoro-view__stop-button--hidden"))),this.updateStats().catch(c=>{console.error("Failed to update stats:",c)})}updateTimer(t){if(this.timerDisplay){let r=Math.max(0,Math.floor(t)),s=Math.floor(r/60),n=r%60;this.timerDisplay.textContent=`${s.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`,r<=60&&r>0?this.timerDisplay.addClass("pomodoro-view__timer-display--warning"):this.timerDisplay.removeClass("pomodoro-view__timer-display--warning")}}updateProgress(t){if(!this.progressCircle||!t.currentSession){if(this.progressCircle){let d=2*Math.PI*110;this.progressCircle.setAttributeNS(null,"stroke-dashoffset",d.toString()),this.progressCircle.removeClass("pomodoro-view__progress-circle--work"),this.progressCircle.removeClass("pomodoro-view__progress-circle--short-break"),this.progressCircle.removeClass("pomodoro-view__progress-circle--long-break")}return}let r=t.currentSession.duration*60,s=r-t.timeRemaining,n=Math.max(0,Math.min(1,s/r)),a=110,o=2*Math.PI*a,l=o-n*o;this.progressCircle.setAttributeNS(null,"stroke-dashoffset",l.toString()),this.progressCircle.removeClass("pomodoro-view__progress-circle--work"),this.progressCircle.removeClass("pomodoro-view__progress-circle--short-break"),this.progressCircle.removeClass("pomodoro-view__progress-circle--long-break"),this.progressCircle.addClass(`pomodoro-view__progress-circle--${t.currentSession.type}`),t.timeRemaining<=60&&t.timeRemaining>0?this.progressCircle.addClass("pomodoro-view__progress-circle--warning"):this.progressCircle.removeClass("pomodoro-view__progress-circle--warning")}async updateStats(){try{let t=await this.plugin.pomodoroService.getTodayStats();this.statElements.pomodoros&&this.statElements.pomodoros.textContent!==t.pomodorosCompleted.toString()&&(this.statElements.pomodoros.textContent=t.pomodorosCompleted.toString()),this.statElements.streak&&this.statElements.streak.textContent!==t.currentStreak.toString()&&(this.statElements.streak.textContent=t.currentStreak.toString()),this.statElements.minutes&&this.statElements.minutes.textContent!==t.totalMinutes.toString()&&(this.statElements.minutes.textContent=t.totalMinutes.toString())}catch(t){console.error("Failed to update stats:",t),this.statElements.pomodoros&&(this.statElements.pomodoros.textContent="0"),this.statElements.streak&&(this.statElements.streak.textContent="0"),this.statElements.minutes&&(this.statElements.minutes.textContent="0")}}onPomodoroComplete(t,r){if(this.updateDisplay(),this.statusDisplay)if(t.type==="work"){let s=r==="long-break";this.statusDisplay.textContent=`Great work! Time for a ${s?"long":"short"} break`}else this.statusDisplay.textContent="Break complete! Ready for the next pomodoro?"}};var _w=require("obsidian");Me();_e();var Jh="2.2.0",Xh="pomodoroMigrationVersion";function ep(i){return i[Xh]?i[Xh]!==Jh:!0}function U_(i){if(i.activePeriods&&i.plannedDuration!==void 0)return i;let e=i,t=[];return e.endTime?t.push({startTime:e.startTime,endTime:e.endTime}):t.push({startTime:e.startTime}),{id:e.id,taskPath:e.taskPath,startTime:e.startTime,endTime:e.endTime,plannedDuration:e.duration,type:e.type,completed:e.completed,interrupted:e.interrupted,activePeriods:t}}function $_(i){if(i.activePeriods)return i;let e=i,t=[{startTime:e.startTime,endTime:e.endTime}];return{id:e.id,startTime:e.startTime,endTime:e.endTime,plannedDuration:e.plannedDuration,type:e.type,taskPath:e.taskPath,completed:e.completed,activePeriods:t}}function tp(i){var t;let e={...i};return(t=e.pomodoroState)!=null&&t.currentSession&&(e.pomodoroState.currentSession=U_(e.pomodoroState.currentSession)),e.pomodoroHistory&&Array.isArray(e.pomodoroHistory)&&(e.pomodoroHistory=e.pomodoroHistory.map(r=>$_(r))),e[Xh]=Jh,e}function to(i){if(i.activePeriods&&Array.isArray(i.activePeriods))return i.activePeriods.filter(e=>e.endTime).reduce((e,t)=>{let r=new Date(t.startTime),n=new Date(t.endTime).getTime()-r.getTime();return e+Math.round(n/(1e3*60))},0);if(i.duration!==void 0)return i.duration;if(i.startTime&&i.endTime){let e=new Date(i.startTime),r=new Date(i.endTime).getTime()-e.getTime();return Math.round(r/(1e3*60))}return 0}function rp(i,e){var n,a,o;let t=((n=i.pomodoroState)==null?void 0:n.currentSession)&&!i.pomodoroState.currentSession.activePeriods,r=((a=i.pomodoroHistory)==null?void 0:a.length)||0,s=r>0&&!((o=i.pomodoroHistory[0])!=null&&o.activePeriods);console.log("[PomodoroMigration] Migration completed:",{version:Jh,currentSessionMigrated:t,historySessionsMigrated:s?r:0,totalDataSizeBefore:JSON.stringify(i).length,totalDataSizeAfter:JSON.stringify(e).length})}var Fc=class extends _w.ItemView{constructor(t,r){super(t);this.todayStatsEl=null;this.weekStatsEl=null;this.recentSessionsEl=null;this.overallStatsEl=null;this.plugin=r}getViewType(){return Cn}getDisplayText(){return"Pomodoro stats"}getIcon(){return"bar-chart"}calculateActualDuration(t){return t.filter(r=>r.endTime).reduce((r,s)=>{let n=new Date(s.startTime),o=new Date(s.endTime).getTime()-n.getTime();return r+Math.round(o/(1e3*60))},0)}async onOpen(){await this.plugin.onReady(),await this.render()}async onClose(){this.contentEl.empty()}async render(){let t=this.contentEl.createDiv({cls:"tasknotes-plugin tasknotes-container pomodoro-stats-container pomodoro-stats-view"}),r=t.createDiv({cls:"pomodoro-stats-header pomodoro-stats-view__header"});r.createEl("h2",{text:"Pomodoro statistics",cls:"pomodoro-stats-view__title"});let s=r.createEl("button",{cls:"pomodoro-stats-refresh-button pomodoro-stats-view__refresh-button",text:"Refresh"});this.registerDomEvent(s,"click",()=>{this.refreshStats()});let n=t.createDiv({cls:"pomodoro-stats-section pomodoro-stats-view__section"});n.createEl("h3",{text:"Today",cls:"pomodoro-stats-view__section-title"}),this.todayStatsEl=n.createDiv({cls:"pomodoro-stats-grid pomodoro-stats-view__stats-grid"});let a=t.createDiv({cls:"pomodoro-stats-section pomodoro-stats-view__section"});a.createEl("h3",{text:"This week",cls:"pomodoro-stats-view__section-title"}),this.weekStatsEl=a.createDiv({cls:"pomodoro-stats-grid pomodoro-stats-view__stats-grid"});let o=t.createDiv({cls:"pomodoro-stats-section pomodoro-stats-view__section"});o.createEl("h3",{text:"All time",cls:"pomodoro-stats-view__section-title"}),this.overallStatsEl=o.createDiv({cls:"pomodoro-stats-grid pomodoro-stats-view__stats-grid"});let l=t.createDiv({cls:"pomodoro-stats-section pomodoro-stats-view__section"});l.createEl("h3",{text:"Recent sessions",cls:"pomodoro-stats-view__section-title"}),this.recentSessionsEl=l.createDiv({cls:"pomodoro-recent-sessions pomodoro-stats-view__recent-sessions"}),await this.refreshStats()}async refreshStats(){try{await Promise.all([this.updateTodayStats(),this.updateWeekStats(),this.updateOverallStats(),this.updateRecentSessions()])}catch(t){console.error("Failed to refresh stats:",t)}}async updateTodayStats(){if(!this.todayStatsEl)return;let t=await this.plugin.pomodoroService.getTodayStats();this.renderStatsGrid(this.todayStatsEl,t)}async updateWeekStats(){if(!this.weekStatsEl)return;let t=new Date,r=ai(t,{weekStartsOn:1}),s=oi(t,{weekStartsOn:1}),n=await this.calculateStatsForRange(r,s);this.renderStatsGrid(this.weekStatsEl,n)}async updateOverallStats(){if(!this.overallStatsEl)return;let t=await this.plugin.pomodoroService.getSessionHistory(),r=this.calculateOverallStats(t);this.renderStatsGrid(this.overallStatsEl,r)}async updateRecentSessions(){var s;if(!this.recentSessionsEl)return;let r=(await this.plugin.pomodoroService.getSessionHistory()).filter(n=>n.type==="work").slice(-10).reverse();if(this.recentSessionsEl.empty(),r.length===0){this.recentSessionsEl.createDiv({cls:"pomodoro-no-sessions pomodoro-stats-view__no-sessions",text:"No sessions recorded yet"});return}for(let n of r){let a=this.recentSessionsEl.createDiv({cls:"pomodoro-session-item pomodoro-stats-view__session-item"}),o=a.createSpan({cls:"session-date pomodoro-stats-view__session-date"});o.textContent=k(new Date(n.startTime),"MMM d, HH:mm");let l=a.createSpan({cls:"session-duration pomodoro-stats-view__session-duration"}),c=to(n);l.textContent=`${c}min`;let d=a.createSpan({cls:"session-status pomodoro-stats-view__session-status"});if(d.textContent=n.completed?"Completed":"Interrupted",d.addClass(n.completed?"status-completed":"status-interrupted"),d.addClass(n.completed?"pomodoro-stats-view__session-status--completed":"pomodoro-stats-view__session-status--interrupted"),n.taskPath){let u=a.createSpan({cls:"session-task pomodoro-stats-view__session-task"}),f=((s=n.taskPath.split("/").pop())==null?void 0:s.replace(".md",""))||"";u.textContent=f}}}renderStatsGrid(t,r){t.empty();let s=t.createDiv({cls:"pomodoro-stat-card pomodoro-stats-view__stat-card"});s.createDiv({cls:"stat-value pomodoro-stats-view__stat-value",text:r.pomodorosCompleted.toString()}),s.createDiv({cls:"stat-label pomodoro-stats-view__stat-label",text:"Pomodoros"});let n=t.createDiv({cls:"pomodoro-stat-card pomodoro-stats-view__stat-card"});n.createDiv({cls:"stat-value pomodoro-stats-view__stat-value",text:r.currentStreak.toString()}),n.createDiv({cls:"stat-label pomodoro-stats-view__stat-label",text:"Streak"});let a=t.createDiv({cls:"pomodoro-stat-card pomodoro-stats-view__stat-card"});a.createDiv({cls:"stat-value pomodoro-stats-view__stat-value",text:r.totalMinutes.toString()}),a.createDiv({cls:"stat-label pomodoro-stats-view__stat-label",text:"Minutes"});let o=t.createDiv({cls:"pomodoro-stat-card pomodoro-stats-view__stat-card"});o.createDiv({cls:"stat-value pomodoro-stats-view__stat-value",text:r.averageSessionLength.toString()}),o.createDiv({cls:"stat-label pomodoro-stats-view__stat-label",text:"Avg Length"});let l=t.createDiv({cls:"pomodoro-stat-card pomodoro-stats-view__stat-card"});l.createDiv({cls:"stat-value pomodoro-stats-view__stat-value",text:`${r.completionRate}%`}),l.createDiv({cls:"stat-label pomodoro-stats-view__stat-label",text:"Completion"})}async calculateStatsForRange(t,r){let s=await this.plugin.pomodoroService.getSessionHistory(),n=Re(t),a=Re(r),o=s.filter(l=>{try{let c=ss(l.startTime),d=Re(c);return d>=n&&d<=a}catch(c){return console.error("Error parsing session timestamp for filtering:",{sessionStartTime:l.startTime,error:c}),!1}});return this.calculateStatsFromSessions(o)}calculateOverallStats(t){return this.calculateStatsFromSessions(t)}calculateStatsFromSessions(t){let r=t.filter(c=>c.type==="work"),s=r.filter(c=>c.completed),n=0;for(let c=r.length-1;c>=0&&r[c].completed;c--)n++;let a=s.reduce((c,d)=>c+to(d),0),o=s.length>0?a/s.length:0,l=r.length>0?s.length/r.length*100:0;return{pomodorosCompleted:s.length,currentStreak:n,totalMinutes:a,averageSessionLength:Math.round(o),completionRate:Math.round(l)}}};var sn=require("obsidian");en();var Hc=class extends sn.ItemView{constructor(t,r){super(t);this.boardContainer=null;this.filterBar=null;this.taskElements=new Map;this.previousGroupKey=null;this.listeners=[];this.columnOrder=[];this.refreshTimeout=null;this.plugin=r,this.currentQuery={searchQuery:void 0,statuses:void 0,contexts:void 0,priorities:void 0,dateRange:void 0,showArchived:!1,sortKey:"priority",sortDirection:"desc",groupKey:"status"},this.previousGroupKey=this.currentQuery.groupKey,this.registerEvents()}getViewType(){return As}getDisplayText(){return"Kanban"}getIcon(){return"layout-grid"}registerEvents(){this.listeners.forEach(n=>n()),this.listeners=[];let t=this.plugin.emitter.on(tt,()=>this.refresh());this.listeners.push(t);let r=this.plugin.emitter.on(Ae,({path:n,originalTask:a,updatedTask:o})=>{if(!n||!o)return;let l=this.taskElements.get(n);if(l)try{pr(l,o,this.plugin,{showDueDate:!0,showCheckbox:!1,showTimeTracking:!0}),l.classList.add("task-card--updated"),setTimeout(()=>{l.classList.remove("task-card--updated")},1e3)}catch(c){console.error("Error updating task card in kanban:",c),this.refresh()}else this.refresh()});this.listeners.push(r);let s=this.plugin.filterService.on("data-changed",()=>{this.refresh()});this.listeners.push(s)}async onOpen(){await this.plugin.onReady();let t=this.plugin.viewStateManager.getFilterState(As);t&&(this.currentQuery=t,this.previousGroupKey=this.currentQuery.groupKey),this.contentEl.empty(),await this.render()}async onClose(){this.listeners.forEach(t=>t()),this.refreshTimeout&&(clearTimeout(this.refreshTimeout),this.refreshTimeout=null),this.filterBar&&(this.filterBar.destroy(),this.filterBar=null),this.contentEl.empty()}async refresh(){this.boardContainer?await this.loadAndRenderBoard():await this.render()}async render(){let t=this.contentEl;t.empty(),t.addClass("tasknotes-plugin","kanban-view"),await this.renderHeader(t),this.boardContainer=t.createDiv({cls:"kanban-view__board-container"}),await this.loadAndRenderBoard()}async renderHeader(t){let r=t.createDiv({cls:"kanban-view__header"}),s=r.createDiv({cls:"kanban-view__filter-container"}),n=await this.plugin.filterService.getFilterOptions();this.filterBar=new hr(s,this.currentQuery,n,{showSearch:!0,showGroupBy:!0,showSortBy:!0,showAdvancedFilters:!0,showDateRangePicker:!0,allowedSortKeys:["priority","title","due","scheduled"],allowedGroupKeys:["status","priority","context"]}),this.filterBar.on("queryChange",async u=>{this.currentQuery=u,await this.plugin.viewStateManager.setFilterState(As,u),this.loadAndRenderBoard()});let a=r.createDiv({cls:"kanban-view__actions"});a.createDiv({cls:"kanban-view__actions-left"}).createEl("button",{cls:"kanban-view__new-task-button",text:"New task"}).addEventListener("click",()=>{this.plugin.openTaskCreationModal()});let d=a.createDiv({cls:"kanban-view__actions-right"}).createDiv({cls:"kanban-view__stats"});this.updateBoardStats(d)}updateBoardStats(t,r){if(t.empty(),!r||r.length===0)return;let s=r.length,n=r.filter(a=>this.plugin.statusManager.isCompletedStatus(a.status)).length;if(s>0){let a=Math.round(n/s*100);t.createSpan({text:`${s} tasks \u2022 ${a}% complete`,cls:"kanban-view__stats-simple"})}}async loadAndRenderBoard(){if(!this.boardContainer)return;let t=this.currentQuery.groupKey;this.previousGroupKey!==null&&this.previousGroupKey!==t&&(this.boardContainer.empty(),this.columnOrder=[]),this.previousGroupKey=t;let r=null;this.boardContainer.children.length===0&&(r=this.boardContainer.createDiv({cls:"kanban-view__loading",text:"Loading board..."}));try{let s=await this.plugin.filterService.getGroupedTasks(this.currentQuery,this.plugin.selectedDate);r&&r.remove(),this.renderBoardFromGroupedTasksWithReconciler(s);let n=Array.from(s.values()).flat(),a=this.contentEl.querySelector(".kanban-view__stats");a&&this.updateBoardStats(a,n)}catch(s){console.error("Error loading Kanban board:",s),new sn.Notice("Failed to load Kanban board. See console for details."),r&&r.remove(),this.boardContainer.empty(),this.boardContainer.createDiv({cls:"kanban-view__error",text:"Error loading board."})}}renderBoardFromGroupedTasks(t){if(!this.boardContainer)return;this.boardContainer.empty(),this.taskElements.clear();let r=Array.from(t.keys()).sort();this.columnOrder.length===0&&(this.columnOrder=[...r]),this.renderBoardFromGroupedTasksWithOrder(t)}renderColumn(t,r,s){let n=t.createDiv({cls:"kanban-view__column"});n.dataset.columnId=r,r==="uncategorized"&&n.addClass("kanban-view__column--uncategorized");let a=n.createDiv({cls:"kanban-view__column-header"});a.draggable=!0,a.dataset.columnId=r,this.addColumnDragHandlers(a);let o=this.formatColumnTitle(r,this.currentQuery.groupKey);a.createEl("div",{text:o,cls:"kanban-view__column-title"}),a.createEl("div",{text:`${s.length} tasks`,cls:"kanban-view__column-count"});let l=n.createDiv({cls:"kanban-view__column-body"});if(s.length===0){let d=l.createDiv({cls:"kanban-view__column-empty",text:"No tasks"});this.addColumnDropHandlers(d)}else s.forEach(d=>{let u=gs(d,this.plugin,{showDueDate:!0,showCheckbox:!1,showTimeTracking:!0});u.draggable=!0,this.addDragHandlers(u,d),l.appendChild(u),this.taskElements.set(d.path,u)});l.createEl("button",{cls:"kanban-view__add-card-button",text:"+ Add a card"}).addEventListener("click",()=>{this.openTaskCreationModalForColumn(r)}),this.addColumnDropHandlers(n)}addColumnDragHandlers(t){t.addEventListener("dragstart",r=>{if(r.dataTransfer){let s=t.dataset.columnId;s&&(r.dataTransfer.setData("text/plain",`column:${s}`),r.dataTransfer.effectAllowed="move")}t.classList.add("kanban-view__column-header--dragging")}),t.addEventListener("dragend",()=>{t.classList.remove("kanban-view__column-header--dragging")})}async reorderColumns(t,r){var o;if(this.columnOrder.length===0){let l=(o=this.boardContainer)==null?void 0:o.querySelectorAll(".kanban-view__column");this.columnOrder=Array.from(l||[]).map(c=>c.dataset.columnId||"").filter(c=>c)}let s=this.columnOrder.indexOf(t),n=this.columnOrder.indexOf(r);if(s===-1||n===-1)return;let[a]=this.columnOrder.splice(s,1);this.columnOrder.splice(n,0,a),this.renderBoardWithOrder()}async renderBoardWithOrder(){if(this.boardContainer)try{let t=await this.plugin.filterService.getGroupedTasks(this.currentQuery,this.plugin.selectedDate);this.renderBoardFromGroupedTasksWithReconciler(t);let r=Array.from(t.values()).flat(),s=this.contentEl.querySelector(".kanban-view__stats");s&&this.updateBoardStats(s,r)}catch(t){console.error("Error reordering Kanban board:",t),this.refresh()}}renderBoardFromGroupedTasksWithOrder(t){if(!this.boardContainer)return;let r=this.boardContainer.querySelector(".kanban-view__board");r?r.empty():r=this.boardContainer.createDiv({cls:"kanban-view__board"}),this.taskElements.clear(),this.columnOrder.forEach(n=>{if(t.has(n)){let a=t.get(n)||[];this.renderColumn(r,n,a)}}),Array.from(t.keys()).forEach(n=>{if(!this.columnOrder.includes(n)){this.columnOrder.push(n);let a=t.get(n)||[];this.renderColumn(r,n,a)}})}addDragHandlers(t,r){t.addEventListener("dragstart",s=>{s.dataTransfer&&(s.dataTransfer.setData("text/plain",r.path),s.dataTransfer.effectAllowed="move"),setTimeout(()=>t.classList.add("task-card--dragging"),0)}),t.addEventListener("dragend",()=>{t.classList.remove("task-card--dragging")})}addColumnDropHandlers(t){t.addEventListener("dragover",r=>{var s;r.preventDefault(),r.dataTransfer&&(r.dataTransfer.dropEffect="move",((s=this.boardContainer)==null?void 0:s.querySelector(".kanban-view__column-header--dragging"))?t.classList.add("kanban-view__column--column-drop-target"):t.classList.add("kanban-view__column--dragover"))}),t.addEventListener("dragleave",r=>{t.contains(r.relatedTarget)||(t.classList.remove("kanban-view__column--dragover"),t.classList.remove("kanban-view__column--column-drop-target"))}),t.addEventListener("drop",async r=>{var o,l;r.preventDefault(),r.stopPropagation(),(o=this.boardContainer)==null||o.querySelectorAll(".kanban-view__column--dragover, .kanban-view__column--column-drop-target").forEach(c=>{c.classList.remove("kanban-view__column--dragover","kanban-view__column--column-drop-target")});let s=(l=r.dataTransfer)==null?void 0:l.getData("text/plain");if(s!=null&&s.startsWith("column:")){let c=s.replace("column:",""),d=t.dataset.columnId;c&&d&&c!==d&&await this.reorderColumns(c,d);return}let n=s,a=t.dataset.columnId;if(!a){let c=r.target.closest(".kanban-view__column");a=(c==null?void 0:c.getAttribute("data-column-id"))||void 0}if(n&&a&&a!=="uncategorized"){let c=this.plugin.cacheManager.getCachedTaskInfo(n);if(c)try{let d,u;switch(this.currentQuery.groupKey){case"status":d="status",u=a;break;case"priority":d="priority",u=a;break;case"context":d="contexts",u=[a];break;default:throw new Error(`Unsupported groupBy: ${this.currentQuery.groupKey}`)}await this.plugin.updateTaskProperty(c,d,u,{silent:!0}),new sn.Notice(`Task moved to "${this.formatColumnTitle(a,this.currentQuery.groupKey)}"`)}catch(d){console.error("Failed to move task:",d),new sn.Notice("Failed to move task"),this.refresh()}}})}renderBoardFromGroupedTasksWithReconciler(t){if(!this.boardContainer)return;let r=this.boardContainer.querySelector(".kanban-view__board");r||(r=this.boardContainer.createDiv({cls:"kanban-view__board"}));let s=Array.from(t.keys()).sort();this.columnOrder.length===0&&(this.columnOrder=[...s]),s.forEach(o=>{this.columnOrder.includes(o)||this.columnOrder.push(o)});let n=this.columnOrder.map(o=>({id:o,tasks:t.get(o)||[]}));this.plugin.domReconciler.updateList(r,n,o=>o.id,o=>this.createColumnElement(o.id,o.tasks),(o,l)=>this.updateColumnElement(o,l.id,l.tasks)),this.taskElements.clear(),r.querySelectorAll(".task-card[data-task-path]").forEach(o=>{let l=o.dataset.taskPath;l&&this.taskElements.set(l,o)})}createColumnElement(t,r){let s=document.createElement("div");s.className="kanban-view__column",s.dataset.columnId=t,t==="uncategorized"&&s.classList.add("kanban-view__column--uncategorized");let n=s.createDiv({cls:"kanban-view__column-header"});n.draggable=!0,n.dataset.columnId=t,this.addColumnDragHandlers(n);let a=this.formatColumnTitle(t,this.currentQuery.groupKey);n.createEl("div",{text:a,cls:"kanban-view__column-title"}),n.createEl("div",{text:`${r.length} tasks`,cls:"kanban-view__column-count"});let o=s.createDiv({cls:"kanban-view__column-body"}),l=o.createDiv({cls:"kanban-view__tasks-container"});if(r.length===0){let d=l.createDiv({cls:"kanban-view__column-empty",text:"No tasks"});this.addColumnDropHandlers(d)}else this.plugin.domReconciler.updateList(l,r,d=>d.path,d=>this.createTaskCardElement(d),(d,u)=>this.updateTaskCardElement(d,u));return o.createEl("button",{cls:"kanban-view__add-card-button",text:"+ Add a card"}).addEventListener("click",()=>{this.openTaskCreationModalForColumn(t)}),this.addColumnDropHandlers(s),s}updateColumnElement(t,r,s){let n=t.querySelector(".kanban-view__column-count");n&&(n.textContent=`${s.length} tasks`);let a=t.querySelector(".kanban-view__column-body");if(a){let o=a.querySelector(".kanban-view__add-card-button"),l=a.querySelector(".kanban-view__tasks-container");if(l||(l=a.createDiv({cls:"kanban-view__tasks-container"}),o?a.insertBefore(l,o):a.appendChild(l)),s.length===0){l.empty();let c=l.createDiv({cls:"kanban-view__column-empty",text:"No tasks"});this.addColumnDropHandlers(c)}else{let c=l.querySelector(".kanban-view__column-empty");c&&c.remove(),this.plugin.domReconciler.updateList(l,s,d=>d.path,d=>this.createTaskCardElement(d),(d,u)=>this.updateTaskCardElement(d,u))}}}createTaskCardElement(t){let r=gs(t,this.plugin,{showDueDate:!0,showCheckbox:!1,showTimeTracking:!0});return r.draggable=!0,this.addDragHandlers(r,t),this.taskElements.set(t.path,r),r}updateTaskCardElement(t,r){pr(t,r,this.plugin,{showDueDate:!0,showCheckbox:!1,showTimeTracking:!0}),this.taskElements.set(r.path,t)}debounceRefresh(){this.refreshTimeout&&clearTimeout(this.refreshTimeout),this.refreshTimeout=setTimeout(()=>{this.refresh(),this.refreshTimeout=null},150)}formatColumnTitle(t,r){var s,n;switch(r){case"status":return((s=this.plugin.statusManager.getStatusConfig(t))==null?void 0:s.label)||t;case"priority":return((n=this.plugin.priorityManager.getPriorityConfig(t))==null?void 0:n.label)||t;case"context":return t==="uncategorized"?"Uncategorized":`@${t}`;case"due":return t;case"none":default:return t}}openTaskCreationModalForColumn(t){let r={};switch(this.currentQuery.groupKey){case"status":t!=="uncategorized"&&(r.status=t);break;case"priority":t!=="uncategorized"&&(r.priority=t);break;case"context":t!=="uncategorized"&&(r.contexts=[t]);break}this.plugin.openTaskCreationModal(r)}};var lt=require("obsidian");Me();rr();_e();var Bc=class{constructor(e){this.timerInterval=null;this.stateFile="pomodoro-state.json";this.activeAudioContexts=new Set;this.cleanupTimeouts=new Set;this.visibilityChangeHandler=null;this.plugin=e,this.state={isRunning:!1,timeRemaining:e.settings.pomodoroWorkDuration*60}}async initialize(){await this.loadState(),this.state.isRunning&&this.state.currentSession&&this.resumeTimer(),this.visibilityChangeHandler=()=>{!document.hidden&&this.state.isRunning&&this.state.currentSession&&this.resumeTimer()},this.plugin.registerDomEvent(document,"visibilitychange",this.visibilityChangeHandler)}async loadState(){try{let e=await this.plugin.loadData();if(e&&ep(e)){console.log("[PomodoroService] Migrating pomodoro data to new format...");let t={...e};e=tp(e),await this.plugin.saveData(e),rp(t,e),console.log("[PomodoroService] Pomodoro data migration completed successfully")}if(e!=null&&e.pomodoroState){this.state=e.pomodoroState,this.state.timeRemaining=Math.max(0,this.state.timeRemaining||0);let t=k(new Date,"yyyy-MM-dd");if(e.lastPomodoroDate!==t&&this.state.currentSession&&(this.state.currentSession=void 0,this.state.isRunning=!1),this.state.currentSession){let s=new Date(this.state.currentSession.startTime).getTime();(Date.now()-s)/(1e3*60*60)>24&&(this.state.currentSession=void 0,this.state.isRunning=!1,this.state.timeRemaining=this.plugin.settings.pomodoroWorkDuration*60)}this.state.currentSession||(this.state.timeRemaining=this.plugin.settings.pomodoroWorkDuration*60)}}catch(e){console.error("Failed to load pomodoro state:",e),this.state={isRunning:!1,timeRemaining:this.plugin.settings.pomodoroWorkDuration*60}}}async saveState(){try{let e=await this.plugin.loadData()||{};e.pomodoroState=this.state,e.lastPomodoroDate=k(new Date,"yyyy-MM-dd"),await this.plugin.saveData(e)}catch(e){console.error("Failed to save pomodoro state:",e)}}async saveLastSelectedTask(e){try{let t=await this.plugin.loadData()||{};t.lastSelectedTaskPath=e,await this.plugin.saveData(t)}catch(t){console.error("Failed to save last selected task:",t)}}async getLastSelectedTaskPath(){try{let e=await this.plugin.loadData();return e==null?void 0:e.lastSelectedTaskPath}catch(e){console.error("Failed to load last selected task:",e);return}}async startPomodoro(e){var n;if(this.state.isRunning){new lt.Notice("A pomodoro is already running");return}if(this.state.currentSession&&!this.state.isRunning){new lt.Notice("Resume the current session instead of starting a new one");return}let t=Math.max(1,Math.min(120,this.plugin.settings.pomodoroWorkDuration)),r=we(),s={id:Date.now().toString(),taskPath:e==null?void 0:e.path,startTime:r,plannedDuration:t,type:"work",completed:!1,activePeriods:[{startTime:r}]};if(this.state.currentSession=s,this.state.isRunning=!0,this.state.timeRemaining=s.plannedDuration*60,await this.saveState(),this.startTimer(),e)try{await this.plugin.taskService.startTimeTracking(e)}catch(a){(n=a.message)!=null&&n.includes("Time tracking is already active")||console.error("Failed to start time tracking for Pomodoro:",a)}this.plugin.emitter.emit(Do,{session:s,task:e}),new lt.Notice(`Pomodoro started${e?` for: ${e.title}`:""}`)}async startBreak(e=!1){if(this.state.isRunning){new lt.Notice("A timer is already running");return}if(this.state.currentSession&&!this.state.isRunning){new lt.Notice("Resume the current session instead of starting a new one");return}let t=e?Math.max(1,Math.min(60,this.plugin.settings.pomodoroLongBreakDuration)):Math.max(1,Math.min(30,this.plugin.settings.pomodoroShortBreakDuration)),r=we(),s={id:Date.now().toString(),startTime:r,plannedDuration:t,type:e?"long-break":"short-break",completed:!1,activePeriods:[{startTime:r}]};this.state.currentSession=s,this.state.isRunning=!0,this.state.timeRemaining=s.plannedDuration*60,await this.saveState(),this.startTimer(),new lt.Notice(`${e?"Long":"Short"} break started`)}async pausePomodoro(){if(!(!this.state.isRunning||!this.timerInterval)){if(this.stopTimer(),this.state.isRunning=!1,this.state.currentSession&&this.state.currentSession.activePeriods.length>0){let e=this.state.currentSession.activePeriods[this.state.currentSession.activePeriods.length-1];e.endTime||(e.endTime=we())}if(this.state.currentSession&&this.state.currentSession.taskPath)try{let e=await this.plugin.cacheManager.getTaskInfo(this.state.currentSession.taskPath,!0);e&&await this.plugin.taskService.stopTimeTracking(e)}catch(e){console.error("Failed to stop time tracking for Pomodoro pause:",e)}await this.saveState(),this.plugin.emitter.emit($r,{timeRemaining:this.state.timeRemaining,session:this.state.currentSession}),new lt.Notice("Pomodoro paused")}}async resumePomodoro(){var e;if(!(this.state.isRunning||!this.state.currentSession)){if(this.state.isRunning=!0,this.state.currentSession&&this.state.currentSession.activePeriods.push({startTime:we()}),await this.saveState(),this.startTimer(),this.state.currentSession&&this.state.currentSession.taskPath)try{let t=await this.plugin.cacheManager.getTaskInfo(this.state.currentSession.taskPath,!0);t&&await this.plugin.taskService.startTimeTracking(t)}catch(t){(e=t.message)!=null&&e.includes("Time tracking is already active")||console.error("Failed to start time tracking for Pomodoro resume:",t)}this.plugin.emitter.emit($r,{timeRemaining:this.state.timeRemaining,session:this.state.currentSession}),new lt.Notice("Pomodoro resumed")}}async stopPomodoro(){if(!this.state.currentSession)return;let e=this.state.isRunning;if(this.stopTimer(),this.state.currentSession){if(this.state.currentSession.interrupted=!0,this.state.currentSession.endTime=we(),this.state.currentSession.activePeriods.length>0){let t=this.state.currentSession.activePeriods[this.state.currentSession.activePeriods.length-1];t.endTime||(t.endTime=we())}await this.addSessionToHistory(this.state.currentSession)}if(this.plugin.emitter.emit(Co,{session:this.state.currentSession}),this.state.currentSession&&this.state.currentSession.taskPath&&e)try{let t=await this.plugin.cacheManager.getTaskInfo(this.state.currentSession.taskPath,!0);t&&await this.plugin.taskService.stopTimeTracking(t)}catch(t){console.error("Failed to stop time tracking for Pomodoro interrupt:",t)}this.state.currentSession=void 0,this.state.isRunning=!1,this.state.timeRemaining=this.plugin.settings.pomodoroWorkDuration*60,await this.saveState(),this.plugin.emitter.emit($r,{timeRemaining:this.state.timeRemaining,session:this.state.currentSession}),e&&new lt.Notice("Pomodoro stopped and reset")}startTimer(){this.stopTimer(),this.saveState().catch(e=>{console.error("Failed to save state when starting timer:",e)}),this.timerInterval=setInterval(async()=>{this.state.timeRemaining>0&&(this.state.timeRemaining--,this.plugin.emitter.emit($r,{timeRemaining:this.state.timeRemaining,session:this.state.currentSession}),this.state.timeRemaining%10===0&&this.saveState().catch(e=>{console.error("Failed to save periodic state:",e)})),this.state.timeRemaining<=0&&await this.completePomodoro()},1e3)}stopTimer(){this.timerInterval&&(clearInterval(this.timerInterval),this.timerInterval=null)}resumeTimer(){if(this.state.currentSession&&this.state.currentSession.startTime){let e=new Date(this.state.currentSession.startTime).getTime(),t=Date.now();if(e>t){this.stopPomodoro();return}let r=Math.floor((t-e)/1e3),s=this.state.currentSession.plannedDuration*60;!this.state.isRunning&&this.state.timeRemaining>0?this.state.timeRemaining=Math.min(this.state.timeRemaining,s):this.state.timeRemaining=Math.max(0,s-r),this.state.timeRemaining>0&&this.state.isRunning?this.startTimer():this.state.timeRemaining<=0&&this.completePomodoro()}}async completePomodoro(){if(this.stopTimer(),!this.state.currentSession)return;let e=this.state.currentSession;if(e.completed=!0,e.endTime=we(),e.activePeriods.length>0){let r=e.activePeriods[e.activePeriods.length-1];r.endTime||(r.endTime=we())}if(e.type==="work"&&this.state.isRunning&&e.taskPath)try{let r=await this.plugin.cacheManager.getTaskInfo(e.taskPath,!0);r&&await this.plugin.taskService.stopTimeTracking(r)}catch(r){console.error("Failed to stop time tracking for Pomodoro completion:",r)}e.type==="work"&&await this.updateDailyNotePomodoros();let t=!1;if(e.type==="work")try{t=(await this.getTodayStats()).pomodorosCompleted%this.plugin.settings.pomodoroLongBreakInterval===0}catch(r){console.error("Failed to calculate break type:",r),t=!1}if(await this.addSessionToHistory(e),this.plugin.emitter.emit(So,{session:e,nextType:e.type==="work"?t?"long-break":"short-break":"work"}),this.plugin.settings.pomodoroNotifications){let r=e.type==="work"?`Pomodoro completed! Time for a ${t?"long":"short"} break.`:"Break completed! Ready for the next pomodoro?";new lt.Notice(r)}if(this.plugin.settings.pomodoroSoundEnabled&&this.playCompletionSound(),this.state.currentSession=void 0,this.state.isRunning=!1,this.state.timeRemaining=0,await this.saveState(),e.type==="work"&&this.plugin.settings.pomodoroAutoStartBreaks){let r=setTimeout(()=>this.startBreak(t),1e3);this.cleanupTimeouts.add(r)}else if(e.type!=="work"&&this.plugin.settings.pomodoroAutoStartWork){let r=setTimeout(()=>this.startPomodoro(),1e3);this.cleanupTimeouts.add(r)}}async updateDailyNotePomodoros(){try{let e=`${this.plugin.settings.dailyNotesFolder}/${k(new Date,"yyyy-MM-dd")}.md`,t=this.plugin.app.vault.getAbstractFileByPath(e);if(t instanceof lt.TFile)await this.plugin.app.fileManager.processFrontMatter(t,r=>{let s=this.plugin.fieldMapper.toUserField("pomodoros"),n=r[s]||0;r[s]||(r[s]=0),r[s]++});else{await Pi(this.plugin.app.vault,this.plugin.settings.dailyNotesFolder);let r=`---
date: ${k(new Date,"yyyy-MM-dd")}
pomodoros: 1
---

# ${k(new Date,"EEEE, MMMM d, yyyy")}

## Pomodoros Completed: 1
`;try{t=await this.plugin.app.vault.create(e,r)}catch(s){if(s.message.includes("File already exists"))t=this.plugin.app.vault.getAbstractFileByPath(e),t instanceof lt.TFile&&await this.plugin.app.fileManager.processFrontMatter(t,n=>{let a=this.plugin.fieldMapper.toUserField("pomodoros");(!n[a]||typeof n[a]!="number")&&(n[a]=0),n[a]++});else throw s}}}catch(e){console.error("Failed to update daily note pomodoros:",e)}}playCompletionSound(){try{let e=new(window.AudioContext||window.webkitAudioContext),t=e.createOscillator(),r=e.createGain();t.connect(r),r.connect(e.destination);let s=Math.max(0,Math.min(1,this.plugin.settings.pomodoroSoundVolume/100));r.gain.value=s*.3,t.frequency.value=800,t.type="sine",t.start(),t.stop(e.currentTime+.1),this.activeAudioContexts.add(e);let n=setTimeout(()=>{try{let o=e.createOscillator();o.connect(r),o.frequency.value=1e3,o.type="sine",o.start(),o.stop(e.currentTime+.1)}catch(o){console.error("Failed to play second beep:",o)}},150);this.cleanupTimeouts.add(n);let a=setTimeout(()=>{this.activeAudioContexts.delete(e),e.close().catch(()=>{})},300);this.cleanupTimeouts.add(a)}catch(e){console.error("Failed to play completion sound:",e)}}getState(){return{...this.state}}isRunning(){return this.state.isRunning}getCurrentSession(){return this.state.currentSession}getTimeRemaining(){return this.state.timeRemaining}async getPomodorosCompleted(){return(await this.getTodayStats()).pomodorosCompleted}async getCurrentStreak(){return(await this.getTodayStats()).currentStreak}async getTotalMinutesToday(){return(await this.getTodayStats()).totalMinutes}async assignTaskToCurrentSession(e){this.state.currentSession&&(this.state.currentSession.taskPath=e==null?void 0:e.path,await this.saveState(),this.plugin.emitter.emit($r,{timeRemaining:this.state.timeRemaining,session:this.state.currentSession}))}async getSessionHistory(){try{let e=await this.plugin.loadData();if(e&&ep(e)){let t={...e};e=tp(e),await this.plugin.saveData(e),rp(t,e),console.log("[PomodoroService] Session history migrated during retrieval")}return(e==null?void 0:e.pomodoroHistory)||[]}catch(e){return console.error("Failed to load session history:",e),[]}}async saveSessionHistory(e){try{let t=await this.plugin.loadData()||{};t.pomodoroHistory=e,await this.plugin.saveData(t)}catch(t){console.error("Failed to save session history:",t)}}calculateActualDuration(e){return e.filter(t=>t.endTime).reduce((t,r)=>{let s=new Date(r.startTime),a=new Date(r.endTime).getTime()-s.getTime();return t+Math.round(a/(1e3*60))},0)}async addSessionToHistory(e){if(!e.endTime){console.warn("Cannot add session to history without end time");return}let t={id:e.id,startTime:e.startTime,endTime:e.endTime,plannedDuration:e.plannedDuration,type:e.type,taskPath:e.taskPath,completed:e.completed&&!e.interrupted,activePeriods:e.activePeriods.slice()};try{let r=await this.getSessionHistory();r.push(t),await this.saveSessionHistory(r)}catch(r){console.error("Failed to add session to history:",r)}}async getStatsForDate(e){let t=k(e,"yyyy-MM-dd"),n=(await this.getSessionHistory()).filter(u=>k(new Date(u.startTime),"yyyy-MM-dd")===t).filter(u=>u.type==="work"),a=n.filter(u=>u.completed),o=0;for(let u=n.length-1;u>=0&&n[u].completed;u--)o++;let l=a.reduce((u,f)=>u+to(f),0),c=a.length>0?l/a.length:0,d=n.length>0?a.length/n.length*100:0;return{pomodorosCompleted:a.length,currentStreak:o,totalMinutes:l,averageSessionLength:Math.round(c),completionRate:Math.round(d)}}async getTodayStats(){return this.getStatsForDate(new Date)}cleanup(){this.stopTimer();for(let e of this.cleanupTimeouts)clearTimeout(e);this.cleanupTimeouts.clear();for(let e of this.activeAudioContexts)try{e.state!=="closed"&&e.close().catch(()=>{})}catch(t){}this.activeAudioContexts.clear(),this.visibilityChangeHandler=null,this.saveState().catch(e=>{console.error("Failed to save final state:",e)})}};rr();yl();var At=require("obsidian");rr();yl();ra();Me();_e();var Mt=class{constructor(e,t,r="",s="",n="",a){this.fileContentCache=new Map;this.yamlCache=new Map;this.taskInfoCache=new Map;this.noteInfoCache=new Map;this.indexedFilesCache=new Map;this.tasksByDate=new Map;this.notesByDate=new Map;this.tasksByStatus=new Map;this.tasksByPriority=new Map;this.overdueTasks=new Set;this.dailyNotes=new Set;this.allTags=new Set;this.allContexts=new Set;this.fieldMapper=null;this.stats={cacheHits:0,cacheMisses:0,fileReads:0,yamlParses:0,memoryUsage:0,cacheEvictions:0,lastMemoryCheck:0};this.eventHandlers={};this.subscribers=new Map;this.recentUpdates=new Map;this.lastCacheCleanup=Date.now();this.memoryCheckInterval=null;this.delayedInitTimeout=null;this.initializationPromise=null;this.initialized=!1;this.delayedInitializationScheduled=!1;this.vault=e,this.taskTag=t,this.excludedFolders=r?r.split(",").map(o=>o.trim()):[],this.dailyNotesPath=(0,At.normalizePath)(s),this.dailyNoteTemplatePath=n,this.fieldMapper=a||null,this.registerFileEvents()}isInitialized(){return this.initialized}subscribe(e,t){return this.subscribers.has(e)||this.subscribers.set(e,new Set),this.subscribers.get(e).add(t),()=>{let r=this.subscribers.get(e);r&&(r.delete(t),r.size===0&&this.subscribers.delete(e))}}notifySubscribers(e,t){let r=this.subscribers.get(e);r&&r.forEach(s=>{try{s(t)}catch(n){console.error(`Error in cache subscriber for ${e}:`,n)}})}async getFileContent(e,t=!1){let r=this.vault.getAbstractFileByPath(e);if(!(r instanceof At.TFile)||r.extension!=="md")return null;let s=this.fileContentCache.get(e),n=Date.now();if(!t&&s&&n-s.mtime<Mt.FILE_CACHE_TTL)return this.stats.cacheHits++,s.content;try{let a=await this.vault.cachedRead(r);return this.stats.fileReads++,this.fileContentCache.set(e,{content:a,mtime:n}),this.evictFileCache(),a}catch(a){return console.error(`Error reading file ${e}:`,a),null}}parseYAML(e,t){let r=this.yamlCache.get(t),s=Date.now();if(r&&s-r.timestamp<Mt.YAML_CACHE_TTL)return r.data;try{let n=Mi(e);return this.stats.yamlParses++,this.yamlCache.set(t,{data:n,timestamp:s}),this.cleanupYAMLCache(),n}catch(n){return console.error("Error parsing YAML content:",n),null}}extractFrontmatter(e,t){if(!e.startsWith("---"))return null;let r=e.indexOf("---",3);if(r===-1)return null;let s=e.substring(3,r);return this.parseYAML(s,t)}async getTaskInfo(e,t=!1){if(!t&&this.taskInfoCache.has(e)){let s=this.taskInfoCache.get(e);return this.stats.cacheHits++,s}t&&(this.taskInfoCache.delete(e),this.yamlCache.delete(e),st.clearCacheEntry(e));let r=await this.getFileContent(e,t);if(!r)return null;try{let s=qy(r,e,this.fieldMapper||void 0);if(s)return this.taskInfoCache.set(e,s),this.updateTaskIndexes(e,s),this.stats.cacheMisses++,s}catch(s){console.error(`Error extracting task info from ${e}:`,s)}return null}async getNoteInfo(e,t=!1){if(!t&&this.noteInfoCache.has(e))return this.stats.cacheHits++,this.noteInfoCache.get(e);let r=await this.getFileContent(e,t);if(!r)return null;let s=this.vault.getAbstractFileByPath(e);if(!(s instanceof At.TFile))return null;try{let n=Yy(r,e,s);if(n)return this.noteInfoCache.set(e,n),this.updateNoteIndexes(e,n),this.stats.cacheMisses++,n}catch(n){console.error(`Error extracting note info from ${e}:`,n)}return null}async getTasksForDate(e,t=!1){await this.ensureInitialized();let r=[];if(t&&(this.clearAllCaches(),await this.performInitialization(),this.initialized=!0),Array.from(this.taskInfoCache.keys()).length===0){let n=Array.from(this.indexedFilesCache.keys()).filter(a=>{let o=this.indexedFilesCache.get(a);return o==null?void 0:o.isTask});if(n.length===0&&!t){await this.initializeCache();let o=Array.from(this.indexedFilesCache.keys()).filter(c=>{let d=this.indexedFilesCache.get(c);return d==null?void 0:d.isTask}).map(c=>this.getTaskInfo(c,!0));(await Promise.all(o)).forEach(c=>{c&&r.push(c)})}else{let a=n.map(l=>this.getTaskInfo(l,t));(await Promise.all(a)).forEach(l=>{l&&r.push(l)})}}else{let n=Array.from(this.taskInfoCache.values());r.push(...n)}return r}async getTasksDueOnDate(e){await this.ensureInitialized();let t=k(e,"yyyy-MM-dd"),r=this.tasksByDate.get(t)||new Set,s=[],a=Array.from(r).map(l=>this.getTaskInfo(l,!1));return(await Promise.all(a)).forEach(l=>{l&&s.push(l)}),s}async getNotesForDate(e,t=!1){await this.ensureInitialized();let r=k(e,"yyyy-MM-dd"),s=this.notesByDate.get(r)||new Set,n=[],o=Array.from(s).map(c=>this.getNoteInfo(c,t));return(await Promise.all(o)).forEach(c=>{c&&n.push(c)}),n}async getCalendarData(e,t,r=!1){let s=tr(e,t,1),n=tr(e,t+1,0),a=new Map,o=new Map;for(let[c,d]of this.notesByDate){let u=le(c);u>=s&&u<=n&&a.set(c,d.size)}for(let[c,d]of this.tasksByDate){let u=le(c);if(u>=s&&u<=n){let h=(await Promise.all(Array.from(d).map(m=>this.getTaskInfo(m)))).filter(Boolean);if(h.length>0){let m=h.some(g=>g.due&&ge(g.due)===c),p=h.some(g=>g.scheduled&&ge(g.scheduled)===c);o.set(c,{count:h.length,hasDue:m,hasScheduled:p,hasCompleted:h.some(g=>g.status==="done"),hasArchived:h.some(g=>g.archived)})}}}let l=new Set;return this.dailyNotes.forEach(c=>{let d=new Date(c);d.getFullYear()===e&&d.getMonth()===t&&l.add(c)}),{notes:a,tasks:o,dailyNotes:l}}async initializeCache(){if(!this.initialized){if(this.initializationPromise)return this.initializationPromise;this.initializationPromise=this.performInitialization();try{await this.initializationPromise,this.initialized=!0}catch(e){throw console.error("CacheManager: Initialization failed:",e),this.initializationPromise=null,e}}}async performInitialization(){let e=performance.now();this.clearAllCaches();let t=this.vault.getMarkdownFiles();if(t.length===0){this.scheduleDelayedInitialization();return}await Promise.all(t.map(s=>this.indexFile(s))),this.rebuildOverdueTasksIndex();let r=performance.now();this.notifySubscribers("cache-initialized",{taskCount:this.taskInfoCache.size,noteCount:this.noteInfoCache.size,duration:r-e})}scheduleDelayedInitialization(){this.delayedInitializationScheduled||(this.delayedInitializationScheduled=!0,this.delayedInitTimeout=setTimeout(async()=>{this.delayedInitTimeout=null;try{this.vault.getMarkdownFiles().length>0?(this.initialized=!1,this.initializationPromise=null,await this.initializeCache()):(this.delayedInitializationScheduled=!1,this.scheduleDelayedInitialization())}catch(e){console.error("Delayed initialization failed:",e),this.delayedInitializationScheduled=!1}},2e3))}async ensureInitialized(){this.initialized||(this.initializationPromise?await this.initializationPromise:await this.initializeCache())}async indexFile(e){var t;if(!(e.extension!=="md"||this.isExcluded(e.path)))try{let r=await this.getFileContent(e.path,!0);if(!r)return;let s=this.extractFrontmatter(r,e.path),n=(t=s==null?void 0:s.tags)==null?void 0:t.includes(this.taskTag),a={path:e.path,mtime:e.stat.mtime,ctime:e.stat.ctime,tags:(s==null?void 0:s.tags)||[],isTask:n};this.indexedFilesCache.set(e.path,a),n?await this.getTaskInfo(e.path,!0):await this.getNoteInfo(e.path,!0),this.updateDailyNotesIndex(e.path)}catch(r){console.error(`Error indexing file ${e.path}:`,r)}}updateTaskIndexes(e,t){let r=this.taskInfoCache.get(e);if(this.removeFromIndexes(e,"task",r),t.due){let s=t.due;this.tasksByDate.has(s)||this.tasksByDate.set(s,new Set),this.tasksByDate.get(s).add(e)}if(t.scheduled){let s=t.scheduled;this.tasksByDate.has(s)||this.tasksByDate.set(s,new Set),this.tasksByDate.get(s).add(e)}t.status&&(this.tasksByStatus.has(t.status)||this.tasksByStatus.set(t.status,new Set),this.tasksByStatus.get(t.status).add(e)),t.priority&&(this.tasksByPriority.has(t.priority)||this.tasksByPriority.set(t.priority,new Set),this.tasksByPriority.get(t.priority).add(e)),this.updateOverdueTaskIndex(e,t),t.tags&&Array.isArray(t.tags)&&t.tags.forEach(s=>{s&&typeof s=="string"&&this.allTags.add(s)}),t.contexts&&Array.isArray(t.contexts)&&t.contexts.forEach(s=>{s&&typeof s=="string"&&this.allContexts.add(s)})}updateNoteIndexes(e,t){let r=this.noteInfoCache.get(e);if(this.removeFromIndexes(e,"note",r),t.createdDate){let s=t.createdDate.includes("T")?t.createdDate.split("T")[0]:t.createdDate;this.notesByDate.has(s)||this.notesByDate.set(s,new Set),this.notesByDate.get(s).add(e)}}updateDailyNotesIndex(e){let t=(0,At.normalizePath)(this.dailyNotesPath),r=e.startsWith(t+"/")||e===t||t===""&&!e.includes("/"),s=e.split("/").pop()||"",n=/^\d{4}-\d{2}-\d{2}\.md$/.test(s);if(r&&n){let a=s.replace(".md","");this.dailyNotes.add(a)}}removeFromIndexes(e,t,r){if(r&&t==="task"){let n=r;if(n.due){let a=n.due,o=this.tasksByDate.get(a);o&&(o.delete(e),o.size===0&&this.tasksByDate.delete(a))}if(n.scheduled){let a=n.scheduled,o=this.tasksByDate.get(a);o&&(o.delete(e),o.size===0&&this.tasksByDate.delete(a))}if(n.status){let a=this.tasksByStatus.get(n.status);a&&(a.delete(e),a.size===0&&this.tasksByStatus.delete(n.status))}if(n.priority){let a=this.tasksByPriority.get(n.priority);a&&(a.delete(e),a.size===0&&this.tasksByPriority.delete(n.priority))}if(n.due&&!n.recurrence){let a=Dr();kr(n.due,a)&&this.overdueTasks.delete(e)}this.rebuildCanonicalSets()}else if(r&&t==="note"){let n=r;if(n.createdDate){let a=n.createdDate.includes("T")?n.createdDate.split("T")[0]:n.createdDate,o=this.notesByDate.get(a);o&&(o.delete(e),o.size===0&&this.notesByDate.delete(a))}}else{for(let[n,a]of this.tasksByDate)a.delete(e),a.size===0&&this.tasksByDate.delete(n);for(let[n,a]of this.notesByDate)a.delete(e),a.size===0&&this.notesByDate.delete(n);for(let[n,a]of this.tasksByStatus)a.delete(e),a.size===0&&this.tasksByStatus.delete(n);for(let[n,a]of this.tasksByPriority)a.delete(e),a.size===0&&this.tasksByPriority.delete(n);this.overdueTasks.delete(e),t==="task"&&this.rebuildCanonicalSets()}let s=e.split("/").pop()||"";if(/^\d{4}-\d{2}-\d{2}\.md$/.test(s)){let n=s.replace(".md","");this.dailyNotes.delete(n)}}rebuildCanonicalSets(){this.allTags.clear(),this.allContexts.clear();for(let e of this.taskInfoCache.values())e.tags&&Array.isArray(e.tags)&&e.tags.forEach(t=>{t&&typeof t=="string"&&this.allTags.add(t)}),e.contexts&&Array.isArray(e.contexts)&&e.contexts.forEach(t=>{t&&typeof t=="string"&&this.allContexts.add(t)})}registerFileEvents(){let e=Nu(r=>{this.handleFileUpdate(r)},300),t=Nu(r=>{this.handleFileAdd(r)},300);this.eventHandlers.modify=r=>{r instanceof At.TFile&&e(r)},this.eventHandlers.delete=r=>{r instanceof At.TFile&&this.handleFileDelete(r)},this.eventHandlers.rename=(r,s)=>{r instanceof At.TFile&&this.handleFileRename(r,s)},this.eventHandlers.create=r=>{r instanceof At.TFile&&t(r)},this.vault.on("modify",this.eventHandlers.modify),this.vault.on("delete",this.eventHandlers.delete),this.vault.on("rename",this.eventHandlers.rename),this.vault.on("create",this.eventHandlers.create)}async handleFileUpdate(e){let t=this.recentUpdates.get(e.path),r=Date.now();if(t&&r-t<Mt.RECENT_UPDATE_WINDOW){this.recentUpdates.delete(e.path),this.notifySubscribers("file-updated",{path:e.path});return}this.clearCacheEntry(e.path),await this.indexFile(e),this.notifySubscribers("file-updated",{path:e.path})}async handleFileAdd(e){await this.indexFile(e),this.notifySubscribers("file-added",{path:e.path})}handleFileDelete(e){this.clearCacheEntry(e.path),this.removeFromIndexes(e.path),this.notifySubscribers("file-deleted",{path:e.path})}async handleFileRename(e,t){this.clearCacheEntry(t),this.removeFromIndexes(t),await this.indexFile(e),this.notifySubscribers("file-renamed",{oldPath:t,newPath:e.path})}clearCacheEntry(e){this.fileContentCache.delete(e),this.yamlCache.delete(e),this.taskInfoCache.delete(e),this.noteInfoCache.delete(e),this.indexedFilesCache.delete(e),st.clearCacheEntry(e)}clearAllCaches(){this.fileContentCache.clear(),this.yamlCache.clear(),this.taskInfoCache.clear(),this.noteInfoCache.clear(),this.indexedFilesCache.clear(),this.tasksByDate.clear(),this.notesByDate.clear(),this.tasksByStatus.clear(),this.tasksByPriority.clear(),this.overdueTasks.clear(),this.dailyNotes.clear(),this.allTags.clear(),this.allContexts.clear(),this.initialized=!1,this.initializationPromise=null}evictFileCache(){if(this.fileContentCache.size<=Mt.MAX_CACHE_SIZE)return;let e=Array.from(this.fileContentCache.entries()).sort((r,s)=>r[1].mtime-s[1].mtime),t=e.slice(0,e.length-Mt.MAX_CACHE_SIZE);t.forEach(([r])=>{this.fileContentCache.delete(r)}),this.stats.cacheEvictions+=t.length}evictTaskCache(){if(this.taskInfoCache.size<=Mt.MAX_TASK_CACHE_SIZE)return;let e=Array.from(this.taskInfoCache.entries()).sort((r,s)=>{try{let n=r[1].dateModified?ss(r[1].dateModified).getTime():0,a=s[1].dateModified?ss(s[1].dateModified).getTime():0;return n-a}catch(n){return(r[1].dateModified||"").localeCompare(s[1].dateModified||"")}}),t=e.slice(0,e.length-Mt.MAX_TASK_CACHE_SIZE);t.forEach(([r,s])=>{this.taskInfoCache.delete(r),this.removeFromIndexes(r,"task",s)}),this.stats.cacheEvictions+=t.length}evictNoteCache(){if(this.noteInfoCache.size<=Mt.MAX_NOTE_CACHE_SIZE)return;let e=Array.from(this.noteInfoCache.entries()).sort((r,s)=>{try{let n=r[1].createdDate?ss(r[1].createdDate).getTime():0,a=s[1].createdDate?ss(s[1].createdDate).getTime():0;return n-a}catch(n){return(r[1].createdDate||"").localeCompare(s[1].createdDate||"")}}),t=e.slice(0,e.length-Mt.MAX_NOTE_CACHE_SIZE);t.forEach(([r,s])=>{this.noteInfoCache.delete(r),this.removeFromIndexes(r,"note",s)}),this.stats.cacheEvictions+=t.length}cleanupYAMLCache(){let e=Date.now(),t=0;for(let[r,s]of this.yamlCache.entries())e-s.timestamp>Mt.YAML_CACHE_TTL&&(this.yamlCache.delete(r),t++);this.stats.cacheEvictions+=t}isExcluded(e){return this.dailyNoteTemplatePath&&e===this.dailyNoteTemplatePath?!0:this.excludedFolders.some(t=>t&&e.startsWith(t))}updateConfig(e,t,r,s,n){e!==void 0&&(this.taskTag=e),t!==void 0&&(this.excludedFolders=t?t.split(",").map(a=>a.trim()):[]),r!==void 0&&(this.dailyNotesPath=(0,At.normalizePath)(r)),s!==void 0&&(this.dailyNoteTemplatePath=s),n!==void 0&&(this.fieldMapper=n)}updateDailyNoteTemplatePath(e){this.updateConfig(void 0,void 0,void 0,e,void 0)}updateFieldMapper(e){this.updateConfig(void 0,void 0,void 0,void 0,e)}clearCachedInfo(e){this.clearCacheEntry(e)}async updateTaskInfoInCache(e,t){let s=0;for(;s<3;)try{if(this.recentUpdates.set(e,Date.now()),t){let n=this.taskInfoCache.get(e);if(!t.path||!t.title)throw new Error("Invalid task info: missing required fields");let a={...t,dateModified:we()};this.taskInfoCache.set(e,a),this.indexedFilesCache.set(e,{path:e,mtime:Date.now(),ctime:Date.now(),isTask:!0,tags:a.tags||[],cachedInfo:a});try{this.updateTaskIndexes(e,a)}catch(o){console.warn(`Error updating task indexes for ${e}:`,o)}}else{let n=this.taskInfoCache.get(e);this.taskInfoCache.delete(e),this.indexedFilesCache.delete(e);try{this.removeFromIndexes(e,"task",n)}catch(a){console.warn(`Error removing from indexes for ${e}:`,a)}}return}catch(n){s++;let a=n instanceof Error?n.message:String(n);if(s>=3)throw console.error(`Failed to update task info in cache for ${e} after ${3} attempts:`,{error:a,stack:n instanceof Error?n.stack:void 0,taskInfo:t?{path:t.path,title:t.title}:null}),new Error(`Cache update failed after ${3} attempts: ${a}`);console.warn(`Cache update attempt ${s} failed for ${e}, retrying:`,a),await new Promise(o=>setTimeout(o,Math.pow(2,s)*100))}}async rebuildDailyNotesCache(e,t){let r=new Set,s=this.vault.getMarkdownFiles(),n=(0,At.normalizePath)(this.dailyNotesPath);for(let a of s){let o=a.path;if(!(o.startsWith(n+"/")||o===n||n===""&&!o.includes("/")))continue;let d=(o.split("/").pop()||"").match(/^(\d{4})-(\d{2})-(\d{2})\.md$/);if(d){let u=parseInt(d[1]),f=parseInt(d[2])-1;if(u===e&&f===t){let h=`${u}-${String(f+1).padStart(2,"0")}-${d[3]}`;r.add(h),this.dailyNotes.add(h)}}}return r}async rebuildIndex(){this.clearAllCaches(),await this.initializeCache()}async getTaskInfoForDate(e,t=!1){return this.getTasksForDate(e,t)}async getAllContexts(){try{return await this.ensureInitialized(),Array.from(this.allContexts).sort()}catch(e){return console.error("Error getting all contexts:",e),[]}}async getAllTags(){try{return await this.ensureInitialized(),Array.from(this.allTags).sort()}catch(e){return console.error("Error getting all tags:",e),[]}}async getAllNotes(){try{return await this.ensureInitialized(),Array.from(this.noteInfoCache.values())}catch(e){return console.error("Error getting all notes:",e),[]}}async getTaskByPath(e){return await this.ensureInitialized(),this.taskInfoCache.has(e)?(this.stats.cacheHits++,this.taskInfoCache.get(e)):this.getTaskInfo(e,!1)}getTaskPathsByStatus(e){return this.tasksByStatus.get(e)||new Set}getTaskPathsByPriority(e){return this.tasksByPriority.get(e)||new Set}getTaskPathsByDate(e){return this.tasksByDate.get(e)||new Set}getTaskPathsByDueDate(e){let t=this.tasksByDate.get(e)||new Set,r=new Set;for(let s of t){let n=this.taskInfoCache.get(s);(n==null?void 0:n.due)===e&&r.add(s)}return r}getTaskPathsByScheduledDate(e){let t=this.tasksByDate.get(e)||new Set,r=new Set;for(let s of t){let n=this.taskInfoCache.get(s);(n==null?void 0:n.scheduled)===e&&r.add(s)}return r}getAllTaskPaths(){return new Set(this.taskInfoCache.keys())}getAllStatuses(){return Array.from(this.tasksByStatus.keys()).sort()}getAllPriorities(){return Array.from(this.tasksByPriority.keys()).sort()}getOverdueTaskPaths(){return new Set(this.overdueTasks)}updateOverdueTaskIndex(e,t){if(this.overdueTasks.delete(e),!t.recurrence){let r=Dr(),s=!1;t.due&&kr(t.due,r)&&(s=!0),!s&&t.scheduled&&kr(t.scheduled,r)&&(s=!0),s&&this.overdueTasks.add(e)}}rebuildOverdueTasksIndex(){this.overdueTasks.clear();for(let[e,t]of this.taskInfoCache)this.updateOverdueTaskIndex(e,t)}async yieldToMainThread(){return new Promise(e=>{setTimeout(()=>e(),0)})}getCachedTaskInfo(e){return this.taskInfoCache.get(e)||null}getAllTaskDates(){return Array.from(this.tasksByDate.keys()).sort()}hasTasksOnDate(e){let t=this.tasksByDate.get(e);return t!==void 0&&t.size>0}getTaskCountOnDate(e){let t=this.tasksByDate.get(e);return t?t.size:0}clearScheduledDateFromIndex(e,t){try{let r=ge(t),s=this.tasksByDate.get(r);s&&(s.delete(e),s.size===0&&this.tasksByDate.delete(r))}catch(r){console.error(`Error clearing scheduled date from index for ${e}:`,r)}}clearDueDateFromIndex(e,t){try{let r=ge(t),s=this.tasksByDate.get(r);s&&(s.delete(e),s.size===0&&this.tasksByDate.delete(r))}catch(r){console.error(`Error clearing due date from index for ${e}:`,r)}}getStats(){let e=this.stats.cacheHits+this.stats.cacheMisses;return{...this.stats,hitRatio:e>0?this.stats.cacheHits/e:0,tasksCached:this.taskInfoCache.size,notesCached:this.noteInfoCache.size,filesCached:this.fileContentCache.size,datesWithTasks:this.tasksByDate.size,memoryUsageMB:this.stats.memoryUsage/1024/1024,cacheEvictions:this.stats.cacheEvictions,indexSize:this.tasksByDate.size+this.notesByDate.size+this.tasksByStatus.size+this.tasksByPriority.size}}destroy(){this.eventHandlers.modify&&this.vault.off("modify",this.eventHandlers.modify),this.eventHandlers.delete&&this.vault.off("delete",this.eventHandlers.delete),this.eventHandlers.rename&&this.vault.off("rename",this.eventHandlers.rename),this.eventHandlers.create&&this.vault.off("create",this.eventHandlers.create),this.clearAllCaches(),this.subscribers.clear(),this.eventHandlers={},this.recentUpdates.clear(),this.delayedInitTimeout&&(clearTimeout(this.delayedInitTimeout),this.delayedInitTimeout=null)}},pt=Mt;pt.FILE_CACHE_TTL=2*60*1e3,pt.YAML_CACHE_TTL=5*60*1e3,pt.MAX_CACHE_SIZE=500,pt.MAX_TASK_CACHE_SIZE=1e3,pt.MAX_NOTE_CACHE_SIZE=2e3,pt.MAX_INDEX_SIZE=1e4,pt.MEMORY_WARNING_THRESHOLD=100*1024*1024,pt.CACHE_CLEANUP_INTERVAL=5*60*1e3,pt.RECENT_UPDATE_WINDOW=1e3;var Wc=class{constructor(){this.inFlightRequests=new Map;this.prefetchQueue=new Set;this.prefetchPromises=new Map;this.activeTimeouts=new Set}async execute(e,t,r=5e3){if(this.inFlightRequests.has(e))return this.inFlightRequests.get(e);let s=this.createRequest(e,t,r);return this.inFlightRequests.set(e,s),s}async createRequest(e,t,r){try{let s=await t(),n=setTimeout(()=>{this.inFlightRequests.delete(e),this.activeTimeouts.delete(n)},r);return this.activeTimeouts.add(n),s}catch(s){throw this.inFlightRequests.delete(e),s}}prefetch(e,t,r="low"){if(!(this.inFlightRequests.has(e)||this.prefetchPromises.has(e)))if(r==="high")this.executePrefetch(e,t);else if(this.prefetchQueue.add(e),"requestIdleCallback"in window)requestIdleCallback(()=>{this.processPrefetchQueue(e,t)});else{let s=setTimeout(()=>{this.processPrefetchQueue(e,t),this.activeTimeouts.delete(s)},50);this.activeTimeouts.add(s)}}async executePrefetch(e,t){try{let r=t();this.prefetchPromises.set(e,r),await r;let s=setTimeout(()=>{this.prefetchPromises.delete(e),this.activeTimeouts.delete(s)},3e4);this.activeTimeouts.add(s)}catch(r){this.prefetchPromises.delete(e)}}processPrefetchQueue(e,t){this.prefetchQueue.has(e)&&(this.prefetchQueue.delete(e),this.executePrefetch(e,t))}getPrefetchedData(e){return this.prefetchPromises.get(e)||null}cancel(e){this.inFlightRequests.delete(e),this.prefetchPromises.delete(e),this.prefetchQueue.delete(e)}cancelAll(){this.inFlightRequests.clear(),this.prefetchPromises.clear(),this.prefetchQueue.clear();for(let e of this.activeTimeouts)clearTimeout(e);this.activeTimeouts.clear()}getStats(){return{inFlightCount:this.inFlightRequests.size,prefetchCount:this.prefetchPromises.size,queuedCount:this.prefetchQueue.size}}},Uc=class{constructor(e){this.lastAccessTime=new Map;this.deduplicator=e}recordAccess(e,t,r){let s=this.getDateKey(e);this.lastAccessTime.set(s,Date.now()),this.prefetchAdjacentDates(e,t,r)}prefetchAdjacentDates(e,t,r){this.getAdjacentDates(e).forEach(({date:n,priority:a})=>{let o=`${t}-${this.getDateKey(n)}`;this.deduplicator.prefetch(o,()=>r(n),a)})}getAdjacentDates(e){let t=[],r=new Date(e);r.setDate(e.getDate()-1),t.push({date:r,priority:"high"});let s=new Date(e);s.setDate(e.getDate()+1),t.push({date:s,priority:"high"});for(let n=2;n<=7;n++){let a=new Date(e);a.setDate(e.getDate()-n),t.push({date:a,priority:"low"});let o=new Date(e);o.setDate(e.getDate()+n),t.push({date:o,priority:"low"})}return t}getDateKey(e){return e.toISOString().split("T")[0]}cleanup(){let e=Date.now(),t=24*60*60*1e3;for(let[r,s]of this.lastAccessTime)e-s>t&&this.lastAccessTime.delete(r)}};var nn=class{constructor(){this.updateQueue=[];this.isProcessing=!1;this.activeTimeouts=new Set}scheduleUpdate(e){this.updateQueue.push(e),this.isProcessing||(this.isProcessing=!0,requestAnimationFrame(()=>{this.processUpdates()}))}processUpdates(){let e=[...this.updateQueue];this.updateQueue=[];try{e.forEach(t=>{try{t()}catch(r){console.error("Error processing DOM update:",r)}})}finally{this.isProcessing=!1,this.updateQueue.length>0&&requestAnimationFrame(()=>{this.processUpdates()})}}updateAttributes(e,t){for(let[r,s]of Object.entries(t))s===null?e.removeAttribute(r):e.getAttribute(r)!==s&&e.setAttribute(r,s)}updateClasses(e,t){for(let[r,s]of Object.entries(t))s?e.classList.add(r):e.classList.remove(r)}updateTextContent(e,t){e.textContent!==t&&(e.textContent=t)}updateStyles(e,t){for(let[r,s]of Object.entries(t))s===null?e.style.removeProperty(r):e.style.setProperty(r,s)}preserveState(e){let t={scrollTop:e.scrollTop,scrollLeft:e.scrollLeft,focused:document.activeElement===e,selection:null};return(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)&&(t.selection={start:e.selectionStart||0,end:e.selectionEnd||0}),t}restoreState(e,t){e.scrollTop=t.scrollTop,e.scrollLeft=t.scrollLeft,t.focused&&e.focus(),t.selection&&(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)&&e.setSelectionRange(t.selection.start,t.selection.end)}animateUpdate(e,t,r=1500){e.classList.add(`task-${t}`);let s=setTimeout(()=>{e.classList.remove(`task-${t}`),this.activeTimeouts.delete(s)},r);this.activeTimeouts.add(s)}updateList(e,t,r,s,n){let a=new Map,o=new Set;Array.from(e.children).forEach(d=>{let u=d.dataset.key;u&&(a.set(u,d),o.add(u))});let l=new Set(t.map(r)),c=document.createDocumentFragment();t.forEach(d=>{let u=r(d),f=a.get(u);if(f)n&&n(f,d),c.appendChild(f);else{let h=s(d);h.dataset.key=u,c.appendChild(h)}}),o.forEach(d=>{if(!l.has(d)){let u=a.get(d);u&&u.parentNode&&u.remove()}}),e.replaceChildren(c)}createOptimisticUpdate(e,t,r){return t(e),{commit:()=>{},revert:()=>{r(e)}}}destroy(){this.updateQueue=[],this.isProcessing=!1;for(let e of this.activeTimeouts)clearTimeout(e);this.activeTimeouts.clear()}},$c=class{constructor(){this.stateMap=new Map}saveState(e,t){let r=new nn;this.stateMap.set(e,r.preserveState(t))}restoreState(e,t){let r=this.stateMap.get(e);r&&new nn().restoreState(t,r)}clearState(e){e?this.stateMap.delete(e):this.stateMap.clear()}destroy(){this.stateMap.clear()}};Mu();Md();Ad();var vs=require("obsidian");Me();ra();_e();rr();var Vc=class{constructor(e){this.plugin=e}async createTask(e){try{if(!e.title||!e.title.trim())throw new Error("Title is required");if(e.title.length>200)throw new Error("Title is too long (max 200 characters)");let t=e.title.trim(),r=e.priority||this.plugin.settings.defaultTaskPriority,s=e.status||this.plugin.settings.defaultTaskStatus,n=e.dateCreated||we(),a=e.dateModified||we(),o=e.contexts||[],l=e.tags||[this.plugin.settings.taskTag];l.includes(this.plugin.settings.taskTag)||l.unshift(this.plugin.settings.taskTag);let c={title:t,priority:r,status:s,date:new Date},d=_c(c,this.plugin.settings),u=this.plugin.settings.taskCreationDefaults.defaultFolder,f=u&&u.trim()?u.trim():this.plugin.settings.tasksFolder||"";f&&await Pi(this.plugin.app.vault,f);let h=await ww(d,f,this.plugin.app.vault),m=f?`${f}/${h}.md`:`${h}.md`,p={title:t,status:s,priority:r,due:e.due||void 0,scheduled:e.scheduled||void 0,contexts:o.length>0?o:void 0,timeEstimate:e.timeEstimate&&e.timeEstimate>0?e.timeEstimate:void 0,dateCreated:n,dateModified:a,recurrence:e.recurrence||void 0},g=this.plugin.fieldMapper.mapToFrontmatter(p,this.plugin.settings.taskTag);g.tags=l;let w=`---
${ta(g)}---

`;e.details&&e.details.trim()&&(w+=`${e.details.trim()}

`);let _=await this.plugin.app.vault.create(m,w),E={...g,path:_.path,tags:l,archived:!1};return await this.plugin.cacheManager.updateTaskInfoInCache(_.path,E),this.plugin.emitter.emit(Ae,{path:_.path,updatedTask:E}),{file:_,taskInfo:E}}catch(t){let r=t instanceof Error?t.message:String(t);throw console.error("Error creating task:",{error:r,stack:t instanceof Error?t.stack:void 0,taskData:e}),new Error(`Failed to create task: ${r}`)}}async toggleStatus(e){try{let r=this.plugin.statusManager.isCompletedStatus(e.status)?this.plugin.settings.defaultTaskStatus:this.plugin.statusManager.getCompletedStatuses()[0]||"done";return await this.updateProperty(e,"status",r)}catch(t){let r=t instanceof Error?t.message:String(t);throw console.error("Error toggling task status:",{error:r,stack:t instanceof Error?t.stack:void 0,taskPath:e.path,currentStatus:e.status}),new Error(`Failed to toggle task status: ${r}`)}}async updateProperty(e,t,r,s={}){try{let n=this.plugin.app.vault.getAbstractFileByPath(e.path);if(!(n instanceof vs.TFile))throw new Error(`Cannot find task file: ${e.path}`);let a=await this.plugin.cacheManager.getTaskInfo(e.path,!0)||e,o={...a};o[t]=r,o.dateModified=we(),t==="status"&&!a.recurrence&&(this.plugin.statusManager.isCompletedStatus(r)?o.completedDate=aa():o.completedDate=void 0),await this.plugin.app.fileManager.processFrontMatter(n,l=>{let c=this.plugin.fieldMapper.toUserField(t);if(t==="status"){if(l[c]=r,!e.recurrence){let u=this.plugin.fieldMapper.toUserField("completedDate");this.plugin.statusManager.isCompletedStatus(r)?l[u]=aa():l[u]&&delete l[u]}}else(t==="due"||t==="scheduled")&&!r?delete l[c]:l[c]=r;let d=this.plugin.fieldMapper.toUserField("dateModified");l[d]=o.dateModified});try{await this.plugin.cacheManager.updateTaskInfoInCache(e.path,o)}catch(l){console.error("Error updating task cache:",{error:l instanceof Error?l.message:String(l),taskPath:e.path})}try{this.plugin.emitter.emit(Ae,{path:e.path,originalTask:e,updatedTask:o})}catch(l){console.error("Error emitting task update event:",{error:l instanceof Error?l.message:String(l),taskPath:e.path})}return o}catch(n){let a=n instanceof Error?n.message:String(n);throw console.error("Error updating task property:",{error:a,stack:n instanceof Error?n.stack:void 0,taskPath:e.path,property:String(t),value:r}),new Error(`Failed to update task property: ${a}`)}}async toggleArchive(e){let t=this.plugin.app.vault.getAbstractFileByPath(e.path);if(!(t instanceof vs.TFile))throw new Error(`Cannot find task file: ${e.path}`);let r=this.plugin.fieldMapper.getMapping().archiveTag,s=e.archived,n={...e};return n.archived=!s,n.dateModified=we(),n.tags||(n.tags=[]),s?n.tags=n.tags.filter(a=>a!==r):n.tags.includes(r)||(n.tags=[...n.tags,r]),await this.plugin.app.fileManager.processFrontMatter(t,a=>{let o=this.plugin.fieldMapper.toUserField("dateModified");s?a.tags&&Array.isArray(a.tags)&&(a.tags=a.tags.filter(l=>l!==r),a.tags.length===0&&delete a.tags):(a.tags?Array.isArray(a.tags)||(a.tags=[a.tags]):a.tags=[],a.tags.includes(r)||a.tags.push(r)),a[o]=n.dateModified}),await this.plugin.cacheManager.updateTaskInfoInCache(e.path,n),this.plugin.emitter.emit(Ae,{path:e.path,originalTask:e,updatedTask:n}),n}async startTimeTracking(e){let t=this.plugin.app.vault.getAbstractFileByPath(e.path);if(!(t instanceof vs.TFile))throw new Error(`Cannot find task file: ${e.path}`);if(this.plugin.getActiveTimeSession(e))throw new Error("Time tracking is already active for this task");let s={...e};s.dateModified=we(),s.timeEntries||(s.timeEntries=[]);let n={startTime:we(),description:"Work session"};return s.timeEntries=[...s.timeEntries,n],await this.plugin.app.fileManager.processFrontMatter(t,a=>{let o=this.plugin.fieldMapper.toUserField("timeEntries"),l=this.plugin.fieldMapper.toUserField("dateModified");a[o]||(a[o]=[]),a[o].push(n),a[l]=s.dateModified}),await this.plugin.cacheManager.updateTaskInfoInCache(e.path,s),this.plugin.emitter.emit(Ae,{path:e.path,originalTask:e,updatedTask:s}),s}async stopTimeTracking(e){let t=this.plugin.app.vault.getAbstractFileByPath(e.path);if(!(t instanceof vs.TFile))throw new Error(`Cannot find task file: ${e.path}`);let r=this.plugin.getActiveTimeSession(e);if(!r)throw new Error("No active time tracking session for this task");let s={...e};if(s.dateModified=we(),s.timeEntries&&Array.isArray(s.timeEntries)){let n=s.timeEntries.findIndex(a=>a.startTime===r.startTime&&!a.endTime);n!==-1&&(s.timeEntries=[...s.timeEntries],s.timeEntries[n]={...s.timeEntries[n],endTime:we()})}return await this.plugin.app.fileManager.processFrontMatter(t,n=>{let a=this.plugin.fieldMapper.toUserField("timeEntries"),o=this.plugin.fieldMapper.toUserField("dateModified");if(n[a]&&Array.isArray(n[a])){let l=n[a].findIndex(c=>c.startTime===r.startTime&&!c.endTime);l!==-1&&(n[a][l].endTime=we())}n[o]=s.dateModified}),await this.plugin.cacheManager.updateTaskInfoInCache(e.path,s),this.plugin.emitter.emit(Ae,{path:e.path,originalTask:e,updatedTask:s}),s}async updateTask(e,t){try{let r=this.plugin.app.vault.getAbstractFileByPath(e.path);if(!(r instanceof vs.TFile))throw new Error(`Cannot find task file: ${e.path}`);let s={...e,...t};s.dateModified=we(),t.status!==void 0&&!e.recurrence&&(this.plugin.statusManager.isCompletedStatus(t.status)?e.completedDate||(s.completedDate=aa()):s.completedDate=void 0),e.complete_instances&&(s.complete_instances=e.complete_instances),await this.plugin.app.fileManager.processFrontMatter(r,n=>{let a={...e,...t,dateModified:s.dateModified};t.status!==void 0&&!e.recurrence&&(this.plugin.statusManager.isCompletedStatus(t.status)?e.completedDate||(a.completedDate=aa()):a.completedDate=void 0);let o=this.plugin.fieldMapper.mapToFrontmatter(a,this.plugin.settings.taskTag);Object.keys(o).forEach(l=>{o[l]!==void 0&&(n[l]=o[l])}),t.hasOwnProperty("due")&&t.due===void 0&&delete n[this.plugin.fieldMapper.toUserField("due")],t.hasOwnProperty("scheduled")&&t.scheduled===void 0&&delete n[this.plugin.fieldMapper.toUserField("scheduled")],t.hasOwnProperty("contexts")&&t.contexts===void 0&&delete n[this.plugin.fieldMapper.toUserField("contexts")],t.hasOwnProperty("timeEstimate")&&t.timeEstimate===void 0&&delete n[this.plugin.fieldMapper.toUserField("timeEstimate")],t.hasOwnProperty("completedDate")&&t.completedDate===void 0&&delete n[this.plugin.fieldMapper.toUserField("completedDate")],t.hasOwnProperty("recurrence")&&t.recurrence===void 0&&delete n[this.plugin.fieldMapper.toUserField("recurrence")],t.hasOwnProperty("tags")?n.tags=t.tags:e.tags&&(n.tags=e.tags)});try{await this.plugin.cacheManager.updateTaskInfoInCache(e.path,s)}catch(n){console.error("Error updating task cache:",{error:n instanceof Error?n.message:String(n),taskPath:e.path})}try{this.plugin.emitter.emit(Ae,{path:e.path,originalTask:e,updatedTask:s})}catch(n){console.error("Error emitting task update event:",{error:n instanceof Error?n.message:String(n),taskPath:e.path})}return s}catch(r){let s=r instanceof Error?r.message:String(r);throw console.error("Error updating task:",{error:s,stack:r instanceof Error?r.stack:void 0,taskPath:e.path,updates:t}),new Error(`Failed to update task: ${s}`)}}async deleteTask(e){try{let t=this.plugin.app.vault.getAbstractFileByPath(e.path);if(!(t instanceof vs.TFile))throw new Error(`Cannot find task file: ${e.path}`);await this.plugin.app.vault.delete(t),this.plugin.cacheManager.clearCacheEntry(e.path),this.plugin.emitter.emit(Ig,{path:e.path,deletedTask:e})}catch(t){let r=t instanceof Error?t.message:String(t);throw console.error("Error deleting task:",{error:r,stack:t instanceof Error?t.stack:void 0,taskPath:e.path}),new Error(`Failed to delete task: ${r}`)}}async toggleRecurringTaskComplete(e,t){let r=this.plugin.app.vault.getAbstractFileByPath(e.path);if(!(r instanceof vs.TFile))throw new Error(`Cannot find task file: ${e.path}`);if(!e.recurrence)throw new Error("Task is not recurring");let s=t||this.plugin.selectedDate,n=k(s,"yyyy-MM-dd"),a=Array.isArray(e.complete_instances)?e.complete_instances:[],l=!a.includes(n),c={...e};return c.dateModified=we(),l?a.includes(n)||(c.complete_instances=[...a,n]):c.complete_instances=a.filter(d=>d!==n),await this.plugin.app.fileManager.processFrontMatter(r,d=>{let u=this.plugin.fieldMapper.toUserField("completeInstances"),f=this.plugin.fieldMapper.toUserField("dateModified");d[u]||(d[u]=[]);let h=d[u];l?h.includes(n)||(d[u]=[...h,n]):d[u]=h.filter(m=>m!==n),d[f]=c.dateModified}),await this.plugin.cacheManager.updateTaskInfoInCache(e.path,c),this.plugin.emitter.emit(Ae,{path:e.path,originalTask:e,updatedTask:c}),c}};var zc=class extends fr{constructor(){super();this.filterState={};this.storageKey="tasknotes-view-filter-state";this.loadFromStorage()}getFilterState(t){return this.filterState[t]}setFilterState(t,r){this.filterState[t]={...r},this.saveToStorage(),this.emit("filter-state-changed",{viewType:t,query:r})}clearFilterState(t){delete this.filterState[t],this.saveToStorage(),this.emit("filter-state-cleared",{viewType:t})}clearAllFilterStates(){this.filterState={},this.saveToStorage(),this.emit("all-filter-states-cleared")}loadFromStorage(){try{let t=localStorage.getItem(this.storageKey);t&&(this.filterState=JSON.parse(t))}catch(t){console.warn("Failed to load view filter state from storage:",t),this.filterState={}}}saveToStorage(){try{localStorage.setItem(this.storageKey,JSON.stringify(this.filterState))}catch(t){console.warn("Failed to save view filter state to storage:",t)}}getAllFilterStates(){return{...this.filterState}}cleanup(){this.removeAllListeners()}};jc();var ln=require("@codemirror/state"),Pt=require("@codemirror/view"),qc=require("obsidian");ip();var Mw=require("@codemirror/view"),an=require("obsidian");_e();var on=class extends Mw.WidgetType{constructor(t,r,s,n){super();this.taskInfo=t,this.plugin=r,this.originalText=s,this.displayText=n}toDOM(t){let r=document.createElement("span"),s=["tasknotes-plugin","task-inline-preview"];this.taskInfo.priority&&s.push(`task-inline-preview--priority-${this.taskInfo.priority}`),this.plugin.statusManager.isCompletedStatus(this.taskInfo.status)&&s.push("task-inline-preview--completed"),r.className=s.join(" ");let n=this.taskInfo.title.length>80?this.taskInfo.title.slice(0,77)+"...":this.taskInfo.title,a=r.createEl("span",{cls:"task-inline-preview__title",text:n}),o=this.plugin.statusManager.getStatusConfig(this.taskInfo.status),l=(o==null?void 0:o.color)||"#666";if(r.createEl("span",{cls:"task-inline-preview__status-dot",text:"\u25CF",attr:{title:`Status: ${this.taskInfo.status}`}}).style.setProperty("--status-color",l),this.taskInfo.priority){let u=this.plugin.priorityManager.getPriorityConfig(this.taskInfo.priority);u&&r.createEl("span",{cls:"task-inline-preview__priority-dot",text:"\u25CF",attr:{title:`Priority: ${u.label}`}}).style.setProperty("--priority-color",u.color)}if(this.taskInfo.due){let u=$e(this.taskInfo.due,{dateFormat:"MMM d",timeFormat:"h:mm a",showTime:!0}),f=$e(this.taskInfo.due,{dateFormat:"MMM d, yyyy",timeFormat:"h:mm a",showTime:!0}),h=r.createEl("span",{cls:"task-inline-preview__date task-inline-preview__date--due",attr:{title:`Due: ${f}`}}),m=h.createEl("span",{cls:"task-inline-preview__date-icon"});(0,an.setIcon)(m,"calendar"),h.appendText(u)}if(this.taskInfo.scheduled&&(!this.taskInfo.due||this.taskInfo.scheduled!==this.taskInfo.due)){let u=$e(this.taskInfo.scheduled,{dateFormat:"MMM d",timeFormat:"h:mm a",showTime:!0}),f=$e(this.taskInfo.scheduled,{dateFormat:"MMM d, yyyy",timeFormat:"h:mm a",showTime:!0}),h=r.createEl("span",{cls:"task-inline-preview__date task-inline-preview__date--scheduled",attr:{title:`Scheduled: ${f}`}}),m=h.createEl("span",{cls:"task-inline-preview__date-icon"});(0,an.setIcon)(m,"clock"),h.appendText(u)}let d=r.createEl("span",{cls:"task-inline-preview__pencil",attr:{title:"Task options"},text:""});return(0,an.setIcon)(d,"pencil"),r.dataset.taskPath=this.taskInfo.path,r.dataset.originalText=this.originalText,this.addDragHandlers(r),r.addEventListener("click",async u=>{u.preventDefault(),u.stopPropagation();let f=u.target;if(f===d||d.contains(f)||f.closest(".task-inline-preview__pencil")){this.showTaskContextMenu(u,r);return}if(u.ctrlKey||u.metaKey){let h=this.plugin.app.vault.getAbstractFileByPath(this.taskInfo.path);h instanceof an.TFile&&this.plugin.app.workspace.getLeaf(!1).openFile(h)}else{let h=await this.plugin.cacheManager.getTaskInfo(this.taskInfo.path,!0);await this.plugin.openTaskEditModal(h||this.taskInfo)}}),r.addEventListener("contextmenu",async u=>{u.preventDefault(),u.stopPropagation(),await this.showTaskContextMenu(u,r)}),r.addEventListener("mouseover",u=>{this.plugin.app.vault.getAbstractFileByPath(this.taskInfo.path)&&this.plugin.app.workspace.trigger("hover-link",{event:u,source:"tasknotes-task-card",hoverParent:r,targetEl:r,linktext:this.taskInfo.path,sourcePath:this.taskInfo.path})}),r}addDragHandlers(t){this.plugin.dragDropManager.makeTaskCardDraggable(t,this.taskInfo.path)}async showTaskContextMenu(t,r){try{let{showTaskContextMenu:s}=await Promise.resolve().then(()=>(en(),Ew)),n=this.plugin.selectedDate||new Date;await s(t,this.taskInfo.path,this.plugin,n)}catch(s){console.error(`Error showing context menu for task ${this.taskInfo.path}:`,s);let n=await this.plugin.cacheManager.getTaskInfo(this.taskInfo.path,!0);await this.plugin.openTaskEditModal(n||this.taskInfo)}}eq(t){return t instanceof on?this.taskInfo.path===t.taskInfo.path&&this.taskInfo.status===t.taskInfo.status&&this.taskInfo.title===t.taskInfo.title&&this.taskInfo.priority===t.taskInfo.priority&&this.taskInfo.archived===t.taskInfo.archived&&this.taskInfo.due===t.taskInfo.due&&this.taskInfo.scheduled===t.taskInfo.scheduled&&this.taskInfo.dateModified===t.taskInfo.dateModified:!1}ignoreEvent(){return!1}get estimatedHeight(){return-1}get block(){return!1}};var Aw=ln.StateEffect.define();function V_(i){let e=new Map;return ln.StateField.define({create(t){return Pt.Decoration.none},update(t,r){if(!i||!r)return Pt.Decoration.none;if(!r.state)return console.warn("Invalid transaction state in task link overlay update"),Pt.Decoration.none;if(!i.settings||!i.settings.enableTaskLinkOverlay)return Pt.Decoration.none;try{if(!r.state.field(qc.editorLivePreviewField))return Pt.Decoration.none}catch(s){return console.debug("Error checking live preview mode:",s),Pt.Decoration.none}try{let s=r.effects.some(n=>n.is(Aw));return r.docChanged||s?(s&&e.clear(),z_(r.state,i,e)):t!==Pt.Decoration.none?t.map(r.changes):t}catch(s){return console.error("Error updating task link overlay decorations:",s),Pt.Decoration.none}},provide(t){return Pt.EditorView.decorations.from(t)}})}function z_(i,e,t){var l;let r=new ln.RangeSetBuilder;if(!i||!e||!t)return console.warn("Invalid inputs for building task link decorations"),r.finish();let s=i.doc;if(!s)return console.warn("Invalid document state"),r.finish();if(!e.app||!e.app.workspace)return console.warn("Plugin app or workspace not available"),r.finish();let n=e.taskLinkDetectionService||new ro(e),a=e.app.workspace.getActiveViewOfType(qc.MarkdownView);if(!a)return r.finish();let o=(l=a.file)==null?void 0:l.path;if(!o)return r.finish();if(typeof o!="string"||o.length===0)return console.warn("Invalid current file path"),r.finish();try{let c=s.toString();if(typeof c!="string")return console.warn("Invalid document text"),r.finish();if(c.length>1e5)return console.warn("Document too large for task link processing, skipping"),r.finish();let d=n.findWikilinks(c);if(!Array.isArray(d))return console.warn("Invalid wikilinks result from detection service"),r.finish();for(let u of d)try{if(!u||typeof u.match!="string"||typeof u.start!="number"||typeof u.end!="number"){console.debug("Invalid wikilink object:",u);continue}if(u.start<0||u.end<=u.start||u.start>=c.length||u.end>c.length){console.debug("Invalid wikilink positions:",u.start,u.end);continue}let f=j_(u.match);if(!f)continue;let{linkPath:h}=f;if(!h||typeof h!="string"||h.trim().length===0){console.debug("Invalid link path:",h);continue}let m=q_(h,o,e);if(!m)continue;let p=Y_(m,e);if(p){if(!p.title||typeof p.title!="string"){console.debug("Invalid task info for:",m);continue}let g=`${m}-${u.start}-${u.end}`,v=t.get(g),w=new on(p,e,u.match,f.displayText);(!v||!v.eq(w))&&(v=w,t.set(g,v));let _=Pt.Decoration.replace({widget:v,inclusive:!0});r.add(u.start,u.end,_)}}catch(f){console.debug("Error processing wikilink:",u.match,f);continue}}catch(c){console.error("Error in buildTaskLinkDecorations:",c)}return r.finish()}function j_(i){if(!i||typeof i!="string"||i.length<4||!i.startsWith("[[")||!i.endsWith("]]"))return null;let e=i.slice(2,-2).trim();if(!e||e.length===0)return null;if(e.length>500)return console.debug("Wikilink content too long, skipping:",e.length),null;let t=e.indexOf("|");if(t!==-1){let r=e.slice(0,t).trim(),s=e.slice(t+1).trim();return!r||!s?null:{linkPath:r,displayText:s}}return{linkPath:e}}function q_(i,e,t){if(!i||typeof i!="string"||i.trim().length===0||!e||typeof e!="string"||!t||!t.app||!t.app.metadataCache)return null;try{let r=i.replace(/\.\./g,"").trim();if(!r)return null;let s=t.app.metadataCache.getFirstLinkpathDest(r,e);return!s||!s.path||typeof s.path!="string"?null:s.path}catch(r){return console.debug("Error resolving link path:",i,r),null}}function Y_(i,e){if(!i||typeof i!="string"||i.trim().length===0||!e)return null;try{if(i.length>260)return console.debug("File path too long:",i.length),null;if(/[<>:"|?*\x00-\x1f\x7f]/.test(i))return console.debug("File path contains invalid characters:",i),null;let r=e.cacheManager;if(!r||!r.getCachedTaskInfo)return null;let s=r.getCachedTaskInfo(i);return s&&typeof s=="object"&&s.title?s:null}catch(t){return console.debug("Error getting task info for:",i,t),null}}function Iw(i){return V_(i)}function Pw(i,e){i.dispatch({effects:[Aw.of({taskPath:e})]})}var Yc=class{constructor(e){this.draggableInstances=new Map;this.plugin=e}makeTaskCardDraggable(e,t){if(this.draggableInstances.has(e))return;e.dataset.taskPath=t;let r=new Sc(e);this.draggableInstances.set(e,r),e.style.cursor="grab",e.addEventListener("dragstart",s=>{e.classList.add("task-card--dragging"),s.dataTransfer&&(s.dataTransfer.setData("text/plain",t),s.dataTransfer.setData("application/x-task-path",t),s.dataTransfer.effectAllowed="copy")}),e.addEventListener("dragend",()=>{e.classList.remove("task-card--dragging")})}removeDraggable(e){let t=this.draggableInstances.get(e);t&&(t.destroy(),this.draggableInstances.delete(e))}destroy(){this.draggableInstances.forEach(e=>{e.destroy()}),this.draggableInstances.clear()}};var io=class extends ne.Plugin{constructor(){super(...arguments);this.selectedDate=new Date;this.emitter=new fr;this.taskUpdateListenerForEditor=null}async onload(){this.readyPromise=new Promise(n=>{this.resolveReady=n}),await this.loadSettings(),this.fieldMapper=new Ai(this.settings.fieldMapping),this.statusManager=new Br(this.settings.customStatuses),this.priorityManager=new vr(this.settings.customPriorities),this.requestDeduplicator=new Wc,this.predictivePrefetcher=new Uc(this.requestDeduplicator),this.domReconciler=new nn,this.uiStateManager=new $c,this.cacheManager=new pt(this.app.vault,this.settings.taskTag,this.settings.excludedFolders,this.settings.dailyNotesFolder,this.settings.dailyNoteTemplate,this.fieldMapper),await sr.measure("cache-initialization",async()=>{await this.cacheManager.initializeCache()}),this.cacheManager.subscribe("cache-initialized",n=>{n.taskCount>0&&this.notifyDataChanged()}),this.taskService=new Vc(this),this.filterService=new Or(this.cacheManager,this.statusManager,this.priorityManager),this.filterService.initialize(),this.viewStateManager=new zc,this.pomodoroService=new Bc(this),await this.pomodoroService.initialize(),this.dragDropManager=new Yc(this),this.injectCustomStyles(),this.registerView(Wr,n=>new ca(n,this)),this.registerView(_s,n=>new Mc(n,this)),this.registerView(xs,n=>new Ac(n,this)),this.registerView(Dn,n=>new Rc(n,this)),this.registerView(Ms,n=>new rn(n,this)),this.registerView(Sn,n=>new Lc(n,this)),this.registerView(Cn,n=>new Fc(n,this)),this.registerView(As,n=>new Hc(n,this));let{TaskLinkDetectionService:t}=await Promise.resolve().then(()=>(ip(),xw));this.taskLinkDetectionService=new t(this);let{InstantTaskConvertService:r}=await Promise.resolve().then(()=>(Nw(),Rw));this.instantTaskConvertService=new r(this),this.registerEditorExtension(Iw(this));let{createInstantConvertButtons:s}=await Promise.resolve().then(()=>(Fw(),Lw));this.registerEditorExtension(s(this)),this.taskUpdateListenerForEditor=this.emitter.on(Ae,n=>{this.app.workspace.iterateRootLeaves(a=>{if(a.view.getViewType()==="markdown"){let o=a.view.editor;o&&o.cm&&Pw(o.cm,n==null?void 0:n.path)}})}),this.addRibbonIcon("calendar-days","Open calendar",async()=>{await this.activateCalendarView()}),this.addCommands(),this.addSettingTab(new Eo(this.app,this)),this.resolveReady()}async onReady(){if(!this.readyPromise)throw new Error("Plugin not yet initialized");await this.readyPromise}setSelectedDate(t){this.selectedDate=t,this.emitter.emit(Ur,t)}notifyDataChanged(t,r=!1,s=!0){t?(this.cacheManager.clearCacheEntry(t),st.clearCacheEntry(t),this.taskLinkDetectionService&&this.taskLinkDetectionService.clearCacheForFile(t)):r&&(this.cacheManager.clearAllCaches(),this.taskLinkDetectionService&&this.taskLinkDetectionService.clearCache()),s&&requestAnimationFrame(()=>{this.emitter.emit(tt)})}onunload(){let t=sr.getStats("cache-initialization");t&&t.count>0&&sr.logSummary(),this.pomodoroService&&this.pomodoroService.cleanup(),this.filterService&&this.filterService.cleanup(),this.taskLinkDetectionService&&this.taskLinkDetectionService.cleanup(),this.dragDropManager&&this.dragDropManager.destroy(),this.viewStateManager&&this.viewStateManager.cleanup(),this.cacheManager&&this.cacheManager.destroy(),this.requestDeduplicator&&this.requestDeduplicator.cancelAll(),this.domReconciler&&this.domReconciler.destroy(),this.uiStateManager&&this.uiStateManager.destroy(),typeof sr!="undefined"&&sr.destroy(),this.taskUpdateListenerForEditor&&this.taskUpdateListenerForEditor(),this.emitter.removeAllListeners()}async loadSettings(){let t=await this.loadData();this.settings={...mi,...t,fieldMapping:{...mi.fieldMapping,...(t==null?void 0:t.fieldMapping)||{}},customStatuses:(t==null?void 0:t.customStatuses)||mi.customStatuses,customPriorities:(t==null?void 0:t.customPriorities)||mi.customPriorities},Object.keys(mi.fieldMapping).some(s=>{var n;return!((n=t==null?void 0:t.fieldMapping)!=null&&n[s])})&&await this.saveData(this.settings)}async saveSettings(){await this.saveData(this.settings),this.fieldMapper&&this.fieldMapper.updateMapping(this.settings.fieldMapping),this.statusManager&&this.statusManager.updateStatuses(this.settings.customStatuses),this.priorityManager&&this.priorityManager.updatePriorities(this.settings.customPriorities),this.cacheManager.updateConfig(this.settings.taskTag,this.settings.excludedFolders,this.settings.dailyNotesFolder,this.settings.dailyNoteTemplate,this.fieldMapper),this.injectCustomStyles(),this.notifyDataChanged()}addCommands(){this.addCommand({id:"open-calendar-view",name:"Open mini calendar view",callback:async()=>{await this.activateCalendarView()}}),this.addCommand({id:"open-advanced-calendar-view",name:"Open advanced calendar view",callback:async()=>{await this.activateAdvancedCalendarView()}}),this.addCommand({id:"open-tasks-view",name:"Open tasks view",callback:async()=>{await this.activateTasksView()}}),this.addCommand({id:"open-notes-view",name:"Open notes view",callback:async()=>{await this.activateNotesView()}}),this.addCommand({id:"open-agenda-view",name:"Open agenda view",callback:async()=>{await this.activateAgendaView()}}),this.addCommand({id:"open-pomodoro-view",name:"Open pomodoro timer",callback:async()=>{await this.activatePomodoroView()}}),this.addCommand({id:"open-kanban-view",name:"Open kanban board",callback:async()=>{await this.activateKanbanView()}}),this.addCommand({id:"open-pomodoro-stats",name:"Open pomodoro statistics",callback:async()=>{await this.activatePomodoroStatsView()}}),this.addCommand({id:"create-new-task",name:"Create new task",callback:()=>{this.openTaskCreationModal()}}),this.addCommand({id:"convert-to-tasknote",name:"Convert task to TaskNote",editorCallback:t=>{this.convertTaskToTaskNote(t)}}),this.addCommand({id:"go-to-today",name:"Go to today's note",callback:async()=>{await this.navigateToCurrentDailyNote()}}),this.addCommand({id:"start-pomodoro",name:"Start pomodoro timer",callback:async()=>{await this.pomodoroService.startPomodoro()}}),this.addCommand({id:"stop-pomodoro",name:"Stop pomodoro timer",callback:async()=>{await this.pomodoroService.stopPomodoro()}}),this.addCommand({id:"pause-pomodoro",name:"Pause/resume pomodoro timer",callback:async()=>{let t=this.pomodoroService.getState();t.isRunning?await this.pomodoroService.pausePomodoro():t.currentSession&&await this.pomodoroService.resumePomodoro()}}),this.addCommand({id:"refresh-cache",name:"Refresh TaskNotes cache",callback:async()=>{await this.refreshCache()}})}async activateView(t){let{workspace:r}=this.app,s=this.getLeafOfType(t);return s||(s=r.getLeaf("tab"),await s.setViewState({type:t,active:!0})),r.setActiveLeaf(s,{focus:!0}),r.revealLeaf(s),s}async activateCalendarView(){return this.activateView(Wr)}async activateAdvancedCalendarView(){return this.activateView(_s)}async activateTasksView(){return this.activateView(xs)}async activateNotesView(){return this.activateView(Dn)}async activateAgendaView(){return this.activateView(Ms)}async activatePomodoroView(){return this.activateView(Sn)}async activatePomodoroStatsView(){return this.activateView(Cn)}async activateKanbanView(){return this.activateView(As)}getLeafOfType(t){let{workspace:r}=this.app,s=r.getLeavesOfType(t);return s.length>0?s[0]:null}getCalendarLeaf(){return this.getLeafOfType(Wr)}async navigateToCurrentDailyNote(){let t=new Date;await this.navigateToDailyNote(t)}async navigateToDailyNote(t){let r=k(t,"yyyy-MM-dd")+".md",s=(0,ne.normalizePath)(`${this.settings.dailyNotesFolder}/${r}`),n=this.app.vault.getAbstractFileByPath(s),a=!1;if(!n)try{await Pi(this.app.vault,this.settings.dailyNotesFolder);let l=await this.generateDailyNoteTemplate(t);await this.app.vault.create(s,l),a=!0}catch(l){let c=l instanceof Error?l.message:String(l);console.error("Failed to create daily note:",{error:c,path:s,date:k(t,"yyyy-MM-dd")}),new ne.Notice(`Failed to create daily note: ${c}`);return}let o=this.app.vault.getAbstractFileByPath(s);if(o instanceof ne.TFile&&(await this.app.workspace.getLeaf(!1).openFile(o),a)){let l=t.getFullYear(),c=t.getMonth();try{await this.cacheManager.rebuildDailyNotesCache(l,c),this.notifyDataChanged(s,!1,!0)}catch(d){console.error("Error rebuilding daily notes cache:",d)}}}async generateDailyNoteTemplate(t){if(this.settings.dailyNoteTemplate&&this.settings.dailyNoteTemplate.trim())try{let r=(0,ne.normalizePath)(this.settings.dailyNoteTemplate.trim());r.endsWith(".md")||(r+=".md");let s=this.app.vault.getAbstractFileByPath(r);if(s instanceof ne.TFile){let n=await this.app.vault.read(s);return Lu(t,n)}else new ne.Notice(`Daily note template not found: ${r}`)}catch(r){console.error("Error reading daily note template:",r),new ne.Notice(`Error reading daily note template: ${this.settings.dailyNoteTemplate}`)}return Lu(t)}injectCustomStyles(){let t=document.getElementById("tasknotes-custom-styles");t&&t.remove();let r=this.statusManager.getStatusStyles(),s=this.priorityManager.getPriorityStyles(),n=document.createElement("style");n.id="tasknotes-custom-styles",n.textContent=`
		${r}
		${s}
	`,document.head.appendChild(n)}async updateTaskProperty(t,r,s,n={}){try{let a=await this.taskService.updateProperty(t,r,s,n);if(!n.silent)if(r==="status"){let o=this.statusManager.getStatusConfig(s);new ne.Notice(`Task marked as '${(o==null?void 0:o.label)||s}'`)}else new ne.Notice(`Task ${r} updated`);return a}catch(a){throw console.error(`Failed to update task ${r}:`,a),new ne.Notice(`Failed to update task ${r}`),a}}async toggleRecurringTaskComplete(t,r){var s;try{let n=r||this.selectedDate,a=await this.taskService.toggleRecurringTaskComplete(t,r),o=k(n,"yyyy-MM-dd"),c=((s=a.complete_instances)==null?void 0:s.includes(o))?"completed":"marked incomplete";return new ne.Notice(`Recurring task ${c} for ${k(n,"MMM d")}`),a}catch(n){throw console.error("Failed to toggle recurring task completion:",n),new ne.Notice("Failed to update recurring task"),n}}async toggleTaskArchive(t){try{let r=await this.taskService.toggleArchive(t),s=r.archived?"archived":"unarchived";return new ne.Notice(`Task ${s}`),r}catch(r){throw console.error("Failed to toggle task archive:",r),new ne.Notice("Failed to update task archive status"),r}}async toggleTaskStatus(t){try{let r=await this.taskService.toggleStatus(t),s=this.statusManager.getStatusConfig(r.status);return new ne.Notice(`Task marked as '${(s==null?void 0:s.label)||r.status}'`),r}catch(r){throw console.error("Failed to toggle task status:",r),new ne.Notice("Failed to update task status"),r}}openTaskCreationModal(t){new ni(this.app,this,t).open()}async startTimeTracking(t,r){try{let s=await this.taskService.startTimeTracking(t);return new ne.Notice("Time tracking started"),s}catch(s){throw console.error("Failed to start time tracking:",s),s.message==="Time tracking is already active for this task"?new ne.Notice("Time tracking is already active for this task"):new ne.Notice("Failed to start time tracking"),s}}async stopTimeTracking(t){try{let r=await this.taskService.stopTimeTracking(t);return new ne.Notice("Time tracking stopped"),r}catch(r){throw console.error("Failed to stop time tracking:",r),r.message==="No active time tracking session for this task"?new ne.Notice("No active time tracking session for this task"):new ne.Notice("Failed to stop time tracking"),r}}getActiveTimeSession(t){return Vy(t.timeEntries||[])}isRecurringTaskCompleteForDate(t,r){if(!t.recurrence)return!1;let s=k(r,"yyyy-MM-dd");return(Array.isArray(t.complete_instances)?t.complete_instances:[]).includes(s)}formatTime(t){return zy(t)}async openTaskEditModal(t){let s=await this.cacheManager.getTaskInfo(t.path,!0)||t;new Xi(this.app,this,s).open()}async openDueDateModal(t){try{let{DueDateModal:r}=await Promise.resolve().then(()=>(Bw(),Hw));new r(this.app,t,this).open()}catch(r){console.error("Error loading DueDateModal:",r)}}async openScheduledDateModal(t){try{let{ScheduledDateModal:r}=await Promise.resolve().then(()=>(Uw(),Ww));new r(this.app,t,this).open()}catch(r){console.error("Error loading ScheduledDateModal:",r)}}async refreshCache(){try{let t=new ne.Notice("Refreshing TaskNotes cache...",0);this.cacheManager.clearAllCaches(),st.clearCache(),await this.cacheManager.initializeCache(),this.notifyDataChanged(void 0,!0,!0),t.hide(),new ne.Notice("TaskNotes cache refreshed successfully")}catch(t){console.error("Error refreshing cache:",t),new ne.Notice("Failed to refresh cache. Please try again.")}}convertTaskToTaskNote(t){try{let r=t.getCursor(),s=t.getLine(r.line),n=It.parseTaskLine(s);if(!n.isTaskLine){new ne.Notice("Current line is not a task. Place cursor on a line with a checkbox task.");return}if(n.error){new ne.Notice(`Error parsing task: ${n.error}`);return}if(!n.parsedData){new ne.Notice("Failed to parse task data from current line.");return}let a={parsedData:n.parsedData,editor:t,lineNumber:r.line};new ni(this.app,this,void 0,a).open()}catch(r){console.error("Error converting task:",r),new ne.Notice("Failed to convert task. Please try again.")}}};var K_=io;
